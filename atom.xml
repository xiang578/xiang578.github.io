<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>算法花园</title>
  
  
  <link href="https://blog.xiang578.com/atom.xml" rel="self"/>
  
  <link href="https://blog.xiang578.com/"/>
  <updated>2024-05-03T06:46:46.000Z</updated>
  <id>https://blog.xiang578.com/</id>
  
  <author>
    <name>Ryen Xiang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>lc1491. 去掉最低工资和最高工资后的工资平均值</title>
    <link href="https://blog.xiang578.com/problem/lc1491.html"/>
    <id>https://blog.xiang578.com/problem/lc1491.html</id>
    <published>2024-05-02T16:00:00.000Z</published>
    <updated>2024-05-03T06:46:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/average-salary-excluding-the-minimum-and-maximum-salary/description/">1491. 去掉最低工资和最高工资后的工资平均值 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>排序，调包即可。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">average</span>(<span class="params">self, salary: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">        salary.sort()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(salary[<span class="number">1</span>:-<span class="number">1</span>])/<span class="built_in">len</span>(salary[<span class="number">1</span>:-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/average-salary-excluding-the-minimum-and-maximum-salary/description/&quot;&gt;1491. 去掉最低工资和最高工资后的工资平均值 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="sortings" scheme="https://blog.xiang578.com/tags/sortings/"/>
    
  </entry>
  
  <entry>
    <title>@didi food中的智能补贴实战漫谈</title>
    <link href="https://blog.xiang578.com/note/WU1iILMFdH3RZAbJKFU4WA.html"/>
    <id>https://blog.xiang578.com/note/WU1iILMFdH3RZAbJKFU4WA.html</id>
    <published>2024-04-18T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>滴滴国际化外卖团队的文章，前几个月做补贴关业务的时候看过。文章链接：<a href="https://mp.weixin.qq.com/s/WU1iILMFdH3RZAbJKFU4WA">https://mp.weixin.qq.com/s/WU1iILMFdH3RZAbJKFU4WA</a></p><span id="more"></span><p>补贴问题和其他机器学习问题最核心和最关键的不同点是补贴行为需要付出成本，一般用 ROI 来评估增加补贴成本带来的增量指标收益。</p><h2 id="智能补贴问题拆解"><a class="markdownIt-Anchor" href="#智能补贴问题拆解"></a> 智能补贴问题拆解</h2><p>预估<strong>干预 action</strong> 相比没有<strong>干预</strong>带来的增量</p><ul><li>建模 [[UPlift Model]]<ul><li>[[Meta Learning]] 主要思想通过一些基模型的组合，去近似你和一个无法被观测到的增量<ul><li>[[Two Model]]  差分模型，利用两个模型的差值去近似用户的增量</li><li>[[Single Model]] 将与干预手段 w 有关的特征加入训练，只建立一个模型。<ul><li>利用样本特征、label、干预 w 训练一个模型</li><li>预测时将特征赋值 w=1 和 w=0 计算用户增量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>τ</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>W</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mover accent="true"><mi>μ</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>W</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{\tau}(x)=\hat{\mu}(x, W=1)-\hat{\mu}(x, W=0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">μ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></li></ul></li><li>[[X-Learner]] 利用观察到的样本结果去预估未观察到的样本结果的思想，对增量进行近似，同时还会对结果进行倾向性权重调整，以达到优化近似结果的目的。</li><li>[[R-Learner]] 通过 Robinson’s transfomation 定义一个损失函数，然后通过最小化损失函数的方法达到对增量进行建模的目的。</li></ul></li><li>tree-base 通过树模型中节点分类的算法思想，尝试直接对增量建模，预测增量。<ul><li>主要思路，通过对特征点进行分裂，<strong>将X划分到一个又一个subspace中，这与补贴场景下，希望找到某一小部分增量很高的用户的想法几乎是完美重合</strong>。</li><li>[[Uplift Decision Tree]] 分裂规则<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mtext>gain </mtext></msub><mo>=</mo><msub><mi>D</mi><mtext>after </mtext></msub><mrow><mo fence="true">(</mo><msup><mi>P</mi><mi>T</mi></msup><mo separator="true">,</mo><msup><mi>P</mi><mi>C</mi></msup><mo fence="true">)</mo></mrow><mo>−</mo><msub><mi>D</mi><mtext>before </mtext></msub><mrow><mo fence="true">(</mo><msup><mi>P</mi><mi>T</mi></msup><mo separator="true">,</mo><msup><mi>P</mi><mi>C</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta_{\text {gain }}=D_{\text {after }}\left(P^T, P^C\right)-D_{\text {before }}\left(P^T, P^C\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.317502em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">gain </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">after </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">before </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></li></ul></li><li>[[Contextual Treatment Selection]] <strong>直接最大化每个节点上实验组和对照组之间label期望的差值（可以理解为该节点上样本的Uplift值）</strong></li></ul></li></ul></li><li>[[Uplift Model 评估]]<ul><li>[[Qini curve]]</li><li>[[AUUC]]</li></ul></li></ul><p>分配策略：存在多种干预 action 和已预估了他们 增量 的情况下，如何为每个用户合理分配 action 以期望达到全局最优</p><ul><li>贪心分配<ul><li>根据运营规则计算每个类别券的可支配数量</li><li>用户按计算出的 uplift 值倒排，按可以发放券的数量截断。</li><li>同一个用户如果在多个券的 uplift 都比较高，优先发比较低的券</li></ul></li><li>整数规划<ul><li>参数含义<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>：是否对用户 i 发 j 券</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 增量模型预估用户 i 在 j 券下的增量</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 转化率模型预估用户 i 在 j 券下的转化率</li></ul></li><li>优化目标<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>t</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>t</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>t</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>t</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>t</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>t</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>t</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>t</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max \left(x_{1,1} t_{1,1}+x_{1,2} t_{1,2}+x_{1,3} t_{1,3}+x_{1,4} t_{1,4}+\ldots+x_{n, 1} t_{n, 1}+x_{n, 2} t_{n, 2}+x_{n, 3} t_{n, 3}+x_{n, 4} t_{n, 4}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li></ul></li><li>问题约束<ul><li>用户只能拿到一张券<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\left\{\begin{array}{l}x_{1,1}+x_{1,2}+x_{1,3}+x_{1,4}=1 \\ \cdots \\ x_{n, 1}+x_{n, 2}+x_{n, 3}+x_{n, 4}=1\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.00501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">{</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo fence="true">}</mo></mrow><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\left\{x_{1,1}, x_{1,2}, x_{1,3}, x_{1,4}, \ldots, x_{n, 1}, x_{n, 2}, x_{n, 3}, x_{n, 4}\right\} \in\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></li></ul></li><li>总资金约束<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>c</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>p</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>c</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>p</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>c</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>p</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>c</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><msub><mi>c</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>p</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><msub><mi>c</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>p</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><msub><mi>c</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>p</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><msub><mi>c</mi><mrow><mi>n</mi><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>≤</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">x_{1,1} p_{1,1} c_{1,1}+x_{1,2} p_{1,2} c_{1,2}+x_{1,3} p_{1,3} c_{1,3}+x_{1,4} p_{1,4} c_{1,4}+\ldots+x_{n, 1} p_{n, 1} c_{n, 1}+x_{n, 2} p_{n, 2} c_{n, 2}+x_{n, 3} p_{n, 3} c_{n, 3}+x_{n, 4} p_{n, 4} c_{n, 4} \leq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li></ul></li></ul></li></ul></li></ul><h2 id="实验设计"><a class="markdownIt-Anchor" href="#实验设计"></a> 实验设计</h2><p>作者做了两组实验，来分别验证不同业务目标。（相同补贴或者相同单量/GMV 条件下，对比 ROI 才有意义）</p><ul><li>相同单量，更少补贴</li><li>相同补贴，更多单量</li></ul><h2 id="后续规划"><a class="markdownIt-Anchor" href="#后续规划"></a> 后续规划</h2><p>整数规划与强化学习理论结合的可能性</p><p>当前方法是针对每一次活动求得全局的最优化，实际需要对用户长期价值 [[LTV]] 建模。</p><h2 id="问题"><a class="markdownIt-Anchor" href="#问题"></a> 问题</h2><h3 id="如何正确理解线上业务指标-roi"><a class="markdownIt-Anchor" href="#如何正确理解线上业务指标-roi"></a> 如何正确理解线上业务指标 [[ROI]]</h3><ul><li><img src="https://media.xiang578.com/202404192114955.png" alt="" /></li></ul><h3 id="如何理解离线指标-auuc"><a class="markdownIt-Anchor" href="#如何理解离线指标-auuc"></a> 如何理解离线指标 [[AUUC]]</h3><ul><li>[[AUC]] 不同范围含义<ul><li>0.5 随机线</li><li>0.6 模型还需要迭代</li><li>0.6-0.8 模型上线标准</li><li>0.9 模型是否过拟合或是否有未知强相关特征参与模型训练</li></ul></li><li>补贴问题本身就是与实验批次和样本强相关的问题，很难在增量预估模型中建立一套类似 auc 的标准</li><li><img src="https://media.xiang578.com/202404192114116.png" alt="" /></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;滴滴国际化外卖团队的文章，前几个月做补贴关业务的时候看过。文章链接：&lt;a href=&quot;https://mp.weixin.qq.com/s/WU1iILMFdH3RZAbJKFU4WA&quot;&gt;https://mp.weixin.qq.com/s/WU1iILMFdH3RZAbJKFU4WA&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="Causal Inference" scheme="https://blog.xiang578.com/tags/Causal-Inference/"/>
    
    <category term="智能营销" scheme="https://blog.xiang578.com/tags/%E6%99%BA%E8%83%BD%E8%90%A5%E9%94%80/"/>
    
    <category term="Ref" scheme="https://blog.xiang578.com/tags/Ref/"/>
    
    <category term="web" scheme="https://blog.xiang578.com/tags/web/"/>
    
    <category term="Ship 90 for 90" scheme="https://blog.xiang578.com/tags/Ship-90-for-90/"/>
    
  </entry>
  
  <entry>
    <title>lc2923.找到冠军 i</title>
    <link href="https://blog.xiang578.com/problem/lc2923.html"/>
    <id>https://blog.xiang578.com/problem/lc2923.html</id>
    <published>2024-04-11T16:00:00.000Z</published>
    <updated>2024-05-12T11:11:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/find-champion-i/description/">2923. 找到冠军 I - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>简单模拟，写的时候发现自己的 Voyager 键盘忘记设置大于号和小于号，还是从题目中复制的符号。。。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findChampion</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n = grid.<span class="built_in">size</span>();</span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i) &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j) &#123;</span><br><span class="line">sum+=grid[i][j];</span><br><span class="line">&#125;</span><br><span class="line">          </span><br><span class="line"><span class="keyword">if</span> (sum == n<span class="number">-1</span>) &#123;</span><br><span class="line">ans = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/find-champion-i/description/&quot;&gt;2923. 找到冠军 I - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="implementation" scheme="https://blog.xiang578.com/tags/implementation/"/>
    
    <category term="Easy" scheme="https://blog.xiang578.com/tags/Easy/"/>
    
  </entry>
  
  <entry>
    <title>git pull 报错 MERGE_HEAD exists</title>
    <link href="https://blog.xiang578.com/note/202404111048.html"/>
    <id>https://blog.xiang578.com/note/202404111048.html</id>
    <published>2024-04-10T16:00:00.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>git pull 时，出现如下报错信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">error: You have not concluded your merge (MERGE_HEAD exists).  </span><br><span class="line">hint: Please, commit your changes before merging.  </span><br><span class="line">fatal: Exiting because of unfinished merge.</span><br></pre></td></tr></table></figure><span id="more"></span><p>产生这个错误的原因可能是：以前 pull 下来的代码自动合并失败。解决方法：</p><ul><li>方法一：放弃本地修改，直接覆盖。<code>git reset --hard</code> 以及 <code>git pull</code></li><li>方法二：先 commit 然后再 pull 或 merge。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;git pull 时，出现如下报错信息：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;error: You have not concluded your merge (MERGE_HEAD exists).  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hint: Please, commit your changes before merging.  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fatal: Exiting because of unfinished merge.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="git" scheme="https://blog.xiang578.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Today I Learned</title>
    <link href="https://blog.xiang578.com/note/today-i-learned.html"/>
    <id>https://blog.xiang578.com/note/today-i-learned.html</id>
    <published>2024-04-07T16:00:00.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>本周从 howie serious 的文章 <a href="https://mp.weixin.qq.com/s/uVUOUMRHNc9RH-mQRv4-oA">TIL笔记｜你嘛时候终身学习啊？</a>   学到一个工作方法：Today I Learned，今天我学到。简单来说就是把自己每天学到的东西写下来，在网上公开发表。</p><span id="more"></span><p>这个概念最早的发起人是 Josh Branchau，他差不多从 2015 年开始执行，公开库 <a href="https://github.com/jbranchaud/til">jbranchaud/til: 📝 Today I Learned (github.com)</a>  中已经包含 1400+ 的笔记，笔记按主题分类且大部分和编程相关。他在文章  <a href="https://dev.to/jbranchaud/how-i-built-a-learning-machine-45k9">How I Built a Learning Machine - DEV Community</a>  中提到过三个心得：</p><ol><li>每篇文章限制在 200 字或更少</li><li>每天花 10 到 15 分钟</li><li>在工作中学习，工作时间写</li></ol><p>对自己来说，希望能借助这种形式，将更多的笔记公开到网络上，同时让博客获得更多的访问量。</p><p>另外提一句，开头提到 howie serious 是小能熊的创始人，相当于是一位效率教练。18 年左右看过他的<a href="%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E8%AE%AD%E7%BB%83%E8%90%A5.md">知识管理训练营</a>，当时还按里面的思路用 wikipedie 性质分类+杜威十进制分类在 evernote 上进行知识管理。重新看到他的文章，有一种多年老朋友重新相逢的感觉。</p><h2 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> Ref</h2><ul><li><a href="https://til.simonwillison.net/">Simon Willison: TIL</a></li><li>howie serious 的 <a href="https://todayilearned.candobear.com/">todayilearned 笔记</a> 以及 <a href="https://todayiread.candobear.com/#/page/%F0%9F%93%9A%20today%20i%20read">📚 today i read 阅读笔记</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;本周从 howie serious 的文章 &lt;a href=&quot;https://mp.weixin.qq.com/s/uVUOUMRHNc9RH-mQRv4-oA&quot;&gt;TIL笔记｜你嘛时候终身学习啊？&lt;/a&gt;   学到一个工作方法：Today I Learned，今天我学到。简单来说就是把自己每天学到的东西写下来，在网上公开发表。&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="Workflow" scheme="https://blog.xiang578.com/tags/Workflow/"/>
    
  </entry>
  
  <entry>
    <title>Github Publisher</title>
    <link href="https://blog.xiang578.com/note/github-publisher.html"/>
    <id>https://blog.xiang578.com/note/github-publisher.html</id>
    <published>2024-04-03T16:00:00.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>原来一直用 Logseq 写笔记，等了好久也没有等到一个可以把笔记导出成 md 文章的插件。昨天晚上看其他人博客的时，发现 Obsidian 插件 <a href="https://github.com/ObsidianPublisher/obsidian-github-publisher">Gihub Publisher</a>，可以通过内建的命令把笔记上传到指定的 github 仓库，从而实现使用 Obsidian 管理 blog 文章。</p><span id="more"></span><ul><li><code>Share key</code> 把 share 改成 public，实现和 logseq 兼容</li><li><code>Contents - Internals links</code> 将 wiki link 转换成内部链接，但是 hexo 好像不支持解析内部链接。</li></ul><p>一些问题：</p><ul><li>笔记改名后 publish，会新增加一篇文章，但是不会删除旧的笔记。</li></ul><h2 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> Ref</h2><ul><li><a href="">ObsidianPublisher/obsidian-github-publisher: Github Publisher helps you to publish your notes on a preconfigured GitHub repository from your Obsidian Vault, for free, and more!</a></li><li><a href="https://www.jiangyu.org/obsidian-plugin-and-hexo/">最近折腾Obsidian及hexo - 天一生水 (jiangyu.org)</a><ul><li>用 dataview 生成读书页面</li></ul></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;原来一直用 Logseq 写笔记，等了好久也没有等到一个可以把笔记导出成 md 文章的插件。昨天晚上看其他人博客的时，发现 Obsidian 插件 &lt;a href=&quot;https://github.com/ObsidianPublisher/obsidian-github-publisher&quot;&gt;Gihub Publisher&lt;/a&gt;，可以通过内建的命令把笔记上传到指定的 github 仓库，从而实现使用 Obsidian 管理 blog 文章。&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="Obsidian" scheme="https://blog.xiang578.com/tags/Obsidian/"/>
    
  </entry>
  
  <entry>
    <title>修复 Github Action 无法构建 Hexo 博客</title>
    <link href="https://blog.xiang578.com/note/fix-github-action-build-error.html"/>
    <id>https://blog.xiang578.com/note/fix-github-action-build-error.html</id>
    <published>2024-04-03T16:00:00.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<p>挺长时间没有通过 Github Action 编译过 Hexo 博客，为了更好搭配<a href="Github%20Publisher.md">Github Publisher</a>使用，今天重新打开 action，运行过程中报了下面几个错误，导致无法产出正常的静态文件。</p><span id="more"></span><h2 id="问题一error-cannot-find-module-remywebmentionlibwebmention"><a class="markdownIt-Anchor" href="#问题一error-cannot-find-module-remywebmentionlibwebmention"></a> 问题一：Error: Cannot find module ‘@remy/webmention/lib/webmention’</h2><p>找不到插件，暂时也没有使用这个插件。直接删除对这个包的依赖。<code>npm uninstall hexo-console-webmention --save</code></p><h2 id="问题二-typeerror-require-is-not-a-function"><a class="markdownIt-Anchor" href="#问题二-typeerror-require-is-not-a-function"></a> 问题二：  TypeError: require(…) is not a function</h2><p>报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[7](https://github.com/xiang578/blog-source/actions/runs/8553722187/job/23437478940#step:9:8)Inferno is in development mode.</span><br><span class="line"></span><br><span class="line">[8](https://github.com/xiang578/blog-source/actions/runs/8553722187/job/23437478940#step:9:9)ERROR Script load failed: themes/icarus/scripts/index.js</span><br><span class="line"></span><br><span class="line">[9](https://github.com/xiang578/blog-source/actions/runs/8553722187/job/23437478940#step:9:10)TypeError: require(...) is not a function</span><br><span class="line"></span><br><span class="line">[10](https://github.com/xiang578/blog-source/actions/runs/8553722187/job/23437478940#step:9:11) at /home/runner/work/blog-source/blog-source/themes/icarus/scripts/index.js:2:35</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在使用主题是 <code>hexo-theme-icarus</code>，开发者今天二月份回复 issues  <a href="https://github.com/ppoffice/hexo-theme-icarus/issues/1270">使用源码安装主题报错 · Issue #1270 · ppoffice/hexo-theme-icarus (github.com)</a>指出 hexo-log 4.0含有不兼容的升级。</p><ul><li>由于用的是自己 clone 的版本，参考开发者的修复代码 <a href="https://github.com/ppoffice/hexo-theme-icarus/commit/b1962d7257c566ea647ac1fd477c5f9df4774ee4">chore: update to hexo 7 · ppoffice/hexo-theme-icarus@b1962d7 (github.com)</a>将整个主题中的 <code>const logger = require('hexo-log')();</code> 替换成 <code>const createLogger = require('hexo-log');const logger = typeof createLogger === &quot;function&quot; ? createLogger() : createLogger.default();</code>，大约有 11 处。</li><li>另外也需要修改主题的 <code>package.json</code> 我直接复制这个链接 <a href="https://github.com/ppoffice/hexo-theme-icarus/blob/b1962d7257c566ea647ac1fd477c5f9df4774ee4/package.json">hexo-theme-icarus/package.json at b1962d7257c566ea647ac1fd477c5f9df4774ee4 · ppoffice/hexo-theme-icarus (github.com)</a> 里面的内容替换原始文件。</li></ul><h2 id="问题三error-cannot-find-module-hexolibpluginshelperdate"><a class="markdownIt-Anchor" href="#问题三error-cannot-find-module-hexolibpluginshelperdate"></a> 问题三：Error: Cannot find module ‘hexo/lib/plugins/helper/date’</h2><p>旧的依赖已经删除，需要把主题代码中 <code>require('hexo/lib/plugins/helper/date');</code> 改成  <code>require('hexo/dist/plugins/helper/date'); </code>。</p><p>修复上面三个问题，action 又可以正常生成静态网页。用了 Hexo 快 10 年，经常遇到这些糟心的问题，感觉是时候离开了。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;挺长时间没有通过 Github Action 编译过 Hexo 博客，为了更好搭配&lt;a href=&quot;Github%20Publisher.md&quot;&gt;Github Publisher&lt;/a&gt;使用，今天重新打开 action，运行过程中报了下面几个错误，导致无法产出正常的静态文件。&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="Hexo" scheme="https://blog.xiang578.com/tags/Hexo/"/>
    
    <category term="Github" scheme="https://blog.xiang578.com/tags/Github/"/>
    
    <category term="Action" scheme="https://blog.xiang578.com/tags/Action/"/>
    
  </entry>
  
  <entry>
    <title>lc2575.找出字符串的可整除数组</title>
    <link href="https://blog.xiang578.com/problem/lc2575.html"/>
    <id>https://blog.xiang578.com/problem/lc2575.html</id>
    <published>2024-03-06T16:00:00.000Z</published>
    <updated>2024-05-12T10:30:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>按题意模拟，对中间变量一直模 m。中间过程可能超过 int 范围。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=2575 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [2575] 找出字符串的可整除数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">divisibilityArray</span><span class="params">(string word, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">       vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">       <span class="type">long</span> <span class="type">long</span> p=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i&lt;word.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            p = p*<span class="number">10</span>+word[i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (p%m==<span class="number">0</span>) ans.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span> ans.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            p = p%m;</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="keyword">return</span> ans; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="implementation" scheme="https://blog.xiang578.com/tags/implementation/"/>
    
  </entry>
  
  <entry>
    <title>lc2917.找出数组中的k-or值</title>
    <link href="https://blog.xiang578.com/problem/lc2917.html"/>
    <id>https://blog.xiang578.com/problem/lc2917.html</id>
    <published>2024-03-05T16:00:00.000Z</published>
    <updated>2024-05-12T03:24:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/find-the-k-or-of-an-array/description/">2917. 找出数组中的 K-or 值 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>位运算，按题意模拟。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=2917 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [2917] 找出数组中的 K-or 值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findKOr</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> a[<span class="number">32</span>];</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span> a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> num:nums) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">31</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(num &amp; (<span class="number">1</span>&lt;&lt;i)) a[i]+=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">31</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] &gt;= k) &#123;</span><br><span class="line">                ans += (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/find-the-k-or-of-an-array/description/&quot;&gt;2917. 找出数组中的 K-or 值 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="implementation" scheme="https://blog.xiang578.com/tags/implementation/"/>
    
    <category term="Easy" scheme="https://blog.xiang578.com/tags/Easy/"/>
    
  </entry>
  
  <entry>
    <title>lc1976. 到达目的地的方案数</title>
    <link href="https://blog.xiang578.com/problem/lc1976.html"/>
    <id>https://blog.xiang578.com/problem/lc1976.html</id>
    <published>2024-03-04T16:00:00.000Z</published>
    <updated>2024-05-12T04:05:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>最短路，堆优化</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countPaths</span><span class="params">(<span class="type">int</span> n, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; roads)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> dp[<span class="number">300</span>];</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> mp[<span class="number">300</span>][<span class="number">300</span>];</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> cnt[<span class="number">300</span>];</span><br><span class="line">        <span class="type">int</span> u[<span class="number">300</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// vector&lt;vector&lt;pair&lt;int,long long&gt;&gt;&gt;mp[300];</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">            dp[i]=<span class="number">0x7fffffffffffffff</span>;</span><br><span class="line">            cnt[i]=<span class="number">0</span>;</span><br><span class="line">            u[i]=<span class="number">0</span>;</span><br><span class="line">            <span class="comment">// mp[i].clear();</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(mp, <span class="number">0xff</span>, <span class="keyword">sizeof</span> mp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> r:roads) &#123;</span><br><span class="line">            mp[r[<span class="number">0</span>]][r[<span class="number">1</span>]] = r[<span class="number">2</span>];</span><br><span class="line">            mp[r[<span class="number">1</span>]][r[<span class="number">0</span>]] = r[<span class="number">2</span>];</span><br><span class="line">            <span class="comment">// mp[r[0]].push_back(make_pair(r[1], r[2]));</span></span><br><span class="line">            <span class="comment">// mp[r[1]].push_back(make_pair(r[0], r[2]));</span></span><br><span class="line">        &#125;</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        cnt[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">using</span> Pair = pair&lt;<span class="type">long</span> <span class="type">long</span>, <span class="type">int</span>&gt;;</span><br><span class="line">        priority_queue&lt;Pair, vector&lt;Pair&gt;, greater&lt;Pair&gt;&gt; Q;  <span class="comment">// 小根堆</span></span><br><span class="line">        Q.<span class="built_in">push</span>(<span class="built_in">Pair</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">auto</span> k = Q.<span class="built_in">top</span>().second;</span><br><span class="line">            <span class="comment">// cout&lt;&lt;k&lt;&lt;endl;</span></span><br><span class="line">            Q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(u[k]) <span class="keyword">continue</span>;</span><br><span class="line">            u[k]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="comment">// cout&lt;&lt;i&lt;&lt;&quot;-&gt;&quot;&lt;&lt;k&lt;&lt;&quot;, &quot;&lt;&lt;mp[k][i]&lt;&lt;&quot; &quot;&lt;&lt;Q.size()&lt;&lt;endl;</span></span><br><span class="line">                <span class="keyword">if</span> (mp[k][i] !=<span class="number">-1</span> &amp;&amp; dp[k] + mp[k][i] &lt;= dp[i]) &#123;</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">if</span>(dp[k]+mp[k][i]==dp[i]) &#123;</span><br><span class="line">                    cnt[i] += cnt[k];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    cnt[i] = cnt[k];  </span><br><span class="line">                &#125; </span><br><span class="line">                dp[i] = dp[k] + mp[k][i];</span><br><span class="line">                cnt[i] %= mod;</span><br><span class="line">                Q.<span class="built_in">push</span>(<span class="built_in">Pair</span>(dp[i], i));</span><br><span class="line">                </span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt[n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="最短路" scheme="https://blog.xiang578.com/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>lc232.用栈实现队列</title>
    <link href="https://blog.xiang578.com/problem/lc232.html"/>
    <id>https://blog.xiang578.com/problem/lc232.html</id>
    <published>2024-03-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>简单模拟</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=232 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [232] 用栈实现队列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyQueue</span> &#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt;s1;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt;s2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyQueue</span>() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        s1.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(!s1.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            s2.<span class="built_in">push</span>(s1.<span class="built_in">top</span>());</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ret = s2.<span class="built_in">top</span>();</span><br><span class="line">        s2.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">while</span>(!s2.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            s1.<span class="built_in">push</span>(s2.<span class="built_in">top</span>());</span><br><span class="line">            s2.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(!s1.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            s2.<span class="built_in">push</span>(s1.<span class="built_in">top</span>());</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ret = s2.<span class="built_in">top</span>();</span><br><span class="line">        <span class="comment">// s2.pop();</span></span><br><span class="line">        <span class="keyword">while</span>(!s2.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            s1.<span class="built_in">push</span>(s2.<span class="built_in">top</span>());</span><br><span class="line">            s2.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s1.<span class="built_in">empty</span>()) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyQueue object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyQueue* obj = new MyQueue();</span></span><br><span class="line"><span class="comment"> * obj-&gt;push(x);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj-&gt;pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj-&gt;peek();</span></span><br><span class="line"><span class="comment"> * bool param_4 = obj-&gt;empty();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc225.用队列实现栈</title>
    <link href="https://blog.xiang578.com/problem/lc225.html"/>
    <id>https://blog.xiang578.com/problem/lc225.html</id>
    <published>2024-03-02T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>最简单的模拟，用一个 vector 就可以？好像是偷懒了。。。。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=225 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [225] 用队列实现栈</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyStack</span> &#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MyStack</span>() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        q.<span class="built_in">push_back</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = q[q.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">        q.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> q[q.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (q.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyStack object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyStack* obj = new MyStack();</span></span><br><span class="line"><span class="comment"> * obj-&gt;push(x);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj-&gt;pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj-&gt;top();</span></span><br><span class="line"><span class="comment"> * bool param_4 = obj-&gt;empty();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc2368.受限条件下可到达节点的数目</title>
    <link href="https://blog.xiang578.com/problem/lc2368.html"/>
    <id>https://blog.xiang578.com/problem/lc2368.html</id>
    <published>2024-03-01T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>简单 dfs</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># @lc app=leetcode.cn id=<span class="number">2368</span> lang=python3</span><br><span class="line">#</span><br><span class="line"># [<span class="number">2368</span>] 受限条件下可到达节点的数目</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># @lc code=start</span><br><span class="line"><span class="keyword">class</span> Solution:</span><br><span class="line">    def <span class="built_in">reachableNodes</span>(self, n: <span class="type">int</span>, edges: List[List[<span class="type">int</span>]], restricted: List[<span class="type">int</span>]) -&gt; <span class="type">int</span>:</span><br><span class="line">        g = [[] <span class="keyword">for</span> i in <span class="built_in">range</span>(n)]</span><br><span class="line">        <span class="keyword">for</span> e in edges:</span><br><span class="line">            g[e[<span class="number">0</span>]].<span class="built_in">append</span>(e[<span class="number">1</span>])</span><br><span class="line">            g[e[<span class="number">1</span>]].<span class="built_in">append</span>(e[<span class="number">0</span>])</span><br><span class="line">        ok = <span class="built_in">set</span>(restricted)</span><br><span class="line"></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        def <span class="built_in">dfs</span>(rt, fa):</span><br><span class="line">            <span class="keyword">if</span> rt in ok:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            ret = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> nx in g[rt]:</span><br><span class="line">                <span class="keyword">if</span> nx == fa:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                ret += <span class="built_in">dfs</span>(nx, rt)</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line"># @lc code=end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc2369.检查数组是否存在有效划分</title>
    <link href="https://blog.xiang578.com/problem/lc2369.html"/>
    <id>https://blog.xiang578.com/problem/lc2369.html</id>
    <published>2024-03-01T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>简单 dp</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=2369 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [2369] 检查数组是否存在有效划分</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">validPartition</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ok[<span class="number">112345</span>];</span><br><span class="line">        <span class="built_in">memset</span>(ok, <span class="number">0</span>, <span class="keyword">sizeof</span> ok);</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(nums[i<span class="number">-1</span>] == nums[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">1</span>||ok[i<span class="number">-2</span>]) ok[i] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(i&gt;=<span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i<span class="number">-2</span>] == nums[i<span class="number">-1</span>] &amp;&amp; nums[i<span class="number">-1</span>] == nums[i]) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(i==<span class="number">2</span>||ok[i<span class="number">-3</span>]) ok[i] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(nums[i<span class="number">-2</span>] + <span class="number">1</span> == nums[i<span class="number">-1</span>] &amp;&amp; nums[i<span class="number">-1</span>] +<span class="number">1</span> == nums[i]) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(i==<span class="number">2</span>||ok[i<span class="number">-3</span>]) ok[i] = <span class="number">1</span>;</span><br><span class="line">                &#125; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ok[n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Dynamic Programming" scheme="https://blog.xiang578.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>lc2581.统计可能的树根数目</title>
    <link href="https://blog.xiang578.com/problem/lc2581.html"/>
    <id>https://blog.xiang578.com/problem/lc2581.html</id>
    <published>2024-02-28T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>如果已知 fa 为根时，满足猜测的答案是 now，那么如果 nx 为根，fa 为叶子，对答案的贡献就是 (fa, nx) 和 (nx, fa)。</p><p>第一次以 0 为根，计算满足的答案，之后再 dfs，每次值影响两个节点的关系。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># @lc app=leetcode.cn id=<span class="number">2581</span> lang=python3</span><br><span class="line">#</span><br><span class="line"># [<span class="number">2581</span>] 统计可能的树根数目</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># @lc code=start</span><br><span class="line"><span class="keyword">class</span> Solution:</span><br><span class="line">    def <span class="built_in">rootCount</span>(self, edges: List[List[<span class="type">int</span>]], guesses: List[List[<span class="type">int</span>]], k: <span class="type">int</span>) -&gt; <span class="type">int</span>:</span><br><span class="line">        g = [[] <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(edges) + <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">for</span> a in edges:</span><br><span class="line">            g[a[<span class="number">0</span>]].<span class="built_in">append</span>(a[<span class="number">1</span>])</span><br><span class="line">            g[a[<span class="number">1</span>]].<span class="built_in">append</span>(a[<span class="number">0</span>])</span><br><span class="line">        guesse = &#123;(a[<span class="number">0</span>], a[<span class="number">1</span>]) <span class="keyword">for</span> a in guesses&#125;</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        base = <span class="number">0</span></span><br><span class="line">        def <span class="built_in">dfs</span>(rt, fa):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (fa, rt) in guesse:</span><br><span class="line">                nonlocal base</span><br><span class="line">                base += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> nx in g[rt]:</span><br><span class="line">                <span class="keyword">if</span> nx == fa:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="built_in">dfs</span>(nx, rt)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">        <span class="meta"># print(base)</span></span><br><span class="line"></span><br><span class="line">        def <span class="built_in">check</span>(rt, fa, now):</span><br><span class="line">            nonlocal ans</span><br><span class="line">            <span class="keyword">if</span> (now &gt;= k):</span><br><span class="line">                ans += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> nx in g[rt]:</span><br><span class="line">                <span class="keyword">if</span> nx == fa:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                tmp = now</span><br><span class="line">                <span class="keyword">if</span> (rt, nx) in guesse:</span><br><span class="line">                    tmp -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> (nx, rt) in guesse:</span><br><span class="line">                    tmp += <span class="number">1</span></span><br><span class="line">                <span class="built_in">check</span>(nx, rt, tmp)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">check</span>(<span class="number">0</span>, <span class="number">-1</span>, base)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"># @lc code=end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Dynamic Programming" scheme="https://blog.xiang578.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>lc2763.使二叉树所有路径值相等的最小代价</title>
    <link href="https://blog.xiang578.com/problem/lc2763.html"/>
    <id>https://blog.xiang578.com/problem/lc2763.html</id>
    <published>2024-02-27T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>树形 DP，每一个节点最后对答案贡献是左右子树路径 sum 的差。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># @lc app=leetcode.cn id=<span class="number">2673</span> lang=python3</span><br><span class="line">#</span><br><span class="line"># [<span class="number">2673</span>] 使二叉树所有路径值相等的最小代价</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># @lc code=start</span><br><span class="line"><span class="keyword">class</span> Solution:</span><br><span class="line">    def <span class="built_in">minIncrements</span>(self, n: <span class="type">int</span>, cost: List[<span class="type">int</span>]) -&gt; <span class="type">int</span>:</span><br><span class="line">        </span><br><span class="line">        <span class="meta"># ans = 0</span></span><br><span class="line">        def <span class="built_in">dfs</span>(rt, n):</span><br><span class="line">            <span class="keyword">if</span> rt &gt; n:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">            now_ans = <span class="number">0</span></span><br><span class="line">            left, ans = <span class="built_in">dfs</span>(rt*<span class="number">2</span>, n)</span><br><span class="line">            now_ans += ans</span><br><span class="line">            right, ans = <span class="built_in">dfs</span>(rt*<span class="number">2</span>+<span class="number">1</span>, n)</span><br><span class="line">            now_ans += ans</span><br><span class="line">            now_ans += <span class="built_in">abs</span>(left-right)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(left, right) + cost[rt<span class="number">-1</span>], now_ans</span><br><span class="line">        </span><br><span class="line">        sum1, ans = <span class="built_in">dfs</span>(<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"># @lc code=end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="树形 DP" scheme="https://blog.xiang578.com/tags/%E6%A0%91%E5%BD%A2-DP/"/>
    
  </entry>
  
  <entry>
    <title>lc2867.统计树中的合法路径数目</title>
    <link href="https://blog.xiang578.com/problem/lc2867.html"/>
    <id>https://blog.xiang578.com/problem/lc2867.html</id>
    <published>2024-02-26T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/count-valid-paths-in-a-tree/">https://leetcode.cn/problems/count-valid-paths-in-a-tree/</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>方法一：简单树形dp，需要预处理质数。</p><p>方法二：将所有联通的素数放到一个并查集，减少重复计算</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/count-valid-paths-in-a-tree/&quot;&gt;https://leetcode.cn/problems/count-valid-paths-in-a-tree/&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="树形 DP" scheme="https://blog.xiang578.com/tags/%E6%A0%91%E5%BD%A2-DP/"/>
    
  </entry>
  
  <entry>
    <title>lc235.二叉搜索树的最近公共祖先</title>
    <link href="https://blog.xiang578.com/problem/lc235.html"/>
    <id>https://blog.xiang578.com/problem/lc235.html</id>
    <published>2024-02-24T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>由于是二叉搜索树，两个节点的最近公共祖先就是从 root 找到第一个 val 在两个节点之间的节点。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># @lc app=leetcode.cn id=<span class="number">235</span> lang=python3</span><br><span class="line">#</span><br><span class="line"># LC235.二叉搜索树的最近公共祖先</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># @lc code=start</span><br><span class="line"># Definition <span class="keyword">for</span> a binary tree node.</span><br><span class="line"><span class="meta"># class TreeNode:</span></span><br><span class="line"><span class="meta">#     def __init__(self, x):</span></span><br><span class="line"><span class="meta">#         self.val = x</span></span><br><span class="line"><span class="meta">#         self.left = None</span></span><br><span class="line"><span class="meta">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Solution:</span><br><span class="line">    def <span class="built_in">lowestCommonAncestor</span>(self, root: <span class="string">&#x27;TreeNode&#x27;</span>, p: <span class="string">&#x27;TreeNode&#x27;</span>, q: <span class="string">&#x27;TreeNode&#x27;</span>) -&gt; <span class="string">&#x27;TreeNode&#x27;</span>:</span><br><span class="line">        </span><br><span class="line">        pp = <span class="built_in">min</span>(p.val, q.val)</span><br><span class="line">        qq = <span class="built_in">max</span>(p.val, q.val)</span><br><span class="line">        def <span class="built_in">dfs</span>(rt):</span><br><span class="line">            <span class="meta"># print(rt.val, pp, qq)</span></span><br><span class="line">            <span class="keyword">if</span> rt.val &gt;= pp <span class="keyword">and</span> rt.val &lt;= qq:</span><br><span class="line">                <span class="keyword">return</span> rt</span><br><span class="line">            <span class="keyword">if</span> rt.val &gt; qq:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">dfs</span>(rt.left)</span><br><span class="line">            <span class="keyword">if</span> rt.val &lt; pp:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">dfs</span>(rt.right)</span><br><span class="line">        <span class="meta"># ans = dfs(root)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(root)</span><br><span class="line"># @lc code=end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="二叉搜索树" scheme="https://blog.xiang578.com/tags/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/"/>
    
    <category term="最近公共祖先" scheme="https://blog.xiang578.com/tags/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/"/>
    
  </entry>
  
  <entry>
    <title>lc2476.二叉搜索树最近节点查询</title>
    <link href="https://blog.xiang578.com/problem/lc2476.html"/>
    <id>https://blog.xiang578.com/problem/lc2476.html</id>
    <published>2024-02-23T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>题目中有坑，如果树退化成一个链，每次在树上搜索会超时。所以先把二叉搜索树转到一个数组（中序遍历），然后每次在数组上二分查找。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=2476 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [2476] 二叉搜索树最近节点查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode() : val(0), left(nullptr), right(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(nullptr), right(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x, TreeNode *left, TreeNode *right) : val(x), left(left), right(right) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">closestNodes</span>(TreeNode* root, vector&lt;<span class="type">int</span>&gt;&amp; queries) &#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; tmp;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            TreeNode* node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            tmp.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left) q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;right) q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sort</span>(tmp.<span class="built_in">begin</span>(), tmp.<span class="built_in">end</span>());</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; queries.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="type">int</span> left = <span class="number">-1</span>;</span><br><span class="line">            <span class="type">int</span> right = <span class="number">-1</span>;</span><br><span class="line">            <span class="type">int</span> k = <span class="built_in">lower_bound</span>(tmp.<span class="built_in">begin</span>(), tmp.<span class="built_in">end</span>(), queries[i]) - tmp.<span class="built_in">begin</span>();</span><br><span class="line">            <span class="keyword">if</span>(k!=tmp.<span class="built_in">size</span>() &amp;&amp; tmp[k] == queries[i]) &#123;</span><br><span class="line">                left = queries[i];</span><br><span class="line">                right = queries[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;right = tmp[k];&#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (k == tmp.<span class="built_in">size</span>()) &#123;left = tmp[k<span class="number">-1</span>];&#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                left = tmp[k<span class="number">-1</span>];</span><br><span class="line">                right = tmp[k];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            ans.<span class="built_in">push_back</span>(&#123;left, right&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="二叉搜索树" scheme="https://blog.xiang578.com/tags/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】 8 新的键盘</title>
    <link href="https://blog.xiang578.com/weekly/thinking-8.html"/>
    <id>https://blog.xiang578.com/weekly/thinking-8.html</id>
    <published>2024-02-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:08:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>不想计算距离上次写[[thinking 7]]过去多久，2024 年也已经过去一个月。反正还想立下一个 flag，今年一定要多写几篇！</p><span id="more"></span><p>本周最期待的事情就是收到 ZSA 从台湾寄过来的键盘快递。在使用了快4年的Ergodox ez 后，自己又下单一把分体键盘 <a href="https://www.zsa.io/voyager/">The Voyager: A powerful, low-profile, split ergonomic keyboard | zsa.io</a>。这次选择的是黑色、无刻、凯华茶轴，键盘花费 365 美元（其实商品价值只有 220美元，ZSA这SB公司非要收你 145 刀的快递费），另外过海关报税+快递公司服务费约 240 元。大概得时间线是：1.19 下单，1.30 ZSA 通过 DHL 发出快递，1.31 快递到达海关，DHL 的员工联系你去填写相关资料报关，2.1 海关清关，2.2 收到键盘。大概 10 天多一点，被国内次日达的服务惯坏之后，等待的时间确实挺煎熬。收到那天还随便录一个 <a href="https://www.bilibili.com/video/BV17F4m1u7NP">Zsa voyager 键盘开箱_哔哩哔哩_bilibili</a> ，后面用一段时间再来写写使用感受吧（希望我还记得）。目前用的键盘 layout：<a href="https://configure.zsa.io/voyager/layouts/dY7pX/yg0Dl/0">my voyager</a></p><p><img src="https://media.xiang578.com/202402052017893.png" alt="" /></p><p>工作方面，入职飞猪已经三个月，老板一直让做和机票红包补贴相关的事情。不过，自己对营销相关的方法基本上是一无所知，现在很大一部分精力花在恶补相关的知识。上周看完滴滴城运服团队发在 SIGIR 2023 上的论文 [[@A Consumer Compensation System in Ride-hailing Service]]，文章主要介绍他们在货运和代驾业务上实现的基于 ODT  的用户补贴系统，包括离线构建补贴词典（价格弹性建模 + 运筹求解分配方案）以及在线部署。不知道是不是这个会议文章长度限制，有挺多感兴趣的点他们没有仔细去写。</p><p>另外，周末一直在看 Dragonnet 的原文 [[@Adapting Neural Networks for the Estimation of Treatment Effects]]，targeted regularization 部分用到一些高级的统计知识，看了很久都是云里雾里。今天在知乎冲浪时，看到翁恺老师的鸡汤：<a href="https://www.bilibili.com/video/BV1vt4y1v7JL">计算机没有黑魔法</a>。多花点时间和精力，一定会搞明白。</p><p>接下来还要上到除夕才能放假，好快又是一年。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;不想计算距离上次写[[thinking 7]]过去多久，2024 年也已经过去一个月。反正还想立下一个 flag，今年一定要多写几篇！&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
    <category term="ZSA Voyager" scheme="https://blog.xiang578.com/tags/ZSA-Voyager/"/>
    
    <category term="Fliggy" scheme="https://blog.xiang578.com/tags/Fliggy/"/>
    
  </entry>
  
  <entry>
    <title>lc228. 汇总区间</title>
    <link href="https://blog.xiang578.com/problem/lc228.html"/>
    <id>https://blog.xiang578.com/problem/lc228.html</id>
    <published>2023-08-25T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/summary-ranges/description/">228. 汇总区间 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>按题目模拟，关键是如何写的优化。</p><p>[[分组循环]]</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="function">def <span class="title">summaryRanges</span><span class="params">(self, nums: List[<span class="type">int</span>])</span> -&gt; List[str]:</span></span><br><span class="line"><span class="function">        if len(nums) =</span>=<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        ans = []</span><br><span class="line">        </span><br><span class="line">        ans.<span class="built_in">append</span>([nums[<span class="number">0</span>], nums[<span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i] == ans[<span class="number">-1</span>][<span class="number">1</span>] + <span class="number">1</span>:</span><br><span class="line">                ans[<span class="number">-1</span>][<span class="number">1</span>] = nums[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ans.<span class="built_in">append</span>([nums[i], nums[i]])</span><br><span class="line">        </span><br><span class="line">        ret = []</span><br><span class="line">        <span class="keyword">for</span> (s,e) in ans:</span><br><span class="line">            <span class="keyword">if</span> s == e:</span><br><span class="line">                ret.<span class="built_in">append</span>(<span class="built_in">str</span>(s))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ret.<span class="built_in">append</span>(<span class="string">&quot;&#123;&#125;-&gt;&#123;&#125;&quot;</span>.format(s,e))</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/summary-ranges/description/&quot;&gt;228. 汇总区间 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc18. 四数之和</title>
    <link href="https://blog.xiang578.com/problem/lc18.html"/>
    <id>https://blog.xiang578.com/problem/lc18.html</id>
    <published>2023-07-14T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/4sum/description/">18. 四数之和 - 力扣（Leetcode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>双指针，题目中会超过 int</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">fourSum</span>(vector&lt;<span class="type">int</span>&gt;&amp; a, <span class="type">int</span> s) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;ans;</span><br><span class="line">        <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i&amp;&amp;a[i<span class="number">-1</span>]==a[i]) <span class="keyword">continue</span>;</span><br><span class="line">            map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;n;j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(mp[a[j]]==<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                mp[a[j]] = <span class="number">1</span>;</span><br><span class="line">                <span class="type">long</span> <span class="type">long</span> s1 = (<span class="type">long</span> <span class="type">long</span>)s - a[i] - a[j];</span><br><span class="line">                <span class="type">int</span> k=j+<span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> t=n<span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">while</span>(k&lt;t) &#123;</span><br><span class="line">                    <span class="type">long</span> <span class="type">long</span> s2 = a[k] + a[t];</span><br><span class="line">                    <span class="keyword">if</span>(s2==s1) &#123;</span><br><span class="line">                        vector&lt;<span class="type">int</span>&gt;tmp&#123;a[i], a[j], a[k], a[t]&#125;;</span><br><span class="line">                        ans.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">                        <span class="type">int</span> now = a[k];</span><br><span class="line">                        k++;</span><br><span class="line">                        <span class="keyword">while</span>(k&lt;=t&amp;&amp;a[k]==now) k++; </span><br><span class="line">                        <span class="comment">// cout&lt;&lt;k&lt;&lt;&quot; &quot;&lt;&lt;t&lt;&lt;endl;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(s2&lt;s1) &#123;</span><br><span class="line">                        k++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        t--;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/4sum/description/&quot;&gt;18. 四数之和 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="two pointer" scheme="https://blog.xiang578.com/tags/two-pointer/"/>
    
  </entry>
  
  <entry>
    <title>lc931.下降路径最小和</title>
    <link href="https://blog.xiang578.com/problem/lc931.html"/>
    <id>https://blog.xiang578.com/problem/lc931.html</id>
    <published>2023-07-13T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/minimum-falling-path-sum/description/">下降路径最小和</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>简单动态规划</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">minFallingPathSum</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> m = a[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> dp[n][m];</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">1e9</span>;</span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span> dp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j&lt;m; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i!=<span class="number">0</span>) &#123;</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j];</span><br><span class="line">                    <span class="keyword">if</span> (j &gt; <span class="number">0</span>) dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i<span class="number">-1</span>][j<span class="number">-1</span>]);</span><br><span class="line">                    <span class="keyword">if</span> (j + <span class="number">1</span> &lt; m) dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i<span class="number">-1</span>][j+<span class="number">1</span>]);  </span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][j] += a[i][j];</span><br><span class="line">                <span class="keyword">if</span> (i==n<span class="number">-1</span>) &#123;</span><br><span class="line">                    ans = <span class="built_in">min</span>(ans, dp[i][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/minimum-falling-path-sum/description/&quot;&gt;下降路径最小和&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Dynamic Programming" scheme="https://blog.xiang578.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>lc2544. 交替数字和</title>
    <link href="https://blog.xiang578.com/problem/lc2544.html"/>
    <id>https://blog.xiang578.com/problem/lc2544.html</id>
    <published>2023-07-11T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/alternating-digit-sum/description/">2544. 交替数字和 - 力扣（Leetcode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>按题意模拟</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">alternateDigitSum</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        f = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>(n):</span><br><span class="line">            s += f * <span class="built_in">int</span>(i)</span><br><span class="line">            f = f*-<span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/alternating-digit-sum/description/&quot;&gt;2544. 交替数字和 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc1911. 最大子序列交替和</title>
    <link href="https://blog.xiang578.com/problem/lc1911.html"/>
    <id>https://blog.xiang578.com/problem/lc1911.html</id>
    <published>2023-07-10T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/maximum-alternating-subsequence-sum/description/">1911. 最大子序列交替和 - 力扣（Leetcode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>标准 dp 题</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">maxAlternatingSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> dp[<span class="number">112345</span>][<span class="number">2</span>];</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">1</span>] = nums[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++) &#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>], dp[i<span class="number">-1</span>][<span class="number">1</span>] - nums[i]);</span><br><span class="line">            dp[i][<span class="number">1</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>], dp[i<span class="number">-1</span>][<span class="number">0</span>] + nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(dp[n<span class="number">-1</span>][<span class="number">0</span>], dp[n<span class="number">-1</span>][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/maximum-alternating-subsequence-sum/description/&quot;&gt;1911. 最大子序列交替和 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="DP" scheme="https://blog.xiang578.com/tags/DP/"/>
    
  </entry>
  
  <entry>
    <title>lc16. 最接近的三数之和</title>
    <link href="https://blog.xiang578.com/problem/lc16.html"/>
    <id>https://blog.xiang578.com/problem/lc16.html</id>
    <published>2023-07-09T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/3sum-closest/description/">16. 最接近的三数之和 - 力扣（Leetcode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>连续三天都是双指针，然后今天才发现自己根本不理解双指针。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="function">def <span class="title">threeSumClosest</span><span class="params">(self, nums: List[<span class="type">int</span>], target: <span class="type">int</span>)</span> -&gt; <span class="type">int</span>:</span></span><br><span class="line"><span class="function">        nums.sort()</span></span><br><span class="line"><span class="function">        ret =</span> <span class="number">1e9</span></span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        def <span class="built_in">check_ans</span>(now, pre):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(now - target) &lt;= <span class="built_in">abs</span>(pre - target):</span><br><span class="line">                <span class="keyword">return</span> now</span><br><span class="line">            <span class="keyword">return</span> pre</span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">if</span> i - <span class="number">1</span> &gt;= <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i - <span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            j = i + <span class="number">1</span></span><br><span class="line">            k = n - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> j &lt; k:</span><br><span class="line">                tmp_sum = nums[i] + nums[j] + nums[k]</span><br><span class="line">                <span class="keyword">if</span> tmp_sum == target:</span><br><span class="line">                    <span class="keyword">return</span> target</span><br><span class="line">                ret = <span class="built_in">check_ans</span>(tmp_sum, ret)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> tmp_sum &gt; target:</span><br><span class="line">                    k = k - <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> tmp_sum &lt; target:</span><br><span class="line">                    j += <span class="number">1</span> </span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/3sum-closest/description/&quot;&gt;16. 最接近的三数之和 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="two pointer" scheme="https://blog.xiang578.com/tags/two-pointer/"/>
    
  </entry>
  
  <entry>
    <title>lc15. 三数之和</title>
    <link href="https://blog.xiang578.com/problem/lc15.html"/>
    <id>https://blog.xiang578.com/problem/lc15.html</id>
    <published>2023-07-08T16:00:00.000Z</published>
    <updated>2024-05-12T03:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/3sum/">15. 三数之和 - 力扣（Leetcode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>写了挺久的，不是标解。假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>a</mi><mo>≤</mo><mi>b</mi><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a+b+c=0, a \le b \le c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>，枚举 ab，然后去一个 map 里面找有没有 c。另外还要记录一下 ab 有没有重复过。</p><p>标解里面，先对数组排序，然后 c 用双指针的思路在数组里查找。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="function">def <span class="title">threeSum</span><span class="params">(self, nums: List[<span class="type">int</span>])</span> -&gt; List[List[<span class="type">int</span>]]:</span></span><br><span class="line"><span class="function">        nums.sort()</span></span><br><span class="line"><span class="function">        ret =</span> []</span><br><span class="line">        used = &#123;&#125;</span><br><span class="line">        tmp = &#123;&#125;</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">not</span> in tmp:</span><br><span class="line">                tmp[nums[i]] = []</span><br><span class="line">            tmp[nums[i]].<span class="built_in">append</span>(i)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">for</span> j in <span class="built_in">range</span>(i+<span class="number">1</span>, n):</span><br><span class="line">                key = (<span class="built_in">str</span>(nums[i]) + <span class="string">&quot;_&quot;</span> + <span class="built_in">str</span>(nums[j]))</span><br><span class="line">                <span class="keyword">if</span> key in used:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                used[key] = <span class="number">1</span></span><br><span class="line">                need = <span class="number">0</span> - (nums[i] + nums[j])</span><br><span class="line">                <span class="keyword">if</span> need &lt; nums[j]:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> need <span class="keyword">not</span> in tmp:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> k in tmp[need]:</span><br><span class="line">                    <span class="keyword">if</span> k == i <span class="keyword">or</span> k == j:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    ret.<span class="built_in">append</span>((nums[i], nums[j], nums[k]))</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure><h2 id="超时"><a class="markdownIt-Anchor" href="#超时"></a> 超时</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">threeSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        two_sum = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, n):</span><br><span class="line">                s = nums[i] + nums[j]</span><br><span class="line">                two_sum[s].append((i, j))</span><br><span class="line"></span><br><span class="line">        ret = []</span><br><span class="line">        used = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            need = <span class="number">0</span> - nums[i]</span><br><span class="line">            <span class="keyword">for</span> (a, b) <span class="keyword">in</span> two_sum[need]:</span><br><span class="line">                <span class="keyword">if</span> a == i <span class="keyword">or</span> b == i:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                tmp = [nums[i], nums[a], nums[b]]</span><br><span class="line">                tmp.sort()</span><br><span class="line">                key = <span class="string">&quot;_&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, tmp))</span><br><span class="line">                <span class="keyword">if</span>  key <span class="keyword">in</span> used:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                used[key] = <span class="number">1</span></span><br><span class="line">                ret.append((nums[i], nums[a], nums[b]))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/3sum/&quot;&gt;15. 三数之和 - 力扣（Leetcode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="two pointer" scheme="https://blog.xiang578.com/tags/two-pointer/"/>
    
  </entry>
  
  <entry>
    <title>lc167. 两数之和 ii - 输入有序数组</title>
    <link href="https://blog.xiang578.com/problem/lc167.html"/>
    <id>https://blog.xiang578.com/problem/lc167.html</id>
    <published>2023-07-07T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/two-sum-ii-input-array-is-sorted/">167. 两数之和 II - 输入有序数组</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>数组已经排好序，对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">numbers[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> 只需要用二分搜索查找 numbers 中有没有满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>−</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">target - numbers[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>。</p><p>另外也可以用双指针来做，复杂度可以降到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; numbers, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;numbers.<span class="built_in">size</span>();i++) &#123;</span><br><span class="line">            <span class="type">int</span> need = target - numbers[i];</span><br><span class="line">            <span class="type">int</span> k = <span class="built_in">lower_bound</span>(numbers.<span class="built_in">begin</span>()+i+<span class="number">1</span>, numbers.<span class="built_in">end</span>(), need) - numbers.<span class="built_in">begin</span>();</span><br><span class="line">            <span class="comment">// cout&lt;&lt;need&lt;&lt;&quot; &quot;&lt;&lt;k&lt;&lt;&quot; &quot;&lt;&lt;i&lt;&lt;endl;</span></span><br><span class="line">            <span class="keyword">if</span> (k &gt;= numbers.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (numbers[i] + numbers[k] == target) &#123;</span><br><span class="line">                ans.<span class="built_in">push_back</span>(i+<span class="number">1</span>);</span><br><span class="line">                ans.<span class="built_in">push_back</span>(k+<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/two-sum-ii-input-array-is-sorted/&quot;&gt;167. 两数之和 II - 输入有序数组&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="two pointer" scheme="https://blog.xiang578.com/tags/two-pointer/"/>
    
    <category term="Binary Search" scheme="https://blog.xiang578.com/tags/Binary-Search/"/>
    
  </entry>
  
  <entry>
    <title>lc2178. 拆分成最多数目的正偶数之和</title>
    <link href="https://blog.xiang578.com/problem/lc2178.html"/>
    <id>https://blog.xiang578.com/problem/lc2178.html</id>
    <published>2023-07-06T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/maximum-split-of-positive-even-integers/">LC2178</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>首先 finalSum 为奇数时，问题无解。接下来考虑偶数。</p><p>设 2,4,6,8,10,12… 这个公差为 2 的等差数列和为 S，题目就是要找一个最大的 i 满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>≤</mo><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">S_i \le finalSum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>，答案就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>8...</mn><mo separator="true">,</mo><mn>2</mn><mo>∗</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>2</mn><mo>∗</mo><mi>i</mi><mo>+</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,4,6,8...,2*(i-1),2*i+S_i-finalSum]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span>。</p><p>最后 cpp 求和时可能会超过 long long int 值域，可以用 python 写。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maximumEvenSplit</span>(<span class="params">self, finalSum: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="keyword">if</span> finalSum%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        tmp_sum = <span class="number">0</span></span><br><span class="line">        ans = []</span><br><span class="line">        now = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> finalSum &gt;= tmp_sum + now:</span><br><span class="line">            ans.append(now)</span><br><span class="line">            tmp_sum += now</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        ans[-<span class="number">1</span>] += finalSum - tmp_sum</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/maximum-split-of-positive-even-integers/&quot;&gt;LC2178&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="贪心" scheme="https://blog.xiang578.com/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>eta 技术参考</title>
    <link href="https://blog.xiang578.com/note/eta-ref-list.html"/>
    <id>https://blog.xiang578.com/note/eta-ref-list.html</id>
    <published>2023-07-05T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>持续整理中</p><span id="more"></span><h2 id="滴滴"><a class="markdownIt-Anchor" href="#滴滴"></a> 滴滴</h2><p>[[@Learning to Estimate the Travel Time]] 2018 年KDD，Wide &amp; Deep &amp; RNN</p><ul><li>个人笔记：<a href="https://blog.xiang578.com/post/wdr.html">(WDR) Learning to Estimate the Travel Time - 算法花园</a></li></ul><p>[[@Multi-task Representation Learning for Travel Time Estimation]] 多任务框架，预估行程时间和行程距离</p><p>[[@HetETA: Heterogeneous Information Network Embedding for Estimating Time of Arrival]] 图卷积应用在 ETA 和路况预测任务</p><p>[[CompactETA]] link 表达 + mlp</p><p>[[@Interpreting Trajectories from Multiple Views: A Hierarchical Self-Attention Network for Estimating the Time of Arrival]] 和华南理工合作论文，2022 年KDD。</p><ul><li>个人笔记：<a href="https://blog.xiang578.com/post/hiereta.html">【滴滴 HierETA】Interpreting Trajectories from Multiple Views A Hierarchical Self-Attention Network for Estimating the Time of Arrival - 算法花园 (xiang578.com)</a></li></ul><p>Dynamic Heterogeneous Graph Neural Network for Real-time Event Prediction 使用异质图神经网络进行实时事件预测</p><ul><li><a href="https://zhuanlan.zhihu.com/p/581994896">Dynamic Heterogeneous Graph Neural Network for Real-time Event Prediction （KDD 2020） - 知乎 (zhihu.com)</a></li></ul><h2 id="百度"><a class="markdownIt-Anchor" href="#百度"></a> 百度</h2><p>[[@ConSTGAT: Contextual Spatial-Temporal Graph Attention Network for Travel Time Estimation at Baidu Maps]] 时空图注意力网络</p><ul><li><a href="https://mp.weixin.qq.com/s/ZqQN7Qep-6sNbNCAx0UE6A">工业解密：百度地图背后的路线时长预估模型！</a></li></ul><p>[[@SSML: Self-Supervised Meta-Learner for En Route Travel Time Estimation at Baidu Maps]]</p><p>[[@DuETA: Traffic Congestion Propagation Pattern Modeling via Efficient Graph Learning for ETA Prediction at Baidu Maps]]</p><p>[[@DuTraffic: Live Traffic Condition Prediction with Trajectory Data and Street Views at Baidu Maps]]</p><h2 id="高德"><a class="markdownIt-Anchor" href="#高德"></a> 高德</h2><p><a href="https://mp.weixin.qq.com/s/laoI9y8cRRZpbferCM7cBg">走近高德驾车ETA（预估到达时间） (qq.com)</a></p><ul><li>概念<ul><li>SP(Speed Profile)：同一特征日相同时间区间的历史平均速度，按 10min 聚合。例如每周一早上 9:00-9:10，某个 link 上所有轨迹，可以将过去几周聚合求一个平均速度，这个平均速度可以代表对这个 link 在未来周一早上 9:00-9:10 这个时间区间内通行速度的静态预测。</li><li>AutoLR(Autonavi Location Reference)：实时路况</li><li>link 通行耗时真值：在一个 5min 的时间窗口内进入某一 link 的所有轨迹，在完成去噪后求取平均值，即得到该 link 在该 5min 窗口内的通行耗时真值。</li></ul></li><li>框架<ul><li><img src="https://media.xiang578.com/202307062006132-gaode-eta.png" alt="" /></li></ul></li><li>真值生产<ul><li>将各个 link 上 5min 窗口的实走轨迹聚合求平均通行时间，得到 link 通行耗时真值。</li><li>给定 trace 推算通行耗时真值</li></ul></li><li>link 场景化预测：根据历史真值将 link 归为不同类别<ul><li>不堵 link 直接用静态 sp</li></ul></li><li>link 级别预测<ul><li>静态 sp，预测时间跨度可达未来一周</li><li>线性模型，通过实时信息 autolr 和历史信息 sp 来拟合 link 级真值</li><li>精准预测，模型预测</li></ul></li><li>trace 级别预测<ul><li>准点率预测，给出 trace 级别预测结果的可信度</li><li>路线 link 每 5 分钟推演，使用对应时间片的预测结果。超过 1 小时用历史。最后累加得到整条路线 eta。</li></ul></li><li>效果评测层面<ul><li>对问题 link 的 eta 进行自动干预，人工干预</li></ul></li><li>精准预测<ul><li>每分钟将 link 级多时间跨度预测值写入缓存，预测是有精准预测值的情况下将有限使用精准预测结果</li><li>1小时内有实时路况，使用线性模型预测</li></ul></li><li>eta 预测难点<ul><li>未来流量，让深度模型提前感知拥堵的到来<ul><li>对导航路线进行时间推演，得到未来时间的位置。</li></ul></li><li>[[H-STGCN]] 用域转换器整合异质模态的交通流量特征，设计了复合邻接矩阵使得图卷积层能够更好地捕捉路段间的接近性。</li></ul></li><li>效果评估<ul><li>link 评估<ul><li>bad link 定义 link eta 和 link ata 的 ape 大于 0.3</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">(</mo><mi>l</mi><mi>i</mi><mi>n</mi><msubsup><mi>k</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>e</mi><mi>t</mi><mi>a</mi></mrow><mi>j</mi></msubsup><mo>−</mo><mi>l</mi><mi>i</mi><mi>n</mi><msubsup><mi>k</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>a</mi><mi>t</mi><mi>a</mi></mrow><mi>j</mi></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mi>n</mi><mo>∗</mo><mi>k</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">MSE= \frac{\sum_{i=1}^n \sum_{j=1}^k (link_{i,eta}^j - link_{i, ata}^j)^2}{n * k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.6461599999999998em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3011599999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.63282em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285714em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.46032428571428574em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9547714285714286em;"><span style="top:-2.177714285714286em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-2.9836857142857145em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.46117142857142857em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9547714285714286em;"><span style="top:-2.177714285714286em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-2.9836857142857145em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.46117142857142857em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>trace 评估<ul><li>trace 的 ata 和 eta 对比</li></ul></li></ul></li></ul><p>[[@Hybrid Spatio-Temporal Graph Convolutional Network: Improving Traffic Prediction with Navigation Data]]<br />id:: 63f271b5-aa49-4212-a7c8-507109aefab5</p><ul><li>预测流量</li><li>DARTS</li><li>[[STGCN]]</li><li><a href="https://mp.weixin.qq.com/s?__biz=Mzg4MzIwMDM5Ng==&amp;mid=2247485057&amp;idx=1&amp;sn=f5f5dccaf41a00c76d62118bf8a42aa7&amp;chksm=cf4a5e62f83dd774ec9a4ef4fc442c8266b587579ed01171a57b6b3bedcbcc3047edc4134a8f&amp;scene=21#wechat_redirect">高德KDD2020论文解读|混合时空图卷积网络：更精准的时空预测模型 (qq.com)</a></li><li><a href="https://mp.weixin.qq.com/s/0fV21yi9Og0dxsKIJ0o0Xw">混合时空图卷积网络：能“推导”未来路况的智能算法 (qq.com)</a></li></ul><p><a href="https://mp.weixin.qq.com/s/DXMyXfuUtUGcgB33Jvn8YQ">深度学习在高德驾车导航历史速度预测中的探索与实践 (qq.com)</a></p><ul><li>使用历史平均值法预测历史速度的缺点<ul><li>对于异常点敏感</li><li>无法利用时域序列的演化趋势（trend）信息</li><li>无法利用去年同期的车辆行驶规律</li></ul></li><li>[[TCN]] 特点<ul><li>存在因果关系，未来到过去不会存在信息泄漏</li><li>可以将任意长度的序列映射到固定长度的序列</li><li>利用残差模块和空洞卷积来建构长期依赖关欻</li></ul></li><li>目标：构建一个基于历史信息（某时间段<br />&amp; 去年同期：同一段道路、确定特征日、确定时间批次）和道路属性来预测未来一周历史速度的机器学习模</li><li>网络架构<ul><li><img src="https://media.xiang578.com/202307102238274.png" alt="" /></li></ul></li></ul><p><a href="https://developer.aliyun.com/article/782454">AI在出行场景的应用实践：路线规划、ETA、动态事件挖掘…-阿里云开发者社区 (aliyun.com)</a></p><ul><li>路径规划<ul><li>多目标平衡，如何在“帕累托最优”的情况下，进行多个目标之间的取舍、平衡。通过带约束的最优化问题来进行建模，保证其他指标不变差的情况下，把某个指标最优化。</li><li>偏置网络，解决陌生场景对导航依赖很重，很难决策哪条路线更好，导致首推路线选择率高。<ul><li><strong>优化的主要目标是实走覆盖率。</strong></li><li>用户偏置网络，把路线排序的顺序，以及引导路线之间的相似度信息输入进去，期望尽可能消除掉偏置带来的影响。</li></ul></li><li>TDR 求路算法提供<strong>随时间推演的能力</strong>。比如 8:00 从起点出发，后面要走 1 2 3 …n 条路到达目的地，假设 8:10 走到第 2 条道路，8:20 走到第 3 条道路，那么我们在 8:00 计算 Shortcuts 的时候，就不能只用到 8:00 的路况，需要把后续进入某个道路的时刻考虑进来，用那个时刻的路况来计算</li></ul></li><li>交通事件抽取-对比知识蒸馏模型 LRC-BERT AAAI2021</li></ul><h2 id="饿了么"><a class="markdownIt-Anchor" href="#饿了么"></a> 饿了么</h2><p>[[@Order Fulfillment Cycle Time Estimation for On-Demand Food Delivery]]</p><h2 id="美团"><a class="markdownIt-Anchor" href="#美团"></a> 美团</h2><p>[[深度学习在美团配送ETA预估中的探索与实践]]：提到挺多 eta 相同的算法和工程细节问题，值得仔细读一读。</p><p>[[@A Deep Learning Method for Route and Time Prediction in Food Delivery Service]]</p><h2 id="google"><a class="markdownIt-Anchor" href="#google"></a> Google</h2><p>[[@ETA Prediction with Graph Neural Networks in Google Maps]]</p><p>[[@BusTr: Predicting Bus Travel Times from Real-Time Traffic]]</p><h2 id="uber"><a class="markdownIt-Anchor" href="#uber"></a> Uber</h2><p>[[@DeeprETA: An ETA Post-processing System at Scale]]</p><ul><li>个人笔记：<a href="https://blog.xiang578.com/post/deepreta.html">【Uber ETA】DeeprETA An ETA Post-processing System at Scale - 算法花园 (xiang578.com)</a></li><li><a href="https://www.youtube.com/watch?v=CJTitzj0qBo">How Uber Predicts Arrival Times - Xinyu Hu and Olcay Cirit | Stanford MLSys #64 - YouTube</a>：从两个方面介绍他们的 ETA 系统：how we make it faster 以及 how we make it general(loss 和 calibration)</li><li><a href="https://www.uber.com/en-JP/blog/deepeta-how-uber-predicts-arrival-times/">DeepETA: How Uber Predicts Arrival Times Using Deep Learning | Uber Blog</a></li><li><a href="https://ithelp.ithome.com.tw/articles/10302600">Day 17 Uber 要如何估計司機和外送的抵達時間？（上）- Self attention 介紹</a>：简单讲了 self-attention 的计算过程</li><li><a href="https://ithelp.ithome.com.tw/articles/10303293">Day 18 Uber 要如何估計司機和外送的抵達時間？（下）- DeeprETANet</a><ul><li>geospatial features<ul><li>geohashing 转成 string</li><li>用 multiple feature hashing 转成 index</li></ul></li></ul></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;持续整理中&lt;/p&gt;</summary>
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="ETA" scheme="https://blog.xiang578.com/tags/ETA/"/>
    
  </entry>
  
  <entry>
    <title>lc2600. k 件物品的最大和</title>
    <link href="https://blog.xiang578.com/problem/lc2600.html"/>
    <id>https://blog.xiang578.com/problem/lc2600.html</id>
    <published>2023-07-04T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/k-items-with-the-maximum-sum/">2600. K 件物品的最大和 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>按题意贪心</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">kItemsWithMaximumSum</span><span class="params">(<span class="type">int</span> numOnes, <span class="type">int</span> numZeros, <span class="type">int</span> numNegOnes, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (k&gt;=numOnes) &#123;</span><br><span class="line">            ans += numOnes;</span><br><span class="line">            k-=numOnes;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans = k;</span><br><span class="line">            k = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k&gt;=numZeros) &#123;</span><br><span class="line">            k-=numZeros;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            k = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans -= k;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/k-items-with-the-maximum-sum/&quot;&gt;2600. K 件物品的最大和 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="贪心" scheme="https://blog.xiang578.com/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>lc1969. 数组元素的最小非零乘积</title>
    <link href="https://blog.xiang578.com/problem/lc1969.html"/>
    <id>https://blog.xiang578.com/problem/lc1969.html</id>
    <published>2023-07-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode-cn.com/problems/minimum-non-zero-product-of-the-array-elements/">1969. 数组元素的最小非零乘积 </a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>P=3，P=4，手推一下就可以发现规律，结果是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mi>P</mi></msup><mo>−</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>P</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msup><mn>2</mn><mi>P</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2^P-2)^{(2^{(P-1)} - 1)}(2^P-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2896999999999998em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0396999999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9667142857142857em;"><span style="top:-2.966714285714285em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>由于数字很大，用 C++ 实现快速幂需要手动取模。Python 中的 <code>pow(x, y[, z])</code> 函数 z 可以指定为模数。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minNonZeroProduct</span>(<span class="params">self, p: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>((<span class="built_in">pow</span>(<span class="number">2</span>, p)-<span class="number">1</span>) * <span class="built_in">pow</span>( <span class="built_in">pow</span>(<span class="number">2</span>, p) - <span class="number">2</span>, (<span class="built_in">pow</span>(<span class="number">2</span>, p-<span class="number">1</span>) - <span class="number">1</span>), <span class="number">10</span>**<span class="number">9</span>+<span class="number">7</span>)%(<span class="number">10</span>**<span class="number">9</span>+<span class="number">7</span>))</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode-cn.com/problems/minimum-non-zero-product-of-the-array-elements/&quot;&gt;1969. 数组元素的最小非零乘积 &lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>lc2679. 矩阵中的和</title>
    <link href="https://blog.xiang578.com/problem/lc2679.html"/>
    <id>https://blog.xiang578.com/problem/lc2679.html</id>
    <published>2023-07-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/sum-in-a-matrix/">2679. 矩阵中的和</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>可以转化成，每一行从大到小排序，每一列取最大值求和。</p><p>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mi>log</mi><mo>⁡</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm\log m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">matrixSum</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> m = nums[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;<span class="built_in">ans</span>(m, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> num:nums) &#123;</span><br><span class="line">            <span class="built_in">sort</span>(num.<span class="built_in">begin</span>(), num.<span class="built_in">end</span>());</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++) &#123;</span><br><span class="line">                ans[i]=<span class="built_in">max</span>(ans[i], num[i]);</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> aa:ans) &#123;</span><br><span class="line">            ret += aa;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/sum-in-a-matrix/&quot;&gt;2679. 矩阵中的和&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="排序" scheme="https://blog.xiang578.com/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>lc5832. 构造元素不等于两相邻元素平均值的数组</title>
    <link href="https://blog.xiang578.com/problem/lc5832.html"/>
    <id>https://blog.xiang578.com/problem/lc5832.html</id>
    <published>2023-07-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode-cn.com/problems/array-with-elements-not-equal-to-average-of-neighbors/">5832. 构造元素不等于两相邻元素平均值的数组 - 力扣（LeetCode） </a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>（错了好几次后，看预期结果看出的规律……）数字从小到大排序后，将前 n/2 个数字依次放在 1、3、5… 位置上，剩下数字依次放在 0、2、4…  位置上。这样可以保证每一个数字不可能是左右两个数字的一半。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">rearrangeArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;<span class="built_in">ans</span>(a.<span class="built_in">size</span>());</span><br><span class="line">        <span class="type">int</span> j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>();i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(j &gt;= a.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                j=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[j]=a[i];</span><br><span class="line">            j+=<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode-cn.com/problems/array-with-elements-not-equal-to-average-of-neighbors/&quot;&gt;5832. 构造元素不等于两相邻元素平均值的数组 - 力扣（LeetCode） &lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="贪心" scheme="https://blog.xiang578.com/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="排序" scheme="https://blog.xiang578.com/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>lc852. 山脉数组的峰顶索引</title>
    <link href="https://blog.xiang578.com/problem/lc852.html"/>
    <id>https://blog.xiang578.com/problem/lc852.html</id>
    <published>2023-07-03T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode-cn.com/problems/peak-index-in-a-mountain-array/">852. 山脉数组的峰顶索引 - 力扣（LeetCode） (leetcode-cn.com)</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>三分搜索</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">peakIndexInMountainArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> r = a.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r) &#123;</span><br><span class="line">            <span class="type">int</span> m = l + (r-l) /<span class="number">2</span>;</span><br><span class="line">            <span class="type">int</span> ml = l + (m-l)/<span class="number">2</span> ;</span><br><span class="line">            <span class="type">int</span> mr = r - (r-m) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// cout&lt;&lt;m&lt;&lt;&quot; &quot;&lt;&lt;l&lt;&lt;&quot; &quot;&lt;&lt;r&lt;&lt;&quot; &quot;&lt;&lt;ml&lt;&lt;&quot; &quot;&lt;&lt;mr&lt;&lt;endl;</span></span><br><span class="line">            <span class="keyword">if</span>(a[ml]&gt;=a[mr]) &#123;</span><br><span class="line">                r = mr<span class="number">-1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(a[ml]&lt;a[mr]) &#123;</span><br><span class="line">                l = ml+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode-cn.com/problems/peak-index-in-a-mountain-array/&quot;&gt;852. 山脉数组的峰顶索引 - 力扣（LeetCode） (leetcode-cn.com)&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="三分搜索" scheme="https://blog.xiang578.com/tags/%E4%B8%89%E5%88%86%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
  <entry>
    <title>从 umami cloud 迁移到自建 umami</title>
    <link href="https://blog.xiang578.com/note/umami-docker.html"/>
    <id>https://blog.xiang578.com/note/umami-docker.html</id>
    <published>2023-05-06T16:00:00.000Z</published>
    <updated>2024-04-20T07:10:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>Umami 是自己从今年年初开始使用网站统计工具，和 Google Analytics 相比，Umami 更加轻量和美观。根据 <a href="https://twitter.com/WuPingJu">P.J. Wu 吳秉儒</a> 在 <a href="https://pinchlime.com/blog/started-using-umami-cloud/">博客文章</a> 中介绍，一直通过 Umami Cloud 免费试用。</p><p>5 月 5 日突然收到官方邮件，Umami Cloud 结束 Beta 测试以及公布 Pricing，基础 Hobby Plan(Free) 支持 3 个网站/保存 6 个月内统计数据/10k以内请求量，下一档 Basic 直接是 9 刀一个月。由于免费计划保留数据时间太短，收费计划价格太贵，开始考虑从 Umami Cloud 迁移。</p><span id="more"></span><p>使用 Umami Cloud 差不多 5 月时间，本博客统计到 1.26k 浏览量，从来源域名分析超过一半以上访问都是自己贡献的。毕竟之前在 v2ex 看过网友锐评“大部分个人网站一天就 3 个访客，一个是自己家中电脑，一个是自己公司电脑，最后一个是自己手机”。</p><ul><li><img src="https://media.xiang578.com/202305071614198-blog.png" alt="" /></li></ul><h2 id="使用-docker-自建-umami"><a class="markdownIt-Anchor" href="#使用-docker-自建-umami"></a> 使用 Docker 自建 Umami</h2><p>自建 Umami 有很多方式，比如 Pseudoyu 写过 <a href="https://www.pseudoyu.com/zh/2022/05/21/free_blog_analysis_using_umami_vercel_and_heroku/">从零开始搭建一个免费的个人博客数据统计系统（umami + Vercel + Heroku）</a>，由于自己不太再想依赖其他“免费”服务，直接选择在服务器使用 Docker Compose 一步安装 Umami。</p><p>官方在 <a href="https://github.com/umami-software/umami/blob/master/docker-compose.yml">umami/docker-compose.yml at master · umami-software/umami · GitHub</a> 提供 docker-compose 文件。复制到服务器，保存成 <code>docker-compose.yml</code>，然后 <code>docker-compose up -d</code> 启动容器。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">umami:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ghcr.io/umami-software/umami:postgresql-latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">DATABASE_URL:</span> <span class="string">postgresql://umami:umami@db:5432/umami</span></span><br><span class="line">      <span class="attr">DATABASE_TYPE:</span> <span class="string">postgresql</span></span><br><span class="line">      <span class="attr">APP_SECRET:</span> <span class="string">replace-me-with-a-random-string</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:15-alpine</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">umami</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">umami</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">umami</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sql/schema.postgresql.sql:/docker-entrypoint-initdb.d/schema.postgresql.sql:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">umami-db-data:/var/lib/postgresql/data</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">umami-db-data:</span></span><br></pre></td></tr></table></figure><p>根据 <code>docker-compose.yml</code> 中的设置，自建 umami 端口是 3000，所以可以直接访问 <code>ip:3000</code>。Umami 默认账户是 admin，密码是  umami。对于自建服务，一般出于安全考虑都不太建议通过 ip + 端口访问，加上也不太熟悉通过 nginx 配置反向代理，最终通过 [[Cloudflare Zero Trust]] 给端口绑定一个二级域名。</p><p>博客相关访问数据可以在 <a href="https://umami.xiang5.top/share/xnuNULQGsOZCYkuK/blog">算法花园 Umami 统计</a> 查看。</p><h2 id="导入-umami-cloud-数据"><a class="markdownIt-Anchor" href="#导入-umami-cloud-数据"></a> 导入 Umami Cloud 数据</h2><p>首先，从 Umami Cloud 导出数据。从下图位置点击 Export 后，会收到一封邮件，然后访问邮件中链接，浏览器会自动下载一个 <code>csv</code> 文件。</p><ul><li><img src="https://media.xiang578.com/202305071605375-umami-cloud-export-data.png" alt="" /></li></ul><p>下载的 <code>csv</code> 文件没有标题栏，但是根据文件内数据形式猜测，每一行可能对应一条站点访问记录。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;7e782528-455f-4f0a-acc5-01ec7ed759ff&quot;,&quot;24876f1d-7941-5c58-a549-737ebe7515b1&quot;,&quot;40bc9a7c-a2dc-4e6a-b126-c26313d4d66f&quot;,&quot;blog.xiang578.com&quot;,&quot;edge-chromium&quot;,&quot;Mac OS&quot;,&quot;desktop&quot;,&quot;2560x1440&quot;,&quot;zh-CN&quot;,&quot;HK&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;/movie/age-of-dynamic.html&quot;,&quot;&quot;,&quot;/travel/san-feng-huan-chuan.html&quot;,&quot;&quot;,&quot;blog.xiang578.com&quot;,&quot;@激流时代 - 算法花园&quot;,1,&quot;&quot;,&quot;2023-05-07 07:03:00&quot;</span><br><span class="line">&quot;7e782528-455f-4f0a-acc5-01ec7ed759ff&quot;,&quot;2ffcc2a9-670c-5454-8913-0e6ad2a814a9&quot;,&quot;97b49b96-1f25-40a2-8465-565f2d1f3642&quot;,&quot;blog.xiang578.com&quot;,&quot;chrome&quot;,&quot;Mac OS&quot;,&quot;desktop&quot;,&quot;1920x1080&quot;,&quot;zh-CN&quot;,&quot;HK&quot;,&quot;HK-HCW&quot;,&quot;&quot;,&quot;Central&quot;,&quot;/post/are-transformers-effective-for-time-series-forecasting.html&quot;,&quot;&quot;,&quot;/&quot;,&quot;&quot;,&quot;google.com.hk&quot;,&quot;【时间序列预测】Are Transformers Effective for Time Series Forecasting? - 算法花园&quot;,1,&quot;&quot;,&quot;2023-05-03 07:12:35&quot;</span><br><span class="line">&quot;7e782528-455f-4f0a-acc5-01ec7ed759ff&quot;,&quot;ed67da59-da08-5525-9be2-cd2035f7fc95&quot;,&quot;49891f43-46db-4ec4-a412-b68eaf136e8e&quot;,&quot;blog.xiang578.com&quot;,&quot;chrome&quot;,&quot;Windows 10&quot;,&quot;laptop&quot;,&quot;1536x864&quot;,&quot;zh-CN&quot;,&quot;HK&quot;,&quot;HK-HCW&quot;,&quot;&quot;,&quot;Central&quot;,&quot;/post/reinforce-learnning-basic.html&quot;,&quot;&quot;,&quot;/&quot;,&quot;&quot;,&quot;google.com.hk&quot;,&quot;李宏毅强化学习课程笔记 PG PPO Q-Learing - 算法花园&quot;,1,&quot;&quot;,&quot;2023-05-03 11:35:33</span><br></pre></td></tr></table></figure><p>目前（5.7）没有在网上找到相关导入数据的教程，已经发邮件给官方求助，等收到回复后再来更新。</p><h2 id="umami-docker-数据自动备份"><a class="markdownIt-Anchor" href="#umami-docker-数据自动备份"></a> Umami Docker 数据自动备份</h2><p>保存 postgres 中数据就可以，暂时还没有时间研究，等有空再回来更新。</p><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><p><a href="https://eallion.com/umami/">Umami Docker 部署及优化 - 大大的小蜗牛 (eallion.com)</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Umami 是自己从今年年初开始使用网站统计工具，和 Google Analytics 相比，Umami 更加轻量和美观。根据 &lt;a href=&quot;https://twitter.com/WuPingJu&quot;&gt;P.J. Wu 吳秉儒&lt;/a&gt; 在 &lt;a href=&quot;https://pinchlime.com/blog/started-using-umami-cloud/&quot;&gt;博客文章&lt;/a&gt; 中介绍，一直通过 Umami Cloud 免费试用。&lt;/p&gt;
&lt;p&gt;5 月 5 日突然收到官方邮件，Umami Cloud 结束 Beta 测试以及公布 Pricing，基础 Hobby Plan(Free) 支持 3 个网站/保存 6 个月内统计数据/10k以内请求量，下一档 Basic 直接是 9 刀一个月。由于免费计划保留数据时间太短，收费计划价格太贵，开始考虑从 Umami Cloud 迁移。&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="docker" scheme="https://blog.xiang578.com/tags/docker/"/>
    
    <category term="umami" scheme="https://blog.xiang578.com/tags/umami/"/>
    
  </entry>
  
  <entry>
    <title>三峰环穿</title>
    <link href="https://blog.xiang578.com/travel/san-feng-huan-chuan.html"/>
    <id>https://blog.xiang578.com/travel/san-feng-huan-chuan.html</id>
    <published>2023-04-24T16:00:00.000Z</published>
    <updated>2024-04-20T07:08:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>北京经典户外徒步路线。一般从大觉寺出发，经过三座海拔超过 1000 米的山（萝芭地北尖、阳台山和妙峰山），然后回到大觉寺，全程约 23 公里。</p><span id="more"></span><p><img src="https://media.xiang578.com/202304242213736-%E4%B8%89%E5%B3%B0.png" alt="" /></p><p>目前去过两次，2022 年 07 月 09 日用了 9 个小时走完全程，2022 年 10 月 15 日用了 5  个半小时走到涧沟村约 15 公里。</p><h2 id="行程准备"><a class="markdownIt-Anchor" href="#行程准备"></a> 行程准备</h2><p>交通可以坐 16 号线到达北安河站，然后再打车到大觉寺（十多块钱）。上次在涧沟村结束徒步，打不到滴滴，然后坐 M5 公交车（几个小时一班，可以从高德查看时刻表）到达苹果园站。</p><p>路线可以从两步路或六只脚上查询，两个 app 提供轨迹导航功能，也可以下载轨迹 gpx 文件然后导入佳明等手表中使用。</p><p>中途有多个补给商店（大觉寺商店、第一座山后的茶棚、涧沟村），价格也还行。</p><h2 id="风景"><a class="markdownIt-Anchor" href="#风景"></a> 风景</h2><p><img src="https://media.xiang578.com/202304252214624.jpg" alt="" /></p><p><img src="https://media.xiang578.com/202304252214617.jpg" alt="" /></p><p><img src="https://media.xiang578.com/202304252214609.jpg" alt="" /></p><p><img src="https://media.xiang578.com/202304252214587.jpg" alt="" /></p><p><img src="https://media.xiang578.com/202304252214630.jpg" alt="" />{:height 1629, :width 1216}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;北京经典户外徒步路线。一般从大觉寺出发，经过三座海拔超过 1000 米的山（萝芭地北尖、阳台山和妙峰山），然后回到大觉寺，全程约 23 公里。&lt;/p&gt;</summary>
    
    
    
    <category term="行旅记" scheme="https://blog.xiang578.com/categories/%E8%A1%8C%E6%97%85%E8%AE%B0/"/>
    
    
    <category term="Beijing" scheme="https://blog.xiang578.com/tags/Beijing/"/>
    
  </entry>
  
  <entry>
    <title>@激流时代</title>
    <link href="https://blog.xiang578.com/movie/age-of-dynamic.html"/>
    <id>https://blog.xiang578.com/movie/age-of-dynamic.html</id>
    <published>2023-04-06T16:00:00.000Z</published>
    <updated>2024-05-12T04:39:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>从 <a href="https://www.skyue.com/23031200.html">纪录片：激流时代 - 拾月 (skyue.com)</a> 了解到这部纪录片。腾讯出品，《十三邀》团队制作，李翔主持，共 5 集每集一个主题，从商业角度来观察这个时代。</p><span id="more"></span><h2 id="第1集直播浪潮"><a class="markdownIt-Anchor" href="#第1集直播浪潮"></a> 第1集：直播浪潮</h2><p>直播带货无疑是这几年最火的话题。第一集记录去年双十一期间，杭州大中小三类主播的故事。节目中也贴心给出本集探讨的问题：</p><ul><li>(个体命运)底层主播有没有明天？<ul><li>杭州万象城，大量主播当街直播带货，几部手机一部露营手拉车就是全部家当。</li></ul></li><li>(行业状况)中部主播崛起能带来什么改变？<ul><li>抖音女主播，小熊出没，靠拼时长和拼熬夜杀出来，还直言「不想输不能挺」。</li></ul></li><li>(深度规则)头部主播能否被复制？<ul><li>大部分主播都存在算法焦虑，抖音这样的平台注重内容而不人，似乎有可能快速推出一个新人。</li><li>遥望科技 CEO 谢如栋在双十一这一天不停在公司旗下主播直播场地来回奔波，每次去到一个新的场地都会看一下对应直播间的数据，然后给直播组长一些建议。感觉他们也是数据驱动？<ul><li>想不到谢如栋也是浙财信息学院毕业。。。</li></ul></li><li>选品会上谢如栋批评下属选的白牌直播福利品，「你应该让好的品牌去灵活，而不是让那些灵活的垃圾货进来」</li></ul></li><li>(行业状态)电商伴生的信任重建能为中国人带来什么？<ul><li>价格是护城河，现在看起来直播电商中，商家让利太多给主播个人，不知道什么时候会开始反击？</li><li>谢如栋讲到希望能搭建一个直播中台，给不同的主播提供场地和货源。</li><li>直播这么火是不是之前的推荐系统算法还不够智能？</li></ul></li></ul><p>创新者的窘境</p><ul><li>新行业的赢家不会是旧行业的赢家，所以能找到第二曲线的公司真的好少。</li></ul><p>直播不仅是争夺观众的注意力，更是争夺观众的钱包。其实更希望能看一下原来占据注意力和钱包的模式变得怎么样了。</p><h2 id="第2集咖啡之围"><a class="markdownIt-Anchor" href="#第2集咖啡之围"></a> 第2集：咖啡之围</h2><p>这一集是云南咖啡，讲产业升级的困境。最初的云南咖啡是走期货模式，现在希望能做成精品咖啡，获得更高的溢价空间。</p><p>期货模式，看起来能更好的标准化，但是做不过其他国家的原因居然是国内的人工成本太高，埃塞尔比亚人工 7 元一天，云南的人工要 100 一天，导致咖啡豆的成本比其他产地要高。而且看起来种植咖啡的工业化程度也不太高，没有那种大片农场的感觉，也没有收割机这样的大型设备。</p><p>精品咖啡，供给测标准，有协会有咖啡师给你认定。不过，我总是感觉这些接近于玄学……农作物有一个特点，产地即品牌，云南之前给人的印象是期货咖啡，如果不能形成新的品牌出来，还是很难和其他产地竞争。另外，商业社会残酷的地方在于市场需求就这么大，没有那么多人为这些买单，你就只能当成普通咖啡豆去卖。这么一想，还是当螺丝钉好一些，只要内卷就可以……</p><p>说回咖啡，工作之后偶尔会喝一喝咖啡，不过还是停留在公司内部咖啡厅水平（价格和瑞幸差不多），喝的就是通过咖啡因让自己更加精神。</p><h2 id="第3集消费不息"><a class="markdownIt-Anchor" href="#第3集消费不息"></a> 第3集：消费不息</h2><p>聚集在长沙，讨论新消费、新体验以及新设计美学。</p><ul><li>新的风口自然少不了投资人，这集也采访了峰瑞资本的李丰</li></ul><p>超级文和友，注重体验的品牌。最早在[[疯投圈]]上听过，也见过社交平台上发的动不动上万的等位照片。</p><ul><li>创始人文宾非常有个性，印象最深的是给李翔介绍狭小的卧室，讲自己不喜欢住大的房子，还特意拉李翔坐下来感受一下房间窗外的风景。</li><li>在创始人的心中，超级文和友不是湖南地方精神，而是对应城市的地方精神。可惜深圳和广州的店都没怎么成功。</li><li>和其他人一样，你就没有机会存活下来。</li><li>商业的本质是利他</li><li>提到印度消费品品牌，帕坦加利</li></ul><p>茶颜悦色</p><ul><li>刚开始还有一点小作坊的感觉，慢慢变得正规。</li></ul><p>柠茶</p><ul><li>主打标准化，按流程李翔都能制作一杯标准的茶。在这种方式中，人只是一个工具，不知道什么时候会被完全替代？</li></ul><p>顶上头</p><ul><li>螺蛳粉火锅，创始人自我定位客单价只能做到 50 左右。挺想尝试的。</li></ul><p>李翔</p><ul><li>商业有意思的地方就在于，它一点都不在乎你是否认同，有人认同愿意付钱就行。</li></ul><h2 id="第4集宇宙中心"><a class="markdownIt-Anchor" href="#第4集宇宙中心"></a> 第4集：“宇宙中心”</h2><p>这集选择地点是上海安福路。和三里屯、太古里这样的网红地点相比较，安福路的社区文化不是商业化公司整体运营形成的。</p><p>最初这地方有一个话剧院，负责人喻荣军讲希望做成百老汇模式，观众看完话剧后，可以挑选一些餐厅，然后边吃饭边讨论剧情，然后用话剧院的物业，挑选了一些入住的商业实体。</p><p>国内大部分旅游中心是小商品市场，做的是去特色，安福路的文化核心是时间的积累，外面的人很难融入进去。附近的居民也说到，游客走完才是真正的安福路。</p><p>这条路上居然还有多抓鱼。前几周有同事问我有什么处理旧书的渠道，给他推荐了多抓鱼，技术书籍回收基本上才几块钱……</p><h2 id="第5集穿越周期"><a class="markdownIt-Anchor" href="#第5集穿越周期"></a> 第5集：穿越周期</h2><p>沙漠里不长虚弱的草，大海里没有无名之辈。</p><p>话剧中心</p><ul><li>底线是什么</li></ul><p>奥迪的广告</p><ul><li>车和大众消费品是两个概念，人生安全相关，工业时代产品巅峰之作</li><li>大众产品穿越周期之间，边界是什么？质量</li></ul><p>冯仑</p><ul><li>穿越周期是少数人的事情</li><li>变化过程中什么是不变的，这才是你的核心。</li><li>认识到[[能力圈]]，芒格的不为清单。</li></ul><p>李翔</p><ul><li>[[塔勒布]] 作家被人记住的是他最好的作品。政治家被人记住的是他最糟糕的决定。而商人几乎不会被记住。<ul><li>企业家更大影响力，把技术更加大众化，更能带来改变。</li></ul></li></ul><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>在 youtube 上看的，每集都会有一段时间突然没有声音。网上查了一下，可能是因为 bgm 版本问题，所以主动做了消音……</p><p>前 4 集每集一个城市，奇怪的是没有出现北京，这个时代不需要北京吗？</p><p>如果我给这个系列选主题，可能会选：直播、咖啡、远程工作、自由职业</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;从 &lt;a href=&quot;https://www.skyue.com/23031200.html&quot;&gt;纪录片：激流时代 - 拾月 (skyue.com)&lt;/a&gt; 了解到这部纪录片。腾讯出品，《十三邀》团队制作，李翔主持，共 5 集每集一个主题，从商业角度来观察这个时代。&lt;/p&gt;</summary>
    
    
    
    <category term="时光机" scheme="https://blog.xiang578.com/categories/%E6%97%B6%E5%85%89%E6%9C%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>webmention 实现参考</title>
    <link href="https://blog.xiang578.com/note/641ea60f-a31e-4979-9327-c50509c146e3.html"/>
    <id>https://blog.xiang578.com/note/641ea60f-a31e-4979-9327-c50509c146e3.html</id>
    <published>2023-04-05T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>关于博客内实现 webmention 功能相关文章收集</p><span id="more"></span><h2 id="综合"><a class="markdownIt-Anchor" href="#综合"></a> 综合</h2><p><a href="https://indiewebify.me/">IndieWebify.Me - a guide to getting you on the IndieWeb</a> 逐级引导如何使网站符合 IndieWeb 规范</p><p>KRISTOF ZERBE 三篇文章详细介绍 hexo 博客如何支持 Webmention。</p><ul><li><a href="https://kiko.io/post/Hexo-and-the-IndieWeb/">Hexo and the IndieWeb - kiko.io</a> 介绍 <code>h-card</code>、<code>h-entry</code> 等 html 标签用法。<ul><li>发送 response 支持的标签<ul><li><code>u-in-replay-to</code><ul><li><code>In reply to: &lt;a class=&quot;u-in-reply-to&quot; href=&quot;https://jacks-blog.com/awesome-work&quot;&gt;Jacks Blog: Awesome Work&lt;/a&gt;</code></li></ul></li><li><code>u-link-of</code><ul><li><code>Kristof liked &lt;a class=&quot;u-like-of&quot; href=&quot;https://jacks-blog.com/awesome-work&quot;&gt;Jacks Awesome Work at https://jacks-blog.com/awesome-work&lt;/a&gt;</code></li></ul></li><li><code>u-repost-of</code></li><li><code>u-bookmark-of</code></li></ul></li></ul></li><li><a href="https://kiko.io/post/Hexo-and-the-IndieWeb-Sending-Webmentions/">Hexo and the IndieWeb (Sending Webmentions) - kiko.io</a> 向被你提及的网站发送 webmention 消息<ul><li><a href="https://www.webmention.app/">webmention.app</a>：<s>打开一直显示 404，服务挂了？</s> 评论区 <strong>Mirakelor</strong> 提醒网址必须加上 <code>www</code></li><li>解析你博客的 RSS feed，匹配出提及的网址，然后发出 mention</li></ul></li><li><a href="https://kiko.io/post/Hexo-and-the-IndieWeb-Receiving-Webmentions/">Hexo and the IndieWeb (Receiving Webmentions) - kiko.io</a> 使用 <code>webmention.io</code> 接收其他站点发送的 mention 以及如何在博客页面展示。<ul><li>集成收到的 mention 信息有两种方式：<ul><li><code>Static</code> hexo 博客生成时写相关的数据到 html 页面中</li><li><code>Dynamic</code> 访问网站时 javascript 实时解析数据展示</li></ul></li></ul></li></ul><p><a href="https://kwaa.dev/indieweb">IndieWeb, Webmentions | ./kwaa.dev</a>: <a href="https://kwaa.dev/about">藍+85CD</a> 在 <a href="https://github.com/importantimport/urara">Urara</a> 博客系统中实现的过程记录。该博客系统已开源，详见<a href="https://kwaa.dev/intro-urara/re">RE:Introducing Urara | ./kwaa.dev</a></p><ul><li><a href="https://indieweb.org/Webmention-developer#Sending">Webmention-developer#Sending - IndieWeb</a> <a href="http://indieweb.org">indieweb.org</a> 收集的实现 Sending 功能开源项目列表</li></ul><p><a href="https://geekplux.com/posts/webmention">Refactor your blog comments system with Webmention.io</a>: GeekPlux 使用 twitter + webmention 实现博客评论系统</p><ul><li>相关代码参考 <a href="https://github.com/geekplux/site/blob/main/blog/theme.config.js#L20-L149">site/theme.config.js at main · geekplux/site (github.com)</a></li></ul><p><a href="https://www.owenyoung.com/en/blog/indieweb/">Now, I’m in IndieWeb? - Owen Young’s Blog</a> zola 博客</p><ul><li>定期拉取站点全部 mention 信息，生成站点时在 html 页面写入对应的 mention</li><li><a href="https://github.com/theowenyoung/blog/blob/main/workflows/send-webmention.yml">blog/send-webmention.yml at main · theowenyoung/blog · GitHub</a> 解析 rss feed 发送 mention 脚本</li><li>评论展示可以参考，如果匹配到作者发的推，用专门的卡片样式呈现<ul><li><img src="https://media.xiang578.com/202304011210483-owen-comment.png" alt="" /></li></ul></li></ul><p><a href="https://eindex.me/posts/webmentions/">Joining the Webmentions Community: A Beginner’s Guide (eindex.me)</a>  提供基于js 的 send mention 脚本</p><p><a href="https://kaix.in/0001/webmention/">Webmention - KAIX.IN</a>：介绍为什么要使用 webmention 以及写了个 webmention 接收器，不过没有找到相关代码链接。</p><h2 id="发送"><a class="markdownIt-Anchor" href="#发送"></a> 发送</h2><p><a href="https://jamesmead.org/blog/2020-10-13-sending-webmentions-from-a-static-website">Automatically sending Webmentions from a static website - James Mead</a>：解析站点 rss 然后通过 ifttt 发送请求</p><p><a href="https://telegraph.p3k.io/">Telegraph (p3k.io)</a>：手动发送链接</p><p><a href="https://github.com/kristofzerbe/hexo-console-webmention">kristofzerbe/hexo-console-webmention: Sending webmentions for posts within Hexo (github.com)</a>：解析最新 x 篇文章中引用的链接，然后发送到对应的接收服务。下载后，运行报错。</p><p><a href="https://brid.gy/">Bridgy</a> 获取 twitter 交互</p><h2 id="接收"><a class="markdownIt-Anchor" href="#接收"></a> 接收</h2><p><a href="https://webmention.io/">Webmention.io</a> 公开的接收服务，支持以 html，atom feed，json 等格式获取指定网址的 mention 信息</p><p><a href="https://sebastiandedeyne.com/webmentions-on-a-static-site-with-github-actions/">Webmentions on a static site with GitHub Actions \ Seb De Deyne (sebastiandedeyne.com)</a>：定时拉取 <a href="http://webmention.io">webmention.io</a> 上的 webmention 结果</p><p><a href="https://blog.outv.im/2021/webmention/">新增对 Webmention 的支持 | Re:Linked (outv.im)</a>：基于 hexo+sass 的博客，提到 self-host 的接收服务 <a href="https://github.com/outloudvi/workers-webmention-server">outloudvi/workers-webmention-server: Webmention server on Cloudflare Workers. (github.com)</a></p><h2 id="展示"><a class="markdownIt-Anchor" href="#展示"></a> 展示</h2><p><a href="https://jason-memo.dev/posts/webmention/">透過 webmention 來搜集 blog 的社群迴響 (jason-memo.dev)</a> 评论展示形式很美观，值得学习。</p><ul><li><img src="https://media.xiang578.com/202303312113043-jason-webmention-example.png" alt="" /></li></ul><p><a href="https://chriszheng.science/2022/02/09/Embracing-IndieWeb/">拥抱独立网站运动 | M-x Chris-An-Emacser (chriszheng.science)</a>：hexo 博客，基于 webmention.js 展示收到的反馈。</p><p><a href="https://github.com/PlaidWeb/webmention.js">PlaidWeb/webmention.js: Client-side library for rendering webmentions from webmention.io (github.com)</a>：第三方 js 库</p><p><a href="https://whyouare111.github.io/hexo-icarus-showcase/2021/02/02/webmention-demo/">Webmention Demo - IndieWeb Hexo Icarus (whyouare111.github.io)</a> hexo+icarus 主题博客，实现 webmention + mastodon 集成。 修改后主题代码在 <a href="https://github.com/whyouare111/hexo-theme-icarus/tree/matataki">whyouare111/hexo-theme-icarus at matataki (github.com)</a>。</p><ul><li>提到 <a href="https://seviche.cc/about/">About | Seviche.cc</a> 通过标签切换多种评论</li><li>评论模块以时间线形式展示 webmention<ul><li><img src="https://media.xiang578.com/202303252117168-whyouare111-webmention.png" alt="" /></li></ul></li></ul><h2 id="提醒"><a class="markdownIt-Anchor" href="#提醒"></a> 提醒</h2><p><a href="https://whyouare111.github.io/hexo-icarus-showcase/2023/03/31/reply-to-ryen-xiang-20230331/">回复《webmention 实现参考》 - IndieWeb Hexo Icarus (whyouare111.github.io)</a>：<code>webmention.io</code> 提供 mention 的 rss feed，配合 rss 阅读器/IFTTT 等工具可以查看是否收到新的 mention</p><h2 id="测试数据"><a class="markdownIt-Anchor" href="#测试数据"></a> 测试数据</h2><p><a href="https://webmention.io/api/mentions.json?target=https://www.owenyoung.com/en/blog/indieweb/">Owen 的「Now, I’m in IndieWeb? 」相关 mention</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;关于博客内实现 webmention 功能相关文章收集&lt;/p&gt;</summary>
    
    
    
    <category term="随手记" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%89%8B%E8%AE%B0/"/>
    
    
    <category term="webmention" scheme="https://blog.xiang578.com/tags/webmention/"/>
    
    <category term="IndieWeb" scheme="https://blog.xiang578.com/tags/IndieWeb/"/>
    
  </entry>
  
  <entry>
    <title>lc1053. 交换一次的先前排列</title>
    <link href="https://blog.xiang578.com/problem/lc1053.html"/>
    <id>https://blog.xiang578.com/problem/lc1053.html</id>
    <published>2023-04-02T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/previous-permutation-with-one-swap/">LC1053. 交换一次的先前排列</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>第一次碰到num list 的字典序，数字大的字典序大。</p><p>题目合法交换就是去找一个逆序数，即 <code>i&lt;j, arr[i]&gt;arr[j]</code>。结合字典序最大条件，就是要 i 最大，i 最大情况下，还要 j 最大。这种方法的复杂度应该是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>官方题解复杂度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，枚举 <code>i: n-2 -&gt; 0</code>，有一个隐含的假设已经枚举过的 <code>[i,n)</code> 是非递减的。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">prevPermOpt1</span>(<span class="params">self, arr: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        mp = &#123;&#125;</span><br><span class="line">        a = -<span class="number">1</span></span><br><span class="line">        b = -<span class="number">1</span></span><br><span class="line">        n = <span class="built_in">len</span>(arr)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> j &lt;= a:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> arr[j] &gt; arr[i]:</span><br><span class="line">                    a = j</span><br><span class="line">                    b = i</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> a == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> arr</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(a, b):</span><br><span class="line">                <span class="keyword">if</span> arr[b] == arr[j]:</span><br><span class="line">                    b = j</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            tmp = arr[a]</span><br><span class="line">            arr[a] = arr[b]</span><br><span class="line">            arr[b] = tmp</span><br><span class="line">        <span class="keyword">return</span> arr</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/previous-permutation-with-one-swap/&quot;&gt;LC1053. 交换一次的先前排列&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="greedy" scheme="https://blog.xiang578.com/tags/greedy/"/>
    
  </entry>
  
  <entry>
    <title>lc526. 优美的排列</title>
    <link href="https://blog.xiang578.com/problem/lc526.html"/>
    <id>https://blog.xiang578.com/problem/lc526.html</id>
    <published>2023-04-02T16:00:00.000Z</published>
    <updated>2024-05-12T10:25:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode-cn.com/problems/beautiful-arrangement/submissions/">526. 优美的排列 - 力扣（LeetCode） (leetcode-cn.com)</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>常规状态压缩，（偷懒直接在测试台输入 1-15 的样例打表也可以）</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countArrangement</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> a[<span class="number">16</span>][<span class="number">1</span>&lt;&lt;n];</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">        a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(<span class="number">1</span>&lt;&lt;n);j++) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (k%i!=<span class="number">0</span>&amp;&amp;i%k!=<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (j &amp; (<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))) <span class="keyword">continue</span>;</span><br><span class="line">                    a[i][j|(<span class="number">1</span>&lt;&lt;(k<span class="number">-1</span>))] += a[i<span class="number">-1</span>][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a[n][(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode-cn.com/problems/beautiful-arrangement/submissions/&quot;&gt;526. 优美的排列 - 力扣（LeetCode） (leetcode-cn.com)&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="DP" scheme="https://blog.xiang578.com/tags/DP/"/>
    
    <category term="bitmasks" scheme="https://blog.xiang578.com/tags/bitmasks/"/>
    
  </entry>
  
  <entry>
    <title>lc1039. 多边形三角剖分的最低得分</title>
    <link href="https://blog.xiang578.com/problem/lc1039.html"/>
    <id>https://blog.xiang578.com/problem/lc1039.html</id>
    <published>2023-04-01T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/minimum-score-triangulation-of-polygon/">1039. 多边形三角剖分的最低得分</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>区间 DP，假设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 为从 i 到 j 进行三角剖分后最低分。枚举 i 到  j 中间存在一个点 k，使多边形变成三部分：ik, kj 以及 ijk 三角形的多边形，取最小的就是  ij 的最低分。</p><p>用 DFS 来写比直接写出递推公式简单一些。</p><p>看了标签和官方题解才写出来！</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minScoreTriangulation</span>(<span class="params">self, values: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        mp = &#123;&#125;</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">dp</span>(<span class="params">i, j</span>):</span><br><span class="line">            <span class="keyword">if</span> j - i &lt; <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> j - i == <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> values[i]*values[i+<span class="number">1</span>]*values[j]</span><br><span class="line">            <span class="keyword">if</span> (i,j) <span class="keyword">in</span> mp:</span><br><span class="line">                <span class="keyword">return</span> mp[(i,j)]</span><br><span class="line">            ans = <span class="number">1e9</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, j):</span><br><span class="line">                tmp = dp(i, k) + dp(k, j) + values[i]*values[k]*values[j]</span><br><span class="line">                ans = <span class="built_in">min</span>(tmp, ans)</span><br><span class="line">            mp[(i,j)] = ans</span><br><span class="line">            <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp(<span class="number">0</span>, <span class="built_in">len</span>(values)-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="错误贪心"><a class="markdownIt-Anchor" href="#错误贪心"></a> 错误贪心</h2><p>枚举一个点做为顶点，往其他点连线将平面且分成 n-2 个三角形，样例第三个都过不了……</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minScoreTriangulation</span>(<span class="params">self, values: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(values)</span><br><span class="line">        aa = values + values</span><br><span class="line">        ans = <span class="number">1e9</span>+<span class="number">7</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            tmp = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n-<span class="number">1</span>):</span><br><span class="line">                tmp += aa[i] * aa[i+j] * aa[i+j+<span class="number">1</span>]</span><br><span class="line">            <span class="built_in">print</span>(tmp)</span><br><span class="line">            ans = <span class="built_in">min</span>(tmp, ans)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/minimum-score-triangulation-of-polygon/&quot;&gt;1039. 多边形三角剖分的最低得分&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Dynamic Programming" scheme="https://blog.xiang578.com/tags/Dynamic-Programming/"/>
    
    <category term="区间 DP" scheme="https://blog.xiang578.com/tags/%E5%8C%BA%E9%97%B4-DP/"/>
    
  </entry>
  
  <entry>
    <title>lc831. 隐藏个人信息</title>
    <link href="https://blog.xiang578.com/problem/lc831.html"/>
    <id>https://blog.xiang578.com/problem/lc831.html</id>
    <published>2023-03-31T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/masking-personal-information/">831. 隐藏个人信息 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>模拟</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maskPII</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        ans = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;@&#x27;</span> <span class="keyword">in</span> s:</span><br><span class="line">            s = s.lower()</span><br><span class="line">            a, b = s.split(<span class="string">&quot;@&quot;</span>)</span><br><span class="line">            ans = a[<span class="number">0</span>] + <span class="string">&quot;*****&quot;</span> + a[-<span class="number">1</span>]  + <span class="string">&quot;@&quot;</span> + b</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num = []</span><br><span class="line">            <span class="keyword">for</span> ss <span class="keyword">in</span> s:</span><br><span class="line">                <span class="keyword">if</span> ss.isnumeric():</span><br><span class="line">                    num.append(ss)</span><br><span class="line">            per = [<span class="string">&#x27;***-***-&#x27;</span>, <span class="string">&#x27;+*-***-***-&#x27;</span>, <span class="string">&#x27;+**-***-***-&#x27;</span>, <span class="string">&#x27;+***-***-***-&#x27;</span>]</span><br><span class="line">            ans = per[<span class="built_in">len</span>(num)-<span class="number">10</span>] + <span class="string">&quot;&quot;</span>.join(num[-<span class="number">4</span>:])</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/masking-personal-information/&quot;&gt;831. 隐藏个人信息 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Problems" scheme="https://blog.xiang578.com/tags/Problems/"/>
    
    <category term="implementation" scheme="https://blog.xiang578.com/tags/implementation/"/>
    
  </entry>
  
  <entry>
    <title>lc2367. 算术三元组的数目</title>
    <link href="https://blog.xiang578.com/problem/lc2367.html"/>
    <id>https://blog.xiang578.com/problem/lc2367.html</id>
    <published>2023-03-30T16:00:00.000Z</published>
    <updated>2024-04-20T07:09:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/number-of-arithmetic-triplets/">2367. 算术三元组的数目 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>三层 for 循环暴力，也可以优化，枚举 i 和 j，然后查找 <code>a[k]</code> 是否存在。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">arithmeticTriplets</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; a, <span class="type">int</span> diff)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>; j&lt;a.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(a[j]-a[i]&gt;diff) <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=j+<span class="number">1</span>;k&lt;a.<span class="built_in">size</span>(); ++k) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(a[j]-a[i]==a[k]-a[j] &amp;&amp; a[j]-a[i]==diff) &#123;</span><br><span class="line">                        ans += <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (a[k]-a[j]&gt;a[j]-a[i]) <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/number-of-arithmetic-triplets/&quot;&gt;2367. 算术三元组的数目 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Problems" scheme="https://blog.xiang578.com/tags/Problems/"/>
    
  </entry>
  
  <entry>
    <title>lc1637. 两点之间不包含任何点的最宽垂直区域</title>
    <link href="https://blog.xiang578.com/problem/lc1637.html"/>
    <id>https://blog.xiang578.com/problem/lc1637.html</id>
    <published>2023-03-29T16:00:00.000Z</published>
    <updated>2024-05-12T10:25:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/widest-vertical-area-between-two-points-containing-no-points/">1637. 两点之间不包含任何点的最宽垂直区域 - 力扣（LeetCode）</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>对Points数组按 x 从小到大排序，<code>max(Points[i+1][0] - Points[i][0])</code> 就是答案。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxWidthOfVerticalArea</span>(<span class="params">self, points: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        points.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>])</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(points)):</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, points[i][<span class="number">0</span>]-points[i-<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/widest-vertical-area-between-two-points-containing-no-points/&quot;&gt;1637. 两点之间不包含任何点的最宽垂直区域 - 力扣（LeetCode）&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="sortings" scheme="https://blog.xiang578.com/tags/sortings/"/>
    
  </entry>
  
  <entry>
    <title>lc1638. 统计只差一个字符的子串数目</title>
    <link href="https://blog.xiang578.com/problem/lc1638.html"/>
    <id>https://blog.xiang578.com/problem/lc1638.html</id>
    <published>2023-03-27T16:00:00.000Z</published>
    <updated>2024-05-12T10:19:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://leetcode.cn/problems/count-substrings-that-differ-by-one-character/">LC1638</a></p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>方法一</p><ul><li>n&lt;100，三层循环枚举。</li></ul><p>方法二：动态规划</p><ul><li>假设 dp[i][j] 代表以 s[i] 和 t[j] 为不同字符的满足题目条件的方案数</li></ul><h2 id="代码"><a class="markdownIt-Anchor" href="#代码"></a> 代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countSubstrings</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;s.<span class="built_in">size</span>();i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;t.<span class="built_in">size</span>();j++) &#123;</span><br><span class="line">                <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;i+k&lt;s.<span class="built_in">size</span>()&amp;&amp;j+k&lt;t.<span class="built_in">size</span>(); k++) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(s[i+k]!=t[j+k]) &#123;</span><br><span class="line">                        d++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(d==<span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">if</span> (d==<span class="number">1</span>) ans +=<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;a href=&quot;https://leetcode.cn/problems/count-substrings-that-differ-by-one-character/&quot;&gt;LC1638&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Problems" scheme="https://blog.xiang578.com/tags/Problems/"/>
    
    <category term="medium" scheme="https://blog.xiang578.com/tags/medium/"/>
    
  </entry>
  
  <entry>
    <title>【时间序列预测】Are Transformers Effective for Time Series Forecasting?</title>
    <link href="https://blog.xiang578.com/post/are-transformers-effective-for-time-series-forecasting.html"/>
    <id>https://blog.xiang578.com/post/are-transformers-effective-for-time-series-forecasting.html</id>
    <published>2023-03-18T13:53:32.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>香港中文大学曾爱玲文章，在长时间序列预测问题上使用线性模型打败基于 Transformer 的模型，并对已有模型的能力进行实验分析（灵魂7问，强烈推荐好好读一下！）。</p><span id="more"></span><h2 id="核心贡献"><a class="markdownIt-Anchor" href="#核心贡献"></a> 核心贡献</h2><ul><li>质疑基于 Transformer 的序列预测模型在长时间序列预测任务（LTSF，long-term time series forecasting） 的有效性<ul><li>大部分模型无法从长序列中抽取时序信息（实验中预测误差并没有随着历史窗口增大而减少）</li><li>大部分模型相对于 baseline（rnn类）的提升是将预测方法从 IMS 替换成 DMS 得到的。</li></ul></li><li>提出只有 one-layer linear model： <code>LTSF-Linear</code>，通过 DMS 方式预测效果超过之前模型。</li><li>对已有模型的能力进行实验分析（建模长输入的能力、对时间顺序的敏感性、位置编码、子序列 embdding 影响、模型性能）</li></ul><h2 id="核心问题"><a class="markdownIt-Anchor" href="#核心问题"></a> 核心问题</h2><ul><li>时间序列预测问题主要形式是：已知前 t 时间的特征，然后预测未来一段时间的结果。如果需要预测的时间很长，被称之为长时间序列预测。<ul><li><code>IMS</code> iterated multi-step (IMS) forecasting，每次预测一个结果，迭代多次得到对未来一段时间的预测结果（自回归）。结果方差比较小，但是预测过程中误差会累积。</li><li><code>DMS</code> direct multistep (DMS) forecasting，一步得到对于未来一段时间的预测结果。常在需要预测未来时间很长或者很难训练无偏单步预测模型时使用。</li></ul></li><li>Transformer 前提假设是成对元素之间有语义相关性，self-attention 机制本质是元素置换不变，建模时序关系能力很大程度上取决于与输入标记相关联的位置编码。<ul><li>时序数据基本上没有点对点的语义相关性，需要模型能提取连续点之间的时序关系。Time Series Transformer 通过位置编码以及序列编码提供部分顺序信息，但是由于置换不变自注意力机制的存在必然存在时序信息丢失问题。</li></ul></li></ul><h2 id="相关工作"><a class="markdownIt-Anchor" href="#相关工作"></a> 相关工作</h2><h3 id="time-series-transformer-框架"><a class="markdownIt-Anchor" href="#time-series-transformer-框架"></a> Time Series Transformer 框架</h3><p><img src="https://media.xiang578.com/202303182247135.png" alt="" /></p><ul><li><code>Time series decomposition</code> 对输入序列进行分解，后续更好预测。<ul><li><a href="/post/autoformer.html">Autoformer</a> 在 seasonal-trend decomposition 中通过 moving average 建模 trend 趋势项。</li><li><a href="/post/FEDformer.html">FEDformer</a> 通过 MoE 策略将移动平均提取的趋势和各种大小核进行混合。</li></ul></li><li>对输入特征的 emebdding 策略：<ul><li>原始时间序列的顺序 local positional information</li><li>全局时间信息，比如hierarchical timestamps (week, month, year) 和 agnostic timestamps(holidays and events)</li><li>injecting several embeddings, like a fixed positional encoding, a channel projection embedding, and learnable temporal embeddings into the input sequence.</li><li>temporal embeddings with a temporal convolution layer or learnable timestamps  are introduced</li></ul></li><li>self-attention schemes 让 attention 矩阵计算尽可能稀疏</li><li>Decoders 改进原始 Transformer 的自回归模式。</li></ul><h2 id="解决方案"><a class="markdownIt-Anchor" href="#解决方案"></a> 解决方案</h2><h3 id="ltsf-linear"><a class="markdownIt-Anchor" href="#ltsf-linear"></a> LTSF-Linear</h3><ul><li>通过一层神经网对过去信息加权得到未来预测结果。</li><li>不同变量间共享参数并且不对 spatial correlations 建模</li></ul><p><img src="https://media.xiang578.com/202303182310362-LTSF-Linear.png" alt="" /></p><h3 id="dlinear"><a class="markdownIt-Anchor" href="#dlinear"></a> DLinear</h3><ul><li>D 对应 Decomposition scheme，将输入数据分解成 trend 和 remaninder 两部分<ul><li>trend 通过移动平均核得到</li><li>remaninder 是输入数据减去 trend 结果得到</li></ul></li><li>在数据集有明显趋势性的时候该方法能提升预测效果</li></ul><h3 id="nlinear"><a class="markdownIt-Anchor" href="#nlinear"></a> NLinear</h3><p>部分数据集的训练数据和测试数据存在分布偏移（下图中 b），无法使用训练集的均值和方差进行归一化。NLinear 将输入序列每一个值减去该序列最后一个值，然后输入序列过完线性层后加回被减去的值得到最后预测结果。</p><p><img src="https://media.xiang578.com/202303182316694-lsft-dis-shift.png" alt="" /></p><h2 id="实验结论"><a class="markdownIt-Anchor" href="#实验结论"></a> 实验结论</h2><ul><li><code>Repeat*</code> 指用输入序列最后一个特征做为未来一段时间的预测，模型如果效果比这个查，说明模型错误预测了趋势……</li><li>NLiner 和 DLinear 的结果比 Linear 好，说明处理分布偏移和分解趋势-周期特征的重要性。</li><li>FEDformer 相比其他 Transformer 方法好，是因为它采用经典的时间序列分析技术，不太依赖自注意力机制。</li></ul><p><img src="https://media.xiang578.com/202303182322387-ltsf-linear-result.png" alt="" /></p><h3 id="定性分析"><a class="markdownIt-Anchor" href="#定性分析"></a> 定性分析</h3><ul><li>过去 96 预测未来 336 时，下图 a 和 c，部分 Tranformer 模型根本无法预测未来数据的取值范围和偏差。</li><li>在非周期数据（图b，汇率）Tranformer 模型几乎无法预测适当的趋势。</li></ul><p><img src="https://media.xiang578.com/202303182331993-ltsf-f3-fix.png" alt="" /></p><h3 id="transformer-类模型进一步分析灵魂七问"><a class="markdownIt-Anchor" href="#transformer-类模型进一步分析灵魂七问"></a> Transformer 类模型进一步分析（灵魂七问）</h3><h4 id="能否从长序列中提取时序信息"><a class="markdownIt-Anchor" href="#能否从长序列中提取时序信息"></a> 能否从长序列中提取时序信息？</h4><ul><li>历史窗口（look-back window） 越长（输入信息越多），预测效果应该越好。</li><li>下图 x 轴对应不同历史窗口长度，可以看到随着输入信息变多，LTSF-Linear 方法预测结果越来越准，但是大部分 Transformer 模型 mse 并没有太多变化，作者猜测可能模型过拟合噪音而不能获得时序信息。</li></ul><p><img src="https://media.xiang578.com/202303192214654-ltsf-linear-f4.png" alt="" /></p><h4 id="能从长序列预测可以学到什么"><a class="markdownIt-Anchor" href="#能从长序列预测可以学到什么"></a> 能从长序列预测可以学到什么？</h4><ul><li>历史窗口中的动态时间会显著影响短期预测的精度，而长期预测仅依赖模型是否很好捕捉趋势和周期性。即预测时间跨度越长，历史窗口本身影响越小。</li><li>预测未来 720 步，下面两种取历史窗口方法:<ul><li><code>Close</code> 前 96 步输入</li><li><code>Far</code> 前 192 步到 前 97 步输入</li></ul></li><li>fedformer 和 autoformer 在两种方法下预测效果几乎相同，说明模型只能从相邻时间序列中捕获到类似的时序信息。</li></ul><p><img src="https://media.xiang578.com/202303192209473-ltsf-t3.png" alt="" /></p><h4 id="self-attention-scheme-是否有效"><a class="markdownIt-Anchor" href="#self-attention-scheme-是否有效"></a> self-attention scheme 是否有效？</h4><ul><li>对 Informer 结构进行消融实验，下表从左到右网络结构越来越简单，然后效果基本上逐步提升。看起来注意力机制和其他复杂模块在 LTSF 上没有正向效果。<ul><li><code>Att.-Linear</code> 用 linear layer 替换  self-attention layer</li><li><code>Embed+Linear</code> 再去除其他模块</li></ul></li></ul><p><img src="https://media.xiang578.com/202303192202216-ltsf-t4.png" alt="" /></p><h4 id="模型可以保留时序信息吗"><a class="markdownIt-Anchor" href="#模型可以保留时序信息吗"></a> 模型可以保留时序信息吗？</h4><ul><li>self-attention 本质上不考虑空间关系（无视元素的位置信息） permutation-invariant，通过 positional and temporal embedding 模型还是丢失时间信息。</li><li>三种数据处理方式<ul><li><code>Shuf</code> 输入数据顺序全部打乱</li><li><code>Half-ex</code> 输入数据分成前后两部分，交换这两部分的顺序。</li></ul></li><li>两个实验表明 Transformers  不能很好保留时序信息<ul><li>在 Exchange 汇率数据集，三个 Tranformer 模型在这三种数据处理方式下，预测结果的 mse 基本上都都接近，可能仅保留有限的时间关系，但是最终过拟合了。Linear 模型自然建模顺序并且使用更少的参数避免过度拟合。</li><li>在 ETH1 数据集，FEDformer 建模时考虑时间序列偏差，提出了数据中明显的时间信息，所以在 shuf 组 mse 下降非常快。Informer 根本没有建模这方面信息。</li></ul></li></ul><p><img src="https://media.xiang578.com/202303190007289-ltsf-t5.png" alt="" /></p><h4 id="不同-embedding-策略的作用"><a class="markdownIt-Anchor" href="#不同-embedding-策略的作用"></a> 不同 embedding 策略的作用？</h4><ul><li>依次删除模型中的 Position embedding、global time stamp embedding 和同时删除这两个 temebdding。</li><li>Informer的预测误差在没有位置嵌入（wo/Pos.）的情况下大幅增加。在没有时间戳嵌入（wo/Temp.）的情况下，随着预测长度的增加，Informer的性能将逐渐受损。<ul><li>论文中给的原因没有看懂：Informer uses a single time step for each token, it is necessary to introduce temporal information in tokens.</li></ul></li><li>Autoformer 和 FEDformer 通过一系列时间戳去编码时间信息，所以删除 pos 后效果可能变得更好。</li><li>Autoformer 去除时间 embedding 后效果明显变差。</li><li>FEDformer 通过 frequency-enhanced module 使模型有 temporal inductive bias，删除 pos 和 temp 影响不是很大。</li></ul><p><img src="https://media.xiang578.com/202303182353101-ltsf-t6.png" alt="" /></p><h4 id="训练数据大小是现在模型的限制因素"><a class="markdownIt-Anchor" href="#训练数据大小是现在模型的限制因素"></a> 训练数据大小是现在模型的限制因素？</h4><ul><li>问题：是不是训练数据量太少导致 Transformer 类模型表现差？</li><li>在交通数据上用 Ori <code>17544*0.7 hour</code> 数据和  Short <code>365＊24=8760 hour</code> 数据对比：<ul><li>基本上是训练数据小的时候，预测误差小。证明训练数据不是限制 Transformer 类模型表现的原因。</li><li>导致这种现象的原因可能是 short 对应全年数据，有更清晰的时间特征趋势。</li></ul></li></ul><p><img src="https://media.xiang578.com/202303182349885-ltsf-t7.png" alt="" /></p><h4 id="性能真的是长时间预测任务中优先级最高的事情吗"><a class="markdownIt-Anchor" href="#性能真的是长时间预测任务中优先级最高的事情吗"></a> 性能真的是长时间预测任务中优先级最高的事情吗？</h4><ul><li>两个问题：Transformer 模型的推理时间和内存消耗是否增加？现在的 GPU 显存能否满足任务和模型需求。</li><li>下图可以看到大部分 Transformer 模型参数量和原始 Tranformer 没有太大区别，但是推理时间可能超过原来……<ul><li>另外在通过 96 步预测 720 步任务上，原始 Tranformer 的参数 GPU 也放得下……</li></ul></li></ul><p><img src="https://media.xiang578.com/202303182345491-ltsf-t8.png" alt="" /></p><h2 id="可解释性"><a class="markdownIt-Anchor" href="#可解释性"></a> 可解释性</h2><p>附录中简单写了一些，由于模型是线性模型，不同输入位置的权重可以直接用来解释模型如何生效以及反应特点。</p><ul><li>金融数据可以观察到越靠近未来时刻的特征权重越大，代表它们对预测值的贡献更大。</li><li>交通数据能观察到明显的周期性。</li></ul><h2 id="读后总结"><a class="markdownIt-Anchor" href="#读后总结"></a> 读后总结</h2><ul><li>灵魂七问提供了很好设计对比实验的思路</li><li>读论文需要更加仔细思考，之前根本没有想过 informer 这种点注意力其实在时间序列预测上的有效性。</li><li>transformer 在时序预测的应用还是值得进一步思考！</li></ul><h2 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> Ref</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/569194246">Are Transformers Effective for Time Series Forecasting? - 知乎 (zhihu.com)</a></li><li><a href="https://www.bilibili.com/video/BV14j411A72V/">Transformer对时序预测真的有效吗? | AAAI’23 Oral_哔哩哔哩_bilibili</a></li><li><a href="https://zhuanlan.zhihu.com/p/521329803">Transformer用于时间序列预测任务真的有效吗？ - 知乎 (zhihu.com)</a></li><li><a href="https://readpaper.com/paper/4628140664303927297">Are Transformers Effective for Time Series Forecasting?-论文阅读讨论-ReadPaper</a></li><li><a href="https://zhuanlan.zhihu.com/p/612092817">CTR率预测One Epoch现象 / LTSF场景质疑Transformer - 知乎 (zhihu.com)</a></li><li><a href="https://zhuanlan.zhihu.com/p/544622984">DLinear：Are Transformers Effective for Time Series Forecasting? - 知乎 (zhihu.com)</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;香港中文大学曾爱玲文章，在长时间序列预测问题上使用线性模型打败基于 Transformer 的模型，并对已有模型的能力进行实验分析（灵魂7问，强烈推荐好好读一下！）。&lt;/p&gt;</summary>
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="Paper" scheme="https://blog.xiang578.com/tags/Paper/"/>
    
    <category term="Transformer" scheme="https://blog.xiang578.com/tags/Transformer/"/>
    
    <category term="Time Series Forecasting" scheme="https://blog.xiang578.com/tags/Time-Series-Forecasting/"/>
    
  </entry>
  
  <entry>
    <title>【滴滴 HierETA】Interpreting Trajectories from Multiple Views A Hierarchical Self-Attention Network for Estimating the Time of Arrival</title>
    <link href="https://blog.xiang578.com/post/hiereta.html"/>
    <id>https://blog.xiang578.com/post/hiereta.html</id>
    <published>2023-03-12T14:14:33.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>滴滴和华南理工在 2022 年 KDD 上发表的 ETA 论文，从多个视角解释轨迹，引入 Hierarchical Self-Attention Network 方法进行建模，最终在滴滴内部数据集上获得指标提升。</p><span id="more"></span><h2 id="关键信息"><a class="markdownIt-Anchor" href="#关键信息"></a> 关键信息</h2><ul><li>论文地址：<a href="https://dl.acm.org/doi/10.1145/3534678.3539051">Interpreting Trajectories from Multiple Views: A Hierarchical Self-Attention Network for Estimating the Time of Arrival | Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</a></li><li>关键字：网约车 ETA、轨迹挖掘、Self-Attention</li></ul><h2 id="背景信息"><a class="markdownIt-Anchor" href="#背景信息"></a> 背景信息</h2><p>下图是一个行程的轨迹（trajectory）示意图，任务是预测整个行程的到达时间。作者提出三种视图：</p><ul><li><code>Intersection-view</code> 对应现实世界中的路口，其属性包括：红绿灯等待时间、交通灯数量、历史车通过流量。</li><li><code>link-view</code> 连接两个路口的路，其静态属性包括：是否收费、道路宽度、道路等级。</li><li><code>segment-view</code> 人工将 link 打断成多个小段，用来表示细粒度的局部交通情况（红绿灯前一条路可能不是全部拥堵，用segment来表示比link来表示更合理），但是在表征道路网络结构方面并不完全。</li></ul><p><img src="https://media.xiang578.com/202303122106126-ETA.png" alt="" /></p><h2 id="核心问题"><a class="markdownIt-Anchor" href="#核心问题"></a> 核心问题</h2><ul><li>传统 ETA 方法采用分治策略，将一个轨迹拆分成多个小段（segment-view），然后累加每个小段预测结果得到最终 ETA（实验结果中的 Route-ETA），显然这种策略会导致较大的累积误差。</li><li>多视图（Intersection、link、segment）建模困难，常规方法使用 segment 建模，不考虑 link，没有对同一个 link 多个段之间的一致性进行建模。</li><li>link 和 Intersection 的属性不一致，很难使用同一个网络去建模。</li></ul><h2 id="相关工作"><a class="markdownIt-Anchor" href="#相关工作"></a> 相关工作</h2><p>文章中引用的相关工作主要包括三个方面：交通流预估（traffic flow prediction）、到达时间预估（travel time estimation）、自注意力机制。</p><ul><li>GMAN：基于图的多注意力机制来预测交通状况<ul><li>图学习通常会受到不相关的空间领域的负面影响（关注的区域越大月明显），并且这种影响会在训练过程中传播。</li><li>图建模被限制在很小的区域范围，在大规模城市系统中存在不足</li></ul></li><li>DeepTTE：原始 GPS 轨迹序列 + geo convolutional network + LSTM</li><li><a href="/post/wdr.html">(WDR) Learning to Estimate the Travel Time</a>：Wide &amp; Deep &amp; RNN</li><li>ConSTGAT 和  CompactETA 图建模 ETA</li><li>DeepGTT： 深度生成模型学习 ETA 分布</li><li>HetETA ：multi-relational network 学习时空数据表示</li><li>TTPNet：利用张量分解和图 embedding 从历史轨迹中学习速度和 emebdding</li></ul><h2 id="核心贡献"><a class="markdownIt-Anchor" href="#核心贡献"></a> 核心贡献</h2><ol><li>利用三个视图的层次关系对道路底层结构进行建模</li><li>分层自自注意力网络 <code>Hierarchical Self-Attention Network</code></li><li>自适应自注意力网络 <code>Adaptive Self-Attention Network</code></li></ol><h2 id="解决方案"><a class="markdownIt-Anchor" href="#解决方案"></a> 解决方案</h2><p>模型结构分成三部分：Segment Encoder、Joint Link-Intersection Encoder 和 Hierachy-Aware Attention Decoder</p><p><img src="https://media.xiang578.com/202303122134091-hiereta-arch.png" alt="" /></p><h3 id="segment-encoder"><a class="markdownIt-Anchor" href="#segment-encoder"></a> Segment Encoder</h3><p>这个编码器主要作用是对同一个 link 的 sgement 进行时空建模：</p><ul><li>segment 特征是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>j</mi><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">[x^s_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1447720000000001em;vertical-align:-0.394772em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>，全局特征是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x_r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></li><li>利用 BiLSTM 处理 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msubsup><mi>x</mi><mi>j</mi><mi>s</mi></msubsup><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x^s_j|x_r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1447720000000001em;vertical-align:-0.394772em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，正向和反向结果 concat 成 segment 的表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mi>j</mi><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">H^s_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.078102em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>。</li><li>同一个 link 内 segement 记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mi>s</mi></msup><mo>=</mo><mrow><mo fence="true">[</mo><msubsup><mi>H</mi><mn>1</mn><mi>s</mi></msubsup><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msubsup><mi>H</mi><mi>n</mi><mi>s</mi></msubsup><mo fence="true">]</mo></mrow><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>n</mi><mo>×</mo><msub><mi>d</mi><mi>s</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">H^s=\left[H_1^s, \ldots, H_n^s\right] \in \mathbb{R}^{n \times d_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4518920000000004em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></li><li>计算 j-th segment 和 link 内其他 segment 的全局相似度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><msub><mi>P</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>Q</mi><mi>j</mi></msub><msup><mi>K</mi><mi>T</mi></msup></mrow><msub><msqrt><mi>d</mi></msqrt><mi>s</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">G P_j=\frac{Q_j K^T}{\sqrt{d}_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7386849999999998em;vertical-align:-0.588em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.150685em;"><span style="top:-2.5335085em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.937845em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mathnormal mtight">d</span></span></span><span style="top:-2.8978450000000002em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.102155em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13395928571428573em;"><span style="top:-2.3264164285714286em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17358357142857145em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.50732em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.588em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>计算 j-th segment 相邻 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span> 个 segment 计算局部相似度 <code>local sematic pattern</code>  ，这一步是捕获局部 segment 的依然，对拥堵转移进行建模。<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><msub><mi>P</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>G</mi><msub><mi>P</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><mi>j</mi><mo>−</mo><mi>k</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi>ω</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">L P_j(k)= \begin{cases}G P_j(k), &amp; |j-k| \leq \omega \\ -\infty, &amp; \text { otherwise }\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> otherwise </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>用门控机制平衡全局和局部相似度的结果<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>j</mi><mi>s</mi></msubsup><mo>=</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>⊙</mo><mi mathvariant="normal">Att</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mi>G</mi><msub><mi>P</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>z</mi><mi>j</mi></msub><mo>⊙</mo><mi mathvariant="normal">Att</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mi>L</mi><msub><mi>P</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_j^s=\left(1-z_j\right) \odot \operatorname{Att}\left(G P_j\right)+z_j \odot \operatorname{Att}\left(L P_j\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.078102em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop"><span class="mord mathrm">A</span><span class="mord mathrm">t</span><span class="mord mathrm">t</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop"><span class="mord mathrm">A</span><span class="mord mathrm">t</span><span class="mord mathrm">t</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></li><li>控制参数通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msub><mi>W</mi><mi>h</mi></msub><msubsup><mi>H</mi><mi>j</mi><mi>s</mi></msubsup><mo>+</mo><msub><mi>W</mi><mi>g</mi></msub><mi>A</mi><mi>t</mi><mi>t</mi><mrow><mo fence="true">(</mo><mi>G</mi><msub><mi>P</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>W</mi><mi>l</mi></msub><mi>A</mi><mi>t</mi><mi>t</mi><mrow><mo fence="true">(</mo><mi>L</mi><msub><mi>P</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>b</mi><mi>z</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_j=\sigma\left(W_h H_j^s+W_g A t t\left(G P_j\right)+W_l A t t\left(L P_j\right)+b_z\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.244772em;vertical-align:-0.394772em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord mathnormal">t</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mord mathnormal">t</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> 学习</li></ul></li><li>所有 link 的 encoder 参数共享以及并行计算</li></ul><h3 id="joint-link-intersection-encoder"><a class="markdownIt-Anchor" href="#joint-link-intersection-encoder"></a> Joint Link-Intersection Encoder</h3><p>上一个解码器主要在 segment-view 上建模，缺少对 link 之间一致性建模，Joint Link-Intersection Encoder 考虑 link 和 intersection 交替出现的特点（一条路连接两个路口），同时在 link-view 和 intersection-view 维度建模，实现通过 segment-view 捕捉局部交通信息， link-intersection context 捕捉道路属性：</p><ul><li>加权融合 segment 表示得到 link 表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>l</mi></msubsup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>h</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^l=\sum_{j=1}^n \gamma_{i j} h_{i j}^s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.107772em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24011em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span><ul><li>权重计算方法 [[Attention]] <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo></mo><mi>j</mi></msub><mrow><mo fence="true">(</mo><msub><mi>W</mi><mi>γ</mi></msub><msubsup><mi>h</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msub><mi>b</mi><mi>γ</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma_{i j}=\operatorname{softmax}_j\left(W_\gamma h_{i j}^s+b_\gamma\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.244772em;vertical-align:-0.394772em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">t</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></li></ul></li><li>得到 link 和 intersections 的表示后，分别用两个不同的 BiLSTM 编码（主要让两个向量长度相同）得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mi>i</mi><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">{H^l_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.107772em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mi>i</mi><mi>c</mi></msubsup></mrow><annotation encoding="application/x-tex">{H^c_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.941994em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span></span>，concat 在一起得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>H</mi><mo>^</mo></mover><mi>i</mi><mi>l</mi></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><msubsup><mi>H</mi><mi>i</mi><mi>l</mi></msubsup><mo>∣</mo><msubsup><mi>H</mi><mi>i</mi><mi>c</mi></msubsup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{H}_i^l=\left[H_i^l \mid H_i^c\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.205434em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>H</mi><mo>^</mo></mover><mi>i</mi><mi>l</mi></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><msubsup><mi>H</mi><mi>i</mi><mi>l</mi></msubsup><mo>∣</mo><msubsup><mi>H</mi><mi>i</mi><mi>c</mi></msubsup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{H}_i^l=\left[H_i^l \mid H_i^c\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.205434em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span> 经过 self-attention layer + resnet + ln 得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mrow><mo fence="true">{</mo><msubsup><mi>h</mi><mi>i</mi><mi>l</mi></msubsup><mo fence="true">}</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">\left\{h_i^l\right\}_{i=1}^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.304002em;vertical-align:-0.39971em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.904292em;"><span style="top:-2.3002900000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.39971em;"><span></span></span></span></span></span></span></span></span></span></li><li>考虑到相邻 link 之间的交通影响更加弱和稀疏，作者没有计算不同 link 之间的 local pattern，从而避免过拟合。</li></ul><h3 id="hierachy-aware-attention-decoder-层次感知注意力解码器"><a class="markdownIt-Anchor" href="#hierachy-aware-attention-decoder-层次感知注意力解码器"></a> Hierachy-Aware Attention Decoder 层次感知注意力解码器</h3><p>一个行程中不同的 sub-route 对于 eta 贡献是不一样的（比如拥堵的路口和道路对时间预估影响更大），引入层次感知注意力来计算最终 ETA：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">R</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>h</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>s</mi></msubsup><mo>+</mo><mi>λ</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>β</mi><mi>i</mi></msub><msubsup><mi>h</mi><mi>i</mi><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{R}=(1-\lambda) \sum_{i=1}^m \sum_{j=1}^n \alpha_{i j} h_{i j}^s+\lambda \sum_{i=1}^m \beta_i h_i^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">R</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">h^s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">h^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span> 分别是 segment 和 link-intersection 的表示</li><li>link 的注意力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>i</mi></msub><mo>=</mo><mi><munder><mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo></mo><mi>i</mi></munder></mi><mrow><mo fence="true">(</mo><msup><mi>f</mi><mi>l</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mi>i</mi><mi>l</mi></msubsup><mo separator="true">,</mo><msup><mi>x</mi><mi>r</mi></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_i=\underset{i}{\operatorname{softmax}}\left(f^l\left(h_i^l, x^r\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.577664em;vertical-align:-0.727664em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.372336em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">t</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.727664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mi>l</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mi>i</mi><mi>l</mi></msubsup><mo separator="true">,</mo><msup><mi>x</mi><mi>r</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><msup><mi>v</mi><mi>T</mi></msup><mi>tanh</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>w</mi><mn>1</mn></msub><msubsup><mi>h</mi><mi>i</mi><mi>l</mi></msubsup><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>x</mi><mi>r</mi></msup><mo>+</mo><mi>b</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">f^l\left(h_i^l, x^r\right)=v^T \tanh \left(w_1 h_i^l+w_2 x^r+b\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">tanh</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> （xr 是全局特征）</li><li>计算 segment 之间注意力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi><munder><mo><mi mathvariant="normal">softmax</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></munder></mi><mrow><mo fence="true">(</mo><msub><mi>β</mi><mi>i</mi></msub><msup><mi>f</mi><mi>s</mi></msup><mrow><mo fence="true">(</mo><msubsup><mi>h</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>s</mi></msubsup><mo separator="true">,</mo><msup><mi>x</mi><mi>r</mi></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_{i j}=\underset{(i, j)}{\operatorname{softmax}}\left(\beta_i f^s\left(h_{i j}^s, x^r\right)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.8159999999999998em;vertical-align:-0.966em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.3089999999999997em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mop"><span class="mord mathrm">s</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">t</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 是 link 重要性，实现在计算 segement 之间的重要性时，模型也能参考 link 重要性。</li></ul><p>Hierachy-Aware Attention Decoder 让整个模型自适应选择不同表示粒度中最相关的特征（可以是几个 link 权重大，还是几个）</p><h2 id="实验结论"><a class="markdownIt-Anchor" href="#实验结论"></a> 实验结论</h2><p>从北京的 mae 上来看比其他方法好 5s 以上，更进一步分析，里程比较长的单提升效果更明显。</p><p><img src="https://media.xiang578.com/202303122127226-hiereta-result.png" alt="" /></p><p>消融实验方法：有无 local 和 global 特征、有无路况信息、由于层次化结构等。mae 超过 1s 可以认为变化很大。</p><p><img src="https://media.xiang578.com/202303122130436-ablation-hiereta.png" alt="" /></p><h2 id="读后总结"><a class="markdownIt-Anchor" href="#读后总结"></a> 读后总结</h2><ul><li>层次化建模然后在利用 link 的 attention 对 segment 的 attention score 进行调整挺有意思的</li><li>遗憾没有线上实验结果，以及没有开放相关数据集，感觉 ETA 任务各家都有自己的数据集，然后不同方法之间没有太强横向可比性</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;滴滴和华南理工在 2022 年 KDD 上发表的 ETA 论文，从多个视角解释轨迹，引入 Hierarchical Self-Attention Network 方法进行建模，最终在滴滴内部数据集上获得指标提升。&lt;/p&gt;</summary>
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="Paper" scheme="https://blog.xiang578.com/tags/Paper/"/>
    
    <category term="eta" scheme="https://blog.xiang578.com/tags/eta/"/>
    
    <category term="didi" scheme="https://blog.xiang578.com/tags/didi/"/>
    
    <category term="self-attention" scheme="https://blog.xiang578.com/tags/self-attention/"/>
    
    <category term="KDD" scheme="https://blog.xiang578.com/tags/KDD/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】07 新年快乐</title>
    <link href="https://blog.xiang578.com/post/thinking-07.html"/>
    <id>https://blog.xiang578.com/post/thinking-07.html</id>
    <published>2023-02-13T14:30:00.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>距离上次分享已经快一个月了，这段时间我度过了长达两周的春节假期，现在是时候写点东西了！</p><span id="more"></span><blockquote><p>卷首语：决定自己人生的那些重要时刻，并没有风雨交加电闪雷鸣。上天从来不屑给于凡人征兆，这些时刻平凡普通，仿佛就和过去无数个日日夜夜一样无聊而烦闷。</p></blockquote><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><ul><li>本周读了一篇 Uber 关于 ETA 的论文，简单整理文章中主要内容写成博客：<a href="https://blog.xiang578.com/post/deepreta.html">DeeprETA: An ETA Post-processing System at Scale</a>。希望今年能养成读论文，写公开的笔记的习惯。</li><li>这个月在读一本效率类工具书 <a href="https://book.douban.com/subject/26854756/">最有生產力的一年 (豆瓣) (douban.com)</a>，作者用 1 年时间进行一系列的实验，记录和探讨什么方法可以提升自己的生产力。有一些方法其实自己之前也尝试过，比如每天做 3 件重要的事情、每天只使用 1 小时手机等，很可惜没有坚持下来。</li></ul><h2 id="影音"><a class="markdownIt-Anchor" href="#影音"></a> 影音</h2><ul><li>满江红：大量情节翻转，部分剧情存在逻辑硬伤。几乎是全部场景都在大院里面拍摄，所以根本没有去电影院看的必要。</li><li>流浪地球：诚意满满，大场面，满足幻想，部分中国独有的精神。由于先看的满江红，看这部片的时候还睡了一会儿，更有趣的是电影院里面还有人打呼噜了……</li><li>扬名立万：剧本杀形式电影，案中案，最后有开放结局的意思。</li><li>飞越13号房：互动影视游戏，看异灵术直播云的，改编自杨永信事件。剧情比较简单，和隐形的守护者相比没有太多反转和暗线。</li><li>三体电视剧：第一部《地球往事》的影视化，腾讯出品，十分忠于原著。部分场景和配乐非常震撼：比如三体游戏中<a href="https://www.bilibili.com/video/BV1Qx4y177qZ/">秦始皇出场的「天有鲲鹏，展翅苍穹。六合一扫，四海统」</a>。</li><li>狂飙：看完电视剧和同名小说，讲得是扫黑除恶的故事。高启强从买鱼佬成长为黑社会老大的过程非常刺激，最后为了过审等原因，强行改了很多剧情，感觉不是很过瘾。</li></ul><h2 id="新工具"><a class="markdownIt-Anchor" href="#新工具"></a> 新工具</h2><ul><li><a href="https://elk.zone/home">鹿鸣 (elk.zone)</a> 一个灵巧的 Mastodon web 客户端，模仿 twitter 样式。<ul><li>去年就接触到 mastodon，上个月 mask 一系列操作，大量推友开始考虑迁移到 mastodon 上。我的帐号 <a href="https://douchi.space/web/@xiang578">@xiang578@douchi.space</a></li><li>可以参考这篇文章 <a href="https://medium.com/@PeiLun/%E8%A8%AD%E5%AE%9A-ifttt-%E5%90%8C%E6%AD%A5-twitter-%E5%88%B0-mastodon-1010ee3798bb">設定 IFTTT 同步 Twitter 到 Mastodon. 事前準備 | by Pei-lun | Medium</a> 将推文同步到长毛象。</li></ul></li><li><a href="https://www.stayinsession.com/">Session - Pomodoro focus timer with analytics (stayinsession.com)</a> 番茄钟工具，5 美元一个月，不太值得。SetApp 中有提供。</li><li><a href="https://umami.is/">umami</a>：网站访问量统计工具，可以用 docker 部署，也能使用官方提供的 umami cloud 服务（目前免费中），和 Google Analytics 相比更加注重隐私。</li><li><a href="https://github.com/sethyuan/logseq-plugin-another-embed">sethyuan/logseq-plugin-another-embed: This plugin provides 2 extra ways to embed blocks/pages. (github.com)</a>： logseq 插件，实现类似于 roam 的 embed 展现 ui。</li><li><a href="Miniflux.net">Minflux</a>：开源的轻量级 RSS 工具，可以用 docker 部署，在线版本 15 天试用，15 美元一年。默认不抓取全文，也没有 Inoreader 那样的双栏模式。</li><li><a href="https://www.skywind.me/blog/archives/2229">别让 cd 浪费你的时间 - Skywind Inside</a> autojump 替代，实现终端内快速目录跳转，使用 lua 语言实现，所以能感觉到速度飞快！</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离上次分享已经快一个月了，这段时间我度过了长达两周的春节假期，现在是时候写点东西了！&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【Uber ETA】DeeprETA An ETA Post-processing System at Scale</title>
    <link href="https://blog.xiang578.com/post/deepreta.html"/>
    <id>https://blog.xiang578.com/post/deepreta.html</id>
    <published>2023-02-12T14:14:33.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>本篇文章充满工业界风格，介绍 Uber 如何构建基于深度学习的 ETA 系统。在 Uber App 中，ETA 主要服务网约车和外卖两大业务，基于业务发展产生出一些细分场景的 ETA 需求（pick-up、drop-off）。技术挑战在于偏航（系统预估路线和司机真实路线不同）、不同场景数据分布不同、不同场景对 ETA 诉求不同，所以他们主要目标是构建高效以及泛用的 ETA 系统。</p><span id="more"></span><h2 id="背景介绍"><a class="markdownIt-Anchor" href="#背景介绍"></a> 背景介绍</h2><blockquote><p>为了更充分了解相关背景知识，也可以看看我之前写的滴滴 ETA 论文解读 <a href="https://blog.xiang578.com/post/wdr.html">(WDR) Learning to Estimate the Travel Time)</a></p></blockquote><p>ETA (Estimated Time of Arrival，预估到达时间)：给定时刻下，预估从一个起点到终点所需要的时间。ATA (Actual Time Of Arrival，真实到达时间)：给定时刻下，真实从一个起点到终点花费的时间。ETA 任务的目标是最小化 ETA 和 ATA 的差距，一般用 MAPE 或 MAE 来衡量。</p><p><img src="https://media.xiang578.com/202302121823437-uber-eta-processing.png" alt="Uber ETA Posting-processing System" /></p><p>上图是 Uber ETA Posting-processing System，主要包括四部分：</p><ul><li><code>Maps &amp; Traffic</code>： Map 指将整个真实世界用图数据（点和边）来建模。在给定起点和终点的情况下，路径规划系统规划的路线可以用一系列边来表示。Traffic 指交通状态，路况团队会根据前一段时间收集到的 gps 信号，预计后面一段时间内真实世界中道路的拥堵程度和通行速度。</li><li><code>Routing Engine</code>：根据路径规划系统规划的路线以及路况发布的道路通行速度计算出一个规则 ETA（Routing Engine ETA, RE-ETA）</li><li><code>ML Model</code>：本文介绍的深度学习 DeeprETA 模型，该模型预估 RE-ETA 和 ATA 的残差。</li><li><code>Routing APIs</code>：通过 api 接口给其他业务提供 ETA 服务</li></ul><h2 id="deepreta"><a class="markdownIt-Anchor" href="#deepreta"></a> DeeprETA</h2><p>遵循 <code>More Embeddings, Fewer Layers</code> 原则，设计预测效率更高的模型，主要包括 embdding module  和 2-Layer Module 两个模块。</p><p><img src="https://media.xiang578.com/202302122107777-deepreta-architecture.png" alt="deepreta-architecture" /></p><h3 id="embedding-module"><a class="markdownIt-Anchor" href="#embedding-module"></a> Embedding module</h3><p>模型特征主要分成三类：Continuous Features、Categorical Features 以及 Geospatial Features，具体特征如下：</p><p><img src="https://media.xiang578.com/202302121908948-deepreta-feature.png" alt="Feature Tabble" /></p><h4 id="categorical-features"><a class="markdownIt-Anchor" href="#categorical-features"></a> Categorical Features</h4><p>所有类别特征都 embedding 化</p><h4 id="continuous-features"><a class="markdownIt-Anchor" href="#continuous-features"></a> Continuous Features</h4><p>数值特征先分桶离散化，然后转成 embeddine。作者他们尝试发现 quantile buckets（等频分桶，比如每 20% 样本分一个同） 比 equal-width buckets（等距分桶）效果更好，猜测其可能原因是等频分桶更有效保留信息（We suspect that quantile buckets perform well because they maximize entropy: for any fixed number of buckets, quantile buckets convey the most information (in bits) about the original feature value compared to any other bucketing scheme.）。</p><h4 id="geospatial-features"><a class="markdownIt-Anchor" href="#geospatial-features"></a> Geospatial Features</h4><p>Geospatial Features 主要指终点和起点的经纬度坐标，通过 geo hashing + multiple feature hashing 转换成 embdding。</p><p><img src="https://media.xiang578.com/202302122052993-multi-resolution-geohashes.png" alt="multi-resolution-geohashes" /></p><ul><li>通过 Geohash 将经纬度转换成固定长度的字符串<ul><li>将 <code>lat, lng</code> 转换成 <code>[0,1]</code> 范围内浮点数</li><li>放大上一步得到的浮点数到 <code>[0, 2e32]</code> 转换成 32 位整数</li><li>将 lat 和 lng 对应的两个 32 整数合并成一个 64 位整数</li><li>利用 base32 对 64 位整数进行编码得到一个长度为 <code>5u</code> bits 的字符串</li></ul></li><li>通过 Feature hasing 将字符串转换成 index<ul><li><code>Exact indexing</code> 每个字符串转成单独 embdding。geohash 精度越高，该方法内存消耗越大。</li><li><code>Multiple feature hashing</code> feature hashing 将多个字符串转换成一个 index。考虑到hash冲突以及格子内订单的热度，同一个字符串使用多个 hash 函数处理得到多个 index。</li></ul></li></ul><h3 id="2-layer-module"><a class="markdownIt-Anchor" href="#2-layer-module"></a> 2-layer Module</h3><p>2-layer Module 分别是 Interaction layer 和 Calibration layer。模型 ETA 可以表示成：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>r</mi><mo>^</mo></mover><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">j</mi></mrow></msub><mo>=</mo><msub><mover accent="true"><mi>f</mi><mo>^</mo></mover><mn>2</mn></msub><mrow><mo fence="true">(</mo><mover accent="true"><mi>f</mi><mo>^</mo></mover><mrow><mo fence="true">(</mo><msub><mi>X</mi><msub><mi>i</mi><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi></mrow></msub></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>+</mo><msub><mover accent="true"><mi>b</mi><mo>^</mo></mover><mi>j</mi></msub><mrow><mo fence="true">(</mo><msub><mi>X</mi><msub><mi>i</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi></mrow></msub></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{r}_{\mathrm{ij}}=\hat{f}_2\left(\hat{f}\left(X_{i_{\mathrm{emb}}}\right)\right)+\hat{b}_j\left(X_{i_{\mathrm{type}}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.317502em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">j</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.08332999999999999em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.08332999999999999em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.55em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">b</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3078899999999998em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166400000000005em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight" style="margin-right:0.01389em;">y</span><span class="mord mathrm mtight">p</span><span class="mord mathrm mtight">e</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>其中 f 代表 Interaction layer，f2 代表全连层，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 代表 Calibration layer （第 j 种类型 ETA 的偏置）。</p><h4 id="interaction-layer"><a class="markdownIt-Anchor" href="#interaction-layer"></a> Interaction layer</h4><p>所有特征在经过 Embedding module 后。都被转换成相同长度的 embdding，然后经过 Interaction layer 进行特征交叉。尝试过主流的网络结构后，作者选择的是 self-attention 结构，更进一步引入 Linear self-attention 解决 attention 矩阵计算速度慢的问题。</p><p><img src="https://media.xiang578.com/202302122114998-one-interaction-layer.png" alt="one-interaction-layer" /></p><h4 id="calibration-layer"><a class="markdownIt-Anchor" href="#calibration-layer"></a> Calibration layer</h4><p>针对不同业务数据分布特点，Calibration layer 根据ETA请求类型（网约车/配送、pickup/dropoff、长短单）使用全连接层对上一步模型结果进行校准（对预测结果进行整体偏移）。另外，作者也提到这一层也可以设计成 MMoE 结构。</p><p><img src="https://media.xiang578.com/202302122129047-uber-model-strucure.png" alt="uber-model-strucure" /></p><h3 id="asymmetric-huber-loss-function"><a class="markdownIt-Anchor" href="#asymmetric-huber-loss-function"></a> Asymmetric Huber loss function</h3><p>不同类型 ETA 任务需要用不同的指标来评估，比如预估价格需要 ETA mean erros，配送 ETA 利用类似于 95th 更加合理。所以作者设计出一种非对称的 Huber Loss Fucntion：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mrow><mo fence="true">(</mo><mi>ω</mi><mo separator="true">,</mo><mi>δ</mi><mo separator="true">,</mo><mi mathvariant="normal">Θ</mi><mo separator="true">;</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">q</mi><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>y</mi><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>ω</mi><mi mathvariant="script">L</mi><mrow><mo fence="true">(</mo><mi>δ</mi><mo separator="true">,</mo><mi mathvariant="normal">Θ</mi><mo separator="true">;</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">q</mi><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>y</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>y</mi><mo>&lt;</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>ω</mi><mo stretchy="false">)</mo><mi mathvariant="script">L</mi><mrow><mo fence="true">(</mo><mi>δ</mi><mo separator="true">,</mo><mi mathvariant="normal">Θ</mi><mo separator="true">;</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">q</mi><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>y</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>y</mi><mo>≥</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}\left(\omega, \delta, \Theta ;\left(\boldsymbol{q}, y_0\right), y\right)= \begin{cases}\omega \mathcal{L}\left(\delta, \Theta ;\left(\boldsymbol{q}, y_0\right), y\right), &amp; y&lt;\hat{y} \\ (1-\omega) \mathcal{L}\left(\delta, \Theta ;\left(\boldsymbol{q}, y_0\right), y\right), &amp; y \geq \hat{y}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Θ</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Θ</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Θ</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mrow><mo fence="true">(</mo><mi>δ</mi><mo separator="true">,</mo><mi mathvariant="normal">Θ</mi><mo separator="true">;</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold-italic">q</mi><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>y</mi><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>δ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>δ</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>δ</mi><mn>2</mn></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi><mo>≥</mo><mi>δ</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}\left(\delta, \Theta ;\left(\boldsymbol{q}, y_0\right), y\right)= \begin{cases}\frac{1}{2}(y-\hat{y})^2, &amp; |y-\hat{y}|&lt;\delta \\ \delta|y-\hat{y}|-\frac{1}{2} \delta^2, &amp; |y-\hat{y}| \geq \delta\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Θ</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi></mrow><annotation encoding="application/x-tex">\Theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Θ</span></span></span></span> 代表模型参数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\omega \in[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 控制模型对高低估倾向（比如准时赔场景，如果模型低估严重会带来大量投诉）, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 控制异常值的容忍程度，值越大对异常值越不敏感。</p><h3 id="train"><a class="markdownIt-Anchor" href="#train"></a> Train</h3><ul><li>每周训练模型</li><li>Adam</li><li>Relative cosine annealing learning rate scheduler</li></ul><h2 id="实验效果"><a class="markdownIt-Anchor" href="#实验效果"></a> 实验效果</h2><h3 id="评估指标"><a class="markdownIt-Anchor" href="#评估指标"></a> 评估指标</h3><p>主要有 mean absolute error (MAE), 50th percentile absolute error (p50 error) and 95th percentile absolute error (p95 error)。实验结果都是计算三个指标相对于 RE-ETA 的提升。比如 MAE 的计算方式改成：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">∣</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo fence="true">∣</mo></mrow><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">∣</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo fence="true">∣</mo></mrow></mrow><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">∣</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo fence="true">∣</mo></mrow></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{\frac{1}{n} \sum_{i=1}^n\left|y_i-\hat{y}_{0 i}\right|-\frac{1}{n} \sum_{i=1}^n\left|y_i-\hat{y}\right|}{\frac{1}{n} \sum_{i=1}^n\left|y_i-\hat{y}_{0 i}\right|} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.660216em;vertical-align:-1.080108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.580108em;"><span style="top:-2.2648919999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7350000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.080108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></p><h3 id="结果"><a class="markdownIt-Anchor" href="#结果"></a> 结果</h3><ul><li>DeeprETANet 比 XGBoost ResNet HammockNet 等方法都有明显的效果提升。</li><li>在 p95 指标上 DeeprETANet 和无 feature hashing DeeprETANet 提升相类似，可能说明 geospatial embeddings 能在 type case 上有提升，但是不能改善极端错误的情况。</li></ul><p><img src="https://media.xiang578.com/202302122153936-deepretaresult.png" alt="deepretaresult" /></p><h3 id="embedding-analysis"><a class="markdownIt-Anchor" href="#embedding-analysis"></a> Embedding Analysis</h3><p>这一部分作者用 t-SNE (将 embedding 降维到 2维）对 geospatial embeddings 和 temporal embedding 进行分析。</p><h4 id="temporal-embedding"><a class="markdownIt-Anchor" href="#temporal-embedding"></a> temporal embedding</h4><p>两幅图分别是配送和网约车的 embedding 分布，深色代表 weekend，浅色代表 weekday，从图上看有局部连续性，但是没有明确的周末或工作日效应（深色和浅色没有明显聚集）</p><p><img src="https://media.xiang578.com/202302122201409-t-sne-time-embedding.png" alt="time-embedding" /></p><h3 id="geospatial-embeddings"><a class="markdownIt-Anchor" href="#geospatial-embeddings"></a> geospatial embeddings</h3><p>geospatial embeddings 有局部聚集性，猜测是相邻的位置有相似的表示。配送和网约车学习到的 embedding 不同。</p><p><img src="https://media.xiang578.com/202302122207120-geospatial-embeddings.png" alt="geospatial embeddings" /></p><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><ul><li><a href="https://www.youtube.com/watch?v=CJTitzj0qBo">How Uber Predicts Arrival Times - Xinyu Hu and Olcay Cirit | Stanford MLSys #64 - YouTube</a></li><li><a href="https://www.uber.com/en-JP/blog/deepeta-how-uber-predicts-arrival-times/">DeepETA: How Uber Predicts Arrival Times Using Deep Learning | Uber Blog</a></li><li><a href="https://ithelp.ithome.com.tw/articles/10302600">Day 17 Uber 要如何估計司機和外送的抵達時間？（上）- Self attention 介紹</a>：简单讲了 self-attention 的计算过程</li><li><a href="https://ithelp.ithome.com.tw/articles/10303293">Day 18 Uber 要如何估計司機和外送的抵達時間？（下）- DeeprETANet</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;本篇文章充满工业界风格，介绍 Uber 如何构建基于深度学习的 ETA 系统。在 Uber App 中，ETA 主要服务网约车和外卖两大业务，基于业务发展产生出一些细分场景的 ETA 需求（pick-up、drop-off）。技术挑战在于偏航（系统预估路线和司机真实路线不同）、不同场景数据分布不同、不同场景对 ETA 诉求不同，所以他们主要目标是构建高效以及泛用的 ETA 系统。&lt;/p&gt;</summary>
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="uber" scheme="https://blog.xiang578.com/tags/uber/"/>
    
    <category term="eta" scheme="https://blog.xiang578.com/tags/eta/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】06 一元复始，重新出发</title>
    <link href="https://blog.xiang578.com/post/thinking-06.html"/>
    <id>https://blog.xiang578.com/post/thinking-06.html</id>
    <published>2023-01-08T08:48:00.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>距离上一次写随想集已经过去一年……趁现在是的一年开始，重新捡起这个习惯来写点东西。</p><span id="more"></span><h2 id="生活"><a class="markdownIt-Anchor" href="#生活"></a> 生活</h2><p>自从去年国内放开后，大家陆续感染了新冠。随着最近一段时间开始去公司上班，我也不可避免的中招：</p><ul><li>周四(0105)，喉咙开始痛。</li><li>周五(0106)，喉咙还是痛，体温也到 37.5 摄氏度，晃一下脑袋都能感觉到头晕，然后整天基本上都是躺在床上发呆或者睡觉，不过测抗原还没有事。</li><li>周六(0107)，喉咙痛好一些，开始咳嗽，吃了一些 999 强力琵琶露。</li><li>周日(0108)，测出抗原阳了，然后其他症状基本上消失。</li></ul><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><ul><li><a href="https://notes.xiang578.com/#/page/%40%E7%BF%A6%E5%95%86%EF%BC%9A%E6%AE%B7%E5%91%A8%E4%B9%8B%E5%8F%98%E4%B8%8E%E5%8D%8E%E5%A4%8F%E6%96%B0%E7%94%9F">翦商：殷周之变与华夏新生</a><ul><li>前一段时间挺火的历史小说，讲得是夏商周的历史。上古史的参考文献很少，作者亮点在于结合这几十年的考古成果（二里头、殷墟、周原等等）进行创造。翦商出自诗经「后稷之孙，实维太王，居岐之阳，实始翦商。」，意思是周灭商。为什么周要消灭商？商代遗址挖掘发现和甲骨文破译，商人生活中使用大量的人牲进行祭祀（比如房屋用人奠基，墓葬用人陪葬……），而且随着时间推移，祭祀规模越来越大，手段越来越残酷。作者推测周族可能长时间从事给商人捕捉祭祀用的人牲工作，随着周文王被拘和伯邑考被杀，周商矛盾激化，周武王开始伐商。周公旦在武王驾崩后，辅佐成王，创建礼乐制度。后世流传的文献没有直接记录商朝活人祭祀，可能是周公毁掉相关的档案，改写历史。</li></ul></li><li>读库 2105：垄断的困境<ul><li>评论尸去年写的长文，围绕互联网相关垄断进行讨论。首先，定义有效垄断（建立在可行的商业模式上）以及无效垄断（任何在短期和长期均无法赚钱的垄断，都应破视为商业上的无效垄断）。一言蔽之，企业垄断的目的是赚钱。<ul><li>无效垄断的例子正是我现在的东家：滴滴，占有网约车市场绝大部分份额却还一直在亏损，产生这种情况更多是竞争对手不想竞争，而不是不能与其竞争。</li><li>有效垄断的例子则是当年的淘宝屏蔽百度对商品详情页面的抓取，淘宝的推荐位一直是阿里重要的收入来源，其他公司也开始学着屏蔽百度爬虫，互联网变得更加割裂。</li></ul></li><li>产生大量无效垄断的根因是资本的无序扩张。</li><li>通过计算垄断的成本收益来衡量互联网企业的垄断是否合理。</li><li>最后作者还是举例了 多抓鱼，元气森林，shenin 等例子来讨论如何在巨头垄断的局面下进行创新。</li></ul></li></ul><h2 id="利器"><a class="markdownIt-Anchor" href="#利器"></a> 利器</h2><ul><li><a href="https://logseq.com/">Logseq</a> 去年 9 月份开始，觉得 Roam Research 更新速度太慢，又迁移到 Logseq。为了使用同步功能，也一直是  Backers 用户（ 5$ 每月）。</li><li><a href="https://readwise.io/i/ryen05">Readwise</a> 高亮管理服务，用来复习 kindle，微信读书，简悦等服务上的高亮。另外也开始用它家的 <a href="https://readwise.io/read">Readwise Reader</a> 阅读 epub 和 newsletter。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离上一次写随想集已经过去一年……趁现在是的一年开始，重新捡起这个习惯来写点东西。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
    <category term="logseq" scheme="https://blog.xiang578.com/tags/logseq/"/>
    
    <category term="covid-19" scheme="https://blog.xiang578.com/tags/covid-19/"/>
    
    <category term="readwise" scheme="https://blog.xiang578.com/tags/readwise/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】05 重新使用 Logseq</title>
    <link href="https://blog.xiang578.com/post/thinking-05.html"/>
    <id>https://blog.xiang578.com/post/thinking-05.html</id>
    <published>2022-01-09T11:00:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>新年快乐！不知不觉距离上次写博客过去 4 个多月，去年的年终总结还不知道如何动笔，先尝试写一篇简单的随想集热热身。</p><span id="more"></span><p>这两年新的笔记软件层出不穷，目前全部私人笔记使用 Roam Research 记录，但是 Roam 过去一年没有什么大更新，更别提移动端。另外为了搭建数字花园，使用 Obsidian 管理部分可以公开的笔记，再通过 MkDocs 生成 html 文件发布（谁让 Obsidian Publish 每月费用高达 8 刀）。</p><p>前几天听 <a href="https://twitter.com/tiensonqin">Tienson Qin</a> 采访 <a href="https://www.xiaoyuzhoufm.com/episode/61c6cccac525309a443b5b36?s=eyJ1IjogIjYxNmFlZTVhZTBmNWU3MjNiYjhjNzE4MCJ9">跟 Logseq 的创造者天生聊聊 Logseq 的故事 - ByteTalk | 小宇宙</a> 后，重新对 Logseq 产生兴趣（刚出的时候体验过，开源+弱化版Roam）。Logseq 支持直接导入 Roam json 文件，我大概有 2k+ 笔记，大小在 6 MB 左右。直接迁移过去有一些细节问题，以至于我发了 <a href="https://github.com/logseq/logseq/issues/3684">Issue #3684：导入 roam json 数据后部分 blockref 无法正确显示</a>，在开发者（不知道是不是）帮助下完美解决。不过体验几个小时后，总感觉 0.5.6 版本很卡，随便进行点击操作，需要 5s 以上才会有反馈……无奈只好放弃迁移。</p><p>这次体验过程中 logseq 插件 <a href="https://github.com/debanjandhar12/logseq-anki-sync">debanjandhar12/logseq-anki-sync: An Logseq to Anki Flashcards integration plugin.</a> 给我留下深刻的印象，只需点击插件 icon 就可以通过 Anki Connect 将笔记中的卡片同步到 Anki 中（单向更新）。使用 Roam 时，我都是将需要制卡的笔记统一整理到一个文档中，然后使用 <a href="https://github.com/shiqi-lu/roam2anki">shiqi-lu/roam2anki</a> 转换成csv 文件，最后手动导入 Anki。可见本地客户端想象空间更加强大！</p><p>Logseq 本身有 Publish 功能，可以配置将全部或有 <code>public:: true</code> 属性的笔记一起导出成单个 html 文件，然后借助静态网站托管工具发布。每次都进行这样的操作也挺麻烦的，幸好前几天看到有人发布 <a href="https://github.com/pengx17/logseq-publish">pengx17/logseq-publish: Logseq Publish Action</a> ，从而实现笔记数据推送到 github 后，自动编译 html 文件并发布。不过笔记数据存在 private repo 中，而我没有购买 <code>Github Pro</code> 服务（这回不是钱的问题，只是找不到理由说服我自己），所以无法直接使用 Github Pages 功能。退而求其次，借助 <a href="https://vercel.com/">Vercel</a> 发布导出的网页。如果你对我公开笔记感兴趣，可以访问：<a href="https://notes.xiang578.com/#/page/Contents">算法花园・笔记</a>。</p><p>这周也看了一些 Supermemo 相关的文章和视频，等再深入体验一下和大家分享。</p><p>最后，推荐一些这两周我看过觉得不错的文章：</p><ul><li><a href="https://zhuanlan.zhihu.com/p/453340208">【ML专栏】谈一种复用CART训练中丢弃信息的改进方案 - 知乎</a>：之前一位同事的文章，对 GBDT 分裂过程的小改进。</li><li><a href="https://blog.k8s.li/2021.html">时光痕迹：2021 年总结 | Reimu’s blog</a></li><li><a href="https://freemind.pluskid.org/misc/2021-summary/">2021 世界终结前一天</a>：pluskid 的年终总结，他已经坚持写了十多年。去年也进行过推荐</li><li><a href="https://wdxmzy.com/pastfuture/year2021/2021/12/31/">2021 总结与 2022 计划 | 小土刀 2.0</a></li><li><a href="https://github.com/saveweb/review-2021">saveweb/review-2021: 今年，你写年终总结了吗？</a>：年终总结大合集，一次看到爽！</li><li><a href="https://mp.weixin.qq.com/s?__biz=MzA4MjkwMDcyOQ==&amp;mid=2647743768&amp;idx=1&amp;sn=7e8bb4538413b1225e22dceb97ca4df0&amp;chksm=87db5e8eb0acd7987c00bd9177aa732e8c4c9ffb33829d5684fe45db8f7a300e90cd1203fb76&amp;mpshare=1&amp;scene=1&amp;srcid=1224Zq6Af0OpusK6GOSQjurt&amp;sharer_sharetime=1640357186656&amp;sharer_shareid=b9cd91a2d6fed9ed64a4a90526f5e1c6#rd">工程化你的习惯</a>：介绍三个习惯记录系统，自己会在今年尝试复刻 Ali Yahya 的 walrOS。</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;新年快乐！不知不觉距离上次写博客过去 4 个多月，去年的年终总结还不知道如何动笔，先尝试写一篇简单的随想集热热身。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
    <category term="logseq" scheme="https://blog.xiang578.com/tags/logseq/"/>
    
  </entry>
  
  <entry>
    <title>2021 迷茫</title>
    <link href="https://blog.xiang578.com/post/2021.html"/>
    <id>https://blog.xiang578.com/post/2021.html</id>
    <published>2022-01-01T15:41:22.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>迷迷糊糊中渡过一年，回头想想似乎什么都不记得。</p><span id="more"></span><p>贴一下去年的博客访问量做一个留念：</p><p><img src="https://media.xiang578.com/blog-analytics-2021.png" alt="2021 年博客访问统计" /></p><h2 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h2><p>2022 New Year Challenge 只有一个：和她走到一起。</p><p><img src="https://media.xiang578.com/Riseasska-fix.jpg" alt="" /></p><hr /><p><a href="https://xiang578.com/post/2017.html">2017 迷茫</a> &gt;&gt; <a href="https://xiang578.com/post/2018.html">2018 探索</a> &gt;&gt; <a href="https://xiang578.com/post/2019.html">2019 起步</a> &gt;&gt; <a href="https://xiang578.com/post/2020.html">2020 挑战</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;迷迷糊糊中渡过一年，回头想想似乎什么都不记得。&lt;/p&gt;</summary>
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="movie" scheme="https://blog.xiang578.com/tags/movie/"/>
    
    <category term="game" scheme="https://blog.xiang578.com/tags/game/"/>
    
    <category term="didiglobal" scheme="https://blog.xiang578.com/tags/didiglobal/"/>
    
  </entry>
  
  <entry>
    <title>lc552. 学生出勤记录 ii</title>
    <link href="https://blog.xiang578.com/problem/lc552.html"/>
    <id>https://blog.xiang578.com/problem/lc552.html</id>
    <published>2021-08-17T16:00:00.000Z</published>
    <updated>2024-05-12T11:02:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目链接：</p><span id="more"></span><h2 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h2><p>动态规划，定义 <code>dp[n][2][3]</code>，分别代表长度为 n，包含几个 A，末尾有几个 L 的方案数，转移的时候仔细点就可以。</p><h2 id="参考代码"><a class="markdownIt-Anchor" href="#参考代码"></a> 参考代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @lc app=leetcode.cn id=552 lang=cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * [552] 学生出勤记录 II</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @lc code=start</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">checkRecord</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> dp[<span class="number">123456</span>][<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">        <span class="type">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span> dp);</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">            <span class="comment">// no A</span></span><br><span class="line">            dp[i][<span class="number">0</span>][<span class="number">0</span>] = (dp[i][<span class="number">0</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">1</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">2</span>])%mod;</span><br><span class="line"></span><br><span class="line">            dp[i][<span class="number">0</span>][<span class="number">1</span>] = (dp[i][<span class="number">0</span>][<span class="number">1</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>])%mod;</span><br><span class="line"></span><br><span class="line">            dp[i][<span class="number">0</span>][<span class="number">2</span>] = (dp[i][<span class="number">0</span>][<span class="number">2</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">1</span>])%mod;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// A </span></span><br><span class="line">            dp[i][<span class="number">1</span>][<span class="number">0</span>] = (dp[i][<span class="number">1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">1</span>] + dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">2</span>]+ dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">1</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">2</span>])%mod;</span><br><span class="line"></span><br><span class="line">            dp[i][<span class="number">1</span>][<span class="number">1</span>] = (dp[i][<span class="number">1</span>][<span class="number">1</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>])%mod;</span><br><span class="line"></span><br><span class="line">            dp[i][<span class="number">1</span>][<span class="number">2</span>] = (dp[i][<span class="number">1</span>][<span class="number">2</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">1</span>])%mod;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++) &#123;</span><br><span class="line">                ans = (ans + dp[n][i][j]) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// @lc code=end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;题目链接：&lt;/p&gt;</summary>
    
    
    
    <category term="problem" scheme="https://blog.xiang578.com/categories/problem/"/>
    
    
    <category term="LeetCode" scheme="https://blog.xiang578.com/tags/LeetCode/"/>
    
    <category term="Dynamic Programming" scheme="https://blog.xiang578.com/tags/Dynamic-Programming/"/>
    
    <category term="Problems" scheme="https://blog.xiang578.com/tags/Problems/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】04 曾经我也想过一了百了</title>
    <link href="https://blog.xiang578.com/post/thinking-04.html"/>
    <id>https://blog.xiang578.com/post/thinking-04.html</id>
    <published>2021-08-14T11:00:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>开始前先推荐一首日文歌曲 <a href="https://www.bilibili.com/video/BV1oW411b7hx">中岛美嘉 - 曾经我也想过一了百了</a> 以及中文填词 <a href="https://www.bilibili.com/video/BV1uW41117yV">【小宁子】曾经我也想过一了百了》中文版 feat. 绝之望的马沙 （僕が死のうと思ったのは）</a>。第一个链接的视频里，中岛美嘉在接近于失聪的状态唱这一首歌。可以注意细节，有时候她的脚在跺地板找节奏。</p><span id="more"></span><p>差不多两个月时间没有写随想集，自己又折腾出一个网站 <a href="https://note.xiang578.com/">Hi - 算法花园・笔记</a>，用来分享一些不成熟的想法。</p><h2 id="图论-算法花园笔记"><a class="markdownIt-Anchor" href="#图论-算法花园笔记"></a> <a href="https://note.xiang578.com/CP/%E5%9B%BE%E8%AE%BA/">图论 - 算法花园・笔记</a></h2><p>实习的时候做过将CH中的搜索模块从双向 Dijikstra 改成双向 A*，很大一部分精力是在尝试启发函数。后来去面试时，有人给了一个启发函数，问为什么不行？<br />最近听专门做图论同事分享时，他提到一句所有图论新算法结果需要和dijkstra一致，可能这就是答案。</p><p>之前做题目时，喜欢的最短路算法是 SPFA 。前几天为了面试一个候选人，特地去 oi wiki 上回顾了一下其他最短路算法，spfa的优势在于使用队列模拟优先队列，一般出题人不特殊构造图，基本上会比 Dijikstra 快。可惜当时没有改一版试试。<br />说回来，工业界看起来只有几家公司有图论方面的需求，但也能让一些人做到极致。</p><h2 id="我眼中的技术深度"><a class="markdownIt-Anchor" href="#我眼中的技术深度"></a> <a href="https://mp.weixin.qq.com/s/fN1GcC1vwZqe-UtCGBO9gg">我眼中的技术深度</a></h2><p>前几天听陶文老师参与录制播客<a href="https://pythonhunter.org/episodes/taowen-vol1">Ep 29. 架构设计与 12fallacy（上） - 捕蛇者说</a>，想起他之前在内网写的文章。作为一名中台部门的算法工程师，其实面临的问题和业务部门的软件工程师挺类似的。</p><p><img src="https://media.xiang578.com/taowen-deep-of-tech.png" alt="" /></p><p>他将工程师的主要工作是定义成：构建一个可持续运行的 solution 去解决用户的一个 problem。深度来自：运营维护这个 solution 如何降低成本以及洞察到 problem 的 new solution。你的竞争力来自：</p><ul><li>为什么在这个点上，我做过的工作证明了比其他同事要更强。</li><li>为什么这个能力是当前公司需要的，也就是所谓的收益。</li></ul><h2 id="ise-grand-shrine"><a class="markdownIt-Anchor" href="#ise-grand-shrine"></a> Ise Grand Shrine</h2><p>很难想象核心模型的训练代码，是一个 10 多人修修补补，长达1 千行的 py 文件（驼峰命名、匈牙利命名、下划线命名混合，多行类似的代码以最后一行生效等）。忍受三年之后，感觉自己有能力去重构一把。特意将分支命名为 ise_gradn_shrine，致敬之前听到的伊势神社（每一代工人之间为传递知识，二十年原地重建一次神社）。并将下面这一段话放到 README 中。</p><blockquote><p>Japan’s Ise Grand Shrine is an extraordinary example in that genre. Every 20 years, caretakers completely tear down the shrine and build it anew. The wooden shrine has been rebuilt again and again for 1,200 years. Locals want to make sure that they don’t ever forget the production knowledge that goes into constructing the shrine. There’s a very clear sense that the older generation wants to teach the building techniques to the younger generation: “I will leave these duties to you next time.”</p></blockquote><h2 id="旧文重发2017-wf感想的校内版本-知乎-zhihucom"><a class="markdownIt-Anchor" href="#旧文重发2017-wf感想的校内版本-知乎-zhihucom"></a> <a href="https://zhuanlan.zhihu.com/p/203222250">「旧文重发」：2017 WF感想的校内版本 - 知乎 (zhihu.com)</a></h2><p>这两个月一直在强迫自己参加 LeetCode 的双周赛、周赛，现在的水平大概勉强能写出 3 题。赛后会去看一下其他人的题解，很多方法自己是绝对想不到的。机缘巧合看到戴老师的文章，自己之前也没有好好参加 rating 比赛，缺少一份面对真实的勇气。有时候点开 LeetCode 比赛在想，如果这场我一题都不会怎么办？可能唯一的选择是在电脑前坐满两个小时。最后文章里面提到要培养思维，还在上学时被人家评价「只会暴力」，这也是我欠缺的，所以现在打完比赛都会进行简单复盘，自己我感觉挺有收获的，极端方法应该是录屏分析。程序设计竞赛对于我意味着什么？可能山就在那里。</p><blockquote><p>个人实力保证队伍下限，队伍配合决定队伍的上限。<br />有趣的是，可能是受我之前的错误观念的影响，我们学校这么些年来真正高分 rating 选手确实是少之又少，很多 final 选手甚至不爱打线上比赛（例如 luyi 学长）。即使参加比赛，也总是喜欢开小号，开黑，而不是认认真真的一路做到底。开小号有个什么坏处呢？赢了是我吊，输了不丢人，这种心态就不是个正常打比赛的心态，等到了关键时候，不能开小号了，心理就可能承受不住压力崩溃。<br />所以做一道题，如果做不出来，看题解不丢人，但要仔细想想：为什么自己想不出来？解题的切入点应该怎么分析出来？以后遇到类似思路、类似条件的题目应该出哪里下手？要及早建立自己的规范的思维方式和体系，这样无论是在竞赛中，还是在以后的学习、工作中，都能发挥重要的作用。</p></blockquote><h2 id="电影心灵捕手-西恩关于真实感"><a class="markdownIt-Anchor" href="#电影心灵捕手-西恩关于真实感"></a> 电影《心灵捕手》 西恩关于真实感</h2><blockquote><p>你只是个孩子，你根本不晓得你在说什麽。   问你艺术，你可能会提出艺术书籍中的粗浅论调，有关米开朗基罗，你知道很多，他的满腔政治热情，他与教皇相交莫逆，和他的耽于性爱，你对他很清楚吧？但你知道西斯汀教堂的气味吗？你没试过站在那儿，昂首眺望天花板上的名画吧？你肯定未见过吧？</p></blockquote><h2 id="如何阅读"><a class="markdownIt-Anchor" href="#如何阅读"></a> 如何阅读？</h2><ul><li><a href="https://einverne.github.io/post/2021/05/is-reading-the-only-important-thing.html">读书是否是唯一重要的事？ | Verne in GitHub (einverne.github.io)</a>：读书与实践的关系。</li><li><a href="https://www.zhuoxi.me/2020/12/%E5%88%B0%E5%BA%95%E8%A6%81%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E8%AF%BB%E4%B9%A6%E5%91%A2-2021%E5%B9%B4%E8%AF%BB%E4%B9%A6%E8%AE%A1%E5%88%92-%E6%9C%80%E5%A4%9A%E5%8F%AA%E8%AF%BB50%E6%9C%AC/">到底要如何有效读书呢 - 2021年读书计划， 最多只读50本 (zhuoxi.me)</a></li></ul><h2 id="尾巴"><a class="markdownIt-Anchor" href="#尾巴"></a> 尾巴</h2><p>推特上冲浪时看到一个问题「数学是发明还是发现？」</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;开始前先推荐一首日文歌曲 &lt;a href=&quot;https://www.bilibili.com/video/BV1oW411b7hx&quot;&gt;中岛美嘉 - 曾经我也想过一了百了&lt;/a&gt; 以及中文填词 &lt;a href=&quot;https://www.bilibili.com/video/BV1uW41117yV&quot;&gt;【小宁子】曾经我也想过一了百了》中文版 feat. 绝之望的马沙 （僕が死のうと思ったのは）&lt;/a&gt;。第一个链接的视频里，中岛美嘉在接近于失聪的状态唱这一首歌。可以注意细节，有时候她的脚在跺地板找节奏。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】03 你当像鸟飞往你的山</title>
    <link href="https://blog.xiang578.com/post/thinking-03.html"/>
    <id>https://blog.xiang578.com/post/thinking-03.html</id>
    <published>2021-06-05T11:00:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>本期的标题取自《圣经》，当然大部分人可能更熟悉这个名字是 <a href="https://book.douban.com/subject/33440205/">Educated:A Memoir</a> 中文版的书名。这本书主要讲的是一个大山女孩克服各种困难成为一名博士的故事，虽然我还没有看过，但还是推荐大家去读一读……</p><span id="more"></span><h2 id="教育"><a class="markdownIt-Anchor" href="#教育"></a> 教育</h2><p>如果没有记错，明天又是一年一度高考的日子。一个神奇的现象，大部分人都觉得自己考差了。几年前我的想法是，高考前有无限的可能，高考后几乎没有什么选择。当然这些也只是我的牢骚，说回来，至少高考提供意义上的公平。借这个机会写一写教育。</p><h3 id="一群穷孩子的人生实验"><a class="markdownIt-Anchor" href="#一群穷孩子的人生实验"></a> <a href="https://mp.weixin.qq.com/s/9N_F6k2a2Tu-o76F3-Q0IQ">一群穷孩子的人生实验</a></h3><p>中国版罗森塔尔实验，十几年前，几个老师在北京务工人员的子女中挑选出一批差不多上小学的孩子组成青云班，参考类似八中少年班的方式，希望能培养成「品行高尚、具有国际视野、富有人文与创新精神的精英人才」。</p><p>不知道在户籍更加宽松的地方会不会有不一样的结果？</p><blockquote><p>第一届青云班最终的成绩就是这样了：有北京户口的孩子顺利地上了北大或出了国，剩下的一部分去了西澳大学，还有几位磕磕绊绊，最终在国内上了本科或专科，极少的人只读到高中或没了下落。</p></blockquote><p>优质教育是一个昂贵的商品。这个项目坚持十多年，最后的投入资金远超 5000 万。</p><blockquote><p>直到他们高中毕业后，孙文华与几位第一届青云班的同学吃饭，喝了一些酒，才讲出了平时他不该说的话。他说随着孩子们慢慢长大，他不再像最开始那样希望他们出人头地，对社会做很大贡献，他的要求在逐渐降低，希望他们首先是作为一个人，一个积极的人，然后还能过得幸福快乐，就足够了——项目逐渐往前走，他发现教育确实是一件吃力不讨好的事情，花钱、耗时间，而且也许并不会有一个让别人很满意的结果。</p></blockquote><p>罗森塔尔在 1966 年得出结论：教师对学生积极的态度，会让他们朝着正确的方向改进。很高兴，我在初三也体会过这种感觉。</p><blockquote><p>孩子们高中毕业时，刘正奎告诉了他们故事的另一个真相——当年选拔他们时的智商测试并不严格，是「矮子里拔高个儿」。青云班孩子们的智商大概在120左右，比普通人稍高，但与北京八中少儿班人均130的智商水平，还是有很大差距，「哪里有那么多超常的孩子？」但他接着说，让人欣慰的是，当被告知有天分时，孩子们就真的可以做到很不错的程度。而学生们听了这话，并不真正感到失望，而是开起了玩笑：「校长你忽悠我们！」<br />实际上，他们早已在漫长过程里修正了对自我的认识。他们确实度过过一个「被选中」的阶段，觉得可以通过努力，成为伟大的、和别人都不一样的人。但后来慢慢发现，大家本来都是不一样的，伟大和成功也没有确切标准，而且——外部环境对一个人的影响太大了。</p></blockquote><p>这是其中一个孩子对这个项目的评价。我也挺喜欢这种人生突然被某样东西改变的故事。</p><blockquote><p>从外界看，这可能是一个非常失败的投资，是一个不太成功的教育案例。但我觉得它是成功的，它教会了我们，如何做一个向上的人、一个正直的人。</p></blockquote><h3 id="inspire-a-generation"><a class="markdownIt-Anchor" href="#inspire-a-generation"></a> Inspire a generation</h3><p>这个是 2012 年伦敦奥运会的口号，中文是「激励一代人」。之前读过一篇文章 <a href="https://cf020031308.github.io/blog/why-i-quit-my-job-for-furthur-study">为何我要辞职读研 | cf020031308.github.io</a>，其中写到两段：</p><blockquote><p>写这文章时，女儿一岁半，预计她小学时会参加我的毕业礼。我希望用包括这几年在内的自己的行动，教会她终生学习、终生奋斗的道理。我很遗憾相比我继续工作，她这些年能获得的教育资源一定更差，但我仍认为将这股精神给到她会是更加宝贵的。<br />前面提到我生自县城，也提到我曾经的没志气、没见识、没规划，很遗憾这可能是大多数小城青年的通病。三十岁了还去读书，虽然只是为了自己与自己的小家，但终究会在家族中树立起一个标杆，拓宽后辈的眼界，动摇长辈的成见，多多少少算是对我们既定命运的一点反抗吧。</p></blockquote><p>对于大部分人来说，教育是一个人的事情，而是几代人的希望。我可能无法激励其他人，但是能给家族里面年轻一代一些关于求学路上的思考。不过从目前来看，每次回家看见几个表弟在疯狂打「王者荣耀」之类的游戏，我都无动于衷。还是希望有一天，能像 <a href="http://xiaohanyu.me/posts/2017-02-13-about-education/">教育对人的改变有多大？</a> 这个故事中主人公那样帮助弟弟考上大学吧。</p><p>最后，其实有空也可以观察身边的同事。</p><blockquote><p>就拿互联网公司来说，外部看到的一些粉丝很多的人顶多是中层级别的，然后这些人离顶端的扎克伯克，马云之间有着大量的资深总监，vp之类的人物，他们不算出名，但是却有着极高的身价，大量时间投入在解决实在问题，这些人的经验基本上只会在熟人圈子里传播，亲戚的孩子之类的。</p></blockquote><h2 id="平行世界"><a class="markdownIt-Anchor" href="#平行世界"></a> 平行世界</h2><p>小径分岔的花园，间谍小说，剧情很巧妙。我们生活的世界就像小径分岔的花园，每到一个岔入口，你走上不同的路，就失去走进其他未来的可能。</p><p>彗星来的那一夜，低成本科幻片。如果多个平行世界之间相互干涉，似乎找不到完美解，不可避免落入黑森林法则？</p><p>笛卡尔的哲学中有一句，我们的世界是众多可能的世界之中最好的一个。</p><h2 id="职场人如何系统做好知识管理"><a class="markdownIt-Anchor" href="#职场人如何系统做好知识管理"></a> <a href="https://youcangogogo.com/live_pc/l_60b49afce4b0017651a08b91">职场人如何系统做好知识管理</a></h2><p>少楠老师前一段时间线上分享，大部分理念都在之前提到过。这个讲座是一个很好的实例，产品总监关于「知识管理」应该有怎么样的认知？</p><ul><li>知识管理的定义：知识是⽤于⽣产的信息（有意义的信息）。管理就是制定决策。知识管理是获取、分配和有效利⽤知识的过程。</li><li>知识管理四个过程：<ul><li>获取：明确自己的母题（关注什么领域），形成知识的复利。<ul><li>这一点自己其实做的挺差的。之前有人和我说，感觉你什么都懂。可能后面半句「但是什么东西都只懂一些」顾及我的面子没有明说。</li></ul></li><li>记录：保持一定的输入难度。也推崇 Zettelkasten 的理念，每天练习写原子化的卡片。</li><li>整理：不进行传统意义上的分类，让知识进行生长。然后建立索引（Zettelkasten 中的大纲笔记）让知识结构涌现出来。</li><li>输出：输出是做出正确的决策。输出不是为了关注，而是为了得到反馈。</li></ul></li><li>需要通过自己的尝试形成一套知识管理的系统。</li></ul><p>最后少楠老师答疑时，抛出一个问题：离开一家公司你带走的是什么？</p><h2 id="重铸荣光"><a class="markdownIt-Anchor" href="#重铸荣光"></a> 重铸荣光</h2><p>前一段时间 MSI 比赛，LCK DWG 中单选手 showmaker 在 S10 宣传视频中说的文案反复在论坛上被引用：</p><blockquote><p>那一年的决赛，是SSG对阵SKT，最终比分3-0。当时我看见FAKER颓坐在椅子上泣不成声，这个画面我永生难忘。<br />那一刻我在想，如果我能成为一名职业选手，我一定要赢下所有。如今奖杯就在眼前，我必须考虑这会不会是我此生仅有的机会。<br />我相信LCK能有过去的霸主地位，FAKER功不可没。重铸LCK的荣光，我辈义不容辞!</p></blockquote><h2 id="尾巴"><a class="markdownIt-Anchor" href="#尾巴"></a> 尾巴</h2><p>我在内部 IM 给一位离职同事发的最后一条消息也是 「你当像鸟飞往你的山」。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;本期的标题取自《圣经》，当然大部分人可能更熟悉这个名字是 &lt;a href=&quot;https://book.douban.com/subject/33440205/&quot;&gt;Educated:A Memoir&lt;/a&gt; 中文版的书名。这本书主要讲的是一个大山女孩克服各种困难成为一名博士的故事，虽然我还没有看过，但还是推荐大家去读一读……&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】02 我曾刻意远离人群</title>
    <link href="https://blog.xiang578.com/post/Thinking-02.html"/>
    <id>https://blog.xiang578.com/post/Thinking-02.html</id>
    <published>2021-05-31T11:00:11.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>开始之前推荐一首歌 <a href="https://music.163.com/#/song?id=16139381">3055 - Ólafur Arnalds</a>。</p><span id="more"></span><h2 id="1-我曾刻意远离人群"><a class="markdownIt-Anchor" href="#1-我曾刻意远离人群"></a> 1. 我曾刻意远离人群</h2><p>五一前，遭受打击，开始陷入自我怀疑中。想起吴岭南在「无闻西东」中的一段台词：</p><blockquote><p>当我在你们这个年纪，有段时间，我远离人群，独自思索，我的人生到底应该怎样度过？某日，我偶然去图书馆，听到泰戈尔的演讲，而陪同在泰戈尔身边的人，是当时最卓越的一群人，这些人站在那里，自信而笃定，那种从容让我十分羡慕。而泰戈尔，正在讲“对自己的真实”有多么重要，那一刻，我从思索生命意义的羞耻感中，释放出来。原来这些卓越的人物，也认为花时间思考这些，谈论这些，是重要的。今天，我把泰戈尔的诗介绍给你们，希望你们在今后的岁月里，不要放弃对生命的思索，对自己的真实。</p></blockquote><h3 id="请给我五月"><a class="markdownIt-Anchor" href="#请给我五月"></a> <a href="https://mp.weixin.qq.com/s/lB2whRNySiZrBLWHIEpkUA">请给我五月</a> 以及 <a href="https://mp.weixin.qq.com/s?__biz=MzIyNzA5ODg5NA==&amp;mid=2647828222&amp;idx=1&amp;sn=97a2bb46a3416ff2dadc13c3a4978f01&amp;chksm=f0406e9fc737e7892dd99b511d4ace483703ad322b7baa46e2be8327de9b6b35a755ea37b969&amp;scene=21#wechat_redirect">逃离韩料店</a></h3><p>Hayami，拼多多 PM（写出这个多少怀疑自己是时间太多从而导致什么都不想干），一直觉得她的文字很温暖。这两篇文章分别是她在 23 岁以及 24 岁生日所写，有时候读其他人的记录相当于给自己照镜子。5 月我也很长时间怀疑人生没有意义，甚至读到哲学史中的「所有形而上学的问题都没有答案」时还有一些激动。后来渐渐明白，自己更大的问题是不知道如何做到自己认为的人生意义。阅读不是解决孤独的方法，创造才是，所以才鼓起勇气重新写下这篇随想集。</p><p>用创作来「抵抗」惯性、「抵抗」生活日复一日的琐屑：</p><ul><li>当你觉得什么事情都提不起兴趣的时候，不要让惯性吞没了自己，去做点什么吧，至少做点什么事情。</li><li>洛克菲勒的信中说，克服绝望的方式只有一种，那就是持续（用自己的行动和努力）创造出各种可能性以跨越障碍。</li><li>如果想去建立自己的社会关系，想去结识丰满有趣的人类，最有效的方法就是成为他们想要认识的人。而成为他们想要认识的人，就是要去创作。</li><li>豆瓣上有个很热门的广播提问—「大家生活的支点究竟是什么呢？（换句话说，究竟是因为什么东西所以愿意承受和忍耐生活中无穷无尽的困难和苦难呢？）」<ul><li>排名分先后：想象力，创作，爱。简言之，是自己信仰的价值体系，包括超越性的审美和智性的情感。</li></ul></li></ul><h2 id="2-我到了参加葬礼的年纪"><a class="markdownIt-Anchor" href="#2-我到了参加葬礼的年纪"></a> 2. 我到了参加葬礼的年纪</h2><p>外公在 4 月 30 日选择离开我们，对他的印象永远停留今年春节。5 月 10 日葬礼前，一直在家里休假，特地去看一些和死亡相关的内容。</p><h3 id="寻梦环游记"><a class="markdownIt-Anchor" href="#寻梦环游记"></a> 寻梦环游记</h3><p>人的一生，要死去三次：</p><ul><li>第一次，当你的心跳停止，呼吸消逝，你在生物学上被宣告了死亡；</li><li>第二次，当你下葬，人们穿着黑衣出席你的葬礼，他们宣告，你在这个社会上不复存在，你悄然离去；</li><li>第三次，是这个世界上最后一个记得你的人，把你忘记，于是，你就真正的死去，整个宇宙都不再和你有关。</li></ul><h3 id="人生总有一刻我们会开始思考死亡-知乎"><a class="markdownIt-Anchor" href="#人生总有一刻我们会开始思考死亡-知乎"></a> <a href="https://zhuanlan.zhihu.com/p/24640592">人生总有一刻，我们会开始思考死亡 - 知乎</a></h3><p>于是我发现，面对死亡最终可能只有两种方法：</p><ul><li>一种是将自己与一些更宏大的东西联系起来：一个数学定理、一本文学著作、一件艺术作品或一种恒久的信仰。马尔克斯与康德靠《百年孤独》与《[[纯粹理性批判]]》遗世独立，米开朗基罗把《创世纪》和《最后的审判》印刻在西斯廷大教堂里，供千万后朝拜——他们肉身虽灭，但精神不朽——反正建筑是永远戳在那儿的。</li><li>还有一种就是，生活在当下的每个瞬间里，不烦扰过去、不担忧将来。</li></ul><h3 id="lambda-reading-这里蕴涵着世界和灵魂的救赎以及关于死亡的读书笔记"><a class="markdownIt-Anchor" href="#lambda-reading-这里蕴涵着世界和灵魂的救赎以及关于死亡的读书笔记"></a> <a href="https://rizi.me/#2019%E5%B9%B410%E6%9C%8830%E6%97%A5%E5%91%A8%E4%B8%89%E4%B8%8B%E5%8D%8804%3A02%3A39:%E3%8B%A1%20%E7%AD%89%E5%BE%85%E4%BB%96%E7%9A%84%E6%AD%BB%E4%BA%A1%202019%E5%B9%B410%E6%9C%8830%E6%97%A5%E5%91%A8%E4%B8%89%E4%B8%8B%E5%8D%8804%3A02%3A39">Lambda-Reading 这里蕴涵着世界和灵魂的救赎以及关于死亡的读书笔记</a></h3><p>临终者的五大遗憾、《天堂的证据》、《陪伴生命》（我从临终病人眼中看到的幸福）、《与神对话》、《耶鲁大学公开课：死亡》、《死亡如此多情》（百位临床医生口述的临终事件）、《向死而生》</p><h3 id="people-die-but-long-live-github-laike9ms-blog"><a class="markdownIt-Anchor" href="#people-die-but-long-live-github-laike9ms-blog"></a> <a href="https://laike9m.com/blog/people-die-but-long-live-github,122/">People Die, but Long Live GitHub - laike9m’s blog</a></h3><blockquote><p>目前来看，我认为 GitHub 是在百年尺度上存储信息并让其能被访问的<strong>唯一</strong>途径。</p></blockquote><p><a href="https://joearms.github.io/#2013-11-21%20My%20favorite%20Erlang%20Program">Joe’s Blog — a non-linear personal web notebook</a> 临终前把博客文章用 TiddlyWiki 保存在 Github，并且写到「I hope the blog will be readable in 100+ years time.」也许 Github 是我们这个时代的数字公墓（不老阁）。</p><h3 id="城堡-17很高兴遇见你-语雀-yuquecom"><a class="markdownIt-Anchor" href="#城堡-17很高兴遇见你-语雀-yuquecom"></a> <a href="https://www.yuque.com/gaohui-bdaa2/chengbao/lug9lw">城堡 17：很高兴遇见你…… · 语雀 (yuque.com)</a></h3><p>我和解的方式是，也曾经让外公在某些时刻高兴过。</p><h3 id="迪拜孝子-郭麒麟-阎鹤祥_哔哩哔哩_bilibili"><a class="markdownIt-Anchor" href="#迪拜孝子-郭麒麟-阎鹤祥_哔哩哔哩_bilibili"></a> <a href="https://www.bilibili.com/video/BV1XX4y1V7bG">【迪拜孝子】 郭麒麟 阎鹤祥_哔哩哔哩_bilibili</a></h3><p>郭麒麟在《欢乐戏剧人》一个相声的链接，这个节目改编自传统相声《福寿全》。大概情节是，一个人用钱忽悠另外一个人穿麻带孝，给号称死去的老富翁当孝子。现在想起来，这是我第一次关于葬礼的练习。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;开始之前推荐一首歌 &lt;a href=&quot;https://music.163.com/#/song?id=16139381&quot;&gt;3055 - Ólafur Arnalds&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【随想集】01 我讲不清楚事情怎么办？</title>
    <link href="https://blog.xiang578.com/post/Thinking-01.html"/>
    <id>https://blog.xiang578.com/post/Thinking-01.html</id>
    <published>2021-03-14T11:00:11.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>重新定期写一些阅读分享，暂时命名为「随想集」。</p><span id="more"></span><h2 id="我讲不清楚事情怎么办-语雀"><a class="markdownIt-Anchor" href="#我讲不清楚事情怎么办-语雀"></a> <a href="https://www.yuque.com/lyndon/daylesson/tyxoqs">我讲不清楚事情，怎么办？ · 语雀</a></h2><p>这是一篇关于职场沟通的文章，如何把事情说清楚是一项很重要的技能。作者给了三点建议：</p><ul><li><strong>说人话，要用比喻的方式，把复杂的概念讲清楚。</strong></li><li><strong>定调子，我讲的第一句话，一定很重要，如果能用通俗的概念开场，才会有兴趣听下去。</strong></li><li><strong>看反馈，不要只顾着讲，或者担心有留白会尴尬，所以一直拼命讲。</strong></li></ul><p>结合自己的经历，讲事情的时候还要考虑听众的背景，对其他 RD 说的就不能和 PM 一样。最后，高情商可以时不时问一下：我说清楚了吗？低情商可以问：你听明白了吗？</p><h2 id="请不要神化双链笔记-少数派"><a class="markdownIt-Anchor" href="#请不要神化双链笔记-少数派"></a> <a href="https://sspai.com/post/65273">请不要神化双链笔记 - 少数派</a></h2><p>Zettelkasten、双链这些概念差不多火了一年多的时间，作者对目前的现象进行思考和批评。</p><p>首先分析大部分介绍双链笔记文章的逻辑：</p><ol><li>卢曼自下而上地生成卡片</li><li>卢曼重视在笔记之间建立联系</li><li>现在的双向链接就是卢曼卡片盒笔记法的软件实现</li><li>得益于卡片盒笔记法，卢曼从公务员成为德国当代重要的社会学家，因此这种扁平化的组织形式是十分有效的。</li></ol><p>看起来是很完备的逻辑论证扁平化的双链笔记如何有用的过程，但是却忽视了最基础的类比可能并不成立的前提。作者提出的观点是：Zettelkasten 这样的信息组织形式是为了消除笔记内容和搜索的不确定性而努力。你需要先积累一定程度的笔记到，然后再去设计更细粒度的、结构化的笔记结构。最终才能明确笔记原则，理清自身期许 。</p><h2 id="为什么有些人总被人评价逻辑性很强而有些人被评价逻辑弱鸡-即刻app"><a class="markdownIt-Anchor" href="#为什么有些人总被人评价逻辑性很强而有些人被评价逻辑弱鸡-即刻app"></a> <a href="https://m.okjike.com/originalPosts/604289315b8fd40011e1fbee">为什么有些人总被人评价逻辑性很强？而有些人被评价逻辑弱鸡？ - 即刻App</a></h2><p>作者将分成三个层次来说：没逻辑，有体系以及逻辑链。由于认知能力有限，没太明白后面两部分的关系。<br />没逻辑这个部分，作者给出的例子很形象：有些人的思考路径是，嗯，我觉得1很重要，2也很重要，对，还有3和4，我想想，对，还有5，嗯5比2重要一点。更糟的是，过两个小时，你再问他这个问题，他会回答235，丢掉了14，可能又多了一个67。所以如何才能避免？</p><h2 id="在做算法工程师的道路上你掌握了什么概念或技术使你感觉自我提升突飞猛进-知乎"><a class="markdownIt-Anchor" href="#在做算法工程师的道路上你掌握了什么概念或技术使你感觉自我提升突飞猛进-知乎"></a> <a href="https://www.zhihu.com/question/436874654/answer/1746629056">在做算法工程师的道路上，你掌握了什么概念或技术使你感觉自我提升突飞猛进？ - 知乎</a> 以及  <a href="https://www.zhihu.com/question/446374101/answer/1756122452">工作之后，顶会还重要吗？ - 知乎</a></h2><p>算法是一个残酷的竞技场。比起软件工程师，淘汰更加残酷，被击败，主动离队。</p><p>顶会论文是跨越公司、跨越国家、跨越年龄的硬通货。</p><p>（希望年前写的论文能中 KDD）<br />（20210609: 被 Reject，等 AAAI）</p><h2 id="换脑游戏试播集"><a class="markdownIt-Anchor" href="#换脑游戏试播集"></a> <a href="https://www.acfun.cn/v/ac25767536">《换脑游戏》试播集：）</a></h2><p>我当时的评论：很喜欢这一期播客。整体听完，对小约翰老师的印象变成了「吾道不孤」，好像知识星球都不能加入了……主播提的那么多问题，引发自己思考的是你有哪一种焦虑？john 的善于利用自己的焦虑提供了一种新的思路。最后，john 提到英语老师讲题目的就只有一个人举手的场景，我也遇到过，可能当时真的想知道问题答案驱动我去举手吧。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;重新定期写一些阅读分享，暂时命名为「随想集」。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【读书记 258】柏拉图 《会饮篇》</title>
    <link href="https://blog.xiang578.com/post/symposium.html"/>
    <id>https://blog.xiang578.com/post/symposium.html</id>
    <published>2021-01-10T12:35:29.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>《会饮篇》记录阿伽通获得酒神节悲剧比赛第一名后，苏格拉底等人在庆祝宴会中「赞美爱神」的比赛过程。实际上记录与会人七种不同的爱情观。最后，酒神狄奥尼索斯决定出当晚的获胜者。</p><span id="more"></span><h2 id="裴卓勇气之爱"><a class="markdownIt-Anchor" href="#裴卓勇气之爱"></a> 裴卓：勇气之爱</h2><p>讲述者被人们视为弱小的被爱之人，美少年裴卓 Phaedrus，爱可以给我们勇气！</p><ul><li>为人们要想过美好正当的生活，必须终生遵循一个指导原则，这并不能完全依靠血统，也不能靠威望、财富，只有靠爱才能办到。这原则是什么呢？就是：厌恶丑恶的，爱慕美好的。</li><li>如果一个情人在准备做一件丢人的坏事，或者在受人凌辱而怯懦不敢抵抗，这时他被人看见了就会觉得羞耻，但是被父亲、朋友或其他人看见还远远不如被爱人看见那样羞到无地自容。爱人被情人发现他做坏事，情形也是如此。</li><li>阿喀琉斯为情人复仇。母亲叮嘱他，杀死仇人赫格多尔之后自己也会死。最后还是奋不顾身杀死仇人，自己被射中脚踵而死。</li><li>“最爱的人心中对我们的期望。「目标的意义」”</li></ul><h2 id="包萨尼亚精神之爱"><a class="markdownIt-Anchor" href="#包萨尼亚精神之爱"></a> 包萨尼亚：精神之爱</h2><p>讲述者是一个成年的同性恋，阿伽通的情人包萨尼亚 Pausanias，被人们视为追求肉欲的人。爱神爱有天地之分，天之爱是精神之爱，是崇高的爱，只有男男之间才有，是美好的追求；地之爱是肉体之爱，是普遍的低级的爱，也就是大多数人的爱，只有肉欲的爱。</p><ul><li>凡间阿莆若狄德引起的爱神确实也是凡俗的，它不分皂白地奔赴它的目的。这种爱情只限于下等人。它的对象可以是娈童，也可以是女子；它所眷恋的是肉体而不是灵魂；最后，它只选择愚蠢的对象，因为它只贪图达到目的，不管达到目的的方式美丑。</li><li>至于天上的那位的出身却与女的无关，只是由男子生的，所以其爱情对象只是少年男子。其次，她的年纪较大，所以不至于荒淫放荡。她只鼓舞人们把爱情专注在男性对象上，因为这种对象生来就比较坚强，比较聪明。</li><li>他们说，与其暗爱，不如明爱，所爱的人应当在门第和品德上都很高尚，美还在其次。人们对情人都给予极大的鼓励，不认为他在做不体面的事；人们把追求爱情的胜利看成光荣，把这方面的失败看成羞耻。为了争取胜利，他可以做出种种离奇的事。</li><li>这种少年男子一定要显现理性，也就是腮帮上长胡须的时候，才能成为爱的对象。我想情人之所以要等爱人达到这种年龄之后才钟爱他，是由于存心要和他终生相守，不是要利用他的年幼无知来哄骗他，碰到另外一个可以宠爱的对象时就把他扔掉。<ul><li>当时社会能接受：年长男性(智慧，情人)和少年男孩(12-17，肉体，爱人)之间的恋爱关系。包萨尼亚和阿伽通年纪都大了。</li></ul></li><li>我认为道理是这样：这件事并不是十分单纯的，像我开头说的那样。单就它本身来看，它无所谓美，也无所谓丑；做的方式美它就美，做的方式丑它就丑。丑的方式就是拿卑鄙的方式来对付卑鄙的对象，美的方式就是拿高尚的方式来对付高尚的对象。所谓卑鄙的对象就是上面说的凡俗的情人，爱肉体过于爱灵魂的。他所爱的东西不是始终不变的，所以他的爱情也不能始终不变。一旦肉体的颜色衰败了，他就远走高飞，毁弃从前的一切信誓。然而钟爱优美品德的情人却不然，他的爱情是始终不变的，因为他所爱的东西也是始终不变的。</li><li>我们的习俗定了两条规矩，头一条是：迅速接受情人是可耻的，应该经过一段时间，因为时间对于许多事物常常是最好的考验；第二条是：受金钱引诱或政治威胁而委身于人是可耻的，无论是不敢抵抗威胁而投降，还是贪图财产和地位，全都一样。因为这些势力、名位和金钱都不是持久不变的，高尚的友谊当然不能由此产生。</li><li>按照我们这里的规矩，如果一个人肯侍候另外一个人，目的在于得到那个人的帮助在爱智或其他品德上更进一步，这种卑躬屈节并不卑鄙，也不能指为谄媚。<ul><li>这里有两条规矩，一条是关于少年男子的爱情，一条是关于学问道德的追求，应该合而为一；如果合而为一，爱人眷恋情人就是一件美事。所以，情人和爱人来往，就各有各的指导原则。情人的原则是爱人对自己既然表现殷勤，自己就应该在一切方面为他效劳；爱人的原则是情人既然使自己在学问道德方面有长进，自己就应该尽量拿恩情来报答。一方面乐于拿学问道德来施教，一方面乐于在这些方面受益，只有在这两条原则合而为一时，爱人眷恋情人才是一件美事，如若不然，它就不美。如果是为了增进学问道德，纵然完全失败也没有什么可耻；如果是为了其他的目的，不管失败与否都是可耻的。假如一个少年男子以为他的情人很富，为了贪财就去眷恋他，后来发现自己看错了，其实他很穷，无利可图。其眷恋还是很可耻的，因为这种行为揭穿了他的性格，证明他这个人为了金钱可以侍候任何人、做出任何事来，这当然是很不光彩的。</li></ul></li><li>我们谈爱情的时候，事实上，我们讨论的正是真实的自己。</li></ul><h2 id="鄂吕克锡马柯功利之爱"><a class="markdownIt-Anchor" href="#鄂吕克锡马柯功利之爱"></a> 鄂吕克锡马柯：功利之爱</h2><p>讲述者是医生鄂吕克锡马柯，理性大于感性，是技术主义的代表。爱情是和谐的，是有规律的，是有用的，我们可以通过其中的规律得到爱情，也可以通过爱情得到别的有用的东西。</p><ul><li>爱情克制论</li></ul><h2 id="阿里斯多芬缺憾之爱"><a class="markdownIt-Anchor" href="#阿里斯多芬缺憾之爱"></a> 阿里斯多芬：缺憾之爱</h2><p>讲述者是喜剧家阿里斯多芬，而喜剧总是悲剧的内核。最初有三种人，男男人、女女人和男女人，像球一样。因为得罪宙斯，人被劈成两半，天生就该追求自己的另一半。不论肉体还是精神，我们都应该追求自己的另一半，以此互补，否则我们孤独，有缺点，不完美。</p><ul><li>所以我们每人都是人的一半，是一种合起来才成为全体的东西。所以每个人都经常在寻求自己的另一半。全人类只有一条幸福之路，就是实现自己的爱，找到恰好和自己配合的爱人，总之，还原到自己的本来面目。</li><li>对爱情最浪漫的解释。</li></ul><h2 id="阿伽通完美之爱"><a class="markdownIt-Anchor" href="#阿伽通完美之爱"></a> 阿伽通：完美之爱</h2><p>讲述者是悲剧诗人阿伽通，是十分优秀的人。我们要追求完美，爱神就是完美的，爱情也是完美的，所以我们要追求爱，而且爱是有益于他人的，是可以从满溢之处流向匮乏之处的(对应开头评价苏格拉底的智慧)，可以让大家一起变的完美。</p><ul><li>前面的人赞美爱神，其实都是在赞美其索给予的幸福，而不是真正地赞美爱神本身。</li></ul><h2 id="苏格拉底朝圣之爱"><a class="markdownIt-Anchor" href="#苏格拉底朝圣之爱"></a> 苏格拉底：朝圣之爱</h2><p>讲述者是苏格拉底，从狄欧蒂玛口中听到的爱。爱神不是完美的，介于不死的神和会死的人之间的精灵，介于美和丑之间，介于无知和有知之间。追求爱不是为了爱本身，是为了爱延伸的东西，是在追求爱情过程中得到的美好、是追求到以后收获的智慧和快乐，美好和永恒。</p><ul><li>和阿伽通的对话<ul><li>爱神不仅公正，而且审慎。大家公认审慎是节制快感和情欲的力量。世界上没有一种快感比爱情本身还要强烈。一切快感都比不上爱情，就是因为它们都受爱神节制，而爱神是它们的统治者。爱神既然统治着快感和情欲，岂不是最审慎的吗？</li><li>爱不也是这样：一个人既然爱一件东西，就是还没有那样东西；他盼望它，就是盼望他现在有它，或者将来有它。是不是？”</li><li>所以总起来说，在这种和其他情况下，一个盼望的人所盼望的是他缺少的、还没有到手的，总之是他所没有的，是本身不存在的，不在他那里的；只有这样的东西才是他所盼望的、他所爱的。</li><li>爱神首先是对某某东西的爱，其次是对他所欠缺的东西的爱。是不是？</li><li>正确的意见而说不出所以然来，就不是有知识（因为没有根据的不能算知识），却也不是无知（因为有正确内容的不能叫无知）。所以很明显，正确的意见就是介于智慧和无知之间的东西。</li></ul></li><li>她说：「说来话长，我还是给你说说吧。当初阿莆若狄德诞生的时候，诸神举行宴会，出席的有智谋女神梅蒂的儿子丰饶神波若。他们宴饮结束时，匮乏神贝尼娅来向他们作节日例行的行乞，站在门口。波若多喝了几杯琼浆（因为那时还没有酒），就走进宙斯的花园，昏昏沉沉地睡着了。贝尼娅由于贫乏，很想和波若生个孩子，于是和他睡在一起，怀下了爱若。爱若也成了阿莆若狄德的随从和仆人，因为他是在阿莆若狄德的生日投的胎，生性爱美的东西，而阿莆若狄德是很美的。」</li><li>她说：‘这正是我要启发你的第二点，苏格拉底。爱神就是这个样子，就是这样产生的。他是奔赴美的东西的，像你说的那样。假如有人问我们：爱者从美的东西得到什么呢，苏格拉底和狄欧蒂玛？或者问得更明确一点：那盼望美的东西的是盼望什么呢？你怎么回答？’</li><li>那我给你说清楚点。苏格拉底啊，所有的人都会生育，凭借身体或灵魂生育，到了一定的年龄，就为本性所推动，迫不及待地要求生育。可是他们不能在丑的东西里、只能在美的东西里生育。男人和女人结合就是生育。怀胎、生育是一件神圣的事，是会死的凡夫身上的不朽的因素。但是这件事不可能在不协调的情况下实现，丑的东西与神圣的事情不协调，只有美的东西才与它协调。所以美是引导和帮助生育的女神和决定命运的女神。因为这个缘故，那生育能力旺盛的一遇到美的对象就立刻欢欣鼓舞，精神焕发，同它交配生子；如果遇到丑的，就垂头丧气，毫无兴趣，避开它不去生育，宁愿把沉重的包袱背下去。因此那充满生育的种子和欲望的一遇到美的对象就欣喜若狂，是由于它可以结束他的巨大痛苦。</li><li>你就不会觉得奇怪了。因为和上面说的完全一样，那会死的东西也是力求能够永远存在和不朽。要达到不朽，全凭生殖，以新的代替旧的。每一个个体的生物，虽然我们说它一生之中始终是同一个东西。</li><li>美者，这时，就只有大愚不解的人才会不明白一切形体中的美是同一个美了。明白了这一点，他就成了爱一切美好形体的人，把他的热情从专注于某一形体推广到一切，因为他把那种专注一点看成渺小的、微不足道的。再则，他必须把灵魂的美看得大大优于形体的美，如果有一个人灵魂值得称赞，即便形貌较次，那也足够了，他也应该对这个人表示爱慕之情，加以照顾，他心里想出来发表的那些美好的话语可以使青年奋发向上，他这样做也使他自己遍览人们各种行动中以及各种风俗习惯中的美，从而见到美是到处贯通的，就把形体的美看成甚为微末的了。可是他必须从各种行动向前更进一步，达到知识，这样就见到知识的美。</li><li>至于爱的方面，情形也是这样。一般说来，凡属对于好东西、对于幸福的企盼，都是每个人心中最大的、强烈的爱。然而其余的那些在某一个方面有所追求的，无论是谋求获利的，喜爱体育的，还是爱智慧的，我们都不说他们在爱，不说他们是钟爱者；只有那些以某种方式发挥作用的喜好者，才占有全体的名称，我们说他们在爱，称他们为情人或钟爱者。</li><li>一个人如果一直接受爱的教育，按照这样的次序一一观察各种美的东西，直到这门爱的学问的结尾，就会突然发现一种无比奇妙的美者，即美本身。</li><li>爱其实就是寻找真正的美的过程。</li><li>苏格拉底的颂辞是全篇三大段的中段，也是全篇精义所在。它本身分两部分：和阿伽通的对话以及和狄欧蒂玛的对话。<ul><li>在和阿伽通的对话里，他说明了：<ul><li>（一）爱情必有对象；</li><li>（二）钟爱者还没有得到所爱的对象；</li><li>（三）爱情就是想占有所爱对象那一个欲望；</li><li>（四）爱情的对象既然是美，如阿伽通所说的，它就还缺乏美，“爱神是美的”一说不能成立；</li><li>（五）美善同一，所以爱神也不是善的。</li></ul></li><li>这样苏格拉底就把阿伽通的一篇大文章完全推翻了。接着他说他的爱情学问是从女巫狄欧蒂玛那里领教来的。他原来和阿伽通一般见解，她纠正了他。她使他明白：<ul><li>（一）爱神是介乎美丑、善恶、有知与无知、神与人之间的一种精灵，是丰富和贫乏的统一，总之，就是一个哲学家；</li><li>（二）爱情就是想凡是美的善的永远归自己所有那一个欲望；</li><li>（三）爱情的目的是在美的对象中传播种子，凭它孕育生殖，达到凡人所能享有的不朽：生殖就是以新代旧，种族与个体都时时刻刻在生灭流转中。这种生殖可以是身体的，也可以是心灵的。诗人、立法者、教育者以及一切创造者都是心灵方面的生殖者；</li><li>（四）爱情的深密教，也就是达到哲学极境的四大步骤。</li></ul></li></ul></li></ul><h2 id="阿尔基比亚德畸形之爱"><a class="markdownIt-Anchor" href="#阿尔基比亚德畸形之爱"></a> 阿尔基比亚德：畸形之爱</h2><p>醉酒阿尔基比亚德（对应开头提到的酒神）的胡言，他爱着苏格拉底却又自惭形秽。爱情的美好没有让他变美好，反而让他与美好背道而驰，离爱越来越远，他矛盾而纠结，爱在折磨着他。</p><h2 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h2><p>柏拉图的爱情观：爱是阶梯式的，肉体之爱会让精神之爱更崇高，二者不能单一存在，否则偏向肉体则堕落，偏向精神则虚渺。(寻找本源的行为。)</p><h2 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> Ref</h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E6%9C%83%E9%A3%B2%E7%AF%87">会饮篇 - 维基百科，自由的百科全书</a></li><li><a href="https://www.zhihu.com/question/22519668">如何理解柏拉图的《会饮篇》？ - 知乎</a><ul><li>我希望你的目的地是星辰大海</li></ul></li><li><a href="https://www.bilibili.com/video/BV1zT4y1K7sm">【罗翔老师直播课堂】共读柏拉图的《会饮篇》_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</a><ul><li>我们所有的学习都是在回忆</li><li>阿尔基比亚德在看到苏格拉底身上看到他原初的美好，现在的匮乏，将来的美好。<ul><li>“人最大的痛苦是无法跨越知道和做到的鸿沟”</li><li>最终在战争中背叛了雅典</li></ul></li><li>有追求者介于有知和无知之间，神有知，所以不需要追求，愚人无知，所以不知道要去追求，只有介于二者之间的人才会去追求知识追求美好，这就是追求者，每一个为梦想努力的人就是这样的人。</li><li>爱他人就是爱自己。因为爱他人时，你爱上的那些优点和美好，其实都印证了自身。也许过去自己拥有这些美好如今失去了，所以我们爱；也许现在我们正拥有这些美好，我们惺惺相惜所以爱；也许我们看到了将来的自己，自己想要成为的样子，想要拥有的特质，所以我们爱。自恋所恋，其实是恋着自身过去、现在、将来的美好。</li><li>所以上次在读书会的时候我给学生说了这样一段话：<ul><li>我说很少有那个词会像爱一样被庸俗对待，但是爱是可以承载真正的严肃和祟高，我们爱因为我们匮乏，我们爱因为我们希望超越每日的锱铢必较，在爱中我们放弃了自我，我们发现了自我，我们希望重塑我们的自我。</li><li>所以整个会饮篇，他提醒我们肉体的爱当然是有意义的，但人不要沉迷于肉体的爱，人要扶级而上，去追求灵魂的爱，去追求更好的爱。因为我们要回忆起我们失落的美好，我们就可以告别，我们当下的平庸苟且，我们要攀登美善的阶梯，一步一步往上爬。</li><li>这样，我们才能够达到一种爱的升华，我们才能在一个具体的人中，去发现我们，对于所有人美好的期待，就是这种抽象的爱。因为具体的人，我们在他身上看到了，我们想看到的样子，我们希望变得美好，当我们变得美好的时候，我们又会和具体的人，在具体的人身上，我们又会经营我们的美好。</li></ul></li></ul></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;《会饮篇》记录阿伽通获得酒神节悲剧比赛第一名后，苏格拉底等人在庆祝宴会中「赞美爱神」的比赛过程。实际上记录与会人七种不同的爱情观。最后，酒神狄奥尼索斯决定出当晚的获胜者。&lt;/p&gt;</summary>
    
    
    
    <category term="读书记" scheme="https://blog.xiang578.com/categories/%E8%AF%BB%E4%B9%A6%E8%AE%B0/"/>
    
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
  </entry>
  
  <entry>
    <title>2020 挑战</title>
    <link href="https://blog.xiang578.com/post/2020.html"/>
    <id>https://blog.xiang578.com/post/2020.html</id>
    <published>2021-01-01T08:19:43.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>2020 年最后一天下午，坐在工位上想着「今年有什么遗憾？」想到最大遗憾：这个世界变不回原来的样子。超级黑天鹅「Covid 2019」或多或少改变我们生活，新时代就这样拉开大幕。在这个背景下，承受来自各个方面的压力，各种「挑战」也随之而来。在这一篇总结中，我会通过关键字回顾自己过去一年。</p><h2 id="一-工作"><a class="markdownIt-Anchor" href="#一-工作"></a> 一 工作</h2><p>没有太多变化，还是选择留在滴滴。年初获得机会参与「晋升」答辩，在老板和同事的帮助下，异常艰难地升到下一个级别。两点感悟：需要做有价值的事情以及有把做过的事情说清楚的能力。之后参与内部一个比较大的探索项目，费了很大力气上线后，12 月底开始和同事一起写相关的论文，希望能中 KDD 2021。</p><p>晋升之后，日常工作中会接触到更多的人，如何与其他人进行有效的沟通成为自己新的挑战。后来也有机会指导实习生，不过没有多久就离开了。简单总结自己变化：做人家分配的事情，到自己思考如何做事情，再到分配事情给其他人做。这些变化中，我经历长时间不适应的感受。大学参与编程比赛培养的是靠外部刺激和目标驱动，工作中需要的是你不断拓展边界，打破旧的认知和规则。</p><h2 id="二-技术能力"><a class="markdownIt-Anchor" href="#二-技术能力"></a> 二 技术能力</h2><p>分成两个部分：尝试一些工程的开发，改线上代码差不多和呼吸一样自然。但是觉得自己总体上来说写的东西还是偏向简单，没有太多的设计和思考在里面。下半年很多时候是在修自己上半年的 bug……算法学习差不多是跟随业务需求进行，看得大部分还是 CTR 相关内容。另外也在 b站看了一半统计机器学习的内容。做的业务不像 CTR、NLP 这样有明确的界限，所以也没有机会去深入一个方向去实践，大部分时候浅尝辄止。</p><h2 id="三-程序设计"><a class="markdownIt-Anchor" href="#三-程序设计"></a> 三 程序设计</h2><p>不知道告别多久之后，下半年尝试想把这个东西捡起来。说回来，我之间问一个进过 world final 的候选人，工作中有没有用过相关的算法，他也是摇头。按自己目前的水平，每周日上午写 LeetCode 周赛是很奇妙的体验。每次都是一场孤独的挑战，只有调整好自己的思维方式，才能把自己从苦海中解脱出来。做这件事情的意义大概是山就在那里。多少年之后，我也体会到当年没有拼尽全力的遗憾。</p><p>9 月份，在周神的组织下，我们组成一个队伍参加 Leetcode 举办的秋季编程大赛。刚开始我们都是信心满满地，比赛开始之后就是无尽的折磨，最后就是以三题结束比赛。原来他们这么久不训练也不会写题目……希望等自己学校举办区域赛的时候还能打星参与一次。</p><h2 id="四-生活"><a class="markdownIt-Anchor" href="#四-生活"></a> 四 生活</h2><p>11 月份遇到房东卖房，从原来住的房子里面搬出来，跑到回龙观和同事一起合租。最大变化是通勤时间的变长，挤过几天地铁后，立马决定打拼车上班，另外忍受几次下班后打车的痛苦，也开始 20:30 自费打车。所以多了很多坐车的时光，一般早上都会带一个阅读器去看书。有一次堵在后厂村路上，看着《禅与摩托车维修艺术》，恨自己没有摩托车。晚上回来的时候，大概率是听播客。似乎比之前把节省下来的时间拿去冲浪好很一些。</p><h2 id="五-知识管理"><a class="markdownIt-Anchor" href="#五-知识管理"></a> 五 知识管理</h2><blockquote><p>投入在 Input 上的时间越多，知识管理越差。</p></blockquote><p>这个差不多是这几年一直在思考的话题（时间管理方法，我看清 GTD 本质之后，就不太纠结）。去年年末开始关注 Zettelkasten，当时还是在借助 <code>sublime_zk</code> 进行折腾。2 月份的时候，了解到一个工具 Roam Research，开始慢慢把自己的笔记迁移过去。几个月之后，Zettelkasten 和双向链接笔记在国内火了起来。给我最大的两点改变是：</p><ol><li>区分自己写的笔记和收藏的文章（印象笔记就是因为剪藏太多变成垃圾堆）。</li><li>思考不同内容之间的关系。</li></ol><p>很遗憾，这一年很大一部分精力停留在把之前散落在不同软件中的笔记汇聚到 Roam 中。新的一年尝试把更多的内容分享出来。</p><p>另外一方面，真正记住内容还需要不断回忆（给你选择记忆的机会），比较知名的软件就是 anki。有一段时间经常制作卡片，但是没能融入自己的系统，也没有把这个习惯坚持下来。</p><h2 id="六-分享"><a class="markdownIt-Anchor" href="#六-分享"></a> 六 分享</h2><p><img src="https://media.xiang578.com/blog-analytics-2019.jpg" alt="2020 博客访问量统计" /></p><p>从访问数据上来看，比起去年博客的流量快增加超过 5 倍。统计数据中，流量大概是 8 月中旬开始的，最大的原因是完成百度和 Google 对博客的收录。大部分流量来自于一篇文章（已被自己手动删除）。不过得到启示，某一些小众的关键字，如果能做到百度的前几名，获得的流量还是很可观的。</p><p>今年没有写多少正经的东西，最大的亮点是差不多用8个月的时间尝试摸索分享每个月阅读相关的总结「Never Reading」。这些文章内容来自 Roam Reasearch 阅读笔记。最终被自己停掉的原因是，形式上并不优美，可能阅读时，都只是一些没有上下文的关键词或短句。最好的形式还是自己将阅读的内容按主题写成文章进行分享。</p><p>放弃写每月的阅读总结后，自己觉得笔记-博客文章中应该还有一个中介介质。用现在时髦的话来说，是数字花园。苦于目前还没有发现如何快速将部分 Roam 笔记公开展示出来，9 月份的时候模仿 <a href="https://onetwo.ren/wiki/#:Index">Meme of LinOnetwo — 林一二的模因和想法</a>也搭建一个 <a href="https://wiki.xiang578.com/">算法花园・Xanadu — 吾辈心中亦有惑，坐！</a>，想着分享一些读书和读论文的笔记。大概过一个多月，差不多就放弃这个网站……目前还是等待更高效导出 Roam 笔记制作站点的方案出现。</p><p>最后，也开始在 Twitter <a href="https://twitter.com/xiang578">Ryen Xiang(@xiang578)</a>进行分享。很遗憾，之前和人交流太少，写的东西除了错别字多以外，没有太强的逻辑性，可能很难理解………这一些都是在新的一年中需要克服的。</p><h2 id="七-阅读"><a class="markdownIt-Anchor" href="#七-阅读"></a> 七 阅读</h2><p>阅读的挑战是：为了什么而读？思考如何去做阅读笔记？主力阅读软件是微信读书，不仅仅是无限会员全场畅读，更重要的是导出的笔记格式都比 kindle 方便整理。全年读过 <a href="https://book.douban.com/people/xiang578/collect?sort=time&amp;tags_sort=count&amp;filter=all&amp;tag=2020&amp;mode=grid">36</a> 本书，平均下来一个月 3 本书，和年初计划每周一本书，还是有很大的差距。推荐几本 5 星的图书：</p><ul><li><a href="https://book.douban.com/subject/35092383/">把自己作为方法</a>：项飙的三场访谈录，一次感受知识分子可爱以及真诚的机会。</li><li><a href="https://book.douban.com/subject/27167270/">像哲学家一样生活</a>：介绍哲学流派斯多葛的书，一种人间哲学。</li><li><a href="https://book.douban.com/subject/21570668/">会饮篇</a>：苏格拉底等人关于爱的讨论。</li><li><a href="https://book.douban.com/subject/26831789/">穷查理宝典</a>：查理芒格 11 篇演讲的合集。</li><li><a href="https://book.douban.com/subject/33438811/">为什么</a>：因果推理入门科普书，不过没有机会应用到业务中。</li><li><a href="https://book.douban.com/subject/35013197/">深度学习推荐系统</a>：介绍深度学习在推荐系统的的应用，大而全。</li><li><a href="https://book.douban.com/subject/25757313/">红楼梦脂评汇校本</a>：市面上口碑比较好的红楼梦版本。</li></ul><p>2021 年的阅读目标还是每周一本书，然后每月挑一本书写出读书笔记在博客中发表。</p><h2 id="八-观影"><a class="markdownIt-Anchor" href="#八-观影"></a> 八 观影</h2><p>今年在豆瓣上标记看过电影只有 <a href="https://movie.douban.com/people/xiang578/collect?start=0&amp;sort=rating&amp;rating=all&amp;tag=2020&amp;mode=list&amp;filter=all">40</a> 个条目，仅是去年的 2/3。可能现在把更多空闲时间花费在看 B 站各种 UP 主的视频中，仔细想想还是需要去欣赏艺术。</p><ul><li><a href="https://movie.douban.com/subject/33447642/">沉默的真相</a>/<a href="https://movie.douban.com/subject/33404425/">隐秘的角落</a>：不错的故事和拍摄，但是紫金陈的原著一言难尽。</li><li><a href="https://movie.douban.com/subject/1900841/">窃听风暴 (豆瓣)</a>：从一个简单的故事告诉你为什么某些制度不行。有一种听不懂德语的遗憾。</li><li><a href="https://movie.douban.com/subject/10533913/">头脑特工队 (豆瓣)</a>：今日简史中推荐反传统科幻片。 完全是五星，迪斯尼实在是太有创意了。</li><li><a href="https://movie.douban.com/subject/27012433/">阿尔法围棋 (豆瓣)</a>：尝试调研 MCTS 时补充看的纪录片，当年的旁观者，再回头已经成为参与者。</li><li><a href="https://movie.douban.com/subject/27010768/">寄生虫 (豆瓣)</a>：小孩子早已经看穿一切。剧情安排真实精彩。</li></ul><h2 id="九-游戏"><a class="markdownIt-Anchor" href="#九-游戏"></a> 九 游戏</h2><p>动物森友会：上半年最火的游戏。曾经的QQ农场爱好者，不可避免在同事的带领下，成为一名光荣的岛主。100 多个小时候之后，就没有重新上过岛……<br />Ingress：一款手机端的 LBS 游戏，你扮演一名特工，完成游戏中的任务探索现实世界。自己最初希望通过这款游戏多出去走走。11 月和 12 月，为了做任务，多次出去暴走 20+ 公里！不过，已经变成匆匆寻找关键打卡地点，很多时候错过旁边的风景。<br />Celeste：IGN 满分作品，号称是治疗抑郁的。横版平台跳跃游戏，和马里奥相比多了一个冲刺键。最大优点是死亡之后复活特别快，第一关还没有通过，我差不多就死了 1k 次。</p><h2 id="十-消费指北"><a class="markdownIt-Anchor" href="#十-消费指北"></a> 十 消费指北</h2><p>克制自己的消费，不单独写一篇文章。</p><p><code>ErgoDox EZ</code>：红轴，分体人体工程学键盘，反正看到的同事都觉得很酷。<br /><code>Inkpad X</code>：为了用微信读书，买的10寸安卓平板。分辨率只有 200 ppi，字体调大一些没有太大影响。不过没有实体翻页键还是挺难受的。微信阅读也没有怎么对这个设备优化。最近小米又出一个 pro 阅读器，也可以考虑。<br /><code>DEVONthink pro</code>：增强型文件管理器，主要用来替代印象笔记。虽然贵，但是好用。<br /><code>Offscreen</code>： 记录手机屏幕时间、打开次数等，不断提醒你今天沉迷手机多久。<br /><code>产品沉思录</code>：邮件组，有关互联网、科技和人文，提供不错的信息来源。可以先从精选集判断是否值得入手。</p><h2 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h2><p>在迈入 2021 之际，给自己留下一些 New Year Challenge:</p><ol><li>认识你自己</li><li>变得勇敢</li><li>成为生产者</li></ol><p>于北京回龙观</p><p><a href="https://xiang578.com/post/2017.html">2017 迷茫</a> &gt;&gt; <a href="https://xiang578.com/post/2018.html">2018 探索</a> &gt;&gt; <a href="https://xiang578.com/post/2019.html">2019 起步</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2020 年最后一天下午，坐在工位上想着「今年有什么遗憾？」想到最大遗憾：这个世界变不回原来的样子。超级黑天鹅「Covid 2019」或多或少改变我们生活，新时代就这样拉开大幕。在这个背景下，承受来自各个方面的压力，各种「挑战」也随之而来。在这一篇总结中，我会通过关键字回顾</summary>
      
    
    
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="movie" scheme="https://blog.xiang578.com/tags/movie/"/>
    
    <category term="game" scheme="https://blog.xiang578.com/tags/game/"/>
    
    <category term="didiglobal" scheme="https://blog.xiang578.com/tags/didiglobal/"/>
    
  </entry>
  
  <entry>
    <title>深入浅出 BERT 源代码之 BertModel 类</title>
    <link href="https://blog.xiang578.com/post/all-about-bert-code.html"/>
    <id>https://blog.xiang578.com/post/all-about-bert-code.html</id>
    <published>2020-10-03T12:56:43.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>国庆节前突然对如何计算 BERT 的参数量感兴趣，不过一直看不明白网上的计算过程，索性下载 BERT 源代码阅读一番。这篇文章记录阅读 BertModel 类（核心代码实现）时写的一些笔记，反正我也是纸上谈兵，所以不需要太关注数据处理和 Finetune 相关部分，最后附上计算 BERT 参数量的过程仅供参考。</p><span id="more"></span><p>代码地址：<a href="https://github.com/google-research/bert/blob/master/modeling.py">bert/modeling.py at master · google-research/bert</a></p><h2 id="bertconfig"><a class="markdownIt-Anchor" href="#bertconfig"></a> BertConfig</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BertConfig</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Configuration for `BertModel`.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,</span></span><br><span class="line"><span class="params">               vocab_size,</span></span><br><span class="line"><span class="params">               hidden_size=<span class="number">768</span>,</span></span><br><span class="line"><span class="params">               num_hidden_layers=<span class="number">12</span>,</span></span><br><span class="line"><span class="params">               num_attention_heads=<span class="number">12</span>,</span></span><br><span class="line"><span class="params">               intermediate_size=<span class="number">3072</span>,</span></span><br><span class="line"><span class="params">               hidden_act=<span class="string">&quot;gelu&quot;</span>,</span></span><br><span class="line"><span class="params">               hidden_dropout_prob=<span class="number">0.1</span>,</span></span><br><span class="line"><span class="params">               attention_probs_dropout_prob=<span class="number">0.1</span>,</span></span><br><span class="line"><span class="params">               max_position_embeddings=<span class="number">512</span>,</span></span><br><span class="line"><span class="params">               type_vocab_size=<span class="number">16</span>,</span></span><br><span class="line"><span class="params">               initializer_range=<span class="number">0.02</span></span>):</span><br><span class="line">    self.vocab_size = vocab_size</span><br><span class="line">    self.hidden_size = hidden_size</span><br><span class="line">    self.num_hidden_layers = num_hidden_layers</span><br><span class="line">    self.num_attention_heads = num_attention_heads</span><br><span class="line">    self.hidden_act = hidden_act</span><br><span class="line">    self.intermediate_size = intermediate_size</span><br><span class="line">    self.hidden_dropout_prob = hidden_dropout_prob</span><br><span class="line">    self.attention_probs_dropout_prob = attention_probs_dropout_prob</span><br><span class="line">    self.max_position_embeddings = max_position_embeddings</span><br><span class="line">    self.type_vocab_size = type_vocab_size</span><br><span class="line">    self.initializer_range = initializer_range</span><br><span class="line"></span><br><span class="line"><span class="meta">  @classmethod</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">from_dict</span>(<span class="params">cls, json_object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Constructs a `BertConfig` from a Python dictionary of parameters.&quot;&quot;&quot;</span></span><br><span class="line">    config = BertConfig(vocab_size=<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">for</span> (key, value) <span class="keyword">in</span> six.iteritems(json_object):</span><br><span class="line">      config.__dict__[key] = value</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line"></span><br><span class="line"><span class="meta">  @classmethod</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">from_json_file</span>(<span class="params">cls, json_file</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Constructs a `BertConfig` from a json file of parameters.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> tf.gfile.GFile(json_file, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> reader:</span><br><span class="line">      text = reader.read()</span><br><span class="line">    <span class="keyword">return</span> cls.from_dict(json.loads(text))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">to_dict</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Serializes this instance to a Python dictionary.&quot;&quot;&quot;</span></span><br><span class="line">    output = copy.deepcopy(self.__dict__)</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">to_json_string</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Serializes this instance to a JSON string.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(self.to_dict(), indent=<span class="number">2</span>, sort_keys=<span class="literal">True</span>) + <span class="string">&quot;\n&quot;</span></span><br></pre></td></tr></table></figure><p><code>BertConfig</code> 类包含模型参数、几个读取和存储参数的方法。</p><p><code>@classmethod</code> 代表类方法，不需要实例化就可以调用类中的方法。参考其他的文件可以发现它的使用是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bert_config = modeling.BertConfig.from_json_file(FLAGS.bert_config_file)</span><br></pre></td></tr></table></figure><p>主要参数有：</p><ul><li><code>vocab_size</code>: 词表大小</li><li><code>hidden_size</code>: Size of the encoder layers and the pooler layer. 词向量 embedding 大小</li><li><code>num_hidden_layers</code>: Number of hidden layers in the Transformer encoder. 层数</li><li><code>num_attention_heads</code>: Number of attention heads for each attention layer in<br />the Transformer encoder. 多头数量</li><li><code>intermediate_size</code>: The size of the “intermediate” (i.e., feed-forward)<br />layer in the Transformer encoder. FFN 中间层的大小</li><li><code>hidden_act</code>: The non-linear activation function (function or string) in the<br />encoder and pooler. 激活函数</li><li><code>hidden_dropout_prob</code>: The dropout probability for all fully connected<br />layers in the embeddings, encoder, and pooler. dropout 参数</li><li><code>attention_probs_dropout_prob</code>: The dropout ratio for the attention<br />probabilities.</li><li><code>max_position_embeddings</code>: position embedding 的最大值 (e.g., 512 or 1024 or 2048).</li><li><code>type_vocab_size</code>: next sentence prediction 中的 Segment A 和 Segment B，默认大小是 2</li><li><code>initializer_range</code>: The stdev of the truncated_normal_initializer for<br />initializing all weight matrices.<br />“”&quot;</li></ul><h2 id="embedding_lookup"><a class="markdownIt-Anchor" href="#embedding_lookup"></a> embedding_lookup</h2><p>根据 <code>input_ids</code> 生成词向量 <code>embedding table</code> 以及对应的 <code>input_id_embeddings</code>。简单一点理解就是向量从 <code>[batch_size, seq_size]</code> 到 <code>[batch_size, seq_size，embedding_size]</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">embedding_lookup</span>(<span class="params">input_ids,</span></span><br><span class="line"><span class="params">                     vocab_size,</span></span><br><span class="line"><span class="params">                     embedding_size=<span class="number">128</span>,</span></span><br><span class="line"><span class="params">                     initializer_range=<span class="number">0.02</span>,</span></span><br><span class="line"><span class="params">                     word_embedding_name=<span class="string">&quot;word_embeddings&quot;</span>,</span></span><br><span class="line"><span class="params">                     use_one_hot_embeddings=<span class="literal">False</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Looks up words embeddings for id tensor.</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    input_ids: int32 Tensor of shape [batch_size, seq_length] containing word</span></span><br><span class="line"><span class="string">      ids.</span></span><br><span class="line"><span class="string">    vocab_size: int. Size of the embedding vocabulary.</span></span><br><span class="line"><span class="string">    embedding_size: int. Width of the word embeddings.</span></span><br><span class="line"><span class="string">    initializer_range: float. Embedding initialization range.</span></span><br><span class="line"><span class="string">    word_embedding_name: string. Name of the embedding table.</span></span><br><span class="line"><span class="string">    use_one_hot_embeddings: bool. If True, use one-hot method for word</span></span><br><span class="line"><span class="string">      embeddings. If False, use `tf.gather()`.</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    float Tensor of shape [batch_size, seq_length, embedding_size].</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="comment"># This function assumes that the input is of shape [batch_size, seq_length,</span></span><br><span class="line">  <span class="comment"># num_inputs].</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># If the input is a 2D tensor of shape [batch_size, seq_length], we</span></span><br><span class="line">  <span class="comment"># reshape to [batch_size, seq_length, 1].</span></span><br><span class="line">  <span class="keyword">if</span> input_ids.shape.ndims == <span class="number">2</span>:</span><br><span class="line">    input_ids = tf.expand_dims(input_ids, axis=[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">  embedding_table = tf.get_variable(</span><br><span class="line">      name=word_embedding_name,</span><br><span class="line">      shape=[vocab_size, embedding_size],</span><br><span class="line">      initializer=create_initializer(initializer_range))</span><br><span class="line"></span><br><span class="line">  flat_input_ids = tf.reshape(input_ids, [-<span class="number">1</span>])</span><br><span class="line">  <span class="keyword">if</span> use_one_hot_embeddings:</span><br><span class="line">    one_hot_input_ids = tf.one_hot(flat_input_ids, depth=vocab_size)</span><br><span class="line">    output = tf.matmul(one_hot_input_ids, embedding_table)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    output = tf.gather(embedding_table, flat_input_ids)</span><br><span class="line"></span><br><span class="line">  input_shape = get_shape_list(input_ids)</span><br><span class="line"></span><br><span class="line">  output = tf.reshape(output,</span><br><span class="line">                      input_shape[<span class="number">0</span>:-<span class="number">1</span>] + [input_shape[-<span class="number">1</span>] * embedding_size])</span><br><span class="line">  <span class="keyword">return</span> (output, embedding_table)</span><br></pre></td></tr></table></figure><p>从 embedding_table 取 input_ids 对应的 embedding 有两种方法：</p><ul><li>矩阵乘法：先通过 input_ids 构造出 one_hot 矩阵，然后和 embedding_table 相乘得到结果。</li><li><code>tf.gather</code> 根据 input_ids 取 embedding_table 对应行的结果。和 <code>tf.nn.embedding_lookup</code> 方法类似。具体原理可以参考 <a href="https://stackoverflow.com/questions/34870614/what-does-tf-nn-embedding-lookup-function-do">python - What does tf.nn.embedding_lookup function do? - Stack Overflow</a></li></ul><p>看网上的解释，定义两种方法主要是不同设备（CPU、GPU、TPU）运算速度导致的。</p><h2 id="embedding_postprocessor"><a class="markdownIt-Anchor" href="#embedding_postprocessor"></a> embedding_postprocessor</h2><p>embedding_postprocessor 将 <code>token embeddings</code> <code>segmentation embeddings</code> <code>position embeddings</code> 三个向量相加得到最终的输入向量。</p><p><img src="https://media.xiang578.com/bert-input-embeddings.png" alt="" /></p><ul><li><code>token embeddings</code> 对应单词 embedding</li><li><code>segmentation embeddings</code> 代表单词来自哪个句子，在 Next Sentence Prediction 任务中使用。</li><li><code>position embeddings</code> 位置 embedding。在「Attention is all your need」论文中，Google 生成 position embedding 的方法是一个花里胡哨 cos/sin 公式，这一次换成训练 position embedding。猜测在之前的论文中，输入的 seq len 可能长短不一，导致部分 position embedding 训练不充分。BERT 中强行定死 seq len。</li><li>最后直接将三个 embedding 相加，可能对新人来说也有点迷惑。我自己的理解是，物理中多个不同波长的波叠加，是可以通过方法区分的。所以三个 embedding 相加，模型也能学到差异。<ul><li>知乎这个问题<a href="https://www.zhihu.com/question/374835153">为什么 Bert 的三个 Embedding 可以进行相加</a>可以提供更加严谨的理由。</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">embedding_postprocessor</span>(<span class="params">input_tensor,</span></span><br><span class="line"><span class="params">                            use_token_type=<span class="literal">False</span>,</span></span><br><span class="line"><span class="params">                            token_type_ids=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                            token_type_vocab_size=<span class="number">16</span>,</span></span><br><span class="line"><span class="params">                            token_type_embedding_name=<span class="string">&quot;token_type_embeddings&quot;</span>,</span></span><br><span class="line"><span class="params">                            use_position_embeddings=<span class="literal">True</span>,</span></span><br><span class="line"><span class="params">                            position_embedding_name=<span class="string">&quot;position_embeddings&quot;</span>,</span></span><br><span class="line"><span class="params">                            initializer_range=<span class="number">0.02</span>,</span></span><br><span class="line"><span class="params">                            max_position_embeddings=<span class="number">512</span>,</span></span><br><span class="line"><span class="params">                            dropout_prob=<span class="number">0.1</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Performs various post-processing on a word embedding tensor.</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    input_tensor: float Tensor of shape [batch_size, seq_length,</span></span><br><span class="line"><span class="string">      embedding_size].</span></span><br><span class="line"><span class="string">    use_token_type: bool. Whether to add embeddings for `token_type_ids`.</span></span><br><span class="line"><span class="string">    token_type_ids: (optional) int32 Tensor of shape [batch_size, seq_length].</span></span><br><span class="line"><span class="string">      Must be specified if `use_token_type` is True.</span></span><br><span class="line"><span class="string">    token_type_vocab_size: int. The vocabulary size of `token_type_ids`.</span></span><br><span class="line"><span class="string">    token_type_embedding_name: string. The name of the embedding table variable</span></span><br><span class="line"><span class="string">      for token type ids.</span></span><br><span class="line"><span class="string">    use_position_embeddings: bool. Whether to add position embeddings for the</span></span><br><span class="line"><span class="string">      position of each token in the sequence.</span></span><br><span class="line"><span class="string">    position_embedding_name: string. The name of the embedding table variable</span></span><br><span class="line"><span class="string">      for positional embeddings.</span></span><br><span class="line"><span class="string">    initializer_range: float. Range of the weight initialization.</span></span><br><span class="line"><span class="string">    max_position_embeddings: int. Maximum sequence length that might ever be</span></span><br><span class="line"><span class="string">      used with this model. This can be longer than the sequence length of</span></span><br><span class="line"><span class="string">      input_tensor, but cannot be shorter.</span></span><br><span class="line"><span class="string">    dropout_prob: float. Dropout probability applied to the final output tensor.</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    float tensor with same shape as `input_tensor`.</span></span><br><span class="line"><span class="string">  Raises:</span></span><br><span class="line"><span class="string">    ValueError: One of the tensor shapes or input values is invalid.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  input_shape = get_shape_list(input_tensor, expected_rank=<span class="number">3</span>)</span><br><span class="line">  batch_size = input_shape[<span class="number">0</span>]</span><br><span class="line">  seq_length = input_shape[<span class="number">1</span>]</span><br><span class="line">  width = input_shape[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">  output = input_tensor</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 是否使用有 segmentation embeddings</span></span><br><span class="line">  <span class="keyword">if</span> use_token_type:</span><br><span class="line">    <span class="keyword">if</span> token_type_ids <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      <span class="keyword">raise</span> ValueError(<span class="string">&quot;`token_type_ids` must be specified if&quot;</span></span><br><span class="line">                       <span class="string">&quot;`use_token_type` is True.&quot;</span>)</span><br><span class="line">    token_type_table = tf.get_variable(</span><br><span class="line">        name=token_type_embedding_name,</span><br><span class="line">        shape=[token_type_vocab_size, width],</span><br><span class="line">        initializer=create_initializer(initializer_range))</span><br><span class="line">    <span class="comment"># segmentation vocab 大小一般是 2，所以使用 one-hot 速度比较快</span></span><br><span class="line">    flat_token_type_ids = tf.reshape(token_type_ids, [-<span class="number">1</span>])</span><br><span class="line">    one_hot_ids = tf.one_hot(flat_token_type_ids, depth=token_type_vocab_size)</span><br><span class="line">    token_type_embeddings = tf.matmul(one_hot_ids, token_type_table)</span><br><span class="line">    token_type_embeddings = tf.reshape(token_type_embeddings,</span><br><span class="line">                                       [batch_size, seq_length, width])</span><br><span class="line">    output += token_type_embeddings</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> use_position_embeddings:</span><br><span class="line">    assert_op = tf.assert_less_equal(seq_length, max_position_embeddings)</span><br><span class="line">    <span class="keyword">with</span> tf.control_dependencies([assert_op]):</span><br><span class="line">      full_position_embeddings = tf.get_variable(</span><br><span class="line">          name=position_embedding_name,</span><br><span class="line">          shape=[max_position_embeddings, width],</span><br><span class="line">          initializer=create_initializer(initializer_range))</span><br><span class="line">      <span class="comment"># Since the position embedding table is a learned variable, we create it</span></span><br><span class="line">      <span class="comment"># using a (long) sequence length `max_position_embeddings`. The actual</span></span><br><span class="line">      <span class="comment"># sequence length might be shorter than this, for faster training of</span></span><br><span class="line">      <span class="comment"># tasks that do not have long sequences.</span></span><br><span class="line">      <span class="comment">#</span></span><br><span class="line">      <span class="comment"># So `full_position_embeddings` is effectively an embedding table</span></span><br><span class="line">      <span class="comment"># for position [0, 1, 2, ..., max_position_embeddings-1], and the current</span></span><br><span class="line">      <span class="comment"># sequence has positions [0, 1, 2, ... seq_length-1], so we can just</span></span><br><span class="line">      <span class="comment"># perform a slice.</span></span><br><span class="line">      <span class="comment"># position embedding 可以通过学习得到，然后可能输入句子的长度没有到达 512。使用 tf.slice 取对应的向量速度比较快。大小是[seq_length, width]</span></span><br><span class="line">      position_embeddings = tf.<span class="built_in">slice</span>(full_position_embeddings, [<span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                                     [seq_length, -<span class="number">1</span>])</span><br><span class="line">      num_dims = <span class="built_in">len</span>(output.shape.as_list())</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Only the last two dimensions are relevant (`seq_length` and `width`), so</span></span><br><span class="line">      <span class="comment"># we broadcast among the first dimensions, which is typically just</span></span><br><span class="line">      <span class="comment"># the batch size.</span></span><br><span class="line">      <span class="comment"># word embedding 的大小是 [batch_size, seq_length, width]，上一步取出的 position embedding 大小是 [seq_length, width]，需要对后面一个矩阵进行广播。</span></span><br><span class="line">      position_broadcast_shape = []</span><br><span class="line">      <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_dims - <span class="number">2</span>):</span><br><span class="line">        position_broadcast_shape.append(<span class="number">1</span>)</span><br><span class="line">      position_broadcast_shape.extend([seq_length, width]) <span class="comment"># 大小为 [1, seq_length, width] </span></span><br><span class="line">      position_embeddings = tf.reshape(position_embeddings,</span><br><span class="line">                                       position_broadcast_shape)</span><br><span class="line">      <span class="comment"># 通过 broadcast 相加                          </span></span><br><span class="line">      output += position_embeddings</span><br><span class="line"></span><br><span class="line">  output = layer_norm_and_dropout(output, dropout_prob)</span><br><span class="line">  <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure><p>三个 embedding 向量相加后，还会过一个 <code>layer_norm_and_dropout</code> 层，都是标准的，没有什么特殊。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dropout</span>(<span class="params">input_tensor, dropout_prob</span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Perform dropout.</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    input_tensor: float Tensor.</span></span><br><span class="line"><span class="string">    dropout_prob: Python float. The probability of dropping out a value (NOT of</span></span><br><span class="line"><span class="string">      *keeping* a dimension as in `tf.nn.dropout`).</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    A version of `input_tensor` with dropout applied.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">if</span> dropout_prob <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> dropout_prob == <span class="number">0.0</span>:</span><br><span class="line">    <span class="keyword">return</span> input_tensor</span><br><span class="line"></span><br><span class="line">  output = tf.nn.dropout(input_tensor, <span class="number">1.0</span> - dropout_prob)</span><br><span class="line">  <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">layer_norm</span>(<span class="params">input_tensor, name=<span class="literal">None</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Run layer normalization on the last dimension of the tensor.&quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">return</span> tf.contrib.layers.layer_norm(</span><br><span class="line">      inputs=input_tensor, begin_norm_axis=-<span class="number">1</span>, begin_params_axis=-<span class="number">1</span>, scope=name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">layer_norm_and_dropout</span>(<span class="params">input_tensor, dropout_prob, name=<span class="literal">None</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Runs layer normalization followed by dropout.&quot;&quot;&quot;</span></span><br><span class="line">  output_tensor = layer_norm(input_tensor, name)</span><br><span class="line">  output_tensor = dropout(output_tensor, dropout_prob)</span><br><span class="line">  <span class="keyword">return</span> output_tensor</span><br></pre></td></tr></table></figure><h2 id="create_attention_mask_from_input_mask"><a class="markdownIt-Anchor" href="#create_attention_mask_from_input_mask"></a> create_attention_mask_from_input_mask</h2><p>create_attention_mask_from_input_mask 用来构造 attention 时的 mask 矩阵（padding 的单词不参与计算 attention socre）。输入向量 <code>[batch_size, from_seq_length, ...]</code> 和 <code>[batch_size, to_seq_length]</code> 输出向量 <code>[batch_size, from_seq_length, to_seq_length]</code>。</p><p>偷个例子来举：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from_tensor = tf.constant([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>], [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]]) <span class="comment"># 中间的 0 代表 padding 的结果</span></span><br><span class="line">to_mask = tf.constant([[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>], [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]]) <span class="comment"># 和 from_tensor 对应。如果 1 代表对应位置有词，如果 0 代表对应位置是 padding 的。</span></span><br><span class="line"></span><br><span class="line">to_mask = tf.cast(tf.reshape(to_mask, [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>]), tf.float32)</span><br><span class="line"><span class="comment"># print(to_mask_2)</span></span><br><span class="line">broadcast_ones = tf.ones(</span><br><span class="line">      shape=[<span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>], dtype=tf.float32)</span><br><span class="line">mask = broadcast_ones * to_mask</span><br><span class="line">init = tf.global_variables_initializer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    <span class="comment"># print(sess.run(to_mask))</span></span><br><span class="line">    <span class="built_in">print</span>(sess.run(mask))</span><br></pre></td></tr></table></figure><p>最后的结果是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[[[1. 1. 1. 0. 0.] #第一个词可以和前三个词计算 attention</span><br><span class="line">  [1. 1. 1. 0. 0.]</span><br><span class="line">  [1. 1. 1. 0. 0.]</span><br><span class="line">  [1. 1. 1. 0. 0.]</span><br><span class="line">  [1. 1. 1. 0. 0.]]</span><br><span class="line"></span><br><span class="line"> [[1. 1. 1. 1. 1.]</span><br><span class="line">  [1. 1. 1. 1. 1.]</span><br><span class="line">  [1. 1. 1. 1. 1.]</span><br><span class="line">  [1. 1. 1. 1. 1.]</span><br><span class="line">  [1. 1. 1. 1. 1.]]]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_attention_mask_from_input_mask</span>(<span class="params">from_tensor, to_mask</span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Create 3D attention mask from a 2D tensor mask.</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    from_tensor: 2D or 3D Tensor of shape [batch_size, from_seq_length, ...].</span></span><br><span class="line"><span class="string">    to_mask: int32 Tensor of shape [batch_size, to_seq_length].</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    float Tensor of shape [batch_size, from_seq_length, to_seq_length].</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  from_shape = get_shape_list(from_tensor, expected_rank=[<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">  batch_size = from_shape[<span class="number">0</span>]</span><br><span class="line">  from_seq_length = from_shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  to_shape = get_shape_list(to_mask, expected_rank=<span class="number">2</span>)</span><br><span class="line">  to_seq_length = to_shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  to_mask = tf.cast(</span><br><span class="line">      tf.reshape(to_mask, [batch_size, <span class="number">1</span>, to_seq_length]), tf.float32)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># We don&#x27;t assume that `from_tensor` is a mask (although it could be). We</span></span><br><span class="line">  <span class="comment"># don&#x27;t actually care if we attend *from* padding tokens (only *to* padding)</span></span><br><span class="line">  <span class="comment"># tokens so we create a tensor of all ones.</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># `broadcast_ones` = [batch_size, from_seq_length, 1]</span></span><br><span class="line">  broadcast_ones = tf.ones(</span><br><span class="line">      shape=[batch_size, from_seq_length, <span class="number">1</span>], dtype=tf.float32)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Here we broadcast along two dimensions to create the mask.</span></span><br><span class="line">  <span class="comment"># 广播得到最后的 mask 矩阵 [batch_size, from_seq_length, to_seq_length]</span></span><br><span class="line">  mask = broadcast_ones * to_mask</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> mask</span><br></pre></td></tr></table></figure><h2 id="transformer_model"><a class="markdownIt-Anchor" href="#transformer_model"></a> transformer_model</h2><p>顾名思议 BERT 最核心的 Multi-headed, multi-layer<br />Transformer 实现过程。Attention is all you need 中的实现在 <a href="https://github.com/tensorflow/tensor2tensor/blob/master/tensor2tensor/models/transformer.py">链接</a></p><p>一个 Transformer 的示意图：</p><p><img src="https://media.xiang578.com/transformer-encoder.png" alt="" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">transformer_model</span>(<span class="params">input_tensor,</span></span><br><span class="line"><span class="params">                      attention_mask=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                      hidden_size=<span class="number">768</span>,</span></span><br><span class="line"><span class="params">                      num_hidden_layers=<span class="number">12</span>,</span></span><br><span class="line"><span class="params">                      num_attention_heads=<span class="number">12</span>,</span></span><br><span class="line"><span class="params">                      intermediate_size=<span class="number">3072</span>,</span></span><br><span class="line"><span class="params">                      intermediate_act_fn=gelu,</span></span><br><span class="line"><span class="params">                      hidden_dropout_prob=<span class="number">0.1</span>,</span></span><br><span class="line"><span class="params">                      attention_probs_dropout_prob=<span class="number">0.1</span>,</span></span><br><span class="line"><span class="params">                      initializer_range=<span class="number">0.02</span>,</span></span><br><span class="line"><span class="params">                      do_return_all_layers=<span class="literal">False</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Multi-headed, multi-layer Transformer from &quot;Attention is All You Need&quot;.</span></span><br><span class="line"><span class="string">  This is almost an exact implementation of the original Transformer encoder.</span></span><br><span class="line"><span class="string">  See the original paper:</span></span><br><span class="line"><span class="string">  https://arxiv.org/abs/1706.03762</span></span><br><span class="line"><span class="string">  Also see:</span></span><br><span class="line"><span class="string">  https://github.com/tensorflow/tensor2tensor/blob/master/tensor2tensor/models/transformer.py</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    input_tensor: float Tensor of shape [batch_size, seq_length, hidden_size].</span></span><br><span class="line"><span class="string">    attention_mask: (optional) int32 Tensor of shape [batch_size, seq_length,</span></span><br><span class="line"><span class="string">      seq_length], with 1 for positions that can be attended to and 0 in</span></span><br><span class="line"><span class="string">      positions that should not be. 就是前面 create_attention_mask_from_input_mask 产出的结果</span></span><br><span class="line"><span class="string">    hidden_size: int. Hidden size of the Transformer.</span></span><br><span class="line"><span class="string">    num_hidden_layers: int. Number of layers (blocks) in the Transformer.</span></span><br><span class="line"><span class="string">    num_attention_heads: int. Number of attention heads in the Transformer.</span></span><br><span class="line"><span class="string">    intermediate_size: int. The size of the &quot;intermediate&quot; (a.k.a., feed</span></span><br><span class="line"><span class="string">      forward) layer.</span></span><br><span class="line"><span class="string">    intermediate_act_fn: function. The non-linear activation function to apply</span></span><br><span class="line"><span class="string">      to the output of the intermediate/feed-forward layer.</span></span><br><span class="line"><span class="string">    hidden_dropout_prob: float. Dropout probability for the hidden layers.</span></span><br><span class="line"><span class="string">    attention_probs_dropout_prob: float. Dropout probability of the attention</span></span><br><span class="line"><span class="string">      probabilities.</span></span><br><span class="line"><span class="string">    initializer_range: float. Range of the initializer (stddev of truncated</span></span><br><span class="line"><span class="string">      normal).</span></span><br><span class="line"><span class="string">    do_return_all_layers: Whether to also return all layers or just the final</span></span><br><span class="line"><span class="string">      layer.</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    float Tensor of shape [batch_size, seq_length, hidden_size], the final</span></span><br><span class="line"><span class="string">    hidden layer of the Transformer.</span></span><br><span class="line"><span class="string">  Raises:</span></span><br><span class="line"><span class="string">    ValueError: A Tensor shape or parameter is invalid.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="comment"># 最终输出的 hidden_size 能被 num_attention_heads 整除</span></span><br><span class="line">  <span class="keyword">if</span> hidden_size % num_attention_heads != <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(</span><br><span class="line">        <span class="string">&quot;The hidden size (%d) is not a multiple of the number of attention &quot;</span></span><br><span class="line">        <span class="string">&quot;heads (%d)&quot;</span> % (hidden_size, num_attention_heads))</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 定义 attention 每个输出的头的大小</span></span><br><span class="line">  <span class="comment"># 最后结果 concat 之后和原始输入大小相同。</span></span><br><span class="line">  attention_head_size = <span class="built_in">int</span>(hidden_size / num_attention_heads)</span><br><span class="line">  input_shape = get_shape_list(input_tensor, expected_rank=<span class="number">3</span>)</span><br><span class="line">  batch_size = input_shape[<span class="number">0</span>]</span><br><span class="line">  seq_length = input_shape[<span class="number">1</span>]</span><br><span class="line">  input_width = input_shape[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># The Transformer performs sum residuals on all layers so the input needs</span></span><br><span class="line">  <span class="comment"># to be the same as the hidden size.</span></span><br><span class="line">  <span class="comment"># Transformer 中有残差连接，所以输入和输出 embedding size 要相同</span></span><br><span class="line">  <span class="keyword">if</span> input_width != hidden_size:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;The width of the input tensor (%d) != hidden size (%d)&quot;</span> %</span><br><span class="line">                     (input_width, hidden_size))</span><br><span class="line"></span><br><span class="line">  <span class="comment"># We keep the representation as a 2D tensor to avoid re-shaping it back and</span></span><br><span class="line">  <span class="comment"># forth from a 3D tensor to a 2D tensor. Re-shapes are normally free on</span></span><br><span class="line">  <span class="comment"># the GPU/CPU but may not be free on the TPU, so we want to minimize them to</span></span><br><span class="line">  <span class="comment"># help the optimizer.</span></span><br><span class="line">  <span class="comment"># TPU 不擅长 reshape 操作，所以把所有的 3D tensor 变成 2D tensor</span></span><br><span class="line">  prev_output = reshape_to_matrix(input_tensor)</span><br><span class="line"></span><br><span class="line">  all_layer_outputs = []</span><br><span class="line">  <span class="comment"># 遍历多层</span></span><br><span class="line">  <span class="keyword">for</span> layer_idx <span class="keyword">in</span> <span class="built_in">range</span>(num_hidden_layers):</span><br><span class="line">    <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;layer_%d&quot;</span> % layer_idx):</span><br><span class="line">      layer_input = prev_output</span><br><span class="line"></span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;attention&quot;</span>):</span><br><span class="line">        attention_heads = []</span><br><span class="line">        <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;self&quot;</span>):</span><br><span class="line">          attention_head = attention_layer(</span><br><span class="line">              from_tensor=layer_input,</span><br><span class="line">              to_tensor=layer_input,</span><br><span class="line">              attention_mask=attention_mask,</span><br><span class="line">              num_attention_heads=num_attention_heads,</span><br><span class="line">              size_per_head=attention_head_size,</span><br><span class="line">              attention_probs_dropout_prob=attention_probs_dropout_prob,</span><br><span class="line">              initializer_range=initializer_range,</span><br><span class="line">              do_return_2d_tensor=<span class="literal">True</span>,</span><br><span class="line">              batch_size=batch_size,</span><br><span class="line">              from_seq_length=seq_length,</span><br><span class="line">              to_seq_length=seq_length)</span><br><span class="line">          attention_heads.append(attention_head)</span><br><span class="line"></span><br><span class="line">        attention_output = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(attention_heads) == <span class="number">1</span>:</span><br><span class="line">          attention_output = attention_heads[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">          <span class="comment"># In the case where we have other sequences, we just concatenate</span></span><br><span class="line">          <span class="comment"># them to the self-attention head before the projection.</span></span><br><span class="line">          <span class="comment"># concat 多头的结果</span></span><br><span class="line">          attention_output = tf.concat(attention_heads, axis=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Run a linear projection of `hidden_size` then add a residual</span></span><br><span class="line">        <span class="comment"># with `layer_input`. 加上残差</span></span><br><span class="line">        <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;output&quot;</span>):</span><br><span class="line">          attention_output = tf.layers.dense(</span><br><span class="line">              attention_output,</span><br><span class="line">              hidden_size,</span><br><span class="line">              kernel_initializer=create_initializer(initializer_range))</span><br><span class="line">          <span class="comment"># dropout 和 layer_norm</span></span><br><span class="line">          attention_output = dropout(attention_output, hidden_dropout_prob)</span><br><span class="line">          attention_output = layer_norm(attention_output + layer_input)</span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 全连接层</span></span><br><span class="line">      <span class="comment"># The activation is only applied to the &quot;intermediate&quot; hidden layer.</span></span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;intermediate&quot;</span>):</span><br><span class="line">        intermediate_output = tf.layers.dense(</span><br><span class="line">            attention_output,</span><br><span class="line">            intermediate_size,</span><br><span class="line">            activation=intermediate_act_fn,</span><br><span class="line">            kernel_initializer=create_initializer(initializer_range))</span><br><span class="line">    </span><br><span class="line">      <span class="comment"># 变回原来的大小，才能加上残差</span></span><br><span class="line">      <span class="comment"># Down-project back to `hidden_size` then add the residual.</span></span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;output&quot;</span>):</span><br><span class="line">        layer_output = tf.layers.dense(</span><br><span class="line">            intermediate_output,</span><br><span class="line">            hidden_size,</span><br><span class="line">            kernel_initializer=create_initializer(initializer_range))</span><br><span class="line">        layer_output = dropout(layer_output, hidden_dropout_prob)</span><br><span class="line">        layer_output = layer_norm(layer_output + attention_output)</span><br><span class="line">        prev_output = layer_output</span><br><span class="line">        all_layer_outputs.append(layer_output)</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 是不是要输出中间结果</span></span><br><span class="line">  <span class="keyword">if</span> do_return_all_layers:</span><br><span class="line">    final_outputs = []</span><br><span class="line">    <span class="keyword">for</span> layer_output <span class="keyword">in</span> all_layer_outputs:</span><br><span class="line">      final_output = reshape_from_matrix(layer_output, input_shape)</span><br><span class="line">      final_outputs.append(final_output)</span><br><span class="line">    <span class="keyword">return</span> final_outputs</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    final_output = reshape_from_matrix(prev_output, input_shape)</span><br><span class="line">    <span class="keyword">return</span> final_output</span><br></pre></td></tr></table></figure><h2 id="attention_layer"><a class="markdownIt-Anchor" href="#attention_layer"></a> attention_layer</h2><p><code>attention_layer</code> 中实现 self-attention 和 multi-head，细节在 「Attention is all your need」里面有。query_layer 由 from_tensor 得到，key_layer 和 value_layer 由 to_tensor 得到。由于是 self-attention-encoder，from_tensor 和 to_tensor 相同。</p><p>示意图：</p><p><img src="https://media.xiang578.com/self-attention-and-multi-head.png" alt="" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">attention_layer</span>(<span class="params">from_tensor,</span></span><br><span class="line"><span class="params">                    to_tensor,</span></span><br><span class="line"><span class="params">                    attention_mask=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    num_attention_heads=<span class="number">1</span>,</span></span><br><span class="line"><span class="params">                    size_per_head=<span class="number">512</span>,</span></span><br><span class="line"><span class="params">                    query_act=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    key_act=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    value_act=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    attention_probs_dropout_prob=<span class="number">0.0</span>,</span></span><br><span class="line"><span class="params">                    initializer_range=<span class="number">0.02</span>,</span></span><br><span class="line"><span class="params">                    do_return_2d_tensor=<span class="literal">False</span>,</span></span><br><span class="line"><span class="params">                    batch_size=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    from_seq_length=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    to_seq_length=<span class="literal">None</span></span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;Performs multi-headed attention from `from_tensor` to `to_tensor`.</span></span><br><span class="line"><span class="string">  This is an implementation of multi-headed attention based on &quot;Attention</span></span><br><span class="line"><span class="string">  is all you Need&quot;. If `from_tensor` and `to_tensor` are the same, then</span></span><br><span class="line"><span class="string">  this is self-attention. Each timestep in `from_tensor` attends to the</span></span><br><span class="line"><span class="string">  corresponding sequence in `to_tensor`, and returns a fixed-with vector.</span></span><br><span class="line"><span class="string">  This function first projects `from_tensor` into a &quot;query&quot; tensor and</span></span><br><span class="line"><span class="string">  `to_tensor` into &quot;key&quot; and &quot;value&quot; tensors. These are (effectively) a list</span></span><br><span class="line"><span class="string">  of tensors of length `num_attention_heads`, where each tensor is of shape</span></span><br><span class="line"><span class="string">  [batch_size, seq_length, size_per_head].</span></span><br><span class="line"><span class="string">  Then, the query and key tensors are dot-producted and scaled. These are</span></span><br><span class="line"><span class="string">  softmaxed to obtain attention probabilities. The value tensors are then</span></span><br><span class="line"><span class="string">  interpolated by these probabilities, then concatenated back to a single</span></span><br><span class="line"><span class="string">  tensor and returned.</span></span><br><span class="line"><span class="string">  In practice, the multi-headed attention are done with transposes and</span></span><br><span class="line"><span class="string">  reshapes rather than actual separate tensors.</span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    from_tensor: float Tensor of shape [batch_size, from_seq_length,</span></span><br><span class="line"><span class="string">      from_width].</span></span><br><span class="line"><span class="string">    to_tensor: float Tensor of shape [batch_size, to_seq_length, to_width].</span></span><br><span class="line"><span class="string">    attention_mask: (optional) int32 Tensor of shape [batch_size,</span></span><br><span class="line"><span class="string">      from_seq_length, to_seq_length]. The values should be 1 or 0. The</span></span><br><span class="line"><span class="string">      attention scores will effectively be set to -infinity for any positions in</span></span><br><span class="line"><span class="string">      the mask that are 0, and will be unchanged for positions that are 1.</span></span><br><span class="line"><span class="string">    num_attention_heads: int. Number of attention heads.</span></span><br><span class="line"><span class="string">    size_per_head: int. Size of each attention head.</span></span><br><span class="line"><span class="string">    query_act: (optional) Activation function for the query transform.</span></span><br><span class="line"><span class="string">    key_act: (optional) Activation function for the key transform.</span></span><br><span class="line"><span class="string">    value_act: (optional) Activation function for the value transform.</span></span><br><span class="line"><span class="string">    attention_probs_dropout_prob: (optional) float. Dropout probability of the</span></span><br><span class="line"><span class="string">      attention probabilities.</span></span><br><span class="line"><span class="string">    initializer_range: float. Range of the weight initializer.</span></span><br><span class="line"><span class="string">    do_return_2d_tensor: bool. If True, the output will be of shape [batch_size</span></span><br><span class="line"><span class="string">      * from_seq_length, num_attention_heads * size_per_head]. If False, the</span></span><br><span class="line"><span class="string">      output will be of shape [batch_size, from_seq_length, num_attention_heads</span></span><br><span class="line"><span class="string">      * size_per_head].</span></span><br><span class="line"><span class="string">    batch_size: (Optional) int. If the input is 2D, this might be the batch size</span></span><br><span class="line"><span class="string">      of the 3D version of the `from_tensor` and `to_tensor`.</span></span><br><span class="line"><span class="string">    from_seq_length: (Optional) If the input is 2D, this might be the seq length</span></span><br><span class="line"><span class="string">      of the 3D version of the `from_tensor`.</span></span><br><span class="line"><span class="string">    to_seq_length: (Optional) If the input is 2D, this might be the seq length</span></span><br><span class="line"><span class="string">      of the 3D version of the `to_tensor`.</span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    float Tensor of shape [batch_size, from_seq_length,</span></span><br><span class="line"><span class="string">      num_attention_heads * size_per_head]. (If `do_return_2d_tensor` is</span></span><br><span class="line"><span class="string">      true, this will be of shape [batch_size * from_seq_length,</span></span><br><span class="line"><span class="string">      num_attention_heads * size_per_head]).</span></span><br><span class="line"><span class="string">  Raises:</span></span><br><span class="line"><span class="string">    ValueError: Any of the arguments or tensor shapes are invalid.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">transpose_for_scores</span>(<span class="params">input_tensor, batch_size, num_attention_heads,</span></span><br><span class="line"><span class="params">                           seq_length, width</span>):</span><br><span class="line">    output_tensor = tf.reshape(</span><br><span class="line">        input_tensor, [batch_size, seq_length, num_attention_heads, width])</span><br><span class="line"></span><br><span class="line">    output_tensor = tf.transpose(output_tensor, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]) <span class="comment">#[batch_size,  num_attention_heads, seq_length, width]</span></span><br><span class="line">    <span class="keyword">return</span> output_tensor</span><br><span class="line"></span><br><span class="line">  from_shape = get_shape_list(from_tensor, expected_rank=[<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">  to_shape = get_shape_list(to_tensor, expected_rank=[<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(from_shape) != <span class="built_in">len</span>(to_shape):</span><br><span class="line">    <span class="keyword">raise</span> ValueError(</span><br><span class="line">        <span class="string">&quot;The rank of `from_tensor` must match the rank of `to_tensor`.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(from_shape) == <span class="number">3</span>:</span><br><span class="line">    batch_size = from_shape[<span class="number">0</span>]</span><br><span class="line">    from_seq_length = from_shape[<span class="number">1</span>]</span><br><span class="line">    to_seq_length = to_shape[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">elif</span> <span class="built_in">len</span>(from_shape) == <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">if</span> (batch_size <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> from_seq_length <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> to_seq_length <span class="keyword">is</span> <span class="literal">None</span>):</span><br><span class="line">      <span class="keyword">raise</span> ValueError(</span><br><span class="line">          <span class="string">&quot;When passing in rank 2 tensors to attention_layer, the values &quot;</span></span><br><span class="line">          <span class="string">&quot;for `batch_size`, `from_seq_length`, and `to_seq_length` &quot;</span></span><br><span class="line">          <span class="string">&quot;must all be specified.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Scalar dimensions referenced here:</span></span><br><span class="line">  <span class="comment">#   B = batch size (number of sequences) </span></span><br><span class="line">  <span class="comment">#   F = `from_tensor` sequence length 输入单词长度</span></span><br><span class="line">  <span class="comment">#   T = `to_tensor` sequence length 输出单词长度</span></span><br><span class="line">  <span class="comment">#   N = `num_attention_heads`</span></span><br><span class="line">  <span class="comment">#   H = `size_per_head`</span></span><br><span class="line"></span><br><span class="line">  from_tensor_2d = reshape_to_matrix(from_tensor) <span class="comment"># [B*F，hidden_size=N*H]</span></span><br><span class="line">  to_tensor_2d = reshape_to_matrix(to_tensor) <span class="comment"># [B*T，head_size=N*H]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># `query_layer` = [B*F, N*H] 从 from_tensor 得到 query_layer</span></span><br><span class="line">  query_layer = tf.layers.dense(</span><br><span class="line">      from_tensor_2d,</span><br><span class="line">      num_attention_heads * size_per_head,</span><br><span class="line">      activation=query_act,</span><br><span class="line">      name=<span class="string">&quot;query&quot;</span>,</span><br><span class="line">      kernel_initializer=create_initializer(initializer_range))</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `key_layer` = [B*T, N*H]</span></span><br><span class="line">  key_layer = tf.layers.dense(</span><br><span class="line">      to_tensor_2d,</span><br><span class="line">      num_attention_heads * size_per_head,</span><br><span class="line">      activation=key_act,</span><br><span class="line">      name=<span class="string">&quot;key&quot;</span>,</span><br><span class="line">      kernel_initializer=create_initializer(initializer_range))</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `value_layer` = [B*T, N*H]</span></span><br><span class="line">  value_layer = tf.layers.dense(</span><br><span class="line">      to_tensor_2d,</span><br><span class="line">      num_attention_heads * size_per_head,</span><br><span class="line">      activation=value_act,</span><br><span class="line">      name=<span class="string">&quot;value&quot;</span>,</span><br><span class="line">      kernel_initializer=create_initializer(initializer_range))</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 计算多头调整 tensor shape，都是为了方便计算.变成 [batch_size,  num_attention_heads, seq_length, width]</span></span><br><span class="line">  <span class="comment"># `query_layer` = [B, N, F, H]</span></span><br><span class="line">  query_layer = transpose_for_scores(query_layer, batch_size,</span><br><span class="line">                                     num_attention_heads, from_seq_length,</span><br><span class="line">                                     size_per_head)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `key_layer` = [B, N, T, H]</span></span><br><span class="line">  key_layer = transpose_for_scores(key_layer, batch_size, num_attention_heads,</span><br><span class="line">                                   to_seq_length, size_per_head)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Take the dot product between &quot;query&quot; and &quot;key&quot; to get the raw</span></span><br><span class="line">  <span class="comment"># attention scores.</span></span><br><span class="line">  <span class="comment"># `attention_scores` = [B, N, F, T] =&gt; [F, H] * [H, T] = [F, T]</span></span><br><span class="line">  attention_scores = tf.matmul(query_layer, key_layer, transpose_b=<span class="literal">True</span>)</span><br><span class="line">  attention_scores = tf.multiply(attention_scores,</span><br><span class="line">                                 <span class="number">1.0</span> / math.sqrt(<span class="built_in">float</span>(size_per_head))) <span class="comment"># 经典缩小 scroe 值，防止落到 softmask 梯度饱和区</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 处理 padding 部分的 score 值， padding 为 0 的在对应的位置上加上 -10000.0， 这样求 exp 之后就是一个接近于 0 的值</span></span><br><span class="line">  <span class="keyword">if</span> attention_mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># `attention_mask` = [B, 1, F, T]</span></span><br><span class="line">    attention_mask = tf.expand_dims(attention_mask, axis=[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Since attention_mask is 1.0 for positions we want to attend and 0.0 for</span></span><br><span class="line">    <span class="comment"># masked positions, this operation will create a tensor which is 0.0 for</span></span><br><span class="line">    <span class="comment"># positions we want to attend and -10000.0 for masked positions.</span></span><br><span class="line">    adder = (<span class="number">1.0</span> - tf.cast(attention_mask, tf.float32)) * -<span class="number">10000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Since we are adding it to the raw scores before the softmax, this is</span></span><br><span class="line">    <span class="comment"># effectively the same as removing these entirely.</span></span><br><span class="line">    attention_scores += adder</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Normalize the attention scores to probabilities.</span></span><br><span class="line">  <span class="comment"># `attention_probs` = [B, N, F, T]</span></span><br><span class="line">  attention_probs = tf.nn.softmax(attention_scores)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># This is actually dropping out entire tokens to attend to, which might</span></span><br><span class="line">  <span class="comment"># seem a bit unusual, but is taken from the original Transformer paper.</span></span><br><span class="line">  attention_probs = dropout(attention_probs, attention_probs_dropout_prob)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `value_layer` = [B, T, N, H]</span></span><br><span class="line">  value_layer = tf.reshape(</span><br><span class="line">      value_layer,</span><br><span class="line">      [batch_size, to_seq_length, num_attention_heads, size_per_head])</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `value_layer` = [B, N, T, H]</span></span><br><span class="line">  value_layer = tf.transpose(value_layer, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">  <span class="comment"># attention 之后的结果</span></span><br><span class="line">  <span class="comment"># `context_layer` = [B, N, F, H]</span></span><br><span class="line">  context_layer = tf.matmul(attention_probs, value_layer)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># `context_layer` = [B, F, N, H]</span></span><br><span class="line">  context_layer = tf.transpose(context_layer, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> do_return_2d_tensor:</span><br><span class="line">    <span class="comment"># `context_layer` = [B*F, N*H]</span></span><br><span class="line">    context_layer = tf.reshape(</span><br><span class="line">        context_layer,</span><br><span class="line">        [batch_size * from_seq_length, num_attention_heads * size_per_head])</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># `context_layer` = [B, F, N*H]</span></span><br><span class="line">    context_layer = tf.reshape(</span><br><span class="line">        context_layer,</span><br><span class="line">        [batch_size, from_seq_length, num_attention_heads * size_per_head])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> context_layer</span><br></pre></td></tr></table></figure><h2 id="bertmodel-构造类"><a class="markdownIt-Anchor" href="#bertmodel-构造类"></a> BertModel 构造类</h2><p>init 方法就是将上面的内容串联起来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,</span></span><br><span class="line"><span class="params">               config,</span></span><br><span class="line"><span class="params">               is_training,</span></span><br><span class="line"><span class="params">               input_ids,</span></span><br><span class="line"><span class="params">               input_mask=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">               token_type_ids=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">               use_one_hot_embeddings=<span class="literal">False</span>,</span></span><br><span class="line"><span class="params">               scope=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Constructor for BertModel.</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      config: `BertConfig` instance.</span></span><br><span class="line"><span class="string">      is_training: bool. true for training model, false for eval model. Controls</span></span><br><span class="line"><span class="string">        whether dropout will be applied.</span></span><br><span class="line"><span class="string">      input_ids: int32 Tensor of shape [batch_size, seq_length].</span></span><br><span class="line"><span class="string">      input_mask: (optional) int32 Tensor of shape [batch_size, seq_length].</span></span><br><span class="line"><span class="string">      token_type_ids: (optional) int32 Tensor of shape [batch_size, seq_length].</span></span><br><span class="line"><span class="string">      use_one_hot_embeddings: (optional) bool. Whether to use one-hot word</span></span><br><span class="line"><span class="string">        embeddings or tf.embedding_lookup() for the word embeddings.</span></span><br><span class="line"><span class="string">      scope: (optional) variable scope. Defaults to &quot;bert&quot;.</span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">      ValueError: The config is invalid or one of the input tensor shapes</span></span><br><span class="line"><span class="string">        is invalid.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    config = copy.deepcopy(config)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_training:</span><br><span class="line">      config.hidden_dropout_prob = <span class="number">0.0</span></span><br><span class="line">      config.attention_probs_dropout_prob = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    input_shape = get_shape_list(input_ids, expected_rank=<span class="number">2</span>)</span><br><span class="line">    batch_size = input_shape[<span class="number">0</span>]</span><br><span class="line">    seq_length = input_shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> input_mask <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      input_mask = tf.ones(shape=[batch_size, seq_length], dtype=tf.int32)</span><br><span class="line">    <span class="comment"># 处理 embedding</span></span><br><span class="line">    <span class="keyword">if</span> token_type_ids <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">      token_type_ids = tf.zeros(shape=[batch_size, seq_length], dtype=tf.int32)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> tf.variable_scope(scope, default_name=<span class="string">&quot;bert&quot;</span>):</span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;embeddings&quot;</span>):</span><br><span class="line">        <span class="comment"># Perform embedding lookup on the word ids.</span></span><br><span class="line">        (self.embedding_output, self.embedding_table) = embedding_lookup(</span><br><span class="line">            input_ids=input_ids,</span><br><span class="line">            vocab_size=config.vocab_size,</span><br><span class="line">            embedding_size=config.hidden_size,</span><br><span class="line">            initializer_range=config.initializer_range,</span><br><span class="line">            word_embedding_name=<span class="string">&quot;word_embeddings&quot;</span>,</span><br><span class="line">            use_one_hot_embeddings=use_one_hot_embeddings)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Add positional embeddings and token type embeddings, then layer</span></span><br><span class="line">        <span class="comment"># normalize and perform dropout.</span></span><br><span class="line">        self.embedding_output = embedding_postprocessor(</span><br><span class="line">            input_tensor=self.embedding_output,</span><br><span class="line">            use_token_type=<span class="literal">True</span>,</span><br><span class="line">            token_type_ids=token_type_ids,</span><br><span class="line">            token_type_vocab_size=config.type_vocab_size,</span><br><span class="line">            token_type_embedding_name=<span class="string">&quot;token_type_embeddings&quot;</span>,</span><br><span class="line">            use_position_embeddings=<span class="literal">True</span>,</span><br><span class="line">            position_embedding_name=<span class="string">&quot;position_embeddings&quot;</span>,</span><br><span class="line">            initializer_range=config.initializer_range,</span><br><span class="line">            max_position_embeddings=config.max_position_embeddings,</span><br><span class="line">            dropout_prob=config.hidden_dropout_prob)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;encoder&quot;</span>):</span><br><span class="line">        <span class="comment"># This converts a 2D mask of shape [batch_size, seq_length] to a 3D</span></span><br><span class="line">        <span class="comment"># mask of shape [batch_size, seq_length, seq_length] which is used</span></span><br><span class="line">        <span class="comment"># for the attention scores. 获得 attention_mask</span></span><br><span class="line">        attention_mask = create_attention_mask_from_input_mask(</span><br><span class="line">            input_ids, input_mask)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Run the stacked transformer. 计算 transformer 的结果</span></span><br><span class="line">        <span class="comment"># `sequence_output` shape = [batch_size, seq_length, hidden_size].</span></span><br><span class="line">        self.all_encoder_layers = transformer_model(</span><br><span class="line">            input_tensor=self.embedding_output,</span><br><span class="line">            attention_mask=attention_mask,</span><br><span class="line">            hidden_size=config.hidden_size,</span><br><span class="line">            num_hidden_layers=config.num_hidden_layers,</span><br><span class="line">            num_attention_heads=config.num_attention_heads,</span><br><span class="line">            intermediate_size=config.intermediate_size,</span><br><span class="line">            intermediate_act_fn=get_activation(config.hidden_act),</span><br><span class="line">            hidden_dropout_prob=config.hidden_dropout_prob,</span><br><span class="line">            attention_probs_dropout_prob=config.attention_probs_dropout_prob,</span><br><span class="line">            initializer_range=config.initializer_range,</span><br><span class="line">            do_return_all_layers=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">      self.sequence_output = self.all_encoder_layers[-<span class="number">1</span>]</span><br><span class="line">      <span class="comment"># The &quot;pooler&quot; converts the encoded sequence tensor of shape</span></span><br><span class="line">      <span class="comment"># [batch_size, seq_length, hidden_size] to a tensor of shape</span></span><br><span class="line">      <span class="comment"># [batch_size, hidden_size]. This is necessary for segment-level</span></span><br><span class="line">      <span class="comment"># (or segment-pair-level) classification tasks where we need a fixed</span></span><br><span class="line">      <span class="comment"># dimensional representation of the segment.</span></span><br><span class="line">      <span class="comment"># 分类任务取第一个 [CLS] 对应的 embedding 值</span></span><br><span class="line">      <span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;pooler&quot;</span>):</span><br><span class="line">        <span class="comment"># We &quot;pool&quot; the model by simply taking the hidden state corresponding</span></span><br><span class="line">        <span class="comment"># to the first token. We assume that this has been pre-trained</span></span><br><span class="line">        first_token_tensor = tf.squeeze(self.sequence_output[:, <span class="number">0</span>:<span class="number">1</span>, :], axis=<span class="number">1</span>)</span><br><span class="line">        self.pooled_output = tf.layers.dense(</span><br><span class="line">            first_token_tensor,</span><br><span class="line">            config.hidden_size,</span><br><span class="line">            activation=tf.tanh,</span><br><span class="line">            kernel_initializer=create_initializer(config.initializer_range))</span><br></pre></td></tr></table></figure><h2 id="模型使用"><a class="markdownIt-Anchor" href="#模型使用"></a> 模型使用</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Already been converted into WordPiece token ids</span></span><br><span class="line">input_ids = tf.constant([[<span class="number">31</span>, <span class="number">51</span>, <span class="number">99</span>], [<span class="number">15</span>, <span class="number">5</span>, <span class="number">0</span>]])</span><br><span class="line">input_mask = tf.constant([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>]])</span><br><span class="line">token_type_ids = tf.constant([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line">config = modeling.BertConfig(vocab_size=<span class="number">32000</span>, hidden_size=<span class="number">512</span>,</span><br><span class="line">  num_hidden_layers=<span class="number">8</span>, num_attention_heads=<span class="number">6</span>, intermediate_size=<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># 调用模型</span></span><br><span class="line">model = modeling.BertModel(config=config, is_training=<span class="literal">True</span>,</span><br><span class="line">  input_ids=input_ids, input_mask=input_mask, token_type_ids=token_type_ids)</span><br><span class="line">label_embeddings = tf.get_variable(...)</span><br><span class="line">pooled_output = model.get_pooled_output()</span><br><span class="line">logits = tf.matmul(pooled_output, label_embeddings)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="bert-参数量计算"><a class="markdownIt-Anchor" href="#bert-参数量计算"></a> Bert 参数量计算</h2><p>回到写这篇文章的起点，最后通过计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>E</mi><mi>R</mi><msub><mi>T</mi><mrow><mi>B</mi><mi>A</mi><mi>S</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BERT_{BASE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的参数量，加深对模型的理解。论文介绍 Layer = 12，Hidden Size = 768，multi head = 12，参数量是 110M 左右。</p><p>总的计算公式为 <code>(30522 + 512 + 2)*768 + 768*2 + (3*768*64*12 + 3*64*12 + 64*768*12 + 768 + 768 + 768 + 768*3072 + 3072 + 3072*768 + 768 + 768 + 768) * 12 = 108891648</code></p><ul><li>embedding 部分 <code>(30522 + 512 + 2)*768 + 768*2</code><ul><li>embedding size = 768</li><li>单词数仅有 30522，比起 CTR 几千万的物品还是少很多。</li><li>position size = 512</li><li>sentence size = 2</li><li>三个 embedding 相加后 Norm 的参数 2</li></ul></li><li>multi attention 部分 <code>(3*768*64*12 + 3*64*12 + 64*768*12 + 768 + 768 + 768 + 768*3072 + 3072 + 3072*768 + 768 + 768 + 768) * 12</code><ul><li>一共是 12 层，对应 12 个 Transformer</li><li><code>3*768*64*12 + 3*64*12</code> 12 个 multi-head 对应的 Q K V 参数</li><li><code>64*768*12 + 768 + 768 + 768</code> multi-head 结果 concat 之后接的全连接层参数以及后面的 norm</li><li><code>768*3072 + 3072 + 3072*768 + 768 + 768 + 768</code> FFN 以及 norm 的参数</li></ul></li></ul><h2 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> Ref</h2><ul><li><a href="http://fancyerii.github.io/2019/03/09/bert-codes/">BERT代码阅读 - 李理的博客</a></li><li><a href="https://lsc417.com/2020/06/19/bert_parameter/">BERT encoder参数量计算 | 417’s blog</a></li><li><a href="https://zhuanlan.zhihu.com/p/69106080">BERT源码分析PART I - 知乎</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;国庆节前突然对如何计算 BERT 的参数量感兴趣，不过一直看不明白网上的计算过程，索性下载 BERT 源代码阅读一番。这篇文章记录阅读 BertModel 类（核心代码实现）时写的一些笔记，反正我也是纸上谈兵，所以不需要太关注数据处理和 Finetune 相关部分，最后附上计算 BERT 参数量的过程仅供参考。&lt;/p&gt;</summary>
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="nlp" scheme="https://blog.xiang578.com/tags/nlp/"/>
    
    <category term="google" scheme="https://blog.xiang578.com/tags/google/"/>
    
    <category term="bert" scheme="https://blog.xiang578.com/tags/bert/"/>
    
    <category term="code" scheme="https://blog.xiang578.com/tags/code/"/>
    
    <category term="transformer" scheme="https://blog.xiang578.com/tags/transformer/"/>
    
  </entry>
  
  <entry>
    <title>【Never Reading】 202008 选择记忆</title>
    <link href="https://blog.xiang578.com/post/Never-Reading-202008.html"/>
    <id>https://blog.xiang578.com/post/Never-Reading-202008.html</id>
    <published>2020-09-13T15:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>某一刻突然意识到可以选择自己的记忆，我顿悟了。</p><span id="more"></span><h2 id="roam-cn-聚会"><a class="markdownIt-Anchor" href="#roam-cn-聚会"></a> Roam CN 聚会</h2><p>8 月 29 日参与由 <a href="https://twitter.com/JESSCATE93">Jessie@FG</a>发起一次北京 RoamCN 微信群聚会，其他到场的还有 <a href="https://twitter.com/pimgeek">pimgeek</a>、<a href="http://flynngao.github.io/about">Flynn</a> 等 7 位群友。聚会中大家讨论和知识管理、Roam Research 相关的内容。记录一些给我灵感的内容：</p><h3 id="anki"><a class="markdownIt-Anchor" href="#anki"></a> Anki</h3><p>做为一个知识管理爱好者，很难没有听说过 Anki。这一次线下的相关内容讨论，给我留下的最大感受就是本期标题的由来「选择记忆」。Flynn 介绍在 Michael Nielsen 的 <a href="http://augmentingcognition.com/ltm.html">Augmenting Long-term Memory</a> ，一直坚持使用 Anki，他举的例子是「可以记住全部的正则匹配」。和绝大部分人一样，我记忆内容的方式就是看一遍，然后等到要用的时候，再去查相关的内容。Anki 可以自己制作需要记忆内容的卡片，这个过程不就是选择自己的记忆吗？其实几年前也看过 Michael Nielsen 的文章，可能是当时境界太低，没有理解选择记忆对自己的重要性。现在觉得有几点很重要：</p><ol><li>自己制作卡片，网上下载的卡片没有灵魂。</li><li>卡片尽量原子化，使用 QA 形式。原子化保证没一张可以快速过去，QA 形式费曼技巧，防止假懂。</li><li>坚持使用。</li></ol><p>等到自制卡片能到达 1k 张，再来具体分享自己的体验。</p><p>Michael Nielsen 的文章实在是太长了，先分享第一部分的摘录：</p><ul><li>之前看过中文翻译但是没有实践 <a href="https://zhuanlan.zhihu.com/p/65131722">【三万字长文】量子物理学家是如何使用 Anki 的？ - 知乎</a></li><li>Solomon Shereshevsky 以超级记忆力闻名</li><li>memex 外部记忆机器，汇总全部个人资料<ul><li>[[Douglas Engelbart]] augmentation of human intelligence</li><li>[[Ted Nelson]] [[Project Xanadu]]</li><li>Tim Berners-Lee world wide web</li></ul></li><li>Anki makes memory a <strong>choice</strong>, rather than a haphazard event, to be left to chance.</li><li>But, as we shall see, there are already powerful ideas about personal memory systems based solely on the structuring and presentation of information. 从信息组织和展示的角度入手。</li><li>Anki 卡片之间的复习间隔时间<ul><li>一张卡片在 20 年间需要花费 4-7 分钟去记忆</li></ul></li><li>制作卡片的标准，Anki make memory a choice：你可以选择自己记忆的内容<ul><li>if memorizing a fact seems worth 10 minutes of my time in the future, then I do it</li><li>superseding the first, if a fact seems striking then into Anki it goes, regardless of whether it seems worth 10 minutes of my future time or not.</li></ul></li><li>尝试使用 Anki 很不容易，通过学习 Unix 命令掌握需要的技巧。可以把之前 [[Vim 实用技巧]] 拆解到 Anki 中。</li><li>用 QA  的形式来使用 Anki</li><li>Using Anki to thoroughly read a research paper in an unfamiliar field<ul><li>[[AlphaGo]]还记得多少？</li><li>举例的问题<ul><li>“What’s the size of a Go board?”;</li><li>“Who plays first in Go?”;</li><li>“How many human game positions did AlphaGo learn from?”;</li><li>“Where did AlphaGo get its training data?”;</li><li>“What were the names of the two main types of neural network AlphaGo used?”</li></ul></li><li>多轮记录问题</li><li>通过一年之后阅读 [[AlphaGo Zero]] 检验记忆效果</li><li>I find Anki works much better when used in service to some personal creative project.</li><li>为了一个明确目标去设置 Anki 的问题，没有温度。<ul><li>when I’m reading in support of some creative project, I ask much better Anki questions.</li></ul></li></ul></li><li>Using Anki to do shallow reads of papers [[how to read a paper]](10 to 60 minutes Ankifying a paper)<ul><li>基于主题去阅读论文，读重要的论文。</li><li>选择性阅读，记录关键。I’ll add to Anki questions about the core claims, core questions, and core ideas of the paper.</li><li>一篇论文 5 到 20 个问题。</li><li>避免 Anki 化有误导性的条目，仔细选择提问的方法。<ul><li>“What does Jones 2011 claim is the average age at which physics Nobelists made their prizewinning discovery, over 1980-2011?” (Answer: 48).</li><li>“Which paper claimed that physics Nobelists made their prizewinning discovery at average age 48, over the period 1980-2011?” (Answer: Jones 2011).</li></ul></li><li>Ankifying figures：知道某张图存在，然后参考。<ul><li>曲线大概走向？</li><li>图表细节</li></ul></li></ul></li><li>Syntopic reading using Anki<ul><li>从 key paper 出发，best 5-10 paper，普通的论文也有助于认识整个领域。</li><li>Anki 从设计上不是为了创造性工作而生。</li><li>Anki 创造理解新领域的机会。</li></ul></li><li>More patterns of Anki use<ul><li><a href="https://www.supermemo.com/en/archives1990-2015/articles/20rules">Effective learning: Twenty rules of formulating knowledge</a></li><li>原子化 <strong>Make most Anki questions and answers as atomic as possible</strong><ul><li>How to create a soft link from linkname to filename?<ul><li><code>ln -s filename linkname</code></li><li>根据答案分解成两部分。</li></ul></li><li>回答错原子化问题，能更清楚在哪一方面不足。</li></ul></li><li>追求大师级使用 <strong>Anki use is best thought of as a virtuoso skill, to be developed:</strong><ul><li>软件简单，但是功能强大。</li><li>你就是创造者。</li></ul></li><li>一个卡组 <strong>Use one big deck</strong><ul><li>不同知识混合在一起，会产生意想不到的结果。</li></ul></li><li>避免临时感兴趣的话题 <strong>Avoid orphan questions</strong></li><li><strong>95% of Anki’s value comes from 5% of the features</strong></li><li><strong>Using Anki for APIs, books, videos, seminars, conversations, the web, events, and places</strong><ul><li>研讨会记录 3 个左右高质量的问题。</li><li>有选择记忆 unmindfully Ankifying everything in sight is a bad habit</li><li>Ankify things that serve your long-term goals</li><li>Anki 之前读过的书或者论文</li></ul></li><li>避免判断题</li><li>创造性工作需要内化理解部分知识。<ul><li>知识的流畅度 Fluency matters in thinking。</li></ul></li><li>为什么 Anki 不火？<strong>If personal memory systems are so great, why aren’t they more widely used?</strong><ul><li>人们更喜欢临时报佛脚。In experimental research on memory, people consistently underestimate the gains that come from distributing their study in a manner similar to Anki. Instead, they prefer last-minute cramming, and believe it produces better results, though many studies show it does not.</li><li>理想难度原理 The psychologist Robert Bjork has suggested the “principle of desirable difficulty”, the idea that memories are maximally strengthened if tested when we’re on the verge of forgetting them. This suggests that an efficient memory system will intrinsically be somewhat difficult to use. Human beings have a complex relationship to difficult activities, and often dislike performing them, unless strongly motivated (in which case they may become pleasurable).</li><li>用好很难。Systems such as Anki are challenging to use well, and easy to use poorly.</li></ul></li></ul></li></ul><p>最后，Michael Nielsen 在文章中提到 AlphaGo，分享一个这个相关的例子：</p><p><a href="https://twitter.com/xiang578/status/1300068256045129728">RyenX 算法花园 在 Twitter: “几周前和大老板开会，他突然问我们一个问题，总结一下就是知识层次。 第一层：alpha go 和 alpha zero 的策略网络是如何训练的？（go 学习获胜的下法，zero 学习分布） 第二层：为什么会产出这样的区别？ 第三层：那么这和我们的业务中什么类似？” / Twitter</a></p><h3 id="zettelkasten"><a class="markdownIt-Anchor" href="#zettelkasten"></a> Zettelkasten</h3><p>最近中文圈比较火的概念，我也多次在 「Never Reading」分享相关的内容。Flynn 在聚会中也分享自己之前写过的一篇文章 <a href="http://flynngao.github.io/2020/07/18/zettelkasten-1">拆解Zettelkasten | 卡片盒知识管理体系实践反思 - Flynn</a>，摘录相关的内容：</p><ul><li>工作流和笔记方式</li><li>Zettelkasten 认可思考的非线性特征，给出了一种脱离现有顺序框架的方式。</li><li><strong>本来就没有一个完整的知识管理工作流。</strong> 如何判断<ul><li>是否在各种情景下都可以使用有效方式捕捉素材？</li><li>是否对待读材料有合适的管理方式？是否能够不定期清空待读材料？</li><li>是否建立了自己的关注领域清单，并且建立对应的项目？</li><li>是否知道如何为任何项目快速建立下一步行动？</li><li>是否有种合理的方式检验自己对知识的理解？</li><li>是否确认现有正在执行系统/习惯能可以长期执行？</li><li>是否确定现有系统在遭遇中断甚至奔溃之后可以很快恢复？</li></ul></li><li>[[Evergreen Note]] 比 Permanent Notes 更合适<ul><li>以能够直接公布为目的逻辑完备的小文章，并且需要不停的更新他们之间的可能存在的逻辑关系，共同点，冲突点。<ul><li>笔记可以直接公开，比如 [[Andy Matuschak]]</li></ul></li><li>写作当做最重要的事情</li><li>引用 [[Simon Eskildsen]] <a href="https://superorganizers.substack.com/p/how-to-build-a-learning-machine">How to Make Yourself Into a Learning Machine - Superorganizers</a> 以及 <a href="https://notes.andymatuschak.org/z7kEFe6NfUSgtaDuUjST1oczKKzQQeQWk4Dbc">notes.andymatuschak.org</a><ul><li><img src="https://media.xiang578.com/flynn-andy.png" alt="" /></li><li><img src="https://media.xiang578.com/flynn-zk.png" alt="" /></li></ul></li></ul></li><li>从他的理解来看，[[Obsidian]] 比 [[Roam]] 更合适，以及在 RoamCN 聚会时提到的，需要对文字数量进行限制。[[Progressive Summarization]] 和 [[Evergreen Note]] 的生长概念类似。</li></ul><h3 id="有限与无限的游戏"><a class="markdownIt-Anchor" href="#有限与无限的游戏"></a> 有限与无限的游戏</h3><blockquote><p>有本书对我蛮有影响的——叫做《有限与无限的游戏》。有限游戏在边界内玩，无限游戏却是在和边界，也就是和“规则”玩，探索改变边界本身。实际上只有一个无限游戏，那就是你的人生，死亡是不可逾越的边界。与之相比，其他的边界并不是那么重要了。<br />人人网、美团网、饭否网创始人王兴</p></blockquote><p>有限游戏有明确的游戏结束目标，无限游戏的目标是让游戏一直进行下去。生活中的很多方面更多接近于无限游戏。比如工作之后的学习，没有明确的目标引导，更多是去保持这个习惯。</p><p>本期中脱不花的四个面试题中的驱动力也和这两个游戏有关。文章中介绍到谷歌之前从编程比赛中寻找程序员（回想到自己大学参加 ACM 经历），这些人习惯与在边界内做事情（外部刺激和目标）。而谷歌希望的人更多能根据自己的兴趣不断地拓展边界，打破旧有规则。结合到自己的工作中，很多任务没有之前编程时那么明确的目标，更多时候是依赖自己去寻找问题和解决问题。</p><p>另外 <a href="https://mp.weixin.qq.com/s/0tUYITGjZjFb7JLU4F-MUw">谁在驱动滴滴发动机？</a> 中也提到张博最近在看 《有限与无限的游戏》，互联网下半场可能各个大佬更希望自己的企业基业长青。</p><h3 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h3><p>还有部分提及的内容还没有时间看，记录一下关键字和大家分享：active recall、spaced repetition、learn how to learn、nstigation habit、Atomic Habits、Mini Habits。</p><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><h3 id="个人成长知乎上最神奇的专业领域"><a class="markdownIt-Anchor" href="#个人成长知乎上最神奇的专业领域"></a> 「个人成长」，知乎上最神奇的「专业领域」</h3><ul><li>厉害的标准<ul><li>在一个职级体系中通过竞争的手段达到了高位。</li><li>留下传世的精品</li><li>让足够多的人改善自己的生活</li></ul></li></ul><h3 id="产品沉思录-product-thinkingvol20200816把自己作为方法"><a class="markdownIt-Anchor" href="#产品沉思录-product-thinkingvol20200816把自己作为方法"></a> [[产品沉思录]] Product Thinking】Vol.20200816：[[把自己作为方法]]</h3><ul><li>他用「<strong>蜂鸟般悬浮</strong>」来描述当下中国人焦虑的现状</li><li>反而对这种「温州乡绅式」的做事方式</li><li>他还提到了一种温柔而坚定地力量 —— <strong>认命不认输</strong><ul><li>所以关键是要把自己所在的社会位置想透。在这个现实下如何去<strong>超脱自己的角色，和强大的社会和历史力量持续的较劲，不认输的较劲。</strong></li></ul></li><li>Temporary Social Media<ul><li>事实证明我还是想的肤浅了、Snap 这两篇文章，是从现有社交网络的设计模式出发，从中寻找被忽略掉的边缘行为，然后反思为何社交网络会的「默认值」会被设计为「记录一切」，而这背后会带来什么样的代价。</li><li>铭记每一刻，但也带来各种挖坟的效果。</li><li>所有的事情都能被记录的时候，往往意味着什么事情都不重要。</li><li>所以 Snap 看似用有限的时间和形式，反而促进你能更好的记住某个故事和感觉，而不是像档案馆一样收集你所有的，几乎不会回溯的过往。</li></ul></li><li>温故知新：如何巧妙地达到你沟通的目的？<ul><li>文中关于沟通的定义值得着重记录 —— Ronald B. Adler与Russell F. Proctor将沟通定义为：<strong>“（沟通是）一种交流的过程，参与者经由交换信息而建立关系。”</strong></li><li>不过另一个有趣的地方是关于沟通深度的，即不是两个人在一起聊得越多越好，而是聊得是否是<strong>对自己意义重大的事件，或者是极为隐私的事件</strong>。</li></ul></li></ul><h3 id="回顾我学心理学的这8年经历-discovery-hipda-hipda"><a class="markdownIt-Anchor" href="#回顾我学心理学的这8年经历-discovery-hipda-hipda"></a> <a href="https://www.hi-pda.com/forum/viewthread.php?tid=2760589&amp;extra=page%3D1">回顾我学心理学的这8年经历 - Discovery - Hi!PDA Hi!PDA</a> #[[fatdragoncat]]</h3><ul><li>沙盘游戏展示个人心理状态</li><li>为了改变这个现状，我用了一个最简单粗暴的办法，就是你不理我，那我就去跟随你，参加你参加的一切活动</li><li>我一改过去记者生涯养成的晚上到处约饭的习惯，下班准点回家，周末绝不加班，而且开始主动参加老婆的各种活动，有时是到公园一群妈妈带娃的聚会，有时是做蛋糕，有时是去不同妈妈家聚餐，我本身是极端内向的人，而且前面也说过，我其实是有社交恐惧症的，所以参加这些活动每次都会迅速让我极端疲劳</li><li>移情(transference)来访者对分析者产生的一种强烈的情感，将自己过去对生活中某些重要人物的情感会太多投射到分析者身上的过程。</li><li>反移情(counter-transference)移情是咨询师把对生活中某个重要人物的情感、态度和属性转移到了来访者身上。</li><li>从那时起我就知道了，自己真正渴望的就是一个温暖的家，我想服务的客户，也是渴望家的温暖的人，而不是只想疗愈自己，而不顾伴侣死活的人。</li><li>我不想再听一帮只是花钱找人诉苦，却不肯承担家庭责任的人说废话了</li><li>我的心理咨询工作终结了，我的婚姻也over了，我以为往后的岁月，就是漂泊江湖，四海为家了。</li><li>于是我开始研究，怎么才能背一个双肩背，就能一边工作，一边生活，然后就撞上了知识付费时代的来临。</li><li>心理咨询教练很难，但是保持自己的心理健康可能很容易。</li></ul><h3 id="观点得到ceo脱不花面试一个人你只问ta这四个问题就够了"><a class="markdownIt-Anchor" href="#观点得到ceo脱不花面试一个人你只问ta这四个问题就够了"></a> <a href="https://mp.weixin.qq.com/s/ks6JKet-GR81QZbqxHgOCw">【观点】得到CEO脱不花：面试一个人，你只问ta这四个问题就够了 ！</a></h3><ul><li>[[面试]] 后来 HR 和 Mentor 告诉我日常要，多积累一些面试相关的题目，这样进去之前就知道，通过什么问题考核什么方面。从此收集一些面试题就成了习惯，而在这个过程中关注点也从对专业内容的考核，变成了对人本身的考核，也变成了对自己的向内思索：这些问题，自己会如何回答呢？</li><li>[[少楠]] 的面试题<ul><li>有哪些事情是别人做起来觉得很难很无趣，但是你自己却乐此不彼的坚持了很久。</li><li>最近半年有什么观点改变了你的认知或者行为方式，为什么？</li><li>你迄今为止做过的，最让你有成就感的一件事是什么？</li></ul></li><li>[[脱不花]] 面试题<ul><li>**驱动力：**如果你突然有半个月的带薪休假，只有一个条件，就是必须研究一个事儿，你会研究什么?<ul><li>主要考察的是内驱力，擅长比赛的要靠外部刺激和目标(原文中举例谷歌从编程比赛中寻找程序员)，在边界内做事。<ul><li>所以我对工作的不适应，除了不了解机器学习，另外一方面来自于大学靠的是外部刺激和目标。现在需要尝试的是突破业务理解？</li></ul></li><li>而内驱力更能适应变化，他们能根据自己的兴趣不断地拓展边界，打破旧有规则</li><li>和最终在谷歌成功概率相关的问题：你几岁开始拥有自己的电脑？</li><li>谷歌的这两条经验,本质上都指向一个问题:一个人的驱动力是从哪里来的?是来自他自己的兴趣或者对自己的要求,还是来自外界什么人给他设定的标准？</li><li>瞬间反应和回答问题的思路。研究的标的、怎么使用这些时间、达到什么目标？</li><li>因为了解个人的内驱力高低,基本上就能判断出来这个人未来应对变化的能力。当环境对他提出新的要求时,他的抗压性强不强,能不能主动适应变化,就能从这个问题中反映出来了。</li></ul></li><li>**期望值：**你正在做的事，行业里最顶尖的人或公司是谁，他们是怎么做的?<ul><li>主要是看眼界如何，视野开阔与否。能不能把内驱力转化为行动力</li><li>对自己领域的理解</li><li>对高手的定义决定了他的认知，定义的过程能看到研究的过程及人脉情况</li><li>关键是如何定义和标杆的差异，以及差异如何形成及缩短方式。</li></ul></li><li><strong>人际</strong>：你在此之前的人生经历中，做过什么重要的取舍?<ul><li>如果你做重要取舍都是一个人，是不是验证你是一个孤独的人？</li><li>核心是看决策机制的形成，了解进退感和分寸，是否有清晰的边界意识。</li><li>为什么做出这种选择？出发点是什么？为什么这个时候做？你能不能清晰地界定选择的代价是什么？在你做出这些选择的前后都发生了什么，分别怎么解决的？</li><li>重大决策都会有一两个关键人的影响，关注是否有其他相关人被提及，以及这些人在决策中的角色，来判断他的关系网络</li><li>啰嗦的人无法带大队伍，因为边界不清晰</li></ul></li><li>**反思：**针对你刚才提到过的这件事，如果你有机会能重新做一遍，会有哪些地方不一样?<ul><li>反思能力，自己经历过的事情是否有清醒的觉察，评估他对待机会的敏感度。</li><li>对过往是否有总结和复盘，以及对机会的敏感度。颗粒度越细，反思越深。</li><li>面试中很难靠一面之词分清哪些是团队的水平，哪些是个人的贡献。通过反思，根据提到的颗粒度，能够判断，他在项目中究竟起到了多大的作用。</li></ul></li><li>对一个人的内驱力、关系建立能力、目标感和反思能力都有充分的了解能更好帮助做出准确的判断。</li><li>很幽默以及不温和</li><li>最后推荐了 [[奈飞文化手册]]</li></ul></li></ul><h2 id="商业"><a class="markdownIt-Anchor" href="#商业"></a> 商业</h2><ul><li><a href="https://mp.weixin.qq.com/s/0tUYITGjZjFb7JLU4F-MUw">谁在驱动滴滴发动机？</a><ul><li>平台治理</li><li>[[有限与无限的游戏]]</li><li>叶杰平来滴滴的两道面试题：<ul><li>“一道题目，跟出行里抢单、派单相关，问我能不能抽象成数学问题。”</li><li>能不能把抢单到派单问题，具体建立成一套算法模型？</li><li>纪念一下人已经走了。</li></ul></li></ul></li><li>失去字节技术中台支持的 TikTok，还会是曾经那个 TikTok 吗？ [[The Information]]<ul><li>美国政府：威胁国家安全和违反数据隐私。</li><li>国内以什么理由封杀部分软件？美国是实行对等的权力吗？中国和美国之间的战争一部分，没有一个人是无辜的。另外，没有看到国内政府在这一件事情上发表任何的声明？</li><li>联系一下，这件事情对滴滴的国际化会产生什么样的影响？滴滴会不会被更加宽容的处理？还是不要抱有幻想？</li><li>从监管层到潜在买家，试图改写 TikTok 未来的角色变多了[[The Information]]</li></ul></li></ul><h2 id="算法"><a class="markdownIt-Anchor" href="#算法"></a> 算法</h2><p>这个月看起来，看得论文和文章比较少。ai-labs 单机 93w QPS 的模型承保我好几点的笑点。</p><h3 id="滴滴kdd2020论文六-滴滴公开eta新系统线上推理速度进入微秒时代"><a class="markdownIt-Anchor" href="#滴滴kdd2020论文六-滴滴公开eta新系统线上推理速度进入微秒时代"></a> <a href="https://mp.weixin.qq.com/s/quJq0bvTs0qpwYUglQrUfw">滴滴KDD2020论文(六) | 滴滴公开ETA新系统，线上推理速度进入微秒时代</a> [[CompactETA]]  #ETA</h3><ul><li>之前写过他们原来的 ETA 模型文章： <a href="https://xiang578.com/post/wdr.html">(WDR) Learning to Estimate the Travel Time | 算法花园</a>。</li><li>数据稀疏<ul><li>空间稀疏：link 历史数据少<ul><li>基于路况分布来度量不同 link 的相似性，利用 metric learning 进行训练</li></ul></li><li>时间稀疏：相邻时段的 embedding 设置共享参数，使得相邻时段的 embedding 更加相似</li></ul></li><li>如何解决线上预测耗时？<ul><li>[[GAN]] 替代 [[LSTM]]，link 之间的依赖关系通过学习路网的拓扑结构来建立</li><li>位置编码：保持序列信息</li><li>查表 + g 然后过 MLP</li><li><img src="https://media.xiang578.com/compacteta.png" alt="" /></li></ul></li></ul><h3 id="算法工程师技术路线图-知乎"><a class="markdownIt-Anchor" href="#算法工程师技术路线图-知乎"></a> <a href="https://zhuanlan.zhihu.com/p/192633890">算法工程师技术路线图 - 知乎</a></h3><ul><li>[[Python]]：[[Learn Python the Hard Way]] [[流畅的 Python]]<ul><li>能读懂 panads、sklearn 等包的源代码</li></ul></li><li>[[Scala]]<ul><li>Spark快速大数据分析</li><li>[[Scala函数式编程]]</li><li>[[冒号课堂]]</li></ul></li><li>[[cpp]] 能够读懂[[LightGBM]]里对于tweedie loss的相关定义代码。</li><li><a href="https://refactoringguru.cn/design-patterns">常用设计模式有哪些？</a></li></ul><h2 id="embedding-技术的非端到端学习方法-知乎"><a class="markdownIt-Anchor" href="#embedding-技术的非端到端学习方法-知乎"></a> <a href="https://zhuanlan.zhihu.com/p/188569580">Embedding 技术的非端到端学习方法 - 知乎</a></h2><ul><li>下载记录变成一个 session</li><li>随机游走扩充数据</li><li>#Airbnb 全局 context [[Real-time Personalization using Embeddings for Search Ranking at Airbnb]]</li><li>同一个类别的随机负样本，分类成本不高。</li><li><img src="https://media.xiang578.com//tencent-app-store-embedding.png" alt="" /></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;某一刻突然意识到可以选择自己的记忆，我顿悟了。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>李宏毅强化学习课程笔记 Imitation Learning</title>
    <link href="https://blog.xiang578.com/post/reinforce-learnning-basic-imitation-learning.html"/>
    <id>https://blog.xiang578.com/post/reinforce-learnning-basic-imitation-learning.html</id>
    <published>2020-09-06T15:14:47.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>我的笔记汇总：</p><ul><li><a href="https://xiang578.com/post/reinforce-learnning-basic.html">Policy Gradient、PPO: Proximal Policy Optimization、Q-Learning</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-actor-critic.html">Actor Critic</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-sparse-reward.html">Sparse Reward</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-imitation-learning.html">Imitation Learning</a></li></ul><p>apprenticeship learning</p><ol><li>无法从环境中获得 reward。</li><li>某些任务中很难定义 reward。</li><li>人为设计的奖励可能导致意外的行为。</li></ol><p>学习专家的行为。</p><h2 id="behavior-cloning"><a class="markdownIt-Anchor" href="#behavior-cloning"></a> Behavior Cloning</h2><p>监督学习，但是样本有限。</p><p>Dataset Aggregation</p><ol><li>通过行为克隆得到 actor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\pi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>利用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\pi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和环境交互得到一些新的样本</li><li>由专家对上一步采样得到的样本进行标注</li><li>利用新得到的样本训练 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\pi_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ol><p>如果机器的学习能力有限，可能复制专家多余无用的动作。监督学习无法区分哪些是需要学习、哪些是需要忽视的行为。</p><h3 id="miss-match"><a class="markdownIt-Anchor" href="#miss-match"></a> Miss match</h3><p>监督学习中，我们假设训练数据和测试数据有相同的分布。Behavior Cloning 中可能分布不同。</p><p><img src="https://media.xiang578.com/15733541795048.jpg" alt="" /></p><h2 id="inverse-reinfofcement-learning"><a class="markdownIt-Anchor" href="#inverse-reinfofcement-learning"></a> Inverse Reinfofcement Learning</h2><p>反向强化学习<br />没有 reward 函数，通过专家和环境互动学到一个 reward function，然后再训练 actor。<br /><img src="https://media.xiang578.com/15733545279563.jpg" alt="" /></p><p>类似于 GAN 的训练方法（actor 换成 generator，reward function 换成 discriminator）。<br />学到 actor 的 pi 后，调整 reward function，保证专家的行为得分大于学到的行为。</p><p><img src="https://media.xiang578.com/15733546273431.jpg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;我的笔记汇总：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://xiang578.com/post/reinforce-learnning-basic.html&quot;&gt;Policy Gradient、PPO: Proximal Policy Optimization</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="algorithm" scheme="https://blog.xiang578.com/tags/algorithm/"/>
    
    <category term="Reinforcement Learning" scheme="https://blog.xiang578.com/tags/Reinforcement-Learning/"/>
    
  </entry>
  
  <entry>
    <title>李宏毅强化学习课程笔记 Sparse Reward</title>
    <link href="https://blog.xiang578.com/post/reinforce-learnning-basic-sparse-reward.html"/>
    <id>https://blog.xiang578.com/post/reinforce-learnning-basic-sparse-reward.html</id>
    <published>2020-09-06T14:14:47.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>我的笔记汇总：</p><ul><li><a href="https://xiang578.com/post/reinforce-learnning-basic.html">Policy Gradient、PPO: Proximal Policy Optimization、Q-Learning</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-actor-critic.html">Actor Critic</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-sparse-reward.html">Sparse Reward</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-imitation-learning.html">Imitation Learning</a></li></ul><h2 id="reward-shaping"><a class="markdownIt-Anchor" href="#reward-shaping"></a> Reward Shaping</h2><p>如果 reward 分布非常稀疏的时候，actor 会很难学习，所以刻意设计 reward 引导模型学习。</p><h3 id="curiosity-intrinsic-curiosity-module-icm"><a class="markdownIt-Anchor" href="#curiosity-intrinsic-curiosity-module-icm"></a> Curiosity Intrinsic Curiosity module (ICM)</h3><p>在原来 Reward 函数的基础上，引入 ICM 函数。ICM 鼓励模型去探索新的动作。最后 ICM 和 Reward 和越大越好。</p><p><img src="https://media.xiang578.com/15732008339393.jpg" alt="" /></p><p>鼓励探索新动作之后，会导致系统风险变大。对比预测的下一个状态和真正的状态的差异程度进行抑制。</p><p><img src="https://media.xiang578.com/15732012078318.jpg" alt="" /></p><p>Feature Ext 对状态进行抽取，过滤没有意义的内容。<br />Network 1 预测下一个状态，然后再和真实状态计算 diff 程度。<br />Network 2 预测 action，和真实的 action 进行对比。如果两个 action 接近，说明 f 可以进行特征提取。重要程度计算。</p><p><img src="https://media.xiang578.com/15732013249053.jpg" alt="" /></p><h3 id="curriculum-learning"><a class="markdownIt-Anchor" href="#curriculum-learning"></a> Curriculum Learning</h3><p>规划学习路线，从简单任务学习。</p><p>Reverse Curriculum Generation</p><p><img src="https://media.xiang578.com/15732019855111.jpg" alt="" /></p><p><img src="https://media.xiang578.com/15732020592680.jpg" alt="" /></p><h3 id="hierarchical-reinforcement-learning"><a class="markdownIt-Anchor" href="#hierarchical-reinforcement-learning"></a> Hierarchical Reinforcement Learning</h3><p>对 agent 分层，高层负责定目标，分配给底层 agent 执行。如果低一层的agent没法达到目标，那么高一层的agent会受到惩罚（高层agent将自己的愿景传达给底层agent）。</p><p>如果一个agent到了一个错误的目标，那就假设最初的目标本来就是一个错误的目标（保证已经实现的成果不被浪费）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;我的笔记汇总：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://xiang578.com/post/reinforce-learnning-basic.html&quot;&gt;Policy Gradient、PPO: Proximal Policy Optimization</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="algorithm" scheme="https://blog.xiang578.com/tags/algorithm/"/>
    
    <category term="Reinforcement Learning" scheme="https://blog.xiang578.com/tags/Reinforcement-Learning/"/>
    
  </entry>
  
  <entry>
    <title>李宏毅强化学习课程笔记 Actor Critic</title>
    <link href="https://blog.xiang578.com/post/reinforce-learnning-basic-actor-critic.html"/>
    <id>https://blog.xiang578.com/post/reinforce-learnning-basic-actor-critic.html</id>
    <published>2020-09-06T13:14:47.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>我的笔记汇总：</p><ul><li><a href="https://xiang578.com/post/reinforce-learnning-basic.html">Policy Gradient、PPO: Proximal Policy Optimization、Q-Learning</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-actor-critic.html">Actor Critic</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-sparse-reward.html">Sparse Reward</a></li><li><a href="https://xiang578.com/post/reinforce-learnning-basic-imitation-learning.html">Imitation Learning</a></li></ul><h2 id="actor-critic"><a class="markdownIt-Anchor" href="#actor-critic"></a> Actor Critic</h2><h3 id="policy-gradient"><a class="markdownIt-Anchor" href="#policy-gradient"></a> policy gradient</h3><ul><li>给定在某个 state 采取某个 action 的概率。</li><li>baseline b 的作用是保证 reward 大的样本有更大的概率被采样到。</li><li>从当前时间点累加 reward，并且当前 action 对后面的 reward 影响很小，添加折扣系数。</li><li>PG 效果受到采样数量和质量影响。</li></ul><p><img src="https://media.xiang578.com/15731332476541.jpg" alt="" /></p><h3 id="q-learning"><a class="markdownIt-Anchor" href="#q-learning"></a> Q-learning</h3><p>状态价值函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span><br />状态行动价值函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q^{\pi}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></p><p><img src="https://media.xiang578.com/15731335120798.jpg" alt="" /></p><h3 id="actor-critic-2"><a class="markdownIt-Anchor" href="#actor-critic-2"></a> Actor-Critic</h3><p>用 V 和 Q 替换 PG 中的累积 reward 和 baseline。新的模型需要训练两个网络，比较困难。</p><p><img src="https://media.xiang578.com/15731338724158.jpg" alt="" /></p><h3 id="advantage-actor-critic"><a class="markdownIt-Anchor" href="#advantage-actor-critic"></a> Advantage Actor-Critic</h3><p>用 V 去替代 Q，能降低模型整体方差（MC 到 TD)。最下面两个公式转化是由实验得到。</p><p><img src="https://media.xiang578.com/15731340046945.jpg" alt="" /></p><p>训练过程：</p><p><img src="https://media.xiang578.com/15731341766172.jpg" alt="" /></p><p>tip:</p><ol><li>actor 和 critic 具有相同的输入 s，可以共享部分网络结构。</li><li>output entropy 作为 pi 的正则项，entropy 越大采样效果越好。</li></ol><p><img src="https://media.xiang578.com/15731342994690.jpg" alt="" /></p><h3 id="asynchronous-advantage-acotr-critic-a3c"><a class="markdownIt-Anchor" href="#asynchronous-advantage-acotr-critic-a3c"></a> Asynchronous Advantage Acotr-Critic A3C</h3><ol><li>利用多个 worker 去训练。</li><li>每个 worker 复制主模型的参数。</li><li>每个模型单独采样，并且计算梯度。</li><li>更新全局参数。</li></ol><h3 id="pathwise-derivative-policy-gradient"><a class="markdownIt-Anchor" href="#pathwise-derivative-policy-gradient"></a> Pathwise derivative policy gradient</h3><p>该网络不仅仅告诉 actor 某一个 action 的好坏，还告诉 actor 应该返回哪一个 action。</p><p><img src="https://media.xiang578.com/15731346701840.jpg" alt="" /></p><p>将这个 actor 返回的 action 和 state 一起输入到一个固定的 Q，利用梯度上升更新 actor。</p><p><img src="https://media.xiang578.com/15731348191409.jpg" alt="" /></p><p>完整的训练过程和 conditional GAN 类似， actor 是 generator，Q 是 discriminator。</p><p><img src="https://media.xiang578.com/15731350424130.jpg" alt="" /></p><p>算法：</p><ol><li>action 由训练的 actor 决定</li><li>利用 s 和 a 更新 Q<br /><img src="https://media.xiang578.com/15731351315860.jpg" alt="" /></li></ol><h3 id="gan-和-ac-方法对比"><a class="markdownIt-Anchor" href="#gan-和-ac-方法对比"></a> GAN 和 AC 方法对比</h3><p><img src="https://media.xiang578.com/15731353632450.jpg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;我的笔记汇总：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://xiang578.com/post/reinforce-learnning-basic.html&quot;&gt;Policy Gradient、PPO: Proximal Policy Optimization</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="algorithm" scheme="https://blog.xiang578.com/tags/algorithm/"/>
    
    <category term="Reinforcement Learning" scheme="https://blog.xiang578.com/tags/Reinforcement-Learning/"/>
    
  </entry>
  
  <entry>
    <title>【Never Reading】 202007 互联网商业模式</title>
    <link href="https://blog.xiang578.com/post/Never-Reading-202007.html"/>
    <id>https://blog.xiang578.com/post/Never-Reading-202007.html</id>
    <published>2020-08-08T15:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>不知不觉中每月分享已经进行半年，不过前 6 期都没有想到取什么名字。上期的标题「Never Reading」来自稍后读列表名称，仔细一想不正好成为每月分享的名字吗？而且还有致敬「Λ-Reading」的成分。</p><h2 id="互联网商业模式"><a class="markdownIt-Anchor" href="#互联网商业模式"></a> 互联网商业模式</h2><p>在 <a href="http://xiang578.com/post/monthly-issue-202006.html">202006 Never Reading</a> 中摘录过「即刻半月刊」的一段内容：</p><ul><li>所谓“商业模式”其实指的是这家公司的“价值创造模式”，即用什么样的模型创造了更多价值。<ul><li>世界上现存所有的商业模式无非三种，一是[[边际效应]]（规模效应/协同效应），二是[[双边效应]]，三是梅特卡夫[[网络效应]]。不同的价值创造模型，带来不同的增长动力，继而带来不同的货币化方法。</li><li>滴滴是什么模型？</li></ul></li></ul><p>当时没有找到上面这一段内容的解释，只是觉得有点神奇就记录下来。这个月收听「三五环」中刘飞和少楠关于交易平台两期内容（14、17），其中提到许小年教授的一本书「商业的本质和互联网」。在书中详细的介绍商业平台的效应，感兴趣的可以找来详细的阅读。</p><ul><li>[[规模效应]]：[[边际成本]]越低和边际收益越高</li><li>[[协同效应]]：依赖于品种增加带来的 1+1 &gt; 2<ul><li>百货公司拥有协同效应</li><li>#problem 协同效应失败的例子？</li></ul></li><li>[[双边市场效应]]<ul><li>双边供需的进入，都会有正外部性。公式：V=k<em>m</em>n</li><li>电商平台的效应弱：需要平台来管控质量，即变成了单边的；滴滴的效应强：司机和乘客的增加，都会带来正向效应（但边际收益未必持续提升）。</li></ul></li><li>[[梅特卡夫效应]]<ul><li>一个网络的价值与用户量的平方成正比。与常见网络效应的概念基本相同。任何用户的进入，都会有正外部性。</li><li>社交网络</li><li>曾李青定律：V=k*n²/r²（r 受 T、S、I、C 影响）。</li></ul></li></ul><p>读完之后，滴滴是什么模型这个问题就迎刃而解。这个月 有一个比较火视频  <a href="https://www.bilibili.com/video/BV1UT4y1j7Ht">复盘出行大战：被BAT选中的滴滴，如何完成垄断霸业_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</a>，介绍滴滴创业的故事。做为一名内部人士，也被里面的内容给震撼到。之前沈南鹏在吴海波的采访中说过一句话「未来十年看滴滴」。记录自己看到的三个细节：</p><ul><li>滴滴接受腾讯投资后，程维和王刚彻底关上和阿里的联系。</li><li>和快的补贴大战中：马化腾建议每次补贴金额在 12-20 中间的一个随机数</li><li>和 uber 大战中：腾讯封禁 uber 在微信上的微信号</li></ul><p>有一个梦想是能看到程维的传记，之前特意查过他的花名 —— 常遇春。知乎热榜这个月出现过一个奇怪的问题，里面有一段引用：</p><blockquote><p>王保保这个“奇男子”的称号，是朱元璋给的，评价较帝国双壁之一常遇春更高，含金量十足：朱元璋曾大会诸将，问道：“天下奇男子谁也？”诸将都说：“[[常遇春]]将不过万人，横行无敌，真奇男子。”明太祖笑曰：“遇春虽人杰，吾得而臣之。吾不能臣王保保，其人奇男子也。”（《明史》-《扩廓帖木儿传》）</p></blockquote><h2 id="商业"><a class="markdownIt-Anchor" href="#商业"></a> 商业</h2><ul><li>阿里很强调价值观，但[[阿里巴巴]]首先是一家商业组织。</li><li>上学时，[[黄峥]]就意识到了机会可贵：“我在上学时就意识到几个事：一是寒门出贵子是小概率事件，大部分富二代，尤其是官二代非常优秀。二是田忌赛马，在整体资源劣势的情况下可以创造出局部优势，进而有机会获得整个战役的胜利。基于此，平凡人可以成就不凡事。第三是钱是工具，不是目的。”</li><li>趣头条本质上是一款游戏产品，只不过披着内容信息流的外衣。<ul><li>不过这一些信息流产品只有学习用户兴趣，真正的影响用户行为还是要靠基于强化学习开发的游戏。</li></ul></li><li>字节系广告变现涉及4个角色：内容消费者，内容生产者，平台，广告主；阿里系广告变现涉及3个角色：消费者，商家，平台；所以阿里的广告变现链条更短，一定程度上也是效率更高的原因。多一个角色，多一份成本，最终效果要多乘一个参数。</li><li><a href="https://medium.learningbyshipping.com/apples-relentless-strategy-and-execution-7544a76aa26">Apple’s Relentless Strategy, Execution, and Point of View | by Steven Sinofsky | Jun, 2020 | Learning By Shipping</a>  Steven Sinofsky 是前微软 Windows 业务部门的总裁评价苹果架构迁移。<ul><li>其实没有仔细看这一篇文章。震惊到我的是，这位兄弟管理过 20000 人的工程团队？不知道现在国内有哪一些公司的 CTO 能管理这么多的人。</li></ul></li><li><a href="https://sspai.com/post/61174">从苹果的系统更新，理解设计中的「控制」与「自由」 - 少数派</a><ul><li>雪城大学建筑学教授理查德·洛萨（Rhichard Rosa）认为**“设计的本质即是在于控制与自由。”**这句话非常简洁但直接地介入了设计的核心——设计行为为混乱与无序赋予秩序，使之得以承载可控的人类行为；但设计也一定不是绝对的控制，它一定要为使用者预留一些自由。</li><li>设计师对美学的自信会落脚在对细节的强制：贝聿铭设计京都东郊的美秀美术馆，下雨天需要领取相应颜色的雨伞才能进入。</li><li><strong>有些人说：“消费者想要什么就给他们什么。”</strong> <strong>人们不知道想要什么，直到你把它摆在他们面前</strong></li><li><strong>设计一定需要控制，但一定不是绝对的控制。平台的搭建者需要预留一些自由给开发者以及用户，对秩序的全盘接手最终会导致自下而上民意的反弹。</strong></li><li>[[设计的哲学]]，设计的背后是不是需要有哲学？一味满足用户需求的软件是不是会变得十分的复杂？比如 Emacs 之类自由度高的软件？</li></ul></li><li><a href="https://www.jianshu.com/p/03080891e4ba">顶级PM的产品观：王慧文看行业-合集 - 简书</a><ul><li>互联网 AB 面：A类是供给和履约在线上，B类是供给和履约在线下。</li><li>B类又可以分为：以SKU为中心的供给B1和以Location为中心的服务B2。</li><li>A 类能力体现在产品设计领域，体现在用户理解上，体现在对于通讯、社交以及内容把握上。</li><li>B1里面，主要体现在对于品类的理解，对于供应链的理解，对于定价的理解。</li><li>B2里面，如果你们去盘点一下B2的公司，他们总体来说有一个比较共有的特征，大规模的线下团队。</li><li>是否有大规模的线下团队是B1和B2一个很大的差别。</li><li>在LBS的方向上，中国和美国的企业这样的差距是怎么样发生的？大概有四个因素决定：人力成本、人口密度、人口规模、代际竞争。</li></ul></li></ul><p><img src="https://media.xiang578.com/a-b1-b2.png" alt="互联网 AB 面" /></p><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><ul><li>理解世界的一个有效方法是，在人生的某个阶段，把任何之前视为理所当然的事情全都重新研究与思考一遍，并弄清楚它们运行的真正起源与机理。在这个过程中，自问的问题越基础、越显得不需要去质疑，收获往往就会越多——人为什么要每天吃三顿饭、买东西为什么要花钱、书籍和文章为什么会存在——真理通常就藏在这些大多数人想都不会想的事情里。[[张潇雨]]<ul><li>「银河系漫游指」里面有一句：任何在我出生时已经有的科技都是稀松平常的世界本来秩序的一部分。</li></ul></li><li>什么是第一原理？<ul><li>[[亚里士多德]] 在[[形而上学]]中提出这个哲学概念，指「公理：无法再分、无法证明且不证自明的命题。」</li><li>“第一原理”本身并不是什么原理，它只是个简称。准确地说，应该叫做“从第一原理推理”（reasoning by first principle），是<strong>分析问题，找出其不可继续拆分的根本原因，即第一原理，再从第一原理反推出解决方案的思考方式。</strong></li><li>第一原理是先验</li></ul></li></ul><h2 id="算法"><a class="markdownIt-Anchor" href="#算法"></a> 算法</h2><ul><li><a href="https://www.tanglei.name/blog/shuffle-algorithm.html">面试官：会玩牌吧？给我讲讲洗牌算法和应用场景吧！ | 唐磊的个人博客</a> [[洗牌算法]]<ul><li>之前的分享中写房租分配 <a href="https://xiang578.com/post/week-issue-9.html">每周分享第 9 期：拼多多 | 算法花园</a></li><li>保证每次的概率是相同</li><li>#[[problem]]实现以下算法：一组数，每次不放回抽样，得到一个随机序列。白板编程。分析时间空间复杂度。<ul><li>follow up：能否时间O(n)完成，能否空间O(1)完成。</li></ul></li></ul></li><li><a href="https://www.youtube.com/watch?v=733m6qBH-jI">Stanford CS230: Deep Learning | Autumn 2018 | Lecture 8 - Career Advice / Reading Research Papers - YouTube</a>：Ag 在课程中介绍如何阅读论文，又一次感受到大佬的真诚。<ul><li>主题阅读<ul><li>收集资料</li><li>列出一个 list ，标注阅读进度。挑选有价值的论文阅读。</li><li>5-20 初步了解</li><li>50-100 很好理解前沿工作</li></ul></li><li>如何阅读论文<ul><li>多遍阅读</li><li>第一遍：标题，摘要，图片</li><li>第二遍：简介、结论、图片相关材料</li><li>第三遍：进入论文主体部分，但是可以跳过数学，明白每个参数的含义。</li><li>第四遍：阅读整篇文章，跳过没意义的部分(内容过时，没有火起来过)。</li></ul></li><li>阅读时思考的问题<ul><li>作者试图解决什么问题？</li><li>研究方法的关键是什么？（最具有开创性）</li><li>哪些东西可以为你所用？</li><li>有哪些参考文献可以继续跟进？</li></ul></li><li>最后发现一篇相关实践文章： <a href="https://towardsdatascience.com/how-you-should-read-research-papers-according-to-andrew-ng-stanford-deep-learning-lectures-98ecbd3ccfb3">How You Should Read Research Papers According To Andrew Ng (Stanford Deep Learning Lectures) | by Richmond Alake | Jul, 2020 | Towards Data Science</a></li></ul></li><li>另外一篇和论文阅读有关的文章：<a href="https://zhuanlan.zhihu.com/p/163227375">沈向洋、华刚：读科研论文的三个层次、四个阶段与十个问题 - 知乎</a><ul><li>三个层次：速度、精读与研读</li><li>四个阶段：Passive Reading、Active Reading、Critical Reading、Creative Reading</li></ul></li></ul><p>这就是本期的 「Never-Reading」，我们下个月再见。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不知不觉中每月分享已经进行半年，不过前 6 期都没有想到取什么名字。上期的标题「Never Reading」来自稍后读列表名称，仔细一想不正好成为每月分享的名字吗？而且还有致敬「Λ-Reading」的成分。&lt;/p&gt;
&lt;h2 id=&quot;互联网商业模式&quot;&gt;&lt;a class=&quot;ma</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202006 Never Reading</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202006.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202006.html</id>
    <published>2020-07-14T15:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>这一份 6 月的阅读总结来的有一点晚。前几年一直断断续续在实践 GTD，人的拖延症超乎想象，学到的一个经验是 「Now or Never」。所以，这个月将自己的阅读列表取名为「Never Reading」。</p><h2 id="笔记方法精进"><a class="markdownIt-Anchor" href="#笔记方法精进"></a> 笔记方法精进</h2><p>Roam Research 引起现在这一波 Backlink 笔记软件浪潮，本月依然阅读一些和笔记方法相关的文章。</p><h3 id="我的-zettelkasten-卡片盒笔记法实践-吕立青的博客"><a class="markdownIt-Anchor" href="#我的-zettelkasten-卡片盒笔记法实践-吕立青的博客"></a> 我的 Zettelkasten 卡片盒笔记法实践 | 吕立青的博客</h3><p><a href="https://blog.jimmylv.info/2020-06-03-zettelkasten-in-action/">文章链接</a></p><p>上个月介绍过，自己已经从 Roam Research 迁移到 Obsidian，然后就看到吕立青这一篇基于 Obsidian 的 Zettelkasten 实践。文章中将卡片盒笔记分拆分成四步：</p><blockquote><p>1️⃣ 第一步：必须用自己的话写笔记卡片，以确保你将来能够理解。</p><p>2️⃣ 第二步：无论何时添加新笔记，主动查找可链接到的已有笔记。</p><p>3️⃣ 第三步：通过添加新记录并联系起来，延续这一系列的连续思考。</p><p>4️⃣ 第四步：使用 Anki 间隔重复加深记忆，主动由大脑触发远程联想。</p></blockquote><p>搞笑地是，在他写出这篇文章没有多久之后，已经开始尝试往 Roam Research 上迁移……另外，为了更好在国内推广，他参与发起 <a href="roam-cn.github.io">roam/cn</a> 组织，从英文世界翻译一些推特、视频以及分享一些个人的案例。</p><h3 id="zettelkasten-note-taking-in-10-minutes"><a class="markdownIt-Anchor" href="#zettelkasten-note-taking-in-10-minutes"></a> Zettelkasten note-taking in 10 minutes</h3><p>两条原则：</p><ul><li>Don’t try to get this method perfect from the get go.</li><li>The advanced practices are useful only when you’ve got close to 1000 notes</li></ul><h3 id="my-productivity-app-for-the-past-12-years-has-been-a-single-txt-file"><a class="markdownIt-Anchor" href="#my-productivity-app-for-the-past-12-years-has-been-a-single-txt-file"></a> My productivity app for the past 12 years has been a single .txt file</h3><p>12 年间使用一个 txt 进行任务管理方法分享。作者提到 to do list 变成 what done list 的过程，每天晚上将日历中第二天的代办事项整理到 txt 中，第二天顺手记录任务相关的信息（比如讨论出的结论，或者得到的信息）。结合自己使用经历，OmniFocus 是一个 to do list，基于纯文本的任务管理方式（org-mode 或 taskpaper）更容易成为 what done list。</p><h2 id="商业"><a class="markdownIt-Anchor" href="#商业"></a> 商业</h2><ul><li><a href="https://36kr.com/p/736767189897093">滴滴重踩油门_详细解读_最新资讯_热点事件_36氪</a> 不开玩笑地说，看完这里面的分析，我才理解公司很多的战略。</li><li><a href="https://www.notion.so/c074ab234e2b4dbb9143a48faceec031">淘宝宣战拼多多的前夜：吕晋杰、陈琪、徐易容和葛永昌的至暗时刻</a> 和很多同学聊天，17 年找工作的时候低估了拼多多的潜力。<ul><li>淘宝 PC 转移动互联网时，流量入口从网页短 300 个减少到手淘 app 48 个。是不是能解释淘宝这几年涌现出那么多的推荐系统相关的问题。</li><li>电视广告投放策略以及如何理解流量暴涨，拼多多上一直很火爆的「百亿补贴」</li><li>任何人都可以成为英雄，哪怕是做了一件不起眼的事情。</li></ul></li><li><a href="https://zhuanlan.zhihu.com/p/146363597">快手的普通，抖音的美好，算法的价值观 - 知乎</a><ul><li>算法没有价值观，算法只会实现设计者的意图。</li><li>主动降低算法效率，是为了实现某些短期无法衡量的业务目标。</li><li>抖音将流量集中在头部。</li><li>快手整体的点击率被牺牲，普通人的流量被保证。</li><li>抖音说记录美好生活，快手说记录世界记录你。</li></ul></li></ul><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><h3 id="人生总有一刻我们会开始思考死亡"><a class="markdownIt-Anchor" href="#人生总有一刻我们会开始思考死亡"></a> 人生总有一刻，我们会开始思考死亡</h3><p>茨威格在《人类的群星闪耀时》所说的那种幸运是什么 —— 「最大的幸运，莫过于在年富力强的时候，发现了自己的使命」</p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/24640592">人生总有一刻，我们会开始思考死亡 - 知乎</a> [[张潇雨]]<br />于是我发现，面对死亡最终可能只有两种方法。</p><ul><li>一种是将自己与一些更宏大的东西联系起来：一个数学定理、一本文学著作、一件艺术作品或一种恒久的信仰。马尔克斯与康德靠《百年孤独》与《纯粹理性批判》遗世独立，米开朗基罗把《创世纪》和《最后的审判》印刻在西斯廷大教堂里，供千万后朝拜——他们肉身虽灭，但精神不朽——反正建筑是永远戳在那儿的。</li><li>还有一种就是，生活在当下的每个瞬间里，不烦扰过去、不担忧将来。</li></ul></blockquote><h3 id="即刻半月刊"><a class="markdownIt-Anchor" href="#即刻半月刊"></a> 即刻半月刊</h3><p>6.18？即刻重新开放，之前对这个社区没有太多印象，尝试关注一些人之后，信息流的质量也不错。「即刻半月刊」是某些爱好者挑选的一些即友发言集合。摘录一些我觉得有意思的内容。</p><ul><li>老罗带货首卖小米的中性笔：数量太少。之前看到过一个分析，抖音自己做电商最大的困难点在于没有用户的物流地址。简单想一下，用户可能在填写地址这一步流失。</li><li>@Rey_L 我在判断哪家公司的产品会换灰色皮肤的时候，基本都猜对了hhh，滴滴头条一定会做，京东会做，淘宝也许会做，拼多多肯定不做。</li><li>微信小程序减少 App Store 在国内的下载量。不过大部分巨头的小程序还是想要从微信中引流的。</li><li>底下有回复cite了一个working paper，大意说的是名校（elite education，这里用的是211高校与非211高校的断点回归）能够给学生带来的起薪上 30-45% 的提升，其原因在于名校当中的social network，elite的peer普遍家庭条件更好，成绩也更好。上网课带来不了这种social connection…所以说不单只是知识改变命运，环境也很重要</li><li>所谓“商业模式”其实指的是这家公司的“价值创造模式”，即用什么样的模型创造了更多价值。<ul><li>世界上现存所有的商业模式无非三种，一是[[边际效应]]（规模效应/协同效应），二是[[双边效应]]，三是梅特卡夫[[网络效应]]。不同的价值创造模型，带来不同的增长动力，继而带来不同的货币化方法。</li><li>滴滴是什么模型？</li></ul></li><li>A/B test只能做模型的小优化，但找不到大的绝对的增长点，所以除了推荐系统里的参数，即刻的很多产品决策希望尽量远离A/B test</li><li>张小龙的饭否，张一鸣的微博，黄峥的微信公众号，很可惜这几个都成了过去形态。现在只剩下王兴的饭否了。</li><li>一个反向小思考：兴趣社交刚需归刚需，社交app的本质还是信息分发。RSS订阅20周年，分发的有效性也不是什么相似推荐，^<sup>而是真正提供专注力的阅读</sup>^。因为个性推荐的本质就是专注力。信息廉价甩卖的今天，打开微博广场/抖音主页/朋友圈（广告），用户最需要的不是新鲜事而是减少噪音的阅读器，人永远看到自己想看到的，产品顺水推舟不也是更讨巧，所以需要设计者克制。沟通永远是双向的，当用户感到一个舒适被接纳的舆论场所，也会更加有表达欲。</li><li>芒果系这么多年都在做一件事，就是把握这个时代的情绪。[[乘风破浪的姐姐们]]</li></ul><h2 id="机器学习"><a class="markdownIt-Anchor" href="#机器学习"></a> 机器学习</h2><p>本月 KDD 2020 的文章应该已经放出，推荐阅读 Airbnb 深度模型实践相关的文章 Managing Diversity in Airbnb Search 以及 Improving Deep Learning For Airbnb Search。 7 月份希望能写一篇博客分享自己的阅读笔记。</p><ul><li><a href="https://www.zhihu.com/question/389912594">神经网络中对需要concat的特征进行线性变换然后相加是否好于直接concat? - 知乎</a> [[机器学习]]<ul><li>concat 没有信息融合，也没有信息缺失</li><li>add 不同向量之间的权重相同，会导致信息缺失。待融合的特征具有相同分布，或特征属于同一类，直接相加才有可能提升模型性能。</li><li>concat + MLP 能够自动学习不同 channel 的权重，MLP 能引入非线性。利于通道间的信息融合，计算量大。</li></ul></li><li><a href="https://zhuanlan.zhihu.com/p/24851814">【机器学习】Bootstrap详解 - 知乎</a>：随机森林里面用到的数据重采样方法，老板要求训练两个有差异模型时给我推荐的方法。</li><li><a href="https://zhuanlan.zhihu.com/p/148729018">BERT 可解释性-从&quot;头&quot;说起 - 知乎</a>：蛮有意思的对 BERT 组件效果分析，这位作者举的例子有些蹭热点。</li><li><a href="https://zhuanlan.zhihu.com/p/63982470">都9102年了，别再用Adam + L2 regularization了 - 知乎</a>：说明为什么要用 AdamW。另外推荐一下，之前一位同事写的 AdamW 实现：<a href="https://zhuanlan.zhihu.com/p/40814046">L2正则=Weight Decay？并不是这样 - 知乎</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这一份 6 月的阅读总结来的有一点晚。前几年一直断断续续在实践 GTD，人的拖延症超乎想象，学到的一个经验是 「Now or Never」。所以，这个月将自己的阅读列表取名为「Never Reading」。&lt;/p&gt;
&lt;h2 id=&quot;笔记方法精进&quot;&gt;&lt;a class=&quot;mar</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202005 Newsletter</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202005.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202005.html</id>
    <published>2020-06-07T15:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="newsletter"><a class="markdownIt-Anchor" href="#newsletter"></a> Newsletter</h2><p>从去年开始给我一种 RSS 复兴的感觉，这个月尝试使用 Newsletter。对于创作者来说，RSS 不仅无法统计数据，也很难开展会员模式。Newsletter 通过邮箱订阅的的手段，完美解决这两个问题，国外开始有一站式的解决方案，可能几个月之后也会在国内火起来。推荐自己订阅的一些邮件组给大家。</p><ul><li><a href="https://www.notion.so/PRODUCT-THINKING-a601a12335044f349a22caf57f274c27">PRODUCT THINKING · 产品沉思录精选</a>：第一个付费订阅的邮件周刊，目前的价格是 199 元/年。根据少楠自己写的介绍，内容包括但不限于产品设计，服务设计，数据分析，互联网技术，经济学，心理学，社会学，决策学，自然科学，城市规划，零售，团队管理等内容。每周会推荐几篇网上比较好的文章，偶尔也翻译一些英语文章。挑选几篇我觉得不错的公开内容：<ul><li><a href="https://www.notion.so/Zettelkasten-25627d7ce99344c487f4e42d861f9e0a">原子笔记法：Zettelkasten</a></li><li><a href="https://www.notion.so/P-A-R-A-Notion-19909e5aac3049d887197dcfb1e97fd5">如何管理信息：P.A.R.A. 是什么及在 Notion中的应用</a></li></ul></li><li><a href="https://rizime.substack.com/">Λ-Reading</a> 阅读相关分享，作者的读书笔记网站也值得一看 <a href="https://rizi.me/">— Read the Word,Read the World.</a>。推荐内容：<ul><li><a href="https://rizime.substack.com/p/f08">路径依赖和困扰计算机的简单问题 - Λ-Reading</a></li><li><a href="https://rizime.substack.com/p/d28">号外：知识管理工具 - Λ-Reading</a> 中文为数不多关于 TiddlyWiki 的介绍。</li></ul></li><li><a href="https://clearbox.substack.com/">透明盒子计划</a> 深度阅读分享，盒子对应 Zettelkasten。<ul><li><a href="https://clearbox.substack.com/p/coming-soon">透明盒子计划 - 透明盒子计划</a></li></ul></li><li><a href="https://superorganizers.substack.com/">Superorganizers</a> 对国外人士的采访，有关于效率、数字生活等。目前只看他的免费内容……<ul><li><a href="https://superorganizers.substack.com/p/how-to-build-a-learning-machine">How to Make Yourself Into a Learning Machine - Superorganizers</a>：对一名高中辍学的小哥的采访，介绍来一些自我教育的方法。</li></ul></li></ul><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><ul><li><a href="https://sspai.com/post/60466">How to take smart notes，方法及工具 - 少数派</a>：Zettelkasten 这种做笔记方法慢慢开始要在国内流行起来，自己已经关注差不多超过半年的时间，接下来也在计划写一篇相关的博客文章。</li><li><a href="https://beepb00p.xyz/hpi.html">Human Programming Interface</a> 简单看来一下，利用 py 包和 Emacs 管理所有相关的个人数据，挺疯狂的。</li><li>上古论坛差不多十年前的帖子， <a href="https://www.hi-pda.com/forum/viewthread.php?tid=819978&amp;extra=&amp;authorid=1956&amp;page=1">我的千书阅读计划 - 意欲蔓延 - Hi!PDA Hi!PDA</a> fatdragoncat 通过阅读成为一名自由职业者。帖子中介绍大量篇幅介绍如何高效阅读、锻炼、自我管理等等。在印象笔记中找到几年前自己写的笔记，现在重新整理一下相关的内容，并分享给大家。</li><li><a href="https://www.twitch.tv/videos/611050187">AndyMatuschak - Making sense of Design Unbound vs. prior theories of collaborative design work - Twitch</a> [[Evergreen notes]]的创始人公开展示写作的过程。通过这个视频可以发现他使用的笔记软件是 [[Bear]]，看起来 Reference 和 Backlink 都是手动输入的，不过这样也符合 [[Zettelkasten]] 的原则。只是 [[Roam Research]] 这样的软件让我们变懒。</li><li>莫言获得诺贝尔文学奖发表的演讲中有一个故事：到了荒滩上，我把牛羊放开，让它们自己吃草。蓝天如海，草地一望无际，周围看不到一个人影，没有人的声音，只有鸟儿在天上鸣叫。我感到很孤独，很寂寞，心里空空荡荡。有时候，我躺在草地上，望着天上懒洋洋地飘动着的白云，脑海里便浮现出许多莫名其妙的幻象。我们那地方流传着许多狐狸变成美女的故事，我幻想着能有一个狐狸变成美女与我来作伴放牛，但她始终没有出现。但有一次，一只火红色的狐狸从我面前的草丛中跳出来时，我被吓得一屁股蹲在地上。狐狸跑没了踪影，我还在那里颤抖。有时候我会蹲在牛的身旁，看着湛蓝的牛眼和牛眼中的我的倒影。有时候我会模仿着鸟儿的叫声试图与天上的鸟儿对话，有时候我会对一棵树诉说心声。但鸟儿不理我，树也不理我。许多年后，当我成为一个小说家，当年的许多幻想，都被我写进了小说。很多人夸我想象力丰富，有一些文学爱好者，希望我能告诉他们培养想象力的秘诀，对此，我只能报以苦笑。</li></ul><h2 id="机器学习"><a class="markdownIt-Anchor" href="#机器学习"></a> 机器学习</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/138136777">谈谈推荐系统中的用户行为序列建模 - 知乎</a> 一篇关于用户行为序列建模的文章，基本上常用的方法都介绍了。<ul><li>和上一次  “<a href="https://zhuanlan.zhihu.com/p/125507748">从谷歌到阿里，谈谈工业界推荐系统多目标预估的两种范式 - 知乎</a>[[机器学习实践]][[MTL]]” 属于同一个作者</li><li>目前主流推荐系统框架 [[Deep Neural Networks for YouTube Recommendations]] 中的 Matching 和 Ranking。另外可能还有规则模块。</li><li>pooling-based architecture 范式，用户行为是无序集合，使用 sum/max pooling 或各种 attention<ul><li>[[Deep Neural Networks for YouTube Recommendations]] 中将用户观看过的视频序列取到 embedding 后，做一个 mean pooling 作为用户历史兴趣的表达</li><li>Ranking 阶段：[[DIN]] target item 和行为序列的 item 做一个 attention，得到一个 weight，然后加权求和。</li><li>结合 [[Transformer]] 做 self-attention 并行的建模长序列依赖，除去用户行为序列中的噪声：[[Behavior Sequence Transformer for E-commerce Recommendation in Alibaba]]</li></ul></li><li>sequential-modeling architecture 范式，用户行为当成一个具有时间属性的序列，使用 RNN、LSTM、GRU 等<ul><li>[[Perceive Your Users in Depth: Learning Universal User Representations from Multiple E-commerce Tasks]] Property Gated LSTM</li><li><a href="https://zhuanlan.zhihu.com/p/30720579">推荐中的序列化建模：Session-based neural recommendation - 知乎</a></li></ul></li><li>上面两种方法都是将用户行为经过 pooling/attention/rnn 的处理，聚合成用户行为序列的 embedding，再和其他的特征 concat 在一起，经过 mlp 后接 sigmod/softmax</li><li>抽取聚类出用户多峰兴趣，Capsule<ul><li>阿里 [[MIND]] 胶囊网络</li></ul></li><li>辅助损失函数<ul><li>[[DIEN]] 兴趣提取和兴趣演化，以最后一个 hidden state 做为用户兴趣的表达。兴趣提取模块，使用隐状态和下一件商品预测做二分类。不加入辅助loss，GRU 的隐变量完全受限于最终点击的 label，加入后能约束 GRU 每个隐状态表示其本身的兴趣。</li></ul></li><li>提升用户序列长度，可以带来可观的 auc 提升。[[MIMN]]</li></ul></li><li>Applying Deep Learning To Airbnb Search：一篇关于从 GBDT 模型迁移到深度模型的工业实践记录 paper。对于我这种没有经历过这种技术迭代的人来说，工业级的深度模型上线比想象中的要困难。作者们针对自己遇到的比如 listing embedding 训练不充分、如何判断 feature 的重要性等问题设计实验去验证以及给出解释。严谨的精神值得吾辈学习。</li></ul><h2 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h2><p>出于对 Roam Research 开发者的不放心，已将全部文档迁移到 Obsidian。目前还在探索新的工作流，5 月分享不可避免产生拖延。另外还在寻找一种建立 Digital Garden 的方法。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;newsletter&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#newsletter&quot;&gt;&lt;/a&gt; Newsletter&lt;/h2&gt;
&lt;p&gt;从去年开始给我一种 RSS 复兴的感觉，这个月尝试使用 Newsletter。对于创作者来说，R</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202004 新的尝试</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202004.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202004.html</id>
    <published>2020-05-01T08:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>不知不觉又到更新每月分享的时间。</p><p>想写一下我为什么做这件事情？分享自己平时看到有意思的内容，现实世界认识的人，很少对我关注的内容感兴趣，所幸能借助博客超越时间和空间限制的分享。</p><p>另外一点，我希望自己能将这个系列当成一个产品去迭代，每一期都有形式和内容上的进步。这件事看起来很简单，但却需要耗费很大的精力。其实在网上看到很多人通过这种形式分享，到头来还在坚持的大概也没有多少人（比如阮一峰的科技爱好者周刊）。</p><h2 id="zettelkasten-以及-roam-research"><a class="markdownIt-Anchor" href="#zettelkasten-以及-roam-research"></a> Zettelkasten 以及 Roam Research</h2><p>Zettlekasten 是一个德语单词，意思是卡片盒。现在主要指一种记笔记的思路。Roam Research 是目前国外很火的一个笔记软件，最大的特点是实现不同笔记之间的双向链接。好几个月前就开始尝试 Zettlekasten 的方法，4 月开始才使用 Roam Research。这里先分享一些我看过的文章。</p><ul><li><a href="https://twitter.com/Tisoga/status/1244856639439515649">Roam Research 入门指南（thread）</a></li><li><a href="https://medium.com/@dongyangvic/%E7%94%A8-roam-research-%E6%9D%A5%E6%89%93%E8%8D%89%E7%A8%BF-a3b1d3873aa4">用 Roam Research 来打草稿 - Dongyang Vic - Medium</a></li><li>Roam Fu<ul><li><a href="https://twitter.com/kcorazo/status/1247260599760736256">Part I: My plan for using @RoamResearch for a thesis</a></li><li><a href="https://twitter.com/kcorazo/status/1252669427125895169">Part II: Using Twitter as an inter-brain zettelkasten</a></li><li><a href="https://twitter.com/kcorazo/status/1255296825566920705">Part III: Beyond the Empire</a></li></ul></li></ul><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><ul><li><a href="https://www.gcores.com/articles/121924">中文互联网中“讨论”的消亡 | 机核 GCORES</a>：从产品设计角度分析国内主流网站如何限制用户讨论，互联网缩短人与人之间的距离，但我们用来互喷。</li><li><a href="https://www.huxiu.com/article/350854.html">互联网是人类历史的一段弯路吗？-虎嗅网</a>：又一篇深度长文，很多观点可以背下来出去装B。</li><li><a href="https://zhuanlan.zhihu.com/p/135281778">ByteDance程序员生存指南 - 知乎</a><ul><li>有些年轻人，在结束一整天的工作后，拖着疲惫不堪的肉体回到出租屋，这时候只想躺着啥都不想干，躺在好几周没有换过的床单上点开了抖音，不一会儿就刷到了凌晨，第二天再拖着疲惫不堪的肉体上班。到了周末也没有任何心力出去玩，只能睡到中午然后随便吃点东西看看剧。没有生活，没有朋友，一晃就单身了四五年，长此以往不仅仅是肉体在亚健康和崩溃的边缘，心理健康更是会出现问题。 孤独、焦虑、易怒等等情绪时刻伴随着一个人。</li><li>每个月仅仅只有收到工资短信时可以高兴几分钟。但这笔钱并不敢轻易花出去，因为都是血汗积攒而来，付出的多自然不敢随意花出去。</li></ul></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzA3MzM0MjUyMQ==&amp;mid=2652149604&amp;idx=1&amp;sn=3c96ebfe992694e5c57affe9ef5ba33f&amp;scene=21#wechat_redirect">构建优雅的知识创造系统</a> [[阳志平]] [[卡片写作法]]<ul><li>利用电子卡片后，如何量化每天的产出？是不是可以换算成 github 更新多少字？</li><li>卡片是自己看的，不需要分享：<strong>在卡片层级最大的误区是：分享</strong>。<strong>不少人误将卡片、文件和项目三个层级混为一谈，喜欢在卡片层级搞分享</strong>。这样每次撰写卡片时就增加了一个选择项：<strong>这张卡片我是该分享还是该存着自己看？增加的认知操作加大了认知负荷，从简单反应时变为选择反应时</strong>。所以尽可能在卡片层级少做分享。</li><li>一周、一月、一年、十年与数十年，进行自己的实践。</li></ul></li><li>所有人问俞军<ul><li>[[金字塔原理]] 和 [[学会提问]]</li><li>优秀的思维方式以及对人性和世界的底层理解</li><li>我不是说人工智能不好，而是我自己只关心我能想明白一两年内能给创造什么用户价值的产品(或技术等)，如果我想不明白这东西马上能给用户创造什么价值，我就毫无兴趣。</li><li>看《搜索研究院》页首页尾的那句话，“我们若能更妥善地搜寻资料，实在已经改变世界。”</li></ul></li><li>前百度首席科学家吴恩达谈学习<ul><li>如果你学习，两天后的周一，你不会很快的就在工作中出彩，你的老板也不会知道你花了整天的时间学习，更不会夸奖你什么。你几乎找不到任何东西可以证明你在努力学习。</li></ul></li><li><a href="https://blog.jimmylv.info/2016-07-12-pkm-again-to-innovate-my-note-system/">再谈个人知识管理：革新我的笔记系统 | 吕立青的博客</a> 好久没有看到立青写文章<ul><li>不同软件之间，单条笔记的迁移相当于一次对知识进行提炼的过程。</li></ul></li><li><a href="https://tundrazone.com/guanyudongwuzhisendesanze/">关于动物之森的三则 – 苔原带</a><ul><li>以前玩家渴望在游戏里杀死巨龙，飞向人马座，击败外星侵入者。而现在我们只需要在游戏里“正常”的生活就乐呵呵了。和朋友一起野餐，请朋友到家里来玩，一个人傻乎乎做开心的事情在现实世界中已经有这么高的门槛了么？又或者只是因为在游戏里做这些事情的成本足够低，多巴胺回报足够快？</li></ul></li></ul><h2 id="机器学习"><a class="markdownIt-Anchor" href="#机器学习"></a> 机器学习</h2><ul><li>内部开始尝试 MCTS 相关的项目。正好接这个机会看一下 DeeepMind 前几年的论文 <a href="">Mastering the game of Go with deep neural networks and tree search</a> 以及 <a href="">Mastering the game of Go without human knowledge</a>。推荐去看一下田渊栋在知乎上 <a href="https://zhuanlan.zhihu.com/p/20607684">AlphaGo的分析</a> ，当时他在 Facebook 参与类似围棋相关的项目。另外就是木遥的 <a href="https://36kr.com/p/5042969">关于 AlphaGo 论文的阅读笔记</a> 有更多关于现实的思考。最后推荐 <a href="https://movie.douban.com/subject/27012433/">阿尔法围棋</a>，记录从 DeepMind 开发 AlphaGo 到战胜李世石的全过程。有一个疑问第四局之后，他们有没有增加使用的 GPU 和 CPU？</li><li><a href="https://www.zhihu.com/question/32218407">在你做推荐系统的过程中都遇到过什么坑？ - 知乎</a> [[CTR]]<ul><li>没有明确的指标：CTR，staytime，read/unread</li><li>精准推荐以及兴趣探索</li><li>线下auc涨，线上 ctr 跌</li></ul></li><li><a href="https://zhuanlan.zhihu.com/p/125507748">从谷歌到阿里，谈谈工业界推荐系统多目标预估的两种范式 - 知乎</a>[[机器学习实践]][[多任务学习]]<ul><li>范式一：[[MMOE]] 替换 hard parameter sharing<ul><li>[[Recommending what video to watch next: a multitask ranking system]]</li></ul></li><li>范式二：任务序列依赖关系建模<ul><li>[[ESMM]]</li></ul></li><li>模型负采样，存在 CTR 漂移问题 U5Jvma3de</li></ul></li></ul><h2 id="放弃的事情emacs"><a class="markdownIt-Anchor" href="#放弃的事情emacs"></a> 放弃的事情：Emacs</h2><p>写作软件中积累一些文章的草稿，不过由于我的兴趣变化太快，很多文章还没有完成就已经被我放弃。借这个机会，展示一些有意思的东西。</p><p>程序员圈子中编辑器战争一直是一个绕不过去的话题。自己日常的工作中会使用多种编辑器：</p><ul><li>Sublime Text 简单处理文本</li><li>IDEA 处理 Scala Spark 相关的代码</li><li>PyCharm  连接 GPU 服务器处理 python 相关的代码</li><li>VS Code 本机上写 python、shell、cpp、sql 等脚本</li><li>Vim 服务器上修改文件</li></ul><p>不论选择什么编辑器，都推荐大家去看陈斌的<a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide/blob/master/guide-zh.org"> 一年成为Emacs高手 (像神一样使用编辑器) </a>。</p><p>去年底的时候，由于想尝试 <code>org-mode</code> 做任务管理（下个月再分享相关的内容），开始尝试使用 Emacs。Emacs 最大的有点是基于 Elisp 开发，软件中的每一个功能都对应一个函数，一个快捷键对应一个按键和函数的 map。修改功能和配置非常的方法。比如有人完全将 Vim 在文本操作上的功能迁移过来做成 evil 这个插件（号称所有和 Vim 中表现不同的情况都是 bug）。</p><p>Emacs 需要大量时间调教才能用起来舒心，对于初学者推荐去网上找一些成熟的配置直接使用。目前比较流行的有 Spacemacs 和 Doom emacs，这些配置维护以及使用的人很多，方便解决你遇到的各种问题。另外那些某些大佬个人分享的配置，如果你和大佬的技术栈不同，没有必要强行 clone。把它当成是一个学习素材，更好的理解 Emacs 背后的哲学。再这些基础上，成为高效的程序员的第一步，就是打造属于你自己的专门的配置文件。</p><p>使用好的编辑器是为了更快的工作。那如何更快的工作？</p><ol><li>在加快敲击键盘的速度</li><li>减少敲击键盘的次数</li><li>减少鼠标和键盘之间的切换</li></ol><p>关于 2，我在之前的文章中提到过一点，改变中文的输入方式（从全拼切换到小鹤双拼）。另外一点就是多使用快捷功能，比如 vim 里面的行号跳转。大部分软件的快捷键都是开发商配置好的，不过每一人主要使用的功能其实是完全不一样的。Emacs 中所有的快捷键可以查到定义的文件，从而进行修改。想象一种情况，为了减少我们按快捷键的次数以及难度。我们统计一段时间内使用 Emacs 各个功能的次数（插件 keyfreq），然后重新定义对应的快捷键。</p><p>由于我自己之前主要使用的是 vim，所以也给 vim 用户一个相对于合理的替换过程：</p><ol><li>当成普通的 vim 使用</li><li>逐步接触 org-mode 相关的功能</li><li>使用 emacs 其他的特性</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不知不觉又到更新每月分享的时间。&lt;/p&gt;
&lt;p&gt;想写一下我为什么做这件事情？分享自己平时看到有意思的内容，现实世界认识的人，很少对我关注的内容感兴趣，所幸能借助博客超越时间和空间限制的分享。&lt;/p&gt;
&lt;p&gt;另外一点，我希望自己能将这个系列当成一个产品去迭代，每一期都有形式和</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202003</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202003.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202003.html</id>
    <published>2020-03-28T08:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="读书"><a class="markdownIt-Anchor" href="#读书"></a> 读书</h2><ul><li><a href="https://book.douban.com/subject/34672176/">呼吸 (豆瓣)</a>：这是一本由 Byte.Coffee 主播 MilkShake 🐑 推荐的一本科幻小说集（前几天看其他东西的时候学会科幻小说的英文 sci-fi）。之前看到过，小说的价值在于作者用一个故事告诉你一个道理。最喜欢的是《商人和炼金术士之门》这篇：在传统的穿越小说无法改变未来和过去的基础上，论证穿越能更深刻理解生活。书中其他探讨的几个问题也很有价值，值得一读。</li></ul><h2 id="我看"><a class="markdownIt-Anchor" href="#我看"></a> 我看</h2><ul><li><a href="https://space.bilibili.com/390461123/">徐大sao的个人空间 - 哔哩哔哩 ( ゜- ゜)つロ 乾杯~ Bilibili</a>：最近挑着看完大 sao 做饭视频，被他展示的生活激情所吸引。</li></ul><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="https://writings.stephenwolfram.com/2019/02/seeking-the-productive-life-some-details-of-my-personal-infrastructure">Seeking the Productive Life: Some Details of My Personal Infrastructure—Stephen Wolfram Writings</a>：这篇超长的文章是 Stephen Wolfram (Mathematica CEO) 介绍自己几十年在家办公的经验，包括如何搭建一个适合自己的工作环境、如何管理文件和个人数据等等。不过这次疫情期间在家办公，大部分同事反应最大的问题是沟通效率降低。另外想想，或许是我们在这方面的思考不够。总之，互联网行业居家办公才是光明的未来。</li><li><a href="https://fs.blog/knowledge-project/naval-ravikant/">Naval Ravikant: The Angel Philosopher</a>：AngelList 的 CEO Naval Ravikant 的播客访谈，Naval 的公司投资 Uber Twitter 等 100 多家科技公司。主要介绍 Naval 的一些哲学，文字版在 <a href="https://fs.blog/wp-content/uploads/2017/02/Naval-Ravikant-TKP.pdf">Naval-Ravikant-TKP.pdf</a><ul><li>利用 Kindle 阅读，遇到喜欢的书，购买实体书收藏。对比书的价格，从书中学到可以改变自己人生的内容更重要。</li><li>发现一个新的博客后，会在 Archived 页面挑选几篇仔细阅读。读书时也可以使用这个技巧。</li></ul></li><li><a href="https://superorganizers.substack.com/p/how-to-build-a-learning-machine">How to Make Yourself Into a Learning Machine - Superorganizers</a>：一位高中毕业后离开丹麦来到加拿大创业公司工作人的自我学习之路。<ul><li>自我定位 T 型人才。</li><li>兴趣面广，主题阅读。</li><li>高亮关键内容，使用 anki 记忆，相关的想法用 zettelkasten 记录。</li><li>zettelkasten 使用纯文本 + 脚本实现。（如果只记录英文 vim 和 emacs 真的是很强大的软件）</li><li>利用谷歌检索的数量判断单词的重要性</li></ul></li><li><a href="https://fortelabs.co/blog/para/">The PARA Method: A Universal System for Organizing Digital Information - Forte Labs</a>：介绍 PARA 这种数字信息整理方法。</li><li><a href="https://tim.blog/2020/01/08/reading-recommendations/">The Best Books and Articles I Read in 2019 – The Blog of Author Tim Ferriss</a>：一篇 2019 年阅读总结文章。对作者介绍的阅读流程比较感兴趣：<ul><li>Evernote 搭配 web clipper 收集文章。 利用 <code>***</code> 以及高亮在文章中做笔记，方便之后进行快速回顾。</li><li>阅读 Kindle 格式的电子书，定期从亚马逊官网导出高亮笔记（国内不支持）。</li><li>利用 Readwise 回顾之前提到的高亮。</li><li>阅读实体书时，写简单的索引卡片，然后将卡片拍照导入 Evernote 中。</li></ul></li></ul><h2 id="机器学习"><a class="markdownIt-Anchor" href="#机器学习"></a> 机器学习</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/111842425">为什么有些深度学习网络要加入Product层？ - 知乎</a>：解释为什么 MLP 只包含特征累加而有学习特征交叉的能力，后面展开讲了一些提高模型特征交叉能力的方法。</li><li><a href="https://blog.csdn.net/u011508640/article/details/72815981">详解最大似然估计（MLE）、最大后验概率估计（MAP），以及贝叶斯公式的理解_网络_nebulaf91的博客-CSDN博客</a>：看过讲 MLE 和 MAP 比较清晰的文章。刚看开头的时候，想到自己大学上过《概率论和统计》居然没有考虑过概率和统计有什么区别……</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;读书&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#读书&quot;&gt;&lt;/a&gt; 读书&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/34672176/&quot;&gt;呼吸 (豆瓣)&lt;/a&gt;：这是</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202002 「山川异域，风月同天」</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202002.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202002.html</id>
    <published>2020-03-07T07:45:15.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>现在看来，又有多少人预测到这一次超级黑天鹅事件。</p><span id="more"></span><blockquote><p>这里记录过去一个月，我看到、想到值得分享的东西。</p></blockquote><h2 id="0x03-how-instapaper-changed-my-kindle-life-for-the-better"><a class="markdownIt-Anchor" href="#0x03-how-instapaper-changed-my-kindle-life-for-the-better"></a> 0x03 <a href="https://www.guidingtech.com/29107/instapaper-kindle-merits/">How Instapaper Changed My Kindle Life For the Better</a></h2><p>利用 Instapaper 定时将稍后读文章发送到 kindle 上。</p><h2 id="0x02-这是我为武汉雷神山-火神山医院设计的品牌形象标志logo-步行街主干道-虎扑社区"><a class="markdownIt-Anchor" href="#0x02-这是我为武汉雷神山-火神山医院设计的品牌形象标志logo-步行街主干道-虎扑社区"></a> 0x02 <a href="https://bbs.hupu.com/32137599.html">这是我为武汉雷神山、火神山医院设计的品牌形象标志logo - 步行街主干道 - 虎扑社区</a></h2><p><img src="https://media.xiang578.com/15807855350677.jpg" alt="" /></p><h2 id="0x01-山川异域风月同天"><a class="markdownIt-Anchor" href="#0x01-山川异域风月同天"></a> 0x01 <a href="https://weibo.com/1218287234/Is1lGejd6?type=comment#_rnd1580519347991">“山川异域，风月同天”</a></h2><blockquote><p>@扎宝：日本汉语水平考试HSK事务所捐赠给武湖北的物资，20000个口罩和一批红外体温计。<br />标签上写着“山川异域，风月同天”，感动[泪][泪]<br />求一个英文译文！<br />p.s. 据记载鉴真事迹的历史典籍《东征传》记载：日本长屋亲王在赠送大唐的千件袈裟上绣“山川异域，风月同天，寄诸佛子，共结来缘”偈。鉴真大师被此偈打动，决心东渡弘法。</p></blockquote><blockquote><p>@文冤阁大学士：We are created to share Nature and love. 扫了下原博评转，翻得都差我好几座唐招提寺。嘻嘻。</p></blockquote><p><img src="https://media.xiang578.com/15807341522123.jpg" alt="" /></p><h2 id="0x00-xgboost"><a class="markdownIt-Anchor" href="#0x00-xgboost"></a> 0x00 <a href="https://arxiv.org/abs/1603.02754">XGBoost</a></h2><p>春节在家，重新把这些经典的内容再拿出来多读几遍。网上写的那些总结感觉都不是很好，还是要回去看论文。说句实话，纸上谈兵这么久，居然没有跑过 xgb 的包……</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;现在看来，又有多少人预测到这一次超级黑天鹅事件。&lt;/p&gt;</summary>
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>2019 起步</title>
    <link href="https://blog.xiang578.com/post/2019.html"/>
    <id>https://blog.xiang578.com/post/2019.html</id>
    <published>2020-02-04T13:44:09.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>受 <a href="http://freemind.pluskid.org/">Free Mind</a> 的影响按这种形式写年度总结</p></blockquote><p>年初的时候看到一句话：「 2019 是过去十年中最差的一年，也是未来十年中最好的一年」。和其他人一样，我害怕不确定性，不过生活除了鼓起勇气前进，还有什么其他选择。</p><h2 id="工作"><a class="markdownIt-Anchor" href="#工作"></a> 工作</h2><p>完整在滴滴工作一年，自己没有太多变化，可是环境却变了很多。从年初内部会议上 Will 优化员工开始，很多同事陆续离开，从而我都快要成为团队元老……</p><p>做为食物链低端的算法工程师，工作中杂七杂八的事情干了很多。洗数据、跑模型、改工程代码、测试、上线、实验各个方面都干过。</p><p>说回来，算法还是自己的主要工具。今年用的最多的是 FM 和 GBDT，这些都是几年前的技术，但是架不住效果好，性能要求小。自己也写了一些相关的文章，可以供大家参考。</p><blockquote><p><a href="https://xiang578.com/post/fm.html">(FM) Factorization Machines | 算法花园</a></p><p><a href="https://xiang578.com/post/ftrl.html">(FTRL) Follow The Regularized Leader | 算法花园</a></p><p><a href="https://xiang578.com/post/gbdt.html">All About GBDT (1) | 算法花园</a></p><p><a href="https://xiang578.com/post/gbdt_lr.html">Practical Lessons from Predicting Clicks on Ads at Facebook(gbdt + lr) | 算法花园</a></p></blockquote><p>关于深度学习，在我入职前模型就基本迭代完成，今年主要探索个性化场景的解决以及模型性能优化。很遗憾，这两方面的工作目前还没有什么可以写成博客分享的。最后，自己没有参与到组内强化学习的项目中，不过还是通过李宏毅老师的相关课程了解初步的概念，争取 20 年内做一些相关的事情。</p><p>9月份开始，leader突然让我准备一些编程题目，开始去面试实习生。通过牛客网以及北邮人论坛大概收到简历60多份，我面试10多个候选人，最终通过的大概五六人，不过过来实习的也就 2 个。印证自己之前的想法，一家已经不是快速发展的公司，很难招到即懂机器学习又会做编程题的实习生。</p><p>另外想写的一点是是匿名交流。内部论坛之前有一个匿名区，后来由于一件比较有名的事情，匿名喷得太厉害，被某位海归高管以提高交流效率减少戾气所关闭（目前这位已经离职，有人开玩笑期待干掉他新公司的匿名论坛）。所幸脉脉还有职言（匿名）以及公司圈。在上面混了一年之后，越来越理解匿名交流的必要，说事。比如今年发生的延迟发年终奖，快手可以直接在内部匿名区引起宿华回复。我们的公司圈一堆人才自嗨。本质是国内环境下很难公开交流一些话题。</p><p>之前看过[一篇文章]中介绍 Google 的 TGIF：</p><blockquote><p>TGIF是Larry和Sergey在公司早期就创立的，一个全公司范围的周会。在这个周会上高管们会透露公司新项目的进展，也安排有答疑环节，员工可以询问两位创始人任何问题。TGIF毫无疑问是为了提高公司内部的透明度，但它在增强员工凝聚力的同时也对公司文化提出了挑战，最直接的就是保密问题。比如Chrome项目在公司内部的公开就是在一次TGIF上发生的，那时离Chrome的正式对外宣布早了一年多的时间。</p></blockquote><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><p>今年读过 <a href="https://book.douban.com/people/xiang578/collect?sort=time&amp;tags_sort=count&amp;filter=all&amp;tag=2019&amp;mode=grid">33</a> 本书，阅读量和前几年基本持平。年底发现自己的一个坏习惯：很多书读了一半就放在那里，导致开的坑很多。应对方法也很简单：一段时间内只读一本书。而且为了提高阅读的质量，将自己读完一本书的定义从读到最后一页改成完成对这本书内容的整理。</p><p>阅读的主要工具是 kindle 和微信阅读（iPhone）。kindle 是这么多年一直使用的阅读介质，从前几年的找破解图书到现在的完全中亚购买（以目前看书的频率还不至于承受不住），长时间看电子水墨屏能减轻一些疲劳。微信阅读的特点是白领无限卡后就能全场免费读，实在是太香了。理想状态下用这两个工具读不类型的材料，微信阅读读小说以及人物传记，kindle 看需要大量抄记的书。对于需要反复阅读的内容，实体书则是最佳的选择。</p><p>分享读完觉得不错的几本书：</p><ol><li>经济学通识/薛兆丰经济学讲义：薛兆丰目前看起来风评不是很好，这两本也不是什么严肃的经济学读物。前一本书是作者专栏文章的合集，后一本是得到专栏的文字版，两本书大量的内容是重复的。书中通过现实中的例子来讲解背后的经济学原理，很适合看完之后做为饭后谈资。反正我运用书中的一些原理，给同事分析好久公司的停车场应该怎么分配车位。</li><li>银河帝国：这一套书有很多本，只看完前三本。概括起来，这本小说是以太空为背景讲政治故事，以谢顿的预言为主线，讲述基地对抗各种危机的挑战。另外书中提到看起来有多少分像统计学的心理史学，谢顿一直用这种方法预测未来，而且信徒们一直强调，预测结果不会因为个人而改变。第三本书，围绕寻找第二基地展开，把所有读者能猜的地方都写了出来，选择了一种情理之中，意料之外的结局。</li><li>人类简史/未来简史：尤瓦尔·赫拉利是前几年很火的一个历史学家。人类简史主要是按他的框架回顾从原始人类到现代人类的文明发展历程。对于我这种没有系统接受过历史学教育的人，完全是一种震撼。未来简史讨论的是人类未来的发展方向，成神。</li><li>房思琪的初戀樂園：讲述一个小女孩被文明所不齿的方式杀死的故事，最让人痛心的这女孩就是作者本人……引用最近很流行的一句话：地狱空荡荡，魔鬼在人间。</li><li>基督山伯爵：看完《了不起的盖茨比》后，老板强力推荐的爽文小说。快意恩仇，永远不要丧失对生活的期望。</li><li>临高启明：工科党神书，死于历史空无主义，最后放上来缅怀一下。</li></ol><p>2020 年开始使用 Notion 记录读书过程，点击 <a href="https://www.notion.so/ryanx/4666b7440155430880b9c9787adde5ab?v=39111f7ebd5e4be6a28d7ef712c4aebb">看书也就图一乐</a> 查看。</p><h2 id="观影"><a class="markdownIt-Anchor" href="#观影"></a> 观影</h2><p>和去年一样，看电影比起看书来更加容易，豆瓣上轻松标记 <a href="https://movie.douban.com/people/xiang578/collect?sort=time&amp;tags_sort=count&amp;filter=all&amp;tag=2018&amp;mode=grid">60</a> 部。想想原因，打开一个视频放在那里，不用怎么理它就能结束。按类别推荐一下自己觉得不错的影视：</p><ol><li>小丑/蝙蝠侠三部曲：去年在观影中大力推荐漫威宇宙，今年看完 DC 这 4 部电影，刷新对超级英雄片的认知。蝙蝠侠：黑暗骑士在是在超级英雄的框架下对人性进行探讨。小丑展示出社会如何逼一个人成为恶魔。</li><li>黑客帝国三部曲：经典的电影，赛博朋克风格。之前的神话描述神创造了世界，在这部片子里面，这个神就变成了机器人。多少算是人工智能行业的从业者，强人工智能离我们看起来还是很远。</li><li>人生七年9：这应该是拍摄时间最慢长的纪录片，也给我们机会在几十个小时时间里面见证这些主人公 60 多年岁月。很大一个感受，除了 Nick 之外，其他人不过是重复父辈的道路，阶级跃迁又是谈何容易。</li><li>哪吒之魔童降世：即大鱼海棠之后，第二部在电影院看的动画电影。之前想过一个问题：为什么一些小说要隔一段时间就翻拍一次？简单的认为要赋予时代主题。这部片子中最喜欢的一个设定：龙族也是妖怪，镇守龙宫，其实也是镇住自己。</li><li>邪不压正：电影看到一半的时候，我就觉得自己看不懂。说回来，看这部电影有一种酣畅淋漓的感觉，节奏很快，比《一步之遥》和《让子弹飞》更快。半夜在知乎上看了很多回答之后渐渐地懂得其中的情节，蓝先生的爱国情怀，李的复仇梦想。在历史的框架下演绎，始终无法逃离历史的结果，日本人还会按照发展进入北京城。一句“异父异母的亲兄弟”就值得一看。</li></ol><h2 id="游戏"><a class="markdownIt-Anchor" href="#游戏"></a> 游戏</h2><p>今年新增的一个板块，自从购入 Switch 之后，开始重新接触一些游戏。</p><ol><li>隐形守护者：抗战背景下面，一个特工面对选择的游戏。所有的场景都是真实拍摄出来的，比绝大部分国内的抗战剧精美。游戏有很多个结局，当然只有符合社会主义核心价值观的才算善终。最印象深刻是第二号突然的一句：什么都是马尔可夫链。</li><li>有氧拳击/健身环大冒险：NS 上的铁人三项之二，充分发挥体感的优势，晚上下班之后健身用。不过从目前的使用频率来看，大概率和买健身卡一个性质。</li><li>塞尔达传说：旷野之息：决定买 Switch 很大程度上源于少数派中一篇关于这个游戏的介绍，大意是没有传统的等级增长，只有你真正掌握一个技巧，林克才能使用出来。这款游戏的给我带来看似无限大的空间，但也有一点遗憾，有时候遇到下雨不好攀岩时，我想让林克坐下等雨停，然后发现没有坐下的选项……</li><li>超级马力欧创作家2：大学的时候，经常看超级小桀玩这个游戏。对于我这种连普通的马里奥都要靠无敌才能通关的来说，大部分自制的地图还是有点难的。说回来，买这个游戏就是买一个青春。只可惜物是人非。</li><li>暗黑破坏神3：永恒之战版 ：Switch 上的冷饭，自己瞎玩了很久，看完所有的剧情。最终在咸鱼上买了很多强力的装备后，速通 150 层大秘境后索然无味。所以玩游戏还是不要作弊。</li></ol><h2 id="未来"><a class="markdownIt-Anchor" href="#未来"></a> 未来</h2><p>世界变化太快，未来可期。</p><p>于浙江临海</p><p><a href="https://xiang578.com/post/2017.html">2017 迷茫</a> &gt;&gt; <a href="https://xiang578.com/post/2018.html">2018 探索</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;受 &lt;a href=&quot;http://freemind.pluskid.org/&quot;&gt;Free Mind&lt;/a&gt; 的影响按这种形式写年度总结&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;年初的时候看到一句话：「 2019 是过去十年中最差的一年，也是未来</summary>
      
    
    
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="movie" scheme="https://blog.xiang578.com/tags/movie/"/>
    
    <category term="game" scheme="https://blog.xiang578.com/tags/game/"/>
    
  </entry>
  
  <entry>
    <title>All About GBDT (1)</title>
    <link href="https://blog.xiang578.com/post/gbdt.html"/>
    <id>https://blog.xiang578.com/post/gbdt.html</id>
    <published>2020-01-26T06:15:43.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>GBDT(Gradient Boosting Decision Tree) 从名字上理解包含三个部分：提升、梯度和树。它最早由 Freidman 在 <code>greedy function approximation ：a gradient boosting machine</code> 中提出。很多公司线上模型是基于 GBDT+FM 开发的，我们 Leader 甚至认为 GBDT 是传统的机器学习集大成者。断断续续使用 GBDT 一年多后，大胆写一篇有关的文章和大家分享。</p><h2 id="朴素的想法"><a class="markdownIt-Anchor" href="#朴素的想法"></a> 朴素的想法</h2><p>假设有一个游戏：给定数据集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(x_1,y_1),(x_2,y_2),...,(x_n,y_n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，寻找一个模型<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\hat y=F(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，使得平方损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{\sum \frac{1}{2}(\hat y_i - y_i)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 最小。</p><p>如果你的朋友提供一个可以使用但是不完美的模型，比如</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0.8</mn><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">F(x_1)=0.8,y_1=0.9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1.4</mn><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mn>1.3</mn></mrow><annotation encoding="application/x-tex">F(x_2)=1.4,y_2=1.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">3</span></span></span></span></span></p><p>在如何不修改这个模型的参数情况下，提高模型效果？</p><p>一个简单的思路是：重新训练一个模型实现</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F(x_1)+h(x_1)=y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F(x_2)+h(x_2)=y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">F(x_n)+h(x_n)=y_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>换一个角度是用模型学习数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(x_1,y_1-F(x_1)),(x_2,y_2-F(x_2)),...,(x_n,y_n-F(x_n))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>。得到新的模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\hat y=F(x_i)+h(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{y_i-F(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的部分被我们称之为残差，即之前的模型没有学习到的部分。重新训练模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{h(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>正是学习残差。如果多次执行上面的步骤，可以将流程描述成：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F_0(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>h</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F_1(x)=F_0(x)+h_1(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F_2(x)=F_1(x)+h_2(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">{...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>t</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F_t(x)=F_t-1(x)+h_t(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span></p><p>即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x;w)=\sum^T_{t=1}h_t(x;w)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></span>，这也就是 GBDT 。</p><h2 id="如何理解-gradient-boosting-decision-tree"><a class="markdownIt-Anchor" href="#如何理解-gradient-boosting-decision-tree"></a> 如何理解 Gradient Boosting Decision Tree ?</h2><p>Gradient Boosting Decision Tree 简称 GBDT，最早由 Friedman 在论文《Greedy function approximation: a gradient boosting machine》中提出。简单从题目中理解包含三个部分内容：Gradient Descent、Boosting、Decision Tree。</p><p>Decision Tree 即决策树，利用超平面对特征空间划分来预测和分类，根据处理的任务不同分成两种：分类树和回归树。在 GBDT 算法中，用到的是 CART 即分类回归树。用数学语言来描述为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{F=\{f(x)=w_{q(x)}\}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>，完成样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span></span> 到决策树叶子节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> 的映射，并将该叶子节点的权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">{w_{q(x)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7857599999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span></span> 赋给样本。CART 中每次通过计算 gain 值贪心来进行二分裂。</p><p>Boosting 是一种常用的集成学习方法（另外一种是 Bagging）。利用弱学习算法，反复学习，得到一系列弱分类器（留一个问题，为什么不用线性回归做为弱分类器）。然后组合这些弱分类器，构成一个强分类器。上面提到的模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x;w)=\sum^T_{t=1}h_t(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> 即是一种 boosting 思路，依次训练多个 CART 树 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{h_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>，并通过累加这些树得到一个强分类器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x;w)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></span>。</p><h2 id="为什么-gbdt-可行"><a class="markdownIt-Anchor" href="#为什么-gbdt-可行"></a> 为什么 GBDT 可行？</h2><p>在 2 中我提到 GBDT 包括三个部分并且讲述了 Boosting 和 Decison Tree。唯独没有提到 Gradient Descent，GBDT 的理论依据却恰恰和它相关。</p><p>回忆一下，Gradient Descent 是一种常用的最小化损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{L(\theta)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span> 的迭代方法。</p><ul><li>给定初始值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">{\theta_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li><li>迭代公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>θ</mi><mi>t</mi></msup><mo>=</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">{\theta ^t = \theta ^{t-1} + \Delta \theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span></li><li>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{L(\theta ^t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{\theta ^{t-1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> 处进行一阶泰勒展开：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><mo stretchy="false">)</mo><mo>≈</mo><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><msup><mi>L</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">{L(\theta ^t)=L(\theta ^{t-1} + \Delta \theta) \approx L(\theta ^{t-1}) + L^\prime(\theta ^{t-1})\Delta \theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span></li><li>要使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo>&lt;</mo><mi>L</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{L(\theta ^t) &lt; L(\theta ^{t-1}) }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>θ</mi><mo>=</mo><mo>−</mo><mi>α</mi><msup><mi>L</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\Delta \theta = -\alpha L^\prime(\theta ^{t-1})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li><li>其中  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span> 是步长，可以通过 line search 确定，但一般直接赋一个很小的数。</li></ul><p>在 1 中提到的问题中，损失函数是 MSE <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{L(y, F(x))=\frac{1}{2}(y_i - f(x_i))^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>。</p><p>我们的任务是通过调整 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x_1), F(x_2), ..., F(x_n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{J=\sum_i L(y_i, F(x_i))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>。</p><p>如果将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 当成是参数，并对损失函数求导得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mo>∑</mo><mi>i</mi></msub><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{ \frac{\partial J}{\partial F(x_i)} = \frac{\partial \sum_i L(y_i, F(x_i))}{\partial F(x_i)} = \frac{\partial L(y_i, F(x_i))}{\partial F(x_i)} = F(x_i)-y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.580007em;vertical-align:-0.52em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.060007em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5350070000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1496471428571428em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathnormal mtight">L</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>。</p><p>可以发现，在 1 中提到的模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{h(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> 学习的残差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{y_i-F(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>正好等于负梯度，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">{y_i-F(x_i)=-\frac{\partial J}{\partial F(x_i)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>。</p><p>所以，参数的梯度下降和函数的梯度下降原理上是一致的：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">{F_{t+1}(x_i)=F_t(x_i)+h(x_i)=F(x_i)+y_i-F(x_i)=F_t(x_i)-1\frac{\partial J}{\partial F(x_i)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>θ</mi><mi>t</mi></msup><mo>=</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>α</mi><msup><mi>L</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\theta ^t = \theta ^{t-1} + \alpha L^\prime(\theta ^{t-1})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ul><h2 id="gbdt-算法流程"><a class="markdownIt-Anchor" href="#gbdt-算法流程"></a> GBDT 算法流程</h2><p>模型 F 定义为加法模型：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mi>α</mi><mi>m</mi></msub><msub><mi>h</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><msub><mi>w</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mi>f</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><msub><mi>w</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F(x;w)=\sum^{M}_{m=1} \alpha_m h_m(x;w_m) = \sum^{M}_{m=1}f_t(x;w_t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p><p>其中，x 为输入样本，h 为分类回归树，w 是分类回归树的参数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span> 是每棵树的权重。</p><p>通过最小化损失函数求解最优模型：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>F</mi></msub><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{F^* = argmin_F \sum^N_{i=1}L(y_i, F(x_i))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>输入: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">{(x_i,y_i),T,L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span></span></span></span></span></p><ol><li>初始化：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f_0(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></li><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi>t</mi><mi>o</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">{t = 1 to T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> ：<ol><li>计算负梯度（伪残差）： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>~</mo></mover><mo>=</mo><mo>−</mo><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><msub><mo stretchy="false">]</mo><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">{ \tilde{y_i} = -[\frac{\partial L(y_i, F(x_i))}{\partial F(x)}]_{F(x)=F_{m-1}(x)} ,i=1,2,...,N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></li><li>根据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">{\tilde{y_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8622999999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span> 学习第 m 棵树： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>w</mi></msub><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>~</mo></mover><mo>−</mo><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">;</mo><mi>w</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{w^*=argmin_{w} \sum_{i=1}^N(\tilde{y_i} - h_t(x_i;w))^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li><li>line searcher 找步长：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ρ</mi><mo>∗</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>ρ</mi></msub><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>L</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>ρ</mi><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">;</mo><msup><mi>w</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\rho^* = argmin_\rho \sum_{i=1}^{N}L(y_i, F_{t-1}(x_i)+\rho h_t(x_i;w^*))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ρ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">ρ</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></li><li>令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mo>=</mo><msup><mi>ρ</mi><mo>∗</mo></msup><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>w</mi><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f_t=\rho^*h_t(x;w*)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span></span>，更新模型：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>t</mi></msub><mo>=</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{F_t=F_{t-1}+f_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li></ol></li><li>输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">{F_T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li></ol><p>说明：</p><ol><li>初始化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">{f_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 方法<ol><li>求解损失函数最小</li><li>随机初始化</li><li>训练样本的充分统计量</li></ol></li><li>每一轮拟合负梯度，而不是拟合残差，是为方便之后扩展到其他损失函数。</li><li>最小化问题中，如果有解析解，直接带入。否则，利用泰勒二阶展开，Newton Step 得到近似解。</li></ol><p>这一篇就先到这里，之后还会分享 GBDT 常用损失函数推导以及 XGboost 相关内容。如果有任何想法，都可以在留言区和我交流。</p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ol><li>李航, 《统计学习方法》8.4 提升树</li><li>Freidman，greedy function approximation ：a gradient boosting machine</li><li><a href="https://zhuanlan.zhihu.com/p/73381835">【19年ML思考笔记】GBDT碎碎念（1）谈回归树的分裂准则 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/29765582">机器学习-一文理解GBDT的原理-20171001 - 知乎</a></li><li><a href="https://louisscorpio.github.io/2017/12/13/GBDT%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/#">GBDT入门详解 - Scorpio.Lu|Blog</a></li><li><a href="https://stackoverflow.com/questions/45409110/why-gradient-boosting-not-working-in-linear-regression">python - Why Gradient Boosting not working in Linear Regression? - Stack Overflow</a></li><li><a href="https://blog.csdn.net/qq_24519677/article/details/82020863">GBDT基本原理及算法描述 - Y学习使我快乐V的博客 - CSDN博客</a></li><li><a href="https://zhuanlan.zhihu.com/p/30711812">GBDT的那些事儿 - 知乎</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GBDT(Gradient Boosting Decision Tree) 从名字上理解包含三个部分：提升、梯度和树。它最早由 Freidman 在 &lt;code&gt;greedy function approximation ：a gradient boosting machi</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="ml" scheme="https://blog.xiang578.com/tags/ml/"/>
    
    <category term="gbdt" scheme="https://blog.xiang578.com/tags/gbdt/"/>
    
  </entry>
  
  <entry>
    <title>(FTRL) Follow The Regularized Leader</title>
    <link href="https://blog.xiang578.com/post/ftrl.html"/>
    <id>https://blog.xiang578.com/post/ftrl.html</id>
    <published>2020-01-03T13:26:06.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>FTRL 是 Google 提出的一种优化算法。常规的优化方法例如梯度下降、牛顿法等属于批处理算法，每次更新需要对 batch 内的训练样本重新训练一遍。在线学习场景下，我们希望模型迭代速度越快越好。例如用户发生一次点击行为后，模型就能快速进行调整。FTRL 在这个场景中能求解出稀疏化的模型。</p><h2 id="基础知识"><a class="markdownIt-Anchor" href="#基础知识"></a> 基础知识</h2><ul><li>L1 正则比 L2 正则可以产生更稀疏的解。</li><li>次梯度：对于 L1 正则在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 处不可导的情况，使用次梯度下降来解决。次梯度对应一个集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>v</mi><mo>:</mo><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{v: v(x-x_t) \le f(x)-f(x_t)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span>，集合中的任意一个元素都能被当成次梯度。以 L1 正则为例，非零处梯度是 1 或 -1，所以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 处的次梯度可以取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 之内任意一个值。</li></ul><h2 id="ftl"><a class="markdownIt-Anchor" href="#ftl"></a> FTL</h2><p>FTL(Follow The Leader) 算法：每次找到让之前所有损失函数之和最小的参数。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>W</mi></msub><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W=argmin_W \sum^t_{i=1}F_i(W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.05823em;vertical-align:-1.277669em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></span></p><p>FTRL 中的 R 是 Regularized，可以很容易猜出来在 FTL 的基础上加正则项。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>W</mi></msub><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo><mo>+</mo><mi>R</mi><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W=argmin_W \sum^t_{i=1}F_i(W) + R(W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.05823em;vertical-align:-1.277669em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></span></p><h2 id="代理函数"><a class="markdownIt-Anchor" href="#代理函数"></a> 代理函数</h2><p>FTRL 的损失函数直接很难求解，一般需要引入一个代理损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>。代理损失函数常选择比较容易求解析解以及求出来的解和优化原函数得到的解差距不能太大。</p><p>我们通过两个解之间的距离 Regret 来衡量效果：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>=</mo><msub><mo><mi mathvariant="normal">argmin</mi><mo>⁡</mo></mo><mi>w</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mtext>Regret</mtext><mi>t</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msub><mi>w</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>f</mi><mi>t</mi></msub><mrow><mo fence="true">(</mo><msup><mi>w</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c}{w_{t}=\operatorname{argmin}_{w} h_{t-1}(w)} \\ {\text {Regret}_{t}=\sum_{t=1}^{T} f_{t}\left(w_{t}\right)-\sum_{t=1}^{T} f_{t}\left(w^{*}\right)}\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5412310000000007em;vertical-align:-1.0206155000000006em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5206155000000001em;"><span style="top:-3.6806155em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span style="top:-2.3393844999999995em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Regret</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18641599999999994em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0206155000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">w^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> 是直接优化 FTRL 算法得到的参数。当距离满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>t</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></msub><mfrac><msub><mtext>Regret</mtext><mi>t</mi></msub><mi>t</mi></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lim _{t \rightarrow \infty} \frac{\text {Regret}_{t}}{t}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.319439em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop">lim</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.974439em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.496108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Regret</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1734742857142857em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，损失函数认为是有效的。其物理意义是，随着训练样本的增加，两个优化目标优化出来的参数效果越接近。</p><h2 id="推导过程"><a class="markdownIt-Anchor" href="#推导过程"></a> 推导过程</h2><p>参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 的迭代公式：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>w</mi></msub><mo stretchy="false">{</mo><msub><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mi>w</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">∥</mo><mi>w</mi><mo>−</mo><msub><mi>w</mi><mi>s</mi></msub><msup><mo stretchy="false">∥</mo><mn>2</mn></msup><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msup><mo stretchy="false">∥</mo><mn>2</mn></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{w_{t+1}=argmin_w\{ g_{(1:t)}w + \frac{1}{2} \sum_{s=1}^t \sigma_s \lVert w - w_s \rVert ^2   + \lambda_1 \lVert W \rVert_1 + \frac{1}{2} \lambda_2 \lVert W \rVert^2 \}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.047674em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">g_{(1:t)}=\sum^{t}_{s=1}g_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7857599999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.233166em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">g_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(w_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的次梯度。参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\sum^t_{s=1}\sigma_s=\frac{1}{\eta _t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233166em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>t</mi></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mi>t</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\eta _t = \frac{1}{\sqrt{t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.383108em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.5612844999999997em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.898165em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-2.858165em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14183500000000004em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，随着迭代轮数增加而减少。</p><p>展开迭代公式</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mi>w</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">∥</mo><mi>w</mi><mo>−</mo><msub><mi>w</mi><mi>s</mi></msub><msup><mo stretchy="false">∥</mo><mn>2</mn></msup><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msup><mo stretchy="false">∥</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{F(w)=  g_{(1:t)}w + \frac{1}{2} \sum_{s=1}^t \sigma_s \lVert w - w_s \rVert ^2   + \lambda_1 \lVert W \rVert_1 + \frac{1}{2} \lambda_2 \lVert W \rVert^2 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.047674em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mi>w</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>−</mo><mn>2</mn><msup><mi>w</mi><mi>T</mi></msup><msub><mi>w</mi><mi>s</mi></msub><mo>+</mo><msubsup><mi>w</mi><mi>s</mi><mi>T</mi></msubsup><msub><mi>w</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msup><mo stretchy="false">∥</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{F(w)=  g_{(1:t)}w + \frac{1}{2} \sum_{s=1}^t \sigma_s ( w^Tw - 2w^Tw_s + w_s^Tw_s)   + \lambda_1 \lVert W \rVert_1 + \frac{1}{2} \lambda_2 \lVert W \rVert^2 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.047674em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>σ</mi><mi>s</mi></msub><msub><mi>w</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mi>w</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><msub><mi>σ</mi><mi>s</mi></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">{F(w)=  (g_{(1:t)} - \sum_{s=1}^t \sigma_s w_s)w + \frac{1}{2} (\sum_{s=1}^t \sigma_s + \lambda_2) w^Tw   + \lambda_1 \lVert W \rVert_1 + const }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.047674em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>z</mi><mi>t</mi><mi>T</mi></msubsup><mi>w</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">{F(w)=  z_t^Tw + \frac{1}{2} (\frac{1}{\eta _t} + \lambda_2) w^Tw   + \lambda_1 \lVert W \rVert_1 + const }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>σ</mi><mi>s</mi></msub><msub><mi>w</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{z_{t-1}=g^{(1:t-1)} - \sum_{s=1}^{t-1} \sigma_s w_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>。</p><p>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span> 求偏导得到：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>w</mi><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mi mathvariant="normal">∂</mi><mo stretchy="false">∣</mo><mi>W</mi><mo stretchy="false">∣</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{z_t + (\frac{1}{\eta _t} + \lambda_2) w + \lambda_1 \partial \lvert W \rvert = 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> 异号时，等式成立。</p><p>根据基础知识里面提到的对于 L1 正则利用偏导数代替无法求解的情况，得到：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">∣</mi><mi>W</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mo>−</mo><mn>1</mn><mo>&lt;</mo><mi>w</mi><mo>&lt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>w</mi><mo>&gt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>w</mi><mo>&lt;</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\partial|W|=\left\{\begin{array}{ll}{0,} &amp; {\text { if }-1&lt;w&lt;1} \\ {1,} &amp; {\text { if } w&gt;1} \\ {-1,} &amp; {\text { if } w&lt;-1}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.00501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><ol><li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>&gt;</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{  z_t  &gt; \lambda_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{w_i &lt; 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mo>−</mo><msub><mi>z</mi><mi>t</mi></msub><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><mrow><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">{w_i = \frac{- z_t + \lambda_1 }{\frac{1}{\eta _t} + \lambda_2 }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6731679999999998em;vertical-align:-0.7769599999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962079999999999em;"><span style="top:-2.59898em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.1em;"><span class="pstrut" style="height:2.61508em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27027999999999996em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5370571428571428em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7769599999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>&lt;</mo><mo>−</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{  z_t &lt; - \lambda_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{w_i &gt; 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mo>−</mo><msub><mi>z</mi><mi>t</mi></msub><mo>−</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><mrow><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">{w_i = \frac{- z_t - \lambda_1 }{\frac{1}{\eta _t} + \lambda_2 }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6731679999999998em;vertical-align:-0.7769599999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962079999999999em;"><span style="top:-2.59898em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.1em;"><span class="pstrut" style="height:2.61508em;"></span><span class="mord mathnormal mtight">t</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27027999999999996em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5370571428571428em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7769599999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy="false">∣</mo><mo>&lt;</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{ \lvert z_t \rvert &lt; \lambda_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 时，当且仅当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{w_i=0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span> 成立</li></ol><p>因此可得：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mrow><mo fence="true">∣</mo><msub><mi>z</mi><mi>i</mi></msub><mo fence="true">∣</mo></mrow><mo>≤</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mo>−</mo><mrow><mo fence="true">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mtext>s</mtext><mi>g</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>λ</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>η</mi><mi>t</mi></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> if others </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">w_{i}=\left\{\begin{array}{ll}{0,} &amp; {\text { if }\left|z_{i}\right| \leq \lambda_{1}} \\ {\frac{-\left(z_{i}-\text sgn(z_i) \lambda_{1}\right)}{\eta_{t}+\lambda_{2}},} &amp; {\text { if others }}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.595554em;"><span style="top:-3.7655539999999994em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span style="top:-2.3955539999999997em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord text mtight"><span class="mord mtight">s</span></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.04398em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.095554em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.595554em;"><span style="top:-3.7655539999999994em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.3955539999999997em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord"> if others </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.095554em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="ftrl-和-sgd-的关系"><a class="markdownIt-Anchor" href="#ftrl-和-sgd-的关系"></a> FTRL 和 SGD 的关系</h2><p>将 SGD 的迭代公式写成：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>W</mi><mi>t</mi></msup><mo>−</mo><msub><mi>η</mi><mi>t</mi></msub><msub><mi>g</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{W^{t+1}=W^t - \eta _tg_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>FTRL 迭代公式为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>w</mi></msub><mo stretchy="false">{</mo><msup><mi>G</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>:</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mi>W</mi><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="false">∥</mo><mi>W</mi><msub><mo stretchy="false">∥</mo><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">∥</mo><mi>W</mi><mo stretchy="false">∥</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{W^{t+1}=argmin_w\{ G^{(1:t)}W + \lambda_1 \lVert W \rVert_1 +\lambda_2 \frac{1}{2} \lVert W \rVert \}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2329999999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">∥</span><span class="mclose">}</span></span></span></span></span></p><p>代入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">{\sum^t_{s=1}\sigma _s= \frac{1}{\eta _t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.414564em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> 到上面的公式中，得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>w</mi></msub><mo stretchy="false">{</mo><msubsup><mo>∑</mo><mi>t</mi><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow></msubsup><msub><mi>g</mi><mi>s</mi></msub><mi>W</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">∥</mo><mi>W</mi><mo>−</mo><msub><mi>W</mi><mi>s</mi></msub><msubsup><mo stretchy="false">∥</mo><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{W^{t+1}=argmin_w\{ \sum_t^{s=1}g_sW + \frac{1}{2} \sum^t_{s=1}\sigma _s\lVert W - W_s \rVert_2^2 \}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.299008em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∥</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p><p>求偏导得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>g</mi><mi>s</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>W</mi><mo>−</mo><msub><mi>W</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\frac{\partial f(w)}{\partial w} = \sum^t_{s=1}g_s +  \sum^t_{s=1}\sigma _s( W - W_s )}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>令偏导等于 0 ：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>g</mi><mi>s</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>W</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\sum^t_{s=1}g_s +  \sum^t_{s=1}\sigma _s( W^{t+1} - W_s ) = 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233166em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span></p><p>化简得到：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><mo stretchy="false">)</mo><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><msup><mi>W</mi><mi>s</mi></msup><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{(\sum^t_{s=1}\sigma _s) W^{t+1} = \sum^t_{s=1}\sigma _s W^{s} -  \sum^t_{s=1}g_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233166em;vertical-align:-0.29971000000000003em;"></span><span class="mord"><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>代入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>σ</mi><mi>s</mi></msub><msup><mi>W</mi><mi>s</mi></msup><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\frac{1}{\eta _t} W^{t+1} = \sum^t_{s=1}\sigma _s W^{s} -  \sum^t_{s=1}g_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.414564em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.933456em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>根据上一个公式得出上一轮的迭代公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>η</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mfrac><msup><mi>W</mi><mi>t</mi></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>σ</mi><mi>s</mi></msub><msup><mi>W</mi><mi>s</mi></msup><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\frac{1}{\eta _{t-1}} W^{t} = \sum^{t-1}_{s=1}\sigma _s W^{s} -  \sum^{t-1}_{s=1}g_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.440773em;vertical-align:-0.486765em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.486765em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>两式相减：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mfrac><mn>1</mn><msub><mi>η</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mfrac><msup><mi>W</mi><mi>t</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>η</mi><mi>t</mi></msub></mfrac><mo>−</mo><mfrac><mn>1</mn><msub><mi>η</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mfrac><mo stretchy="false">)</mo><msub><mi>W</mi><mi>t</mi></msub><mo>−</mo><msub><mi>g</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\frac{1}{\eta _t} W^{t+1} - \frac{1}{\eta _{t-1}} W^{t} = (\frac{1}{\eta _t} - \frac{1}{\eta _{t-1}}) W_t - g_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3318729999999999em;vertical-align:-0.486765em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.486765em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.486765em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>最终化简得到和 SGD 迭代公式相同的公式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>W</mi><mi>t</mi></msub><mo>−</mo><msub><mi>η</mi><mi>t</mi></msub><msub><mi>g</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{W_{t+1} = W_t - \eta_t g_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><h2 id="ftrl-工程化伪代码"><a class="markdownIt-Anchor" href="#ftrl-工程化伪代码"></a> FTRL 工程化伪代码</h2><p>引用自论文 <a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/41159.pdf">Ad Click Prediction: a View from the Trenches</a></p><p>下面的伪代码中学习率和前面公式推导时使用的一些不一样： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><msub><mi>t</mi><mi>i</mi></msub></msub><mo>=</mo><mfrac><mi>α</mi><mrow><mi>β</mi><mo>+</mo><msqrt><mrow><msubsup><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msubsup><mi>g</mi><msub><mi>s</mi><mi>i</mi></msub><mn>2</mn></msubsup></mrow></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">\eta_{t_{i}}=\frac{\alpha}{\beta+\sqrt{\sum_{s=1}^{t} g_{s_{i}}^{2}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.724992em;vertical-align:-1.0296em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.4251725em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="mbin mtight">+</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0926107142857144em;"><span class="svg-align" style="top:-3.7142857142857144em;"><span class="pstrut" style="height:3.7142857142857144em;"></span><span class="mord mtight" style="padding-left:1.4285714285714286em;"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8364857142857143em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.214em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.65952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5107999999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.064610714285714em;"><span class="pstrut" style="height:3.7142857142857144em;"></span><span class="hide-tail mtight" style="min-width:1.02em;height:1.8285714285714287em;"><svg width='400em' height='1.8285714285714287em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.649675em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0296em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。Facebook 在 GBDT + LR 的论文中研究过不同的学习率影响，具体可以参看博文 <a href="https://xiang578.com//post/media/gbdt_lr.html#%E5%AD%A6%E4%B9%A0%E7%8E%87%E9%80%89%E6%8B%A9">Practical Lessons from Predicting Clicks on Ads at Facebook(gbdt + lr) | 算法花园</a>。</p><p><img src="https://media.xiang578.com/15780559628822.jpg" alt="FTRL" /></p><h2 id="例fm-使用-ftrl-优化"><a class="markdownIt-Anchor" href="#例fm-使用-ftrl-优化"></a> 例：FM 使用 FTRL 优化</h2><p>FM 是工业界常用的机器学习算法，在之前博文 <a href="https://xiang578.com/post/fm.html">(FM)Factorization Machines</a> 中有简单的介绍。内部的 FTRL+FM 代码没有开源，所以也不好分析。从 <a href="https://zhuanlan.zhihu.com/p/58508137">FM+FTRL算法原理以及工程化实现 - 知乎</a> 中找了一张 FTRL+FM 的伪代码图片。</p><p><img src="https://media.xiang578.com/15780576261639.jpg" alt="" /></p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://tech.meituan.com/2016/04/21/online-learning.html">Online Learning算法理论与实践 - 美团技术团队</a></li><li><a href="https://zhuanlan.zhihu.com/p/32694097">FTRL公式推导 - 知乎</a></li><li><a href="https://blog.csdn.net/fangqingan_java/article/details/51020653">每周一文】Ad Click Prediction: a View from the Trenches(2013)_机器学习,CTR,online_fangqingan_java的专栏-CSDN博客</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;FTRL 是 Google 提出的一种优化算法。常规的优化方法例如梯度下降、牛顿法等属于批处理算法，每次更新需要对 batch 内的训练样本重新训练一遍。在线学习场景下，我们希望模型迭代速度越快越好。例如用户发生一次点击行为后，模型就能快速进行调整。FTRL 在这个场景中能</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="google" scheme="https://blog.xiang578.com/tags/google/"/>
    
    <category term="ml" scheme="https://blog.xiang578.com/tags/ml/"/>
    
    <category term="fm" scheme="https://blog.xiang578.com/tags/fm/"/>
    
    <category term="ftrl" scheme="https://blog.xiang578.com/tags/ftrl/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 202001 Fine-Tune Your Days</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-202001.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-202001.html</id>
    <published>2020-01-01T08:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><blockquote><p>这里记录过去一个月，我看到、想到值得分享的东西，每周六滚动更新。</p></blockquote><h2 id="0x04-你见过哪些让你目瞪口呆-脑洞大开的骗局-sme情报员的回答-知乎"><a class="markdownIt-Anchor" href="#0x04-你见过哪些让你目瞪口呆-脑洞大开的骗局-sme情报员的回答-知乎"></a> 0x04 <a href="https://www.zhihu.com/question/41182911/answer/966701311">你见过哪些让你目瞪口呆、脑洞大开的骗局？ - SME情报员的回答 - 知乎</a></h2><p>推荐其中的吉普赛读心术，当成脑筋急转弯来看。</p><blockquote><p>首先任选一个两位数，在心里默默记住，然后用这个两位数再依次减去它的十位和个位，最后用得数查表，找到对应的怪符号。 比如67,相应的计算就是67-6-7=54， 现在，在表中找到你心中数字经过计算后所对应的符号。</p></blockquote><p><img src="https://media.xiang578.com/15792508672842.jpg" alt="" /></p><p>最后的答案都会是</p><p><img src="https://media.xiang578.com/15792508879083.jpg" alt="" /></p><h2 id="0x03-deep-neural-networks-for-youtube-recommendations-paper-ml"><a class="markdownIt-Anchor" href="#0x03-deep-neural-networks-for-youtube-recommendations-paper-ml"></a> 0x03 Deep Neural Networks for YouTube Recommendations #paper #ml</h2><p>Youtube 几年前的论文，最近拿过来看一下。工业界的论文最大的价值是提到的一些 tick，比如这篇论文中分析到用户对新视频的偏好，引入 example age 代表视频的上传到预测时的时间。再比如，给用户推荐视频时，考虑用户看过这个视频相关频道次数以及这个视频在用户实现中出现的次数。所以，做算法实现需要深入理解自己所处的场景。</p><p>推荐知乎上一些关于这篇论文的解读：</p><blockquote><ul><li><a href="https://zhuanlan.zhihu.com/p/25343518">Deep Neural Network for YouTube Recommendation论文精读 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/52169807">重读Youtube深度学习推荐系统论文，字字珠玑，惊为神文 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/52504407">YouTube深度学习推荐系统的十大工程问题 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/61827629">揭开YouTube深度推荐系统模型Serving之谜 - 知乎</a></li></ul></blockquote><h2 id="0x02-fine-tune-your-days-with-the-scientific-method"><a class="markdownIt-Anchor" href="#0x02-fine-tune-your-days-with-the-scientific-method"></a> 0x02 Fine-Tune Your Days with the Scientific Method</h2><p>这个小标题出自 <a href="https://book.douban.com/subject/30327043/">Make Time</a>，翻译成中文是利用科学的方法每天微调你的习惯。</p><h2 id="0x01-2020-阅读看板"><a class="markdownIt-Anchor" href="#0x01-2020-阅读看板"></a> 0x01 2020 阅读看板</h2><p>参考部分网友 Notion 的用法，搭建一个自己的阅读看板 <a href="https://www.notion.so/ryanx/4666b7440155430880b9c9787adde5ab?v=39111f7ebd5e4be6a28d7ef712c4aebb">看书也就图一乐</a>。目前挑选出来的书远远超过前两年的阅读量，加油一起读书。</p><p>Notion 这种一个数据库 + 可选的 View 很接近我心目中任务管理软件的极限。</p><p><img src="https://media.xiang578.com/15782399749595.jpg" alt="reading board" /></p><h2 id="0x00-大佬们的年度总结"><a class="markdownIt-Anchor" href="#0x00-大佬们的年度总结"></a> 0x00 大佬们的年度总结</h2><p>新的一年开始时，最期待翻看大佬们的年度总结，罗列一些我觉得有总结。</p><ul><li><a href="https://yiming.dev/blog/2019/12/31/growing-a-result-driven-mindset/">Growing a Result-Driven Mindset - Yiming Chen</a>：英文总结，Yiming 的博客给我带来学习英语并且用之来表达的动力。</li><li><a href="https://wdxmzy.com/pastfuture/year2019/2019/12/31/">2019 总结与 2020 计划 | 小土刀 2.0</a>：从不同角度回顾自己的 2019 年。</li><li><a href="http://freemind.pluskid.org/misc/2019-summary/">2019 时光小偷</a>：这位博主每年总结的标题都是一首歌，也是几年前看他的总结才开始尝试写自己的总结。</li><li><a href="https://zhuanlan.zhihu.com/p/100357148">致敬时间的价值：一品十年 - 知乎</a>：和这个主题没有太大的关系，看一下其他人十年的总结，也能很好的指导自己的生活。</li><li><a href="http://zhengruonan.com/2019/12/29/2019-12-29-farewell-2019/">2019年：下个十年路口，Farewell | Crossairplane的博客</a>：读这篇文章的时候突然想到一点，之后再看年终总结时，留言一句「新年快乐」。</li><li><a href="http://www.ztleespace.com/2020/01/01/create-vs-consume/">Create vs. Consume - ends 2019 then starts 2020 - Ziting Li</a>：真诚的思考。</li><li><a href="https://www.hi-pda.com/forum/viewthread.php?tid=819978&amp;extra=page%3D1">我的千书阅读计划 - 意欲蔓延 - Hi!PDA Hi!PDA</a>：fatdragoncat 13 年在 Hi!PDA 上立下愿望，这么多年过去，不知道数量上有没有达到，但是读书的收获已经改变他的生活。难得可贵这篇帖子展示他的变化过程。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这里记录过去一个月，我看到、想到值得分享的东西，每周六滚动更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x04-你见过哪些让你目瞪口呆-脑洞大开的骗局-sme情报员的回答-知乎&quot;&gt;&lt;a class=&quot;mar</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>李宏毅强化学习课程笔记 PG PPO Q-Learing</title>
    <link href="https://blog.xiang578.com/post/reinforce-learnning-basic.html"/>
    <id>https://blog.xiang578.com/post/reinforce-learnning-basic.html</id>
    <published>2019-12-26T13:14:47.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="info"><a class="markdownIt-Anchor" href="#info"></a> Info</h2><p>课件下载：<a href="http://speech.ee.ntu.edu.tw/~tlkagk/courses_MLDS18.html">Hung-yi Lee - Deep Reinforcement Learning</a></p><p>课程视频：<a href="https://www.youtube.com/watch?v=z95ZYgPgXOY&amp;list=PLJV_el3uVTsODxQFgzMzPLa16h6B8kWM_">DRL Lecture 1: Policy Gradient (Review) - YouTube</a></p><ul><li>Change Log<ul><li>20191226: 整理 PPO 相关资料</li><li>20191227: 整理 Q-Learning 相关资料</li><li>20200906: 拖延半年多没有整理笔记，将剩下的内容整理到单独的笔记中。</li></ul></li></ul><p>我的笔记汇总：</p><ul><li><a href="/post/reinforce-learnning-basic.html">Policy Gradient、PPO: Proximal Policy Optimization、Q-Learning</a></li><li><a href="/post/reinforce-learnning-basic-actor-critic.html">Actor Critic</a></li><li><a href="/post/reinforce-learnning-basic-sparse-reward.html">Sparse Reward</a></li><li><a href="/post/reinforce-learnning-basic-imitation-learning.html">Imitation Learning</a></li></ul><h2 id="rl-基础"><a class="markdownIt-Anchor" href="#rl-基础"></a> RL 基础</h2><p>强化学习基本定义：</p><ul><li>Actor：可以感知环境中的状态，通过执行不同的动作得到反馈的奖励，在此基础上进行学习优化。</li><li>Environment：指除 Actor 之外的所有事务，受 Actor 动作影响而改变其状态，并给 Actor 对应的奖励。</li><li>on-policy 和 off-policy 的区别在于 Actor 和 Environment 交互的策略和它自身在学习的策略是否是同一个。</li></ul><p>一些符号：</p><ul><li>State s 是对环境的描述，其状态空间是 S。</li><li>Action a 是 Actore 的行为描述，其动作空间是 A。</li><li>Policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">∣</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\pi(a|s)=P[A_t=a|S_t=s]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">]</span></span></span></span> 代表在给定环境状态 s 下 动作 a 的分布。</li><li>Reward <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{r(s,a,s^{\prime})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 在状态 s 下执行动作 a 后，Env 给出的打分。</li></ul><h2 id="policy-gradient"><a class="markdownIt-Anchor" href="#policy-gradient"></a> Policy Gradient</h2><p>Policy Network 最后输出的是概率。</p><p>目标：调整 actor 中神经网络 policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>，得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>π</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a=\pi(s, \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>，最大化 reward。</p><p>trajectory <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 由一系列的状态和动作组成，出现这种组合的概率是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\theta}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span> 。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"/><mo>=</mo><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mo>⋯</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"/><mo>=</mo><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><msubsup><mo>∏</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}{p_{\theta}(\tau)} \\ {\quad=p\left(s_{1}\right) p_{\theta}\left(a_{1} | s_{1}\right) p\left(s_{2} | s_{1}, a_{1}\right) p_{\theta}\left(a_{2} | s_{2}\right) p\left(s_{3} | s_{2}, a_{2}\right) \cdots} \\ {\quad=p\left(s_{1}\right) \prod_{l=1}^{T} p_{\theta}\left(a_{t} | s_{t}\right) p\left(s_{t+1} | s_{t}, a_{t}\right)}\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.741231em;vertical-align:-1.6206155000000004em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1206154999999995em;"><span style="top:-4.2806155em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span><span style="top:-3.080615499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span></span></span></span><span style="top:-1.7393844999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6206155000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p><p>reward ：根据 s 和 a 计算得分 r，求和得到 R。在围棋等部分任务中，无法获得中间的 r（下完完整的一盘棋后能得到输赢的结果）。</p><p>需要计算 R 的期望 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\bar{R}_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，形式和 GAN 类似。如果一个动作得到 reward 多，那么就增大这个动作出现的概率。最终达到 agent 所做 policy 的 reward 一直都比较高。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bar{R}_{\theta}=\sum_{\tau} R(\tau) p_{\theta}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span></span></p><p>强化学习中，没有 label。需要从环境中采样得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 和 R，根据下面的公式去优化 agent。相当于去求一个 likelihood。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla f(x) = f(x) \frac{\nabla f(x)}{f(x)}= f(x) \nabla \log f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∇</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> ，这一步中用到对 log 函数进行链式求导。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><msub><mover accent="true"><mi>R</mi><mo>ˉ</mo></mover><mi>θ</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∇</mi><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \bar{R}_{\theta}=\sum_{\tau} R(\tau) \nabla p_{\theta}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord">∇</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord">∇</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>E</mi><mrow><mi>τ</mi><mo>∼</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></msub><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>R</mi><mrow><mo fence="true">(</mo><msup><mi>τ</mi><mi>n</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msup><mi>τ</mi><mi>n</mi></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>n</mi></msub></msubsup><mi>R</mi><mrow><mo fence="true">(</mo><msup><mi>τ</mi><mi>n</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mi>t</mi><mi>n</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>n</mi></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}{=E_{\left.\tau \sim p_{\theta}(\tau)[R(\tau)] \log p_{\theta}(\tau)\right]} \approx \frac{1}{N} \sum_{n=1}^{N} R\left(\tau^{n}\right) \nabla \log p_{\theta}\left(\tau^{n}\right)} \\ {=\frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T_{n}} R\left(\tau^{n}\right) \nabla \log p_{\theta}\left(a_{t}^{n} | s_{t}^{n}\right)}\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.682462em;vertical-align:-1.0912310000000003em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5912309999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span><span class="mclose mtight">]</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">]</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span style="top:-2.268769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0912310000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p><p>参数更新方法：</p><ol><li>在环境中进行采样，得到一系列的轨迹和回报。</li><li>利用状态求梯度，更新模型。如果 R 为正，增大概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\theta}(a_t|s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 否则减少概率。</li><li>重复上面的流程。</li></ol><p><img src="https://media.xiang578.com/15726799935625.jpg" alt="" /></p><h3 id="pg-的例子"><a class="markdownIt-Anchor" href="#pg-的例子"></a> PG 的例子</h3><p>训练 actor 的过程看成是分类任务：输入 state ，输出 action。</p><p>最下面公式分别是反向传播梯度计算和 PG 的反向梯度计算，PG 中要乘以整个轨迹的 R。</p><p><img src="https://media.xiang578.com/15752505145081.jpg" alt="PG" /></p><p>tip 1： add a baseline</p><p>强化学习的优化和样本质量有关，避免采样不充分。Reawrd 函数变成 R-b，代表回报小于 b 的都被我们当成负样本，这样模型能去学习得分更高的动作。b 一般可以使用 R 的均值。</p><p>tip 2: assign suitable credit</p><p>一场游戏中，不论动作好坏，总会乘上相同的权重 R，这种方法是不合理的，希望每个 action 的权重不同。</p><ol><li>引入一个 discount rate，对 t 之后的动作 r 进行降权重。</li><li>利用 Advantage Function 评价状态 s 下动作 a 的好坏 critic。</li></ol><p><img src="https://media.xiang578.com/15752505547153.jpg" alt="Assign Suitable Credit" /></p><h2 id="ppo-proximal-policy-optimization"><a class="markdownIt-Anchor" href="#ppo-proximal-policy-optimization"></a> PPO: Proximal Policy Optimization</h2><h3 id="importance-sampling"><a class="markdownIt-Anchor" href="#importance-sampling"></a> importance sampling</h3><p>假设需要估计期望 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>x</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">E_{x~p[f(x)]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">p</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>，x 符合 p 分布，将期望写成积分的形式。由于在 P 分布下面很难采样，把问题转化到已知 q 分布上，得到在 p 分布下计算期望公式。</p><p><img src="https://media.xiang578.com/15771920437580.jpg" alt="" /></p><p>上面方法得到 p 和 q 期望接近，但是方差可能相差很大，且和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{p(x)}{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 有关。</p><p>原分布的方差：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mo><mi mathvariant="normal">Var</mi><mo>⁡</mo></mo><mrow><mi>x</mi><mo>−</mo><mi>p</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>−</mo><mi>p</mi></mrow></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="true">]</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">(</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>−</mo><mi>q</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\operatorname{Var}_{x-p}[f(x)]=E_{x-p}\left[f(x)^{2}\right]-\left(E_{x-q}[f(x)]\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop"><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span class="mord mathrm">a</span><span class="mord mathrm">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2141179999999998em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.240116em;vertical-align:-0.286108em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>新分布的方差：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mo><mi mathvariant="normal">Var</mi><mo>⁡</mo></mo><mrow><mi>x</mi><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>p</mi></mrow></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="true">]</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">(</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mo><mi mathvariant="normal">Var</mi><mo>⁡</mo></mo><mrow><mi>x</mi><mo>∼</mo><mi>q</mi></mrow></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">]</mo></mrow><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>q</mi></mrow></msub><mrow><mo fence="true">[</mo><msup><mrow><mo fence="true">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo fence="true">]</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">(</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>q</mi></mrow></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">]</mo></mrow><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>p</mi></mrow></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">]</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">(</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}{\operatorname{Var}_{x \sim p}[f(x)]=E_{x \sim p}\left[f(x)^{2}\right]-\left(E_{x \sim p}[f(x)]\right)^{2}} \\ {\operatorname{Var}_{x \sim q}\left[f(x) \frac{p(x)}{q(x)}\right]=E_{x \sim q}\left[\left(f(x) \frac{p(x)}{q(x)}\right)^{2}\right]-\left(E_{x \sim q}\left[f(x) \frac{p(x)}{q(x)}\right]\right)^{2}} \\ {=E_{x \sim p}\left[f(x)^{2} \frac{p(x)}{q(x)}\right]-\left(E_{x \sim p}[f(x)]\right)^{2}}\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.514058em;vertical-align:-2.507029em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.007029em;"><span style="top:-5.503021em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span class="mord mathrm">a</span><span class="mord mathrm">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.693021em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span class="mord mathrm">a</span><span class="mord mathrm">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3540079999999999em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3540079999999999em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.592991em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.507029em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p><p>在 p 和 q 分布不一致时，且采样不充分时，可能会带来比较大的误差。</p><p><img src="https://media.xiang578.com/15771931618906.jpg" alt="Issue of Importance Sampling" /></p><h3 id="从-on-policy-到-off-policy"><a class="markdownIt-Anchor" href="#从-on-policy-到-off-policy"></a> 从 On-policy 到 Off-policy</h3><p>on-policy 时，PG 每次参数更新完成后，actor 就改变了，不能使用之前的数据，必须和环境重新互动收集数据。引入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>θ</mi><mo mathvariant="normal">′</mo></mrow></msub></mrow><annotation encoding="application/x-tex">p_{\theta \prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 进行采样，就能将 PG 转为 off-ploicy。</p><p><img src="https://media.xiang578.com/15771932374489.jpg" alt="" /></p><p>和之前相比，相当于引入重要性采样，所以也有前一节中提到的重要性采样不足问题。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>J</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mrow><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>∼</mo><msub><mi>π</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow></msub><mrow><mo fence="true">[</mo><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac><msup><mi>A</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">J^{\theta^{\prime}}(\theta)=E_{\left(s_{t}, a_{t}\right) \sim \pi_{\theta^{\prime}}}\left[\frac{p_{\theta}\left(a_{t} | s_{t}\right)}{p_{\theta^{\prime}}\left(a_{t} | s_{t}\right)} A^{\theta^{\prime}}\left(s_{t}, a_{t}\right)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.6068285714285713em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8495600000000001em;"><span style="top:-2.84956em;margin-right:0.1em;"><span class="pstrut" style="height:2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2620285714285715em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.36361999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><h3 id="ppotrpo"><a class="markdownIt-Anchor" href="#ppotrpo"></a> PPO/TRPO</h3><p>为了克服采样的分布与原分布差距过大的不足，PPO 引入 KL 散度进行约束。KL 散度用来衡量两个分布的接近程度。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>J</mi><mrow><mi>P</mi><mi>P</mi><mi>O</mi></mrow><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msubsup><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>J</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>β</mi><mi>K</mi><mi>L</mi><mrow><mo fence="true">(</mo><mi>θ</mi><mo separator="true">,</mo><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">J_{P P O}^{\theta^{\prime}}(\theta)=J^{\theta^{\prime}}(\theta)-\beta K L\left(\theta, \theta^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9924799999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p><p>TRPO(Trust Region Policy Optimization)，要求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>L</mi><mrow><mo fence="true">(</mo><mi>θ</mi><mo separator="true">,</mo><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>&lt;</mo><mi>δ</mi></mrow><annotation encoding="application/x-tex">K L\left(\theta, \theta^{\prime}\right)&lt;\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span>。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>J</mi><mrow><mi>T</mi><mi>R</mi><mi>P</mi><mi>O</mi></mrow><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msubsup><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mrow><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>∼</mo><msub><mi>π</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow></msub><mrow><mo fence="true">[</mo><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>p</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mrow><mo fence="true">(</mo><msub><mi>a</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow></mrow></mfrac><msup><mi>A</mi><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">J_{T R P O}^{\theta^{\prime}}(\theta)=E_{\left(s_{t}, a_{t}\right) \sim \pi_{\theta^{\prime}}}\left[\frac{p_{\theta}\left(a_{t} | s_{t}\right)}{p_{\theta^{\prime}}\left(a_{t} | s_{t}\right)} A^{\theta^{\prime}}\left(s_{t}, a_{t}\right)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9924799999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.6068285714285713em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8495600000000001em;"><span style="top:-2.84956em;margin-right:0.1em;"><span class="pstrut" style="height:2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2620285714285715em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.36361999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.99248em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>KL 散度可能比较难计算，在实际中常使用 PPO2。</p><ul><li>A&gt;0，代表当前策虑表现好。需要增大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi( \theta )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>，通过 clip 增加一个上限，防止 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi( \theta )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span> 和旧分布变化太大。</li><li>A&lt;0，代表当前策虑表现差，不限制新旧分布的差异程度，只需要大幅度改变 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi( \theta )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>。</li></ul><p>参考 <a href="https://zhuanlan.zhihu.com/p/43114711">【点滴】策略梯度之PPO - 知乎</a></p><p><img src="https://media.xiang578.com/15772793086357.jpg" alt="" /></p><h3 id="ppo-algorithm"><a class="markdownIt-Anchor" href="#ppo-algorithm"></a> PPO algorithm</h3><p>系数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 在迭代的过程中需要进行动态调整。引入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><msub><mi>L</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mi>K</mi><msub><mi>L</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">KL_{max} KL_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，KL &gt; KLmax，说明 penalty 没有发挥作用，增大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>。</p><p><img src="https://media.xiang578.com/15772793200430.jpg" alt="" /></p><h2 id="q-learning"><a class="markdownIt-Anchor" href="#q-learning"></a> Q-Learning</h2><p>value-base 方法，利用 critic 网络评价 actor 。通过状态价值函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> 来衡量预期的期望。V 和 pi、s 相关。</p><p><img src="https://media.xiang578.com/15773668251569.jpg" alt="" /></p><ol><li>Monte-Carlo MC: 训练网络使预测的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>a</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s_a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和实际完整游戏 reward <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">G_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 接近。</li><li>Temporal-difference TD: 训练网络尽量满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">V^{\pi}(s_t)=V^{\pi}(s_{t+1}) + r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 等式，两个状态之间的收益差。</li></ol><p>MC: 根据策虑 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>  进行游戏得到最后的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>，最终存在方差大的问题。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Var</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>k</mi><mi>X</mi><mo stretchy="false">]</mo><mo>=</mo><msup><mi>k</mi><mn>2</mn></msup><mi mathvariant="normal">Var</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\operatorname{Var}[k X]=k^{2} \operatorname{Var}[X]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span class="mord mathrm">a</span><span class="mord mathrm">r</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span class="mord mathrm">a</span><span class="mord mathrm">r</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span></p><p>TD: r 的方差比较小，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V^{\pi}(s_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 在采样不充分的情况下，可能不准确。</p><p><img src="https://media.xiang578.com/15773670631327.jpg" alt="" /></p><h3 id="another-critic"><a class="markdownIt-Anchor" href="#another-critic"></a> Another Critic</h3><p>State-action value function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q^{\pi}(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>：预测在 pi 策略下，pair(s, a) 的值。相当于假设 state 情况下强制采取 action a。</p><p><img src="https://media.xiang578.com/15773671301402.jpg" alt="" /></p><p>对于非分类的方法：</p><p><img src="https://media.xiang578.com/15773671400847.jpg" alt="" /></p><p>Q-Learning</p><ol><li>初始  actor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> 与环境互动</li><li>学习该 actor 对应的 Q function</li><li>找一个比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> 好的策虑：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo mathvariant="normal">′</mo></mrow><annotation encoding="application/x-tex">\pi \prime</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.55556em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord">′</span></span></span></span>，满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mrow><mi>π</mi><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>≥</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V^{\pi \prime}(s,a) \ge V^{\pi}(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>arg</mi><mo>⁡</mo><msub><mo><mi>max</mi><mo>⁡</mo></mo><mi>a</mi></msub><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi^{\prime}(s)=\arg \max _{a} Q^{\pi}(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></li></ol><p>在给定 state 下，分别代入 action，取函数值最大的 a，作为后面对该 state 时采取的 action。</p><p>证明新的策虑存在：<br /><img src="https://media.xiang578.com/15773672909262.jpg" alt="" /></p><h3 id="target-network"><a class="markdownIt-Anchor" href="#target-network"></a> Target NetWork</h3><p>左右两边的网络相同，如果同时训练比较困难。简单的想法是固定右边的网络进行训练，一定次数后再拷贝左边的网络。</p><p><img src="https://media.xiang578.com/15773673947112.jpg" alt="" /></p><h3 id="exploration"><a class="markdownIt-Anchor" href="#exploration"></a> Exploration</h3><p>Q function 导致 actor 每次都会选择具有更大值的 action，无法准确估计某一些动作，对于收集数据而言是一个弊端。</p><ul><li>Epsilon Greedy<ul><li>小概率进行损失采样</li></ul></li><li>Boltzmann Exploration<ul><li>利用 softmax 计算选取动作的概率，然后进行采样</li></ul></li></ul><p><img src="https://media.xiang578.com/15773674189861.jpg" alt="" /></p><h3 id="replay-buffer"><a class="markdownIt-Anchor" href="#replay-buffer"></a> Replay buffer</h3><p>采样之后的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s_t, a_t, r_t, s_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 保存在一个 buffer 里面（可能是不同策虑下采样得到的)，每次训练从 buffer 中 sample 一个 batch。</p><p>结果：训练方法变成 off-policy。减少 RL 重复采样，充分利用数据。</p><p><img src="https://media.xiang578.com/15773675111439.jpg" alt="" /></p><h3 id="typical-q-learning-algorithm"><a class="markdownIt-Anchor" href="#typical-q-learning-algorithm"></a> Typical Q-Learning Algorithm</h3><p>Q-Learning 流程：</p><p><img src="https://media.xiang578.com/15773677168275.jpg" alt="" /></p><h3 id="double-dqn-ddqn"><a class="markdownIt-Anchor" href="#double-dqn-ddqn"></a> Double DQN DDQN</h3><ul><li>Q value 容易高估：目标值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r_t + maxQ(s_{t+1}, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> 倾向于选择被高估的 action，导致 target 很大。</li><li>选动作的 Q’ 和计算 value 的 Q(target network) 不同。Q 中高估 a，Q’ 可能会准确估计 V 值。Q’ 中高估 a ，可能不会被 Q 选中。</li></ul><p><img src="https://media.xiang578.com/15773677986325.jpg" alt="" /></p><h3 id="dueling-dqn"><a class="markdownIt-Anchor" href="#dueling-dqn"></a> Dueling DQN</h3><p>改 network 架构。V(s) 代表 s 所具有的价值，不同的 action 共享。 A(s,a) advantage function 代表在 s 下执行 a 的价值。最后 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(s, a) = A(s, a) + V(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>。</p><p>为了让网络倾向于使用 V（能训练这个网络），得到 A 后，要对 A 做 normalize。</p><p><img src="https://media.xiang578.com/15773680103445.jpg" alt="" /></p><h3 id="prioritized-reply"><a class="markdownIt-Anchor" href="#prioritized-reply"></a> Prioritized Reply</h3><p>在训练过程中，对于经验 buffer 里面的样本，TD error 比较大的样本有更大的概率被采样，即难训练的数据增大被采样的概率。</p><p><img src="https://media.xiang578.com/15773681449261.jpg" alt="" /></p><h3 id="multi-step"><a class="markdownIt-Anchor" href="#multi-step"></a> Multi-step</h3><p>综合 MC 和 TD 的优点，训练样本按一定步长 N 进行采样。MC 准确方差大，TD 方差小，估计不准。<br /><img src="https://media.xiang578.com/15773682226911.jpg" alt="" /></p><h3 id="noisy-net"><a class="markdownIt-Anchor" href="#noisy-net"></a> Noisy Net</h3><p><img src="https://media.xiang578.com/15773682895872.jpg" alt="" /></p><ul><li>Noise on Action：在相同状态下，可能会采取不同的动作。</li><li>Noise on Parameters：开始时加入噪声。同一个 episode 内，参数不会改变。相同状态下，动作相同。<br />更好探索环境。</li></ul><h3 id="distributional-q-function"><a class="markdownIt-Anchor" href="#distributional-q-function"></a> Distributional Q-function</h3><p>Q 是累积收益的期望，实际上在 s 采取 a 时，最终所有得到的 reward 为一个分布 reward distribution。部分时候分布不同，可能期望相同，所以用期望来代替 reward 会损失一些信息。</p><p>Distributional Q-function 直接输出分布，均值相同时，采取方差小的方案。这种方法不会产生高估 q 值的情况。</p><p><img src="https://media.xiang578.com/15773684681347.jpg" alt="" /></p><h3 id="rainbow"><a class="markdownIt-Anchor" href="#rainbow"></a> Rainbow</h3><p>rainbow 是各种策略的混合体。</p><p><img src="https://media.xiang578.com/15773684767629.jpg" alt="" /></p><p>DDQN 影响不大。</p><p><img src="https://media.xiang578.com/15773684832549.jpg" alt="" /></p><h3 id="continuous-actions"><a class="markdownIt-Anchor" href="#continuous-actions"></a> Continuous Actions</h3><p>action 是一个连续的向量，Q-learning 不是一个很好的方法。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>a</mi></munder><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a=\arg \max _{a} Q(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></span></p><ol><li>从 a 中采样出一批动作，看哪个行动 Q 值最大。</li><li>使用 gradient ascent 解决最优化问题。</li><li>设计一个网络来化简过程。<ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> 是高斯分布的方差和均值，保证矩阵一定是正定。</li><li>最小化下面的函数，需要最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>−</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">a - \mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span>。</li></ol></li></ol><p><img src="https://media.xiang578.com/15773684903236.jpg" alt="" /></p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/41712025">强化学习基础知识 - 知乎</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;info&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#info&quot;&gt;&lt;/a&gt; Info&lt;/h2&gt;
&lt;p&gt;课件下载：&lt;a href=&quot;http://speech.ee.ntu.edu.tw/~tlkagk/courses_MLDS18.h</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="algorithm" scheme="https://blog.xiang578.com/tags/algorithm/"/>
    
    <category term="Reinforcement Learning" scheme="https://blog.xiang578.com/tags/Reinforcement-Learning/"/>
    
  </entry>
  
  <entry>
    <title>【每月分享】 201912</title>
    <link href="https://blog.xiang578.com/post/monthly-issue-201912.html"/>
    <id>https://blog.xiang578.com/post/monthly-issue-201912.html</id>
    <published>2019-12-16T08:55:11.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><blockquote><p>这里记录过去一个月，我看到、想到值得分享的东西，每周六滚动更新。</p></blockquote><h2 id="0x02-org-mode-workflow"><a class="markdownIt-Anchor" href="#0x02-org-mode-workflow"></a> 0x02. <a href="https://blog.jethro.dev/posts/org_mode_workflow_preview/">Org-mode Workflow</a></h2><p>国外一名 CS 学生的 org mode workflow 教程，包括 GTD 和 Zettelkasten 两个主要的部分，分别对应时间管理和知识管理，是一份很好的参考资料。</p><h2 id="0x01-hhkb-更新"><a class="markdownIt-Anchor" href="#0x01-hhkb-更新"></a> 0x01. HHKB 更新</h2><blockquote class="twitter-tweet"><p lang="ja" dir="ltr">改めてとなりますが今回新しく登場したHHKBは3機種になります。それぞれの特徴をまとめたものがこちらになります。<a href="https://twitter.com/hashtag/HHKB%E3%83%9F%E3%83%BC%E3%83%88%E3%82%A2%E3%83%83%E3%83%97?src=hash&amp;ref_src=twsrc%5Etfw">#HHKBミートアップ</a> <a href="https://t.co/GVVxNI6H72">pic.twitter.com/GVVxNI6H72</a></p>&mdash; HHKB OFFICIAL (@PFU_HHKB) <a href="https://twitter.com/PFU_HHKB/status/1204345452658741248?ref_src=twsrc%5Etfw">December 10, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>HHKB 好久之后终于更新了！不过价格也变得更贵……还是很喜欢自己 18 年买的 HHKB BT 版。不过在使用 Emacs 之后，出现没有方向键的烦恼。之前通过映射 <code>Ctrl + HJKL</code> 替代方向键，然后和 Emacs 的一些快捷键冲突……等买一个新的机械键盘。</p><h2 id="0x00-my-gtd-workflow-2019-ver-yiming-chen-gtd"><a class="markdownIt-Anchor" href="#0x00-my-gtd-workflow-2019-ver-yiming-chen-gtd"></a> 0x00. <a href="https://yiming.dev/blog/2019/05/22/my-gtd-workflow-2019-ver/">My GTD Workflow (2019 ver.) - Yiming Chen</a> #gtd</h2><p>很少看到国人用英文写的 GTD 相关文章，年初自己也想按 Workflow 这种形式写一篇，不过一直拖到现在都没有完成。</p><ul><li>对任务设置优先级：A B C</li><li>如何设置任务优先级，对目标进行分解<ul><li>每年一月份设定年度目标</li><li>每月一号根据年度目标设定月度目标</li><li>每周日根据月度目标设定每周目标</li><li>每天早上设定当天目标</li></ul></li><li>任务安排优先级和截止日期后，可以使用四象限法则。</li><li>回顾技巧<ul><li>追求 100% 完成，可以接受 70%。</li><li>一个任务多次延迟之后，考虑是否还是重要。</li><li>如果任务还是重要，对任务进行拆分。</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这里记录过去一个月，我看到、想到值得分享的东西，每周六滚动更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x02-org-mode-workflow&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>2019 年软硬件指北</title>
    <link href="https://blog.xiang578.com/post/2019-consumer-report.html"/>
    <id>https://blog.xiang578.com/post/2019-consumer-report.html</id>
    <published>2019-12-15T13:29:38.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>呼吸不止，折腾不停。记录在过去的一年，自己选择的软件和硬件。去年写指南并不能指南，所以今年直接写成指北。</p><h2 id="硬件更新"><a class="markdownIt-Anchor" href="#硬件更新"></a> 硬件更新</h2><h3 id="iphone-xr-和-apple-watch-series-4"><a class="markdownIt-Anchor" href="#iphone-xr-和-apple-watch-series-4"></a> iPhone XR 和 Apple Watch Series 4</h3><p>iPhone XR 刚出来的时候，一直被吐槽是大边框。不过随着在电商网站上不断降价，越来越被当成是无边框手机……在忍受不了使用多年 iPhone 6 的卡顿，以及很难脱离 iOS 生态的现实。终于在苏宁上下单 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>P</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(Product)^{read}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span> 版的 XR。经过半年多的使用，这部手机实用但是不出彩。</p><p><img src="https://media.xiang578.com/15764169455007.jpg" alt="Apple Watch 圆环图" /></p><p>购买 Apple Watch Series 4(AW) 理由很简单：在去公司健身房锻炼的时候，希望有一个可以记录运动数据的设备。事实 AW 自带的运动软件很不错，可以满足我的运动记录需求。但是例如 Keep 之类的第三方 App 适配不好。另外，AW 很好扩展 iPhone 和 Mac 的使用，比如可以解锁 Mac、查看 iPhone 上的信息等等。到头来，AW 还只是一块需要一天一充的电子表。</p><h3 id="nintendo-switch"><a class="markdownIt-Anchor" href="#nintendo-switch"></a> Nintendo Switch</h3><p>Nintendo Switch(NS) 是任天堂在 2017 年推出的，集掌机和主机于一体的游戏机。买 NS 的理由也很简单，Mac 上游戏太少，我需要一个设备玩游戏。更深层次的来说，感觉自己的反应太慢，想通过玩游戏来锻炼快速决策能力。</p><p>简单统计一下，我在 NS 上花费的时间大概有 200 多小时，购入游戏也花费上千元……反应能力不知道有没有上去，但是享受到游戏的快乐。</p><p><img src="https://media.xiang578.com/15764170682610.jpg" alt="任天堂就是世界的主宰" /></p><p>Nintendo Switch 目前可以选的有 Nintendo Switch、Nintendo Switch 续航版、Nintendo Switch Lite。</p><h3 id="kindle-oasis-2"><a class="markdownIt-Anchor" href="#kindle-oasis-2"></a> Kindle Oasis 2</h3><p>大概是 5 月末，通过公司内部闲置群出了使用 5 年多的 Kindle PaperWhite 2 后，从淘宝上购入美版 Kindle Oasis 2 。可惜的是，1 个月不到的时间，亚马逊推出 Kindle Oasis 3 ……</p><p><img src="https://media.xiang578.com/kindle_2_oasis.jpg" alt="kindle oasis 2 和 kindle 2 对比图" /></p><p>和 KPW2 相比，KO2 主要带来一下几个方面的提升：</p><ol><li>7寸屏幕，更高的分辨率。看的更多，看的更清晰，更加逼近纸书的感觉。</li><li>不对称设计，电池集中在一边，握持比较舒服。</li><li>金属机身。前几代 kindle 都是亚马逊祖传的类肤质塑料机身，很容易沾上油脂，这一代采用金属机身，看起来更加富有科技感。毕竟当年小米用上金属边框的时候，都敢去吹一块钢板的艺术之旅。</li><li>两个翻页实体按键，按起来比较有安全感。</li></ol><p>上面说这么多，kindle 主要功能还是看书。这几年，很多 kindle 电子书分享站都由于版权问题陆续关闭，优质的资源比较难下载。不过，去年自己办信用卡时，领了一年的 Kinle U 会员（今年又领到一年的会员），在中亚上借阅很多本小说。从体验上来说，KU 会员不能实现全场自由借，而且大部分书籍都只是滥竽充数。一对比微信读书会员就是十分实惠，多期待微信读书可以出电子书阅读器吧。</p><h2 id="软件实践"><a class="markdownIt-Anchor" href="#软件实践"></a> 软件实践</h2><p>18 年开始，着手准备构建自己的数字化系统。19 年在前面的基础上，进行了很多迁移。</p><h3 id="信息管理"><a class="markdownIt-Anchor" href="#信息管理"></a> 信息管理</h3><p>11 月份看到一句话：input 做的越多，知识管理越差。这个很好形容我之前的状态，在印象笔记中囤积待看的剪藏、OF 里面有很多想写的主题、MWeb 遗留大量没有写完的文章。</p><p>年中的时候，想把自己写的一些笔记更好的管理起来。最初想到的是搭建 wiki ，实现知识的网状化连接。不过市面上常用的一些个人 wiki 方案都不是很满意。最终选择 hexo 搭配一个 wiki 主题 <a href="https://github.com/zthxxx/hexo-theme-Wikitten">Wikitten</a>。另外，后来了解到有一种基于纯文本的知识管理方案：zettelkasten。感兴趣的可以去看一下。</p><p>写日记是这么多年以来坚持的一件小事情。之前一直是在笔记本上写，后来慢慢的尝试通过印象笔记来写。2月份，订阅 Day One ，开始尝试迁移到它上面去。作为一个专业的软件，体验真的比之前的方式不知道好多少。Day One 上也有很多数据统计，多少可以拿来得瑟用。另外，自己干的一件事情就是把印象笔记中的日记慢慢转移到 Day one 。写在笔记本上的日记，也被我拍成一张又一张的照片，只不过这个迁移起来比较麻烦。</p><p><img src="https://media.xiang578.com/15764175403738.jpg" alt="Day one 按年统计图" /></p><h3 id="任务管理"><a class="markdownIt-Anchor" href="#任务管理"></a> 任务管理</h3><p>这个问题一直是一个大坑，花费很多时间在多个软件中试来试去。在现在这个时间点，自己开始选择混合使用 OmniFocus 和 Org mode。具体怎么搭配使用，等再坚持几个月再出来分享。不过说回来，任务管理的关键不在于软件，而在于执行。</p><h3 id="其他实践"><a class="markdownIt-Anchor" href="#其他实践"></a> 其他实践</h3><p>下面这一些今年自己做的选择，都有一个共同的特点：从商业软件到开源项目。很多人选着使用的开源项目的出发点在于害怕商业公司无休止的使用个人隐私数据，而吸引我的主要是自由软件自由开放的精神。</p><h4 id="从-moneywiz-到-beancount"><a class="markdownIt-Anchor" href="#从-moneywiz-到-beancount"></a> 从 MoneyWiz 到 Beancount</h4><p>MoneyWiz 是在少数派上了解到记账软件，Setapp 中可以免费使用。和国内那些整天搞社区和卖理财的记账软件相比，只是纯粹的一个记账软件。Beancount 是无意中从<a href="https://www.byvoid.com/zhs/blog/beyond-the-void">BYvoid</a>文章中了解的一款纯文本记账软件。最大的优点是扩展性强。在使用过程中，搭配一些简单的脚本，可以实现每月底花一个小时就能把这个月的开销记录明白。</p><p><img src="https://media.xiang578.com/15764177497946.jpg" alt="Beancount fava" /></p><h4 id="从-1password-到-keepass"><a class="markdownIt-Anchor" href="#从-1password-到-keepass"></a> 从 1Password 到 KeePass</h4><p>之前看过一个结论：密码破解的难度主要在于长度而不是复杂度。所以借助密码软件辅助记忆密码是不二之选。1Password 是在去年感恩节活动中获得的长达一年的免费体验。快要到期前，没有选择转向订阅（今年感恩节活动依然是新用户<br />长度一年的免费使用），反而是选择开源的 KeePass。KeePass 在不同的平台上有多个客户端可以选择，目前我主要用的是 MacPass 和奇密。KeePass 中所有的密码数据都保存在一个文件中，跨平台使用只需要简单同步这个文件。</p><h4 id="从搜狗输入法到鼠须管"><a class="markdownIt-Anchor" href="#从搜狗输入法到鼠须管"></a> 从搜狗输入法到鼠须管</h4><p>网上关于搜狗输入法的声讨一直不绝于耳，我也长时间忍受搜狗动不动给你跳出来的斗图功能提示。在花费一番力气，配置鼠须管后，彻底删除搜狗，详见 <a href="https://xiang578.com/post/rime.html">「Rime 鼠须管」小鹤双拼配置指南 | 算法花园</a>。另外 Mac 上自带的输入法的体验也没有那么差。</p><p>博客上和这个主题相关的文章：</p><ul><li><a href="https://xiang578.com/post/best-of-iphone-2019.html">Best of iPhone 2019 软件清单 | 算法花园</a></li><li><a href="https://xiang578.com/post/2018-consumer-report.html">2018 年消费指南 | 算法花园</a></li><li><a href="https://xiang578.com/post/iphone5s.html">iPhone软件清单 | 算法花园</a></li><li><a href="https://xiang578.com/post/mac-software.html">Mac软件清单 | 算法花园</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;呼吸不止，折腾不停。记录在过去的一年，自己选择的软件和硬件。去年写指南并不能指南，所以今年直接写成指北。&lt;/p&gt;
&lt;h2 id=&quot;硬件更新&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#硬件更新&quot;&gt;&lt;/a&gt; 硬件更新&lt;/h2&gt;
&lt;h3 id=&quot;i</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
  </entry>
  
  <entry>
    <title>Standford CS231n 2017 课程部分总结</title>
    <link href="https://blog.xiang578.com/post/cs231n-summary.html"/>
    <id>https://blog.xiang578.com/post/cs231n-summary.html</id>
    <published>2019-12-04T09:58:39.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>去年学习这门做的部分笔记，现在分享出来。<br />笔记格式有些问题，持续整理中。</p></blockquote><ul><li>大量内容参考 <a href="https://github.com/mbadry1/CS231n-2017-Summary/blob/master/README.md">mbadry1/CS231n-2017-Summary</a></li></ul><h2 id="table-of-contents"><a class="markdownIt-Anchor" href="#table-of-contents"></a> Table of contents</h2><ul><li><a href="#table-of-contents">Table of contents</a></li><li><a href="#course-info">Course Info</a></li><li><a href="#01-introduction-to-cnn-for-visual-recognition">01. Introduction to CNN for visual recognition</a></li><li><a href="#02-image-classification">02. Image classification</a></li><li><a href="#03-loss-function-and-optimization">03. Loss function and optimization</a></li><li><a href="#04-introduction-to-neural-network">04. Introduction to Neural network</a></li><li><a href="#05-convolutional-neural-networks-cnns">05. Convolutional neural networks (CNNs)</a></li><li><a href="#06-training-neural-networks-i">06. Training neural networks I</a></li><li><a href="#07-training-neural-networks-ii">07. Training neural networks II</a></li><li><a href="#09-cnn-architectures">09. CNN architectures</a></li><li><a href="#reference">Reference</a></li></ul><h2 id="course-info"><a class="markdownIt-Anchor" href="#course-info"></a> Course Info</h2><ul><li>主页: <a href="http://cs231n.stanford.edu/">http://cs231n.stanford.edu/</a></li><li>视频：<a href="https://www.bilibili.com/video/av17204303">斯坦福深度学习课程CS231N 2017中文字幕版+全部作业参考_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</a></li><li>大纲：<a href="http://cs231n.stanford.edu/2017/syllabus">Syllabus | CS 231N</a></li><li>课件：<a href="http://cs231n.stanford.edu/slides/2017/">Index of /slides/2017</a></li><li>笔记：<a href="https://zhuanlan.zhihu.com/p/21930884">贺完结！CS231n官方笔记授权翻译总集篇发布</a></li><li>作业仓库：<a href="https://github.com/xiang578/MachineLearning/tree/master/CS231n">MachineLearning/CS231n at master · xiang578/MachineLearning</a></li><li>总课时: <strong>16</strong></li></ul><h2 id="01-introduction-to-cnn-for-visual-recognition"><a class="markdownIt-Anchor" href="#01-introduction-to-cnn-for-visual-recognition"></a> 01. Introduction to CNN for visual recognition</h2><ul><li>视觉地出现促进了物种竞争。</li><li>ImageNet 是由李飞飞维护的一个大型图像数据集。</li><li>自从 2012 年 CNN 出现之后，图像分类的错误率大幅度下降。 神经网络的深度也从 7 层增加到 2015 年的 152 层。截止到目前，机器分类准确率已经超过人类，所以 ImageNet 也不再举办相关比赛。</li><li>CNN 在 1998 年就被提出，但是这几年才流行开来。主要原因有：1) 硬件发展，并行计算速度提到 2）大规模带标签的数据集。</li><li>Gola: Understand how to write from scratch, debug and train convolutional neural networks.</li></ul><h2 id="02-image-classification"><a class="markdownIt-Anchor" href="#02-image-classification"></a> 02. Image classification</h2><ul><li>图像由一大堆没有规律的数字组成，无法直观的进行分类，所以存在语义鸿沟。分类的挑战有：视角变化、大小变化、形变、遮挡、光照条件、背景干扰、类内差异。<ul><li><img src="https://media.xiang578.com/2019-10-08-15387098703701.jpg" alt="" /></li></ul></li><li>Data-Driven Approach<ul><li>Collect a dataset of images and labels</li><li>Use Machine Learning to train a classifier</li><li>Evaluate the classifier on new images</li></ul></li><li>图像分类流程：输入、学习、评估</li><li>图像分类数据集：<a href="http://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10</a>，这个数据集包含了60000张32X32的小图像。每张图像都有10种分类标签中的一种。这60000张图像被分为包含50000张图像的训练集和包含10000张图像的测试集。</li><li>一种直观的图像分类算法：K-nearest neighbor(knn)<ul><li>为每一张需要预测的图片找到距离最近的 k 张训练集中的图片，然后选着在这 k 张图片中出现次数最多的标签做为预测图片的标签（多数表决）。</li><li>训练过程：记录所有的数据和标签 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></li><li>预测过程：预测给定图片的标签 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></li><li>Hyperparameters：k and the distance Metric</li><li>Distance Metric<ul><li>L1 distance(Manhattan Distance)</li><li>L2 distance(Euclidean Distance)</li></ul></li><li>knn 缺点<ul><li>Very slow at test time</li><li>Distance metrics on pixels are not informative</li></ul></li><li>反例：下面四张图片的 L2 距离相同<ul><li><img src="https://media.xiang578.com/2019-10-08-15387110626779.jpg" alt="-w622" /></li></ul></li></ul></li><li>Hyperparameters: choices about the algorithm that we set ranther than learn</li><li>留一法 Setting Hyperparameters by Cross-validation:<ul><li>将数据划分为 f 个集合以及一个 test 集合，数据划分中药保证数据集的分布一致。</li><li>给定超参数，利用 f-1 个集合对算法进行训练，在剩下的一个集合中测试训练效果，重复这一个过程，直到所有的集合都当过测试集。</li><li>选择在训练集中平均表现最好的超参数。</li></ul></li><li>Linear classification: <code>Y = wX + b</code><ul><li>b 为 bias，调节模型对结果的偏好</li><li>通过最小化损失函数来，来确定 w 和 b 的值。</li></ul></li><li><strong>Linear SVM</strong>:  classifier is an option for solving the image classification problem, but the curse of dimensions makes it stop improving at some point. @todo</li><li><strong>Logistics Regression</strong>: 无法解决非线性的图像数据</li></ul><h2 id="03-loss-function-and-optimization"><a class="markdownIt-Anchor" href="#03-loss-function-and-optimization"></a> 03. Loss function and optimization</h2><ul><li>通过 Loss function 评估参数质量<ul><li>比如 $$L=\frac{1}{N}\sum_iL_i\left(f\left(x_i,W\right),y_i\right)$$</li></ul></li><li>Multiclass SVM loss 多分类支持向量机损失函数<ul><li><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo mathvariant="normal">≠</mo><msub><mi>y</mi><mi>j</mi></msub></mrow></munder><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>j</mi></msub><mo>−</mo><msub><mi>s</mi><msub><mi>y</mi><mi>i</mi></msub></msub><mo>+</mo><mn>1</mn><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">L_i=\sum_{j \neq y_j}\max\left(0,s_j-s_{y_i}+1\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.5494380000000003em;vertical-align:-1.499433em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.499433em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p></li><li>这种损失函数被称为合页损失 Hinge loss</li><li>SVM 的损失函数要求正确类别的分类分数要比其他类别的高出一个边界值。</li><li>L2-SVM 中使用平方折叶损失函数$$\max(0,-)^2$$能更强烈地惩罚过界的边界值。但是选择使用哪一个损失函数需要通过实验结果来判断。</li><li>举例<ul><li><img src="https://media.xiang578.com/2019-10-08-15388343449162.jpg" alt="" /></li><li>根据上面的公式计算：$$L = \max(0,437.9-(-96.8)) + \max(0,61.95-(-96.8))=695.45$$</li><li>猫的分类得分在三个类别中不是最高得，所以我们需要继续优化。</li></ul></li></ul></li><li>Suppose that we found a W such that L = 0. Is this W unique?<ul><li>No! 2W is also has L = 0!</li></ul></li><li>Regularization: 正则化，向某一些特定的权值 W 添加惩罚，防止权值过大，减轻模型的复杂度，提高泛化能力，也避免在数据集中过拟合现象。<ul><li><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>L</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mi>f</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>W</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><mi>λ</mi><mi>R</mi><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L=\frac{1}{N}\sum_iL_i\left(f\left(x_i,W\right),y_i\right) + \lambda R(W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.599109em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></span></p></li><li><code>R</code> 正则项 $$\lambda$$ 正则化参数</li></ul></li><li>常用正则化方法<ul><li>L2$$\begin{matrix} R(W)=\sum_{k}\sum_l W^2_{k,l} \end{matrix}$$</li><li>L1$$\begin{matrix} R(W)=\sum_{k}\sum_l \left\vert W_{k,l} \right\vert \end{matrix}$$</li><li>Elastic net(L1 + L2): $$\begin{matrix} R(W)=\sum_{k}\sum_l \beta W^2_{k,l} + \left\vert W_{k,l} \right\vert \end{matrix}$$</li><li>Dropout</li><li>Batch normalization</li><li>etc</li></ul></li><li>L2 惩罚倾向于更小更分散的权重向量，L1 倾向于稀疏项。</li><li>Softmax function：<ul><li><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi>s</mi><mi>i</mi></msub></msup><mrow><mo>∑</mo><msup><mi>e</mi><msub><mi>s</mi><mi>j</mi></msub></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f_j(z)=\frac{e^{s_i}}{\sum e^{s_j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.277402em;vertical-align:-0.93601em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.341392em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6064620000000001em;"><span style="top:-3.0050700000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93601em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li>该分类器将输出向量 f 中的评分值解释为没有归一化的对数概率，通过归一化之后，所有概率之和为1。</li><li>Loss 也称交叉熵损失 cross-entropy loss $$L_i = - \log\left(\frac{e^{s_i}}{\sum e^{s_j}}\right)$$</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = np.array([<span class="number">123</span>, <span class="number">456</span>, <span class="number">789</span>]) <span class="comment"># 例子中有3个分类，每个评分的数值都很大</span></span><br><span class="line">p = np.exp(f) / np.<span class="built_in">sum</span>(np.exp(f)) <span class="comment"># 不妙：数值问题，可能导致数值爆炸</span></span><br><span class="line"><span class="comment"># 那么将f中的值平移到最大值为0：</span></span><br><span class="line">f -= np.<span class="built_in">max</span>(f) <span class="comment"># f becomes [-666, -333, 0]</span></span><br><span class="line">p = np.exp(f) / np.<span class="built_in">sum</span>(np.exp(f)) <span class="comment"># 现在OK了，将给出正确结果</span></span><br></pre></td></tr></table></figure><ul><li>SVM 和 Softmax 比较<ol><li>评分，SVM 的损失函数鼓励正确的分类的分值比其他分类的分值高出一个边界值。</li><li>对数概率，Softmax 鼓励正确的分类归一化后的对数概率提高。</li><li>Softmax 永远不会满意，SVM 超过边界值就满意了。</li></ol></li><li>Optimization：最优化过程<ul><li>Follow the slope<ul><li><img src="https://media.xiang578.com/2019-10-08-15388374738605.jpg" alt="" /></li></ul></li></ul></li><li>梯度是函数的斜率的一般化表达，它不是一个值，而是一个向量，它是各个维度的斜率组成的向量。<ul><li>Numerical gradient: Approximate, slow, easy to write. (But its useful in debugging.)</li><li>Analytic gradient: Exact, Fast, Error-prone. (Always used in practice)</li><li>实际应用中使用分析梯度法，但可以用数值梯度法去检查分析梯度法的正确性。</li></ul></li><li>利用梯度优化参数的过程：<code>W = W - learning_rate * W_grad</code></li><li>learning_rate 被称为是学习率，是一个比较重要的超参数</li><li>Stochastic Gradient Descent SGD 随机梯度下降法<ul><li>每次使用一小部分的数据进行梯度计算，这样可以加快计算的速度。</li><li>每个批量中只有1个数据样本，则被称为随机梯度下降（在线梯度下降）</li></ul></li><li>图像分类任务中三大关键部分：<ol><li>评分函数</li><li>损失函数：量化某个具体参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span> 的质量</li><li>最优化：寻找能使得损失函数值最小化的参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span> 的过程</li></ol></li></ul><h2 id="04-introduction-to-neural-network"><a class="markdownIt-Anchor" href="#04-introduction-to-neural-network"></a> 04. Introduction to Neural network</h2><ul><li>反向传播：在已知损失函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span></span></span> 的基础上，如何计算导数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mi>W</mi></msub><mi>L</mi></mrow><annotation encoding="application/x-tex">{\nabla _WL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span></span>？</li><li>计算图<ul><li>由于计算神经网络中某些函数的梯度很困难，所以引入计算图的概念简化运算。</li><li>在计算图中，对应函数所有的变量转换成为计算图的输入，运算符号变成图中的一个节点（门单元）。</li></ul></li><li>反向传播：从尾部开始，根据链式法则递归地向前计算梯度，一直到网络的输入端。<ul><li><img src="https://media.xiang578.com/2019-10-08-15390088806657.jpg" alt="-w1107" /></li><li>绿色是正向传播，红色是反向传播。</li></ul></li><li>对于计算图中的每一个节点，我们需要计算这个节点上的局部梯度，之后根据链式法则反向传递梯度。</li><li>Sigmoid 函数：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mn>0</mn></msub><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">{f(w,x)=\frac{1}{1+e^{-(w_0x_0+w_1x_1+w_2)}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3136839999999999em;vertical-align:-0.468576em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.589755em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8574928571428572em;"><span style="top:-2.8574928571428573em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.02691em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">0</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29964em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">0</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29964em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.02691em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29964em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29964em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.02691em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29964em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.468576em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><ul><li><img src="https://media.xiang578.com/2019-10-08-15390092983570.jpg" alt="" /></li><li>对于门单元 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>x</mi></mfrac></mrow><annotation encoding="application/x-tex">{\frac{1}{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，求导的结果是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mfrac><mn>1</mn><msup><mi>x</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">{-\frac{1}{x^2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，输入为 1.37，梯度返回值为 1.00，所以这一步中的梯度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mfrac><mrow><mo>−</mo><mn>1</mn></mrow><mrow><mn>1.3</mn><msup><mn>7</mn><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">)</mo><mo>∗</mo><mn>1.00</mn><mo>=</mo><mo>−</mo><mn>0.53</mn></mrow><annotation encoding="application/x-tex">{(\frac{-1}{1.37^2})*1.00=-0.53}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mtight">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">3</span></span></span></span></span>。</li><li>模块化思想：对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">{\sigma(x)=\frac{1}{1+e^{-x}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7026642857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> 求导的结果是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(1-\sigma(x))\sigma(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>。如果 sigmoid 表达式输入值为 1.0 时，则前向传播中的结果是 0.73。根据求导结果计算可得局部梯度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>0.73</mn><mo stretchy="false">)</mo><mo>∗</mo><mn>0.73</mn><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">{(1-0.73)*0.73=0.2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span></span></span>。</li></ul></li><li>Modularized implementation: forward/backwar API</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MultuplyGate</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  x,y are scalars</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">x,y</span>):</span><br><span class="line">    z = x*y</span><br><span class="line">    self.x = x  <span class="comment"># Cache</span></span><br><span class="line">    self.y = y<span class="comment"># Cache</span></span><br><span class="line">    <span class="comment"># We cache x and y because we know that the derivatives contains them.</span></span><br><span class="line">    <span class="keyword">return</span> z</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">backward</span>(<span class="params">dz</span>):</span><br><span class="line">    dx = self.y * dz         <span class="comment">#self.y is dx</span></span><br><span class="line">    dy = self.x * dz</span><br><span class="line">    <span class="keyword">return</span> [dx, dy]</span><br></pre></td></tr></table></figure><ul><li>深度学习框架中会实现的门单元：Multiplication、Max、Plus、Minus、Sigmoid、Convolution</li><li>常用计算单元<ul><li>**加法门单元：**把输出的梯度相等地分发给它所有的输入，这一行为与输入值在前向传播时的值无关。</li><li>**取最大值门单元：**将梯度转给前向传播中值最大的那个输入，其余输入的值为0。</li><li>**乘法门单元：**等值缩放。局部梯度就是输入值，但是需要相互交换，然后根据链式法则乘以输出值得梯度。</li></ul></li><li>Neural NetWorks<ul><li>(Before) Linear score function $$f = Wx$$</li><li>(Now) 2-layer Neural NetWork $$f=W_2\max(0,W_1x)$$</li><li>ReLU $$\max(0,x)$$ 是激活函数，如果不使用激活函数，神经网络只是线性模型的组合，无法拟合非线性情况。</li><li>神经网络是更复杂的模型的基础组件</li></ul></li></ul><h2 id="05-convolutional-neural-networks-cnns"><a class="markdownIt-Anchor" href="#05-convolutional-neural-networks-cnns"></a> 05. Convolutional neural networks (CNNs)</h2><ul><li>这一轮浪潮的开端：<a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">AlxNet</a></li><li>卷积神经网络<ul><li>Fully Connected Layer 全连接层：这一层中所有的神经元链接在一起。</li><li>Convolution Layer：<ul><li>通过参数共享来控制参数的数量。Parameter sharing</li><li>Sparsity of connections</li></ul></li><li>卷积神经网络能学习到不同层次的输入信息</li><li>常见的神经网络结构：<code>INPUT -&gt; [[CONV -&gt; RELU]*N -&gt; POOL?]*M -&gt; [FC -&gt; RELU]*K -&gt; FC</code></li><li>使用小的卷积核大小的优点：多个卷积层与非线性的激活层交替的结构，比单一卷积层的结构更能提取出深层的更好地特征。而且使用的参数也会更少</li></ul></li><li>计算卷积层输出<ul><li>stride 是卷积核在移动时的步长</li><li>通用公式 (N-F)/stride + 1<ul><li>stride 1 =&gt; (7-3)/1 + 1 = 5</li><li>stride 2 =&gt; (7-3)/2 + 1 = 3</li><li>stride 3 =&gt; (7-3)/3 + 1 = 2.33</li></ul></li><li>Zero pad the border: 用零填充所有的边界，保证输入输出图像大小相同，保留图像边缘信息，提高算法性能<ul><li>步长为 1 时，需要填充的边界计算公式：(F-1)/2<ul><li>F = 3 =&gt; zero pad with 1</li><li>F = 5 =&gt; zero pad with 2</li><li>F = 7 =&gt; zero pad with 3</li></ul></li></ul></li><li>计算例子<ul><li>输入大小 <code>32*32*3</code> 卷积大小 10 5*5 stride 1 pad 2</li><li>output <code>32*32*10</code></li><li>每个 filter 的参数数量：<code>5*5*3+1 =76</code> bias</li><li>全部参数数量 76*10=760</li></ul></li></ul></li><li>卷积常用超参数设置<ul><li>卷积使用小尺寸滤波器</li><li>卷积核数量 K 一般为 2 的次方倍</li><li>卷积核的空间尺寸 F</li><li>步长 S</li><li>零填充数量 P</li></ul></li><li>Pooling layer<ul><li>降维，减少参数数量。在卷积层中不对数据做降采样</li><li>卷积特征往往对应某个局部的特征，通过池化聚合这些局部特征为全局特征</li></ul></li><li>Max pooling<ul><li>2*2 stride 2</li><li>避免区域重叠</li></ul></li><li>Average pooling</li></ul><h2 id="06-training-neural-networks-i"><a class="markdownIt-Anchor" href="#06-training-neural-networks-i"></a> 06. Training neural networks I</h2><ul><li><p>Activation functions 激活函数</p><ul><li>不使用激活函数，最后的输出会是输入的线性组合。利用激活函数对数据进行修正。</li><li><img src="https://media.xiang578.com/2019-10-08-15395012747510.jpg" alt="" /></li><li>Sigmoid<ul><li>限制输出在 [0,1]区间内</li><li>firing rate</li><li>二分类输出层激活函数</li><li>Problem<ul><li>梯度消失：x很大或者很小时，梯度很小，接近于0（考虑图像中的斜率。无法得到梯度反馈。</li><li>输出不是 0 均值的数据，梯度更新效率低</li><li>exp is a bit compute expensive</li></ul></li></ul></li><li>tanh<ul><li>输出范围 [-1, 1]</li><li>0 均值</li><li>x 很大时，依然没有梯度</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">{f(x)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3906960000000002em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.987365em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7026642857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8476642857142858em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{1-(tanh(x))^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li></ul></li><li>RELU rectified linear unit 线性修正单元<ul><li>一半空间梯度不会饱和，计算速度快，对结果又有精确的计算</li><li>不是 0 均值</li></ul></li><li>Leaky RELU<ul><li><code>leaky_RELU(x) = max(0.01x, x)</code></li><li>梯度不会消失</li><li>需要学习参数</li></ul></li><li>ELU<ul><li>比 ReLU 好用</li><li>反激活机制</li></ul></li><li>Maxout<ul><li>maxout(x) = max(w1.T<em>x + b1, w2.T</em>x + b2)</li><li>梯度不会消失</li><li>增大参数数量</li></ul></li><li>激活函数选取经验<ul><li>使用 ReLU ，但要仔细选取学习率</li><li>尝试使用 Leaky ReLU Maxout ELU</li><li>使用 tanh 时，不要抱有太大的期望</li><li>不要使用 sigmoid</li></ul></li></ul></li><li><p>数据预处理 Data Preprocessing</p><ul><li>均值减法：对数据中每个独立特征减去平均值，从几何上来看是将数据云的中心都迁移到原点。</li><li>归一化：将数据中的所有维度都归一化，使数值范围近似相等。但是在图像处理中，像素的数值范围几乎一致，所以不需要额外处理。</li></ul> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X -= np.mean(X, axis = <span class="number">1</span>)</span><br><span class="line">X /= np.std(X, axis =<span class="number">1</span>)</span><br></pre></td></tr></table></figure><ul><li>图像归一化<ul><li>Subtract the mean image AlexNet<ul><li>mean image 32,32,3</li></ul></li><li>Subtract per-channel mean VGGNet<ul><li>mean along each channel = 3 numbers</li></ul></li><li>如果需要进行均值减法时，均值应该是从训练集中的图片平均值，然后训练集、验证集、测试集中的图像再减去这个平均值。</li></ul></li><li>Weight Initialization<ul><li>全零初始化<ul><li>网络中的每个神经元都计算出相同的输出，然后它们就会在反向传播中计算出相同的梯度。神经元之间会从源头上对称。</li></ul></li><li>Small random numbers<ul><li>初始化权值要非常接近 0 又不能等于 0。将权重初始化为很小的数值，以此来打破对称性</li><li>randn 函数是基于零均值和标准差的高斯分布的随机函数</li><li>W = 0.01 * np.random.rand(D,H)</li><li>问题：一个神经网络的层中的权重值很小，那么在反向传播的时候就会计算出非常小的梯度。会减小反向传播中的“梯度信号”，在深度网络中就会出现问题。</li></ul></li><li>Xavier initialization<ul><li>W = np.random.rand(in, out) / np.sqrt(in)</li><li>校准方差，解决输入数据量增长，随机初始化的神经元输出数据的分布中的方差也增大问题。</li></ul></li><li>He initialization<ul><li>W = np.random.rand(in, out) / np.sqrt(in/2)</li></ul></li></ul></li><li>Batch normalization<ul><li>保证输入到神经网络中的数据服从标准的高斯分布</li><li>通过批量归一化可以加快训练的速度</li><li>步骤<ul><li>首先计算每个特征的平均值和平方差</li><li>通过减去平局值和除以方差对数据进行归一化</li><li><code>Result = gamma * normalizedX + beta</code><ul><li>对数据进行线性变换，相当于对数据分布进行一次移动，可以恢复数据之前的分布特征</li></ul></li></ul></li><li>BN 的好处<ul><li>加快训练速度</li><li>可以使用更快的而学习率</li><li>减少数据对初始化权值的敏感程度</li><li>相当于进行一次正则化</li></ul></li><li>BN 适用于卷积神经网络和常规的 DNN，在 RNN 和增强学习中表现不是很好</li></ul></li><li>Babysitting the Learning Provess</li><li>Hyperparameter Optimization<ul><li>Cross-validation 策略训练</li><li>小范围内随机搜索</li></ul></li></ul></li></ul><h2 id="07-training-neural-networks-ii"><a class="markdownIt-Anchor" href="#07-training-neural-networks-ii"></a> 07. Training neural networks II</h2><ul><li>Optimization Algorithms:<ul><li><p>SGD 的问题</p><ul><li><code>x += - learning_rate * dx</code></li><li>梯度在某一个方向下降速度快，在其他方向下降缓慢</li><li>遇到局部最小值点，鞍点</li></ul></li><li><p>mini-batches GD</p><ul><li>Shuffling and Partitioning are the two steps required to build mini-batches</li><li>Powers of two are often chosen to be the mini-batch size, e.g., 16, 32, 64, 128.</li></ul></li><li><p>SGD + Momentun</p><ul><li>动量更新：从物理学角度启发最优化问题</li><li><code>V[t+1] = rho * v[t] + dx; x[t+1] = x[t] - learningRate * V[t+1]</code></li><li>rho 被看做是动量，其物理意义与摩擦系数想类似，常取 0.9 或0.99</li><li>和 momentun 项更新方向相同的可以快速更新。</li><li>在 dx 中改变梯度方向后， rho 可以减少更新。momentun 能在相关方向加速 SGD，抑制震荡，加快收敛。</li></ul></li><li><p>Nestrov momentum</p><ul><li><img src="https://media.xiang578.com/2019-10-08-15499574039274.jpg" alt="" /></li><li><code>v_prev = v; v = mu * v - learning_rate * dx; x += -mu * v_prev + (1 + mu) * v</code></li></ul></li><li><p>AdaGrad</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>=</mo><msub><mi>n</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">n_t=n_{t-1}+g^2_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mfrac><mi>η</mi><msqrt><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\Delta \theta _t = -\frac{\eta}{\sqrt{n_t+\epsilon}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2855em;vertical-align:-0.538em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6224469999999998em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.81079em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span></span></span><span style="top:-2.77079em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.22921000000000002em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>下面根号中会递推形成一个约束项。前期这一项比较大，能够放大梯度。后期这一项比较小，能约束梯度。</li><li>gt 的平方累积会使梯度趋向于 0</li></ul></li><li><p>RMSProp</p><ul><li>RMS 均方根</li><li>自适应学习率方法</li><li>求梯度的平方和平均数：<code>cache =  decay_rate * cache + (1 - decay_rate) * dx**2</code></li><li><code>x += - learning_rate * dx / (sqrt(cache) + eps)</code></li><li>依赖全局学习率</li></ul></li><li><p>Adam</p><ul><li>RMSProp + Momentum</li><li>It calculates an exponentially weighted average of past gradients, and stores it in variables <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> (before bias correction) and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">v^{corrected}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span> (with bias correction).</li><li>It calculates an exponentially weighted average of the squares of the past gradients, and  stores it in variables <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> (before bias correction) and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">s^{corrected}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span> (with bias correction).</li><li>一阶到导数累积，二阶导数累积</li><li>It updates parameters in a direction based on combining information from “1” and “2”.</li><li>The update rule is, for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">l = 1, ..., L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span></span></span></span>:</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>v</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>v</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mo>=</mo><mfrac><msub><mi>v</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><msub><mi>β</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mi>t</mi></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>s</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>s</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></mfrac><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi>s</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mo>=</mo><mfrac><msub><mi>s</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow></msub><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><msub><mi>β</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mi>t</mi></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>−</mo><mi>α</mi><mfrac><msubsup><mi>v</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msubsup><mrow><msqrt><msubsup><mi>s</mi><mrow><mi>d</mi><msup><mi>W</mi><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></mrow><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msubsup></msqrt><mo>+</mo><mi>ε</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}v_{dW^{[l]}} = \beta_1 v_{dW^{[l]}} + (1 - \beta_1) \frac{\partial \mathcal{J} }{ \partial W^{[l]} } \\v^{corrected}_{dW^{[l]}} = \frac{v_{dW^{[l]}}}{1 - (\beta_1)^t} \\s_{dW^{[l]}} = \beta_2 s_{dW^{[l]}} + (1 - \beta_2) (\frac{\partial \mathcal{J} }{\partial W^{[l]} })^2 \\s^{corrected}_{dW^{[l]}} = \frac{s_{dW^{[l]}}}{1 - (\beta_1)^t} \\W^{[l]} = W^{[l]} - \alpha \frac{v^{corrected}_{dW^{[l]}}}{\sqrt{s^{corrected}_{dW^{[l]}}} + \varepsilon}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.40004em;vertical-align:-3.9500200000000003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.45002em;"><span style="top:-0.09998999999999958em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-0.09498999999999969em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.3899899999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.6849899999999995em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9799899999999995em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.2749899999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.5699899999999998em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.86499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.15999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.59001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.88501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.18001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.47501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.77001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.06501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.36001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.40501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.700019999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9500200000000003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.4069475em;"><span style="top:-6.7472425000000005em;"><span class="pstrut" style="height:3.348295em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23062499999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23062499999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.18472em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-5.307242499999999em;"><span class="pstrut" style="height:3.348295em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.3275750000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.372425em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.923907em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.622515em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.10775em;"><span style="top:-3.1077500000000002em;margin-right:0.1em;"><span class="pstrut" style="height:2.75em;"></span><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44645em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.7792425em;"><span class="pstrut" style="height:3.348295em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23062499999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23062499999999997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.18472em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3392424999999997em;"><span class="pstrut" style="height:3.348295em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.3275750000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.372425em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.923907em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.622515em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.10775em;"><span style="top:-3.1077500000000002em;margin-right:0.1em;"><span class="pstrut" style="height:2.75em;"></span><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44645em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-0.4709475000000001em;"><span class="pstrut" style="height:3.348295em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3482949999999998em;"><span style="top:-2.46973em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.028957142857143em;"><span class="svg-align" style="top:-3.7142857142857144em;"><span class="pstrut" style="height:3.7142857142857144em;"></span><span class="mord mtight" style="padding-left:1.4285714285714286em;"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8408285714285714em;"><span style="top:-2.1487999999999996em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.10775em;"><span style="top:-3.1077500000000002em;margin-right:0.1em;"><span class="pstrut" style="height:2.75em;"></span><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.13605em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.64245em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0009571428571427em;"><span class="pstrut" style="height:3.7142857142857144em;"></span><span class="hide-tail mtight" style="min-width:1.02em;height:1.8285714285714287em;"><svg width='400em' height='1.8285714285714287em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7133285714285715em;"><span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ε</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.699375em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285713em;"><span style="top:-2.235em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.10775em;"><span style="top:-3.1077500000000002em;margin-right:0.1em;"><span class="pstrut" style="height:2.75em;"></span><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.22225em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.79125em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.55625em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0296em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9069475em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>where:</p><ul><li>t counts the number of steps taken of Adam</li><li>L is the number of layers</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are hyperparameters that control the two exponentially weighted averages.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is the learning rate</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ε</span></span></span></span> is a very small number to avoid dividing by zero</li></ul><p>特点：</p><ul><li>适用于大数据集和高维空间。</li><li>对不同的参数计算不同的自适应学习率。</li></ul></li><li><p>Learning decay</p><ul><li>学习率随着训练变化，比如每一轮在前一轮的基础上减少一半。</li><li>防止学习停止</li></ul></li><li><p>Second order optimization</p></li></ul></li><li>Regularization<ul><li>Dropout<ul><li>每一轮中随机使部分神经元失活，减少模型对神经元的依赖，增强模型的鲁棒性。</li></ul></li></ul></li><li>Transfer learning<ul><li>CNN 中的人脸识别，可以在大型的模型基础上利用少量的相关图像进行继续训练。</li></ul></li></ul><h2 id="09-cnn-architectures"><a class="markdownIt-Anchor" href="#09-cnn-architectures"></a> 09. CNN architectures</h2><ul><li>研究模型的方法：搞清楚每一层的输入和输出的大小关系。</li><li>LeNet - 5 [1998]<ul><li>60k 参数</li><li>深度加深，图片大小减少，通道数量增加</li><li>ac: Sigmod/tanh</li></ul></li><li>AlexNet [2012]<ul><li>(227,227,3) （原文错误）</li><li>60M 参数</li><li>LRN：局部响应归一化，之后很少使用</li></ul></li><li>VGG - 16 [2015]<ul><li>138 M</li><li>结构不复杂，相对一致，图像缩小比例和通道增加数量有规律</li></ul></li><li>ZFNet [2013]<ul><li>在 AlexNet 的基础上修改<ul><li><code>CONV1</code>: change from (11 x 11 stride 4) to (7 x 7 stride 2)</li><li><code>CONV3,4,5</code>: instead of 384, 384, 256 filters use 512, 1024, 512</li></ul></li></ul></li><li>VGG [2014]<ul><li>模型中只使用 3*3 conv：与 77 卷积有相同的感受野，而且可以将网络做得更深。比如每一层可以获取到原始图像的范围：第一层 33，第二层 55，第三层 77。</li><li>前面的卷积层参数量很少，模型中大部分参数属于底部的全连接层。</li></ul></li></ul><p><img src="https://media.xiang578.com/2019-10-08-15705415499052.jpg" alt="" /></p><ul><li>GoogLeNet<ul><li>引入 <code>Inception module</code><ul><li>design a good local network topology (network within a network) and then stack these modules on top of each other</li><li>该模块可以并行计算</li><li>conv 和 pool 层进行 padding，最后将结果 concat 在一起</li></ul></li></ul></li></ul><p><img src="https://media.xiang578.com/2019-10-08-15705420412305.jpg" alt="Reset" /></p><ul><li>ResNet<ul><li>目标：深层模型表现不应该差于浅层模型，解决随着网络加深，准确率下降的问题。</li><li><code>Y = (W2* RELU(W1x+b1) + b2) + X</code></li><li>如果网络已经达到最优，继续加深网络，residual mapping会被设置为 0，一直保存网络最优的情况。</li></ul></li></ul><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/22252270">深度学习最全优化方法总结比较（SGD，Adagrad，Adadelta，Adam，Adamax，Nadam） - 知乎</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;去年学习这门做的部分笔记，现在分享出来。&lt;br /&gt;
笔记格式有些问题，持续整理中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;大量内容参考 &lt;a href=&quot;https://github.com/mbadry1/CS231n-2017</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="ml" scheme="https://blog.xiang578.com/tags/ml/"/>
    
    <category term="course" scheme="https://blog.xiang578.com/tags/course/"/>
    
  </entry>
  
  <entry>
    <title>算法花园写作风格清单</title>
    <link href="https://blog.xiang578.com/post/blog-writing-checklist.html"/>
    <id>https://blog.xiang578.com/post/blog-writing-checklist.html</id>
    <published>2019-11-03T10:03:23.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>李如一在 <a href="https://www.qdaily.com/articles/1397.html">写作风格手册</a> 中提到写作风格的作用是 「保持机构和组织内部的文体统一，提高沟通效率。」</p><p>本清单会持续更新，如果有相关的建议，可以在留言中告诉我。</p></blockquote><p>算法花园定位为个人博客，也是我和这个世界沟通的窗口。为提高读者阅读体验，参考相关文章后，推出该清单统一网站文章的基础风格。</p><h2 id="写作"><a class="markdownIt-Anchor" href="#写作"></a> 写作</h2><ol><li>减少形容词使用，尽可能删除 「的」和「了」。</li><li>给出引用图片及引文来源。</li><li>文章如果发布后大幅度修改，在末尾给出版本信息。</li><li>写完文章后，整体阅读一遍。</li></ol><h2 id="排版"><a class="markdownIt-Anchor" href="#排版"></a> 排版</h2><ol><li>中文、英文、数字中间加空格，数字与单位之间无需增加空格，全角标点与其他字符之间不加空格。链接前后增加空格用以区分。</li><li>不重复使用标点符号。</li><li>中文使用直角引号 「」以及『 』。</li><li>使用全角中文标点，数字使用半角字符。中文中出现英文部分，仍然使用中文标点。</li><li>遇到完整的英文整句、特殊名词，其內容使用半角标点。</li><li>专有名词使用正确的大小写，使用公认的缩写。</li><li>todo 如何处理图片排版和命名。</li><li>使用英文命名文档，使用 <code>-</code> 来连接。为保证搜索引擎效果，尽量不要修改文档名称。</li><li><s>每篇文章开头添加简单介绍 <code>&lt;!--more--&gt;</code>。</s></li><li>发布后，在网页中确认格式是否符合预期、链接能否点击以及图片能否展示。</li></ol><h2 id="changelog"><a class="markdownIt-Anchor" href="#changelog"></a> ChangeLog</h2><blockquote><p>20191103: 第一版</p></blockquote><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><ul><li><a href="https://www.qdaily.com/articles/1397.html">写作风格手册_设计词典_好奇心日报</a></li><li><a href="https://mazhuang.org/wiki/chinese-copywriting-guidelines/">中文文案排版指北（简体中文版） — 码志</a></li><li><a href="https://zhuanlan.zhihu.com/p/49729668">简体中文文本排版指南 - 知乎</a></li><li><a href="https://sspai.com/post/37815">少数派写作排版指南 - 少数派</a></li><li><a href="https://www.jianshu.com/p/8ffc3e0d11e2">城堡制作检查清单 0.1 版 - 简书</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;李如一在 &lt;a href=&quot;https://www.qdaily.com/articles/1397.html&quot;&gt;写作风格手册&lt;/a&gt; 中提到写作风格的作用是 「保持机构和组织内部的文体统一，提高沟通效率。」&lt;/p&gt;
&lt;p&gt;本清单会持续更新，如果有</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="writing" scheme="https://blog.xiang578.com/tags/writing/"/>
    
  </entry>
  
  <entry>
    <title>(WDR) Learning to Estimate the Travel Time</title>
    <link href="https://blog.xiang578.com/post/wdr.html"/>
    <id>https://blog.xiang578.com/post/wdr.html</id>
    <published>2019-07-28T14:14:33.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>严重申明：本篇文章所有信息从论文、网络等公开渠道中获得，不会透露滴滴地图 ETA 任何实现方法。</p></blockquote><p>这篇论文是滴滴时空数据组 2018 年在 KDD 上发表的关于在 ETA 领域应用深度学习的文章，里面提到模型和技巧大家都应该耳熟能详，最大亮点是工业界的创新。</p><p>简单介绍一下背景：ETA 是 Estimate Travel Time 的缩写，中文大概能翻译成到达时间估计。这个问题描述是：在某一个时刻，估计从 A 点到 B 点需要的时间。对于滴滴，关注的是司机开车把乘客从起点送到终点需要的时间。抽象出来 ETA 就是一个时间空间信息相关的回归问题。CTR 中常用的方法都可以在这里面尝试。</p><p>对于这个问题：文章首先提到一个最通用的方法 Route ETA：即在获得 A 点到 B 点路线的情况下，计算路线中每一段路的行驶时间，并且预估路口的等待时间。最终 ETA 由全部时间相加得到。这种方法实现起来很简单，也能拿到一些收益。但是仔细思考一下，没有考虑未来道路的通行状态变化情况以及路线的拓扑关系。针对这些问题，文章中提到滴滴内部也有利用 GBDT 或 FM 的方法解决 ETA 问题，不过没有仔细写实现的方法，我也不好继续分析下去。</p><h2 id="评价指标"><a class="markdownIt-Anchor" href="#评价指标"></a> 评价指标</h2><p>对于 ETA 问题来说，工业界和学术界常用的指标是 MAPE(mean absolute percentage error)，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 是司机实际从 A 点到 B 点花费的时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f(x_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 是 ETA 模型估计出来的时间。得到计算公式如下：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>f</mi></msub><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow><msub><mi>y</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">{min_f \sum_{i=1}^{N}\frac{|y_i - f(x_i)|}{y_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p><p>多说一句，如果使用 GBDT 模型实现 ETA 时，这个损失函数的推导有点困难，全网也没有看见几个人推导过。</p><p>这个公式主要考虑预估时间偏差大小对用户感知体验的影响，目前我们更加关心极端 badcase 对用户的影响。</p><h2 id="特征"><a class="markdownIt-Anchor" href="#特征"></a> 特征</h2><ul><li>特征：<ul><li>空间特征：路线序列、道路等级、POI等</li><li>时间特征：月份、星期、时间片等</li><li>路况特征：道路的通行速度、拥堵程度</li><li>个性化信息：司机特征、乘客特征（有「杀熟」风险）、车辆特征</li><li>附近特征：天气、交通管制</li></ul></li></ul><h2 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h2><p>模型包含 3 个部分：</p><ul><li>Wide Learning Models：Wide &amp; Deep 这一部分使用的是 LR + 特征工程，希望模型能记忆一部分的模型。这篇论文中直接利用交叉积学习，减少手动特征工程。</li><li>Deep Neural Networks：对 sparse feature 做一次 Embedding，使用 3 层 MLP 和 ReLU 的网络。</li><li>Long-Short Term Memory：前两部分模块没用使用路线序列特征，所以这部分采用 LSTM 抽取路线特征。由于路线序列是不定长的，论文中的模型是使用最后一个隐藏状态，我们也可以把全部的隐藏状态 reduce_sum 输入到最后的模块。</li><li>Regressor： 将 3 个模型的输出综合起来，作为最后的 ETA 预估。MAPE 作为损失函数，利用 BP 训练模型。</li></ul><p><img src="https://media.xiang578.com/15643233780326.jpg" alt="WDR" /></p><p>上面模型中使用的特征分类：</p><ul><li>Dense feature：行程级别的实数特征，比如起终点球面距离、起终点 GPS 坐标等。</li><li>Sparse feature：行程级别的离散特征，比如时间片编号、星期几、天气类型等。</li><li>Sequential feature：link 级别的特征，实数特征直接输入模型，而离散特征先做 embedding 再输入模型。注意，这里不再是每个行程一个特征向量，而是行程中每条 link 都有一个特征向量。比如，link 的长度、车道数、功能等级、实时通行速度等。</li></ul><h2 id="评估"><a class="markdownIt-Anchor" href="#评估"></a> 评估</h2><p>包括两部分：离线评估和在线评估。</p><p>离线评估中取滴滴 2017 年北京前6个月的订单数据，分成两类 pickup （平台给司机分单后，司机开车去接乘客的过程）和 trip （司机接到乘客并前往目的地的过程）。具体数据集划分如下。</p><p><img src="https://media.xiang578.com/15643234056004.jpg" alt="离线效果" /></p><p>离线使用 MAPE 来评价模型。在线评估时，为了更好的与用户体验挂钩，采用多个指标来衡量 ETA 的效果。包括：</p><ul><li>APE20: absolute percentage error 小于 20% 的订单占比。（越大越好）</li><li>Badcase率：APE 大于 50% 或者 AE 大于 180s 的订单占比，定义为对用户造成巨大影响的情况。（越小越好）</li><li>低估率：低估订单的比例。（越小越好）</li></ul><p>离线结果如下图所示，说来汗颜 PTTE 和 TEMP 是什么算法我都不知道…… WD-MLP 指的是将 WDR 中的 R 部分换成 MLP 。最终 WDR 较 route-ETA 有巨大提升，而且 LSTM 引入的序列信息也在 pikcup 上提升了 0.75%。文章的最后还提出来，LSTM 也可以换成是 Attention，这样替换有什么优点和缺点留给大家思考。</p><p><img src="https://media.xiang578.com/15643234140115.jpg" alt="pickup 和 trip 效果" /></p><p>在线实验结果如下图所示，滴滴 ETA MAPE 明显小于 com1、com2、com3 ，这三家地图公司具体是哪三家，大家也能猜到吧。</p><p><img src="https://media.xiang578.com/15643234258049.jpg" alt="线上实验效果" /></p><h2 id="eta-服务工程架构"><a class="markdownIt-Anchor" href="#eta-服务工程架构"></a> ETA 服务工程架构</h2><p><img src="https://media.xiang578.com/15643234352132.jpg" alt="工程架构" /></p><p>从上面的图中可以看出 ETA 服务工程架构主要包括三个部分：</p><ul><li>Data Aggregation：包括利用 Map Matching 将司机上传到平台的 GPS 对应到滴滴的 Map Info 中得到司机真实行驶过的路线信息，Order Context 指的是订单相关的信息，augmented Data 额外数据比如上文说的交通情况相关信息。</li><li>Offline Training：利用上一步得到的历史数据训练模型。这里可以值得一提的是，ETA 模型是和时间强相关的（节假日和工作日的数据分布明显不同），所以在文章中作者指出将拿出最新的一部分数据用来 fine-tune 训练出来的 WDR 模型。</li><li>Online Service：这里需要一个完整的模型服务系统，其他公司也有很多分享，所以原文没有多提。</li></ul><h2 id="fma-eta-estimating-travel-time-entirely-based-on-ffn-with-attention"><a class="markdownIt-Anchor" href="#fma-eta-estimating-travel-time-entirely-based-on-ffn-with-attention"></a> FMA-ETA: Estimating Travel Time Entirely Based on FFN With Attention</h2><p><img src="https://media.xiang578.com//fma-eta.jpg" alt="模型架构" /></p><ul><li>WDR 模型中 RNN 耗时长，探索基于 Attention 机制的模型</li><li>对特征分组（multi-factor）去做 Attention 效果比多头要好</li><li>实验结果分析这部分没有看懂<blockquote><p>The deep modules with attention achieve better results than WDR on MAE and RMSE metrics, which means attention mechanism can help to extract features and sole the long-range dependencies in long sequence.</p></blockquote></li><li>遗憾之处<ul><li>新模型预测时延减少，但是没有线上实验结果。</li><li>暂时没有公开代码和数据集。</li></ul></li></ul><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>从上面简单的介绍来看，ETA 可以使用 CTR 和 NLP 领域的很多技术，大有可为。最后，滴滴 ETA 团队持续招人中（社招、校招、日常实习等），感兴趣者快快和我联系。</p><p>说点题外话 <a href="https://www.zhihu.com/question/22385673/answer/522580778">你为什么从滴滴出行离职？ - 知乎</a> 中提到一点：</p><blockquote><p>8.同年大跃进，在滴滴中高层的眼里，没有BAT。滴滴单量超淘宝指日可待，GAFA才是滴滴要赶超的对象。百度系，LinkedIn系，学院派，uber帮，联想系，MBB就算了，据说连藤校都混成了一个小圈子。。一个项目A team ，B team。一个ETA，投入了多少人力自相残杀？MAPE做到0%又如何？用户体验就爆表了吗？长期留存就高枕无忧了吗？风流总被雨打风吹去，滴滴是二龙山，三虫聚首？是不是正确的事情不知道，反正跟着公司大势所趋，升D10保平安。</p></blockquote><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><blockquote><ul><li><a href="https://www.leiphone.com/news/201808/EmRne91YDwwNCl4A.html">KDD 2018：滴滴提出WDR模型显著提升ETA预测精度 | 雷锋网</a></li><li><a href="http://www.semocean.com/lbs%e5%b7%a5%e4%b8%9a%e7%95%8ceta%e5%ba%94%e7%94%a8%e5%8f%8a%e6%bb%b4%e6%bb%b4wdr%e6%8a%80%e6%9c%af/">LBS工业界ETA应用及滴滴WDR技术 – Semocean</a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;严重申明：本篇文章所有信息从论文、网络等公开渠道中获得，不会透露滴滴地图 ETA 任何实现方法。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这篇论文是滴滴时空数据组 2018 年在 KDD 上发表的关于在 ETA 领域应用深度学习的文章，里面提到模</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="didi" scheme="https://blog.xiang578.com/tags/didi/"/>
    
    <category term="lstm" scheme="https://blog.xiang578.com/tags/lstm/"/>
    
    <category term="widedeep" scheme="https://blog.xiang578.com/tags/widedeep/"/>
    
  </entry>
  
  <entry>
    <title>(FM) Factorization Machines</title>
    <link href="https://blog.xiang578.com/post/fm.html"/>
    <id>https://blog.xiang578.com/post/fm.html</id>
    <published>2019-07-28T10:18:52.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>Factorization Machines(FM) 由日本 Osaka University 的 Steffen Rendle [1] 在 2010 年提出,是一种常用的因子机模型。</p><h2 id="fm"><a class="markdownIt-Anchor" href="#fm"></a> FM</h2><p>假设现在有一个电影评分的任务，给定如下如所示的特征向量 x（包括用户名、当前在看的电影、已经打分的电影、时间特征、之前看的电影），预测用户对当前观看电影的评分。</p><p><img src="https://media.xiang578.com/15643023365227.jpg" alt="电影评分" /></p><p>作者在线性回归模型的基础上，添加交叉项部分，用来自动组合二阶特征。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo fence="true">⟩</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat y(x):= w_0 + \sum_{i=1}^{n} w_ix_i + \sum_{i=1}^n \sum_{j=i+1}^n \left \langle v_i,v_j \right \rangle x_ix_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中交叉特征的权重由两个向量的点积得到，可以解决没有在模型中出现的特征组合权重问题，以及减少参数数量。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo fence="true">⟩</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>v</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub><mo>⋅</mo><msub><mi>v</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{i,j}=\left \langle v_i,v_j \right \rangle = \sum_{f=1}^kv_{i,f} \cdot v_{j,f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.274334em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>通过下面的方法来化简交叉项权重计算，算法复杂度降到线性。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo fence="true">⟩</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>f</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mrow><mo fence="true">(</mo><msup><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>v</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>v</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>f</mi></mrow><mn>2</mn></msubsup><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n \sum_{j=i+1}^n \left \langle v_i,v_j \right \rangle x_iy_i = \frac{1}{2}\sum^k_{f=1} \left( \left(\sum_{i=1}^nv_{i,f}x_i \right)^2 - \sum^n_{i=1} v^2_{i,f} x_i^2 \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V300 H291 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.954008em;"><span style="top:-4.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V300 H457 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>对交叉项部分的求导：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo fence="true">(</mo><mi>x</mi><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mstyle scriptlevel="0" displaystyle="false"><mi>θ</mi></mstyle><mtext> is </mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>w</mi><mn>0</mn></msub></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mstyle scriptlevel="0" displaystyle="false"><mi>θ</mi></mstyle><mtext> is </mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>w</mi><mi>i</mi></msub></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>i</mi></msub><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>v</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>v</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mstyle scriptlevel="0" displaystyle="false"><mi>θ</mi></mstyle><mtext> is </mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub></mstyle></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial \theta} \hat y \left( x \right) =\begin{cases}1, &amp; \text{ if $\theta$ is $w_0$} \\x_i, &amp; \text{ if $\theta$ is ${w_i}$} \\x_i\sum^n_{j=1} v_{j,f}x_j - v_{i,f}x_i^2, &amp;\text{if $\theta$ is ${v_{i,f}}$}  \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.323817999999999em;vertical-align:-1.9119089999999996em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.411909em;"><span style="top:-4.4119090000000005em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span><span style="top:-2.971909em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-1.5319090000000004em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9119089999999996em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.411909em;"><span style="top:-4.4119090000000005em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord"> is </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.971909em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord"> is </span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.5319090000000004em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord"> is </span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9119089999999996em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>v</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>f</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{\sum^n_{j=1} v_{j,f}x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24011em;vertical-align:-0.43581800000000004em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 无关，可以在计算导数前预处理出来。</p><h3 id="fm-vs-svm"><a class="markdownIt-Anchor" href="#fm-vs-svm"></a> FM vs SVM</h3><p>对于经典的特征组合问题，不难想到使用 SVM 求解。Steffen 在论文中也多次将 FM 和 SVM 做对比。</p><p>在考虑 SVM 的 Polynomial kernel 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">z</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">⟨</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">z</mi><mo stretchy="false">⟩</mo><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{K(\mathbf{x}, \mathbf{z}) :=(\langle\mathbf{x}, \mathbf{z}\rangle+ 1)^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">z</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mopen">⟨</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">z</span></span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>，映射</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mrow><mrow><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>2</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}{\phi(\mathbf{x}) :=\left(1, \sqrt{2} x_{1}, \ldots, \sqrt{2} x_{n}, x_{1}^{2}, \ldots, x_{n}^{2}\right.} {\sqrt{2} x_{1} x_{2}, \ldots, \sqrt{2} x_{1} x_{n}, \sqrt{2} x_{2} x_{3}, \ldots, \sqrt{2} x_{n-1} x_{n} )}\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.26722em;vertical-align:-0.38361000000000006em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88361em;"><span style="top:-2.97639em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.38361000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p><p>SVM 的公式可以转化为：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msqrt><mn>2</mn></msqrt><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>w</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><msqrt><mn>2</mn></msqrt><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>w</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \hat{y}(\mathbf{x})=w_{0}+\sqrt{2} \sum_{i=1}^{n} w_{i} x_{i}+\sum_{i=1}^{n} w_{i, i}^{(2)} x_{i}^{2} &amp;+\sqrt{2} \sum_{i=1}^{n} \sum_{j=i+1}^{n} w_{i, j}^{(2)} x_{i} x_{j} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.3651740000000006em;vertical-align:-1.4325870000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9325870000000003em;"><span style="top:-3.9325870000000003em;"><span class="pstrut" style="height:3.6513970000000007em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4325870000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9325870000000003em;"><span style="top:-3.9325870000000003em;"><span class="pstrut" style="height:3.6513970000000007em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4325870000000003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>论文中提到一句上面的公式中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{w_{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{w_{i,i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> 表达能力类似，我猜这也是为什么 FM 中没有自身交叉项的原因吧。</p><p>FM 相比于 SVM 有下面三个特点：</p><ol><li>SVM 中虽然也有特征交叉项，但是只能在样本中含有相对应的特征交叉数据时才能学习。但是 FM 能在数据稀疏的时候学习到交叉项的参数。</li><li>SVM 问题无法直接求解，常用的方法是根据拉格朗日对偶性将原始问题转化为对偶问题。</li><li>在使用模型预测时，SVM 依赖部分训练数据（支持向量），FM 模型则没有这种依赖。</li></ol><h3 id="rank"><a class="markdownIt-Anchor" href="#rank"></a> Rank</h3><p>FM 用来做回归和分类都很好理解，简单写一下如何应用到排序任务中。以 pairwise 为例。假设排序结果有两个文档 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span>，显然用户点击文档有先后顺序，如果先点击 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>，记 label <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{y_{ij}=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span></span>，反之点击 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span>，label <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{y_{ij}=0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span>。模型需要去预测 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\hat y_{ij} = sigmoid(\hat y_i - \hat y_j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</p><p>参考逻辑回归，用最大似然对参数进行估计，得到损失函数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mo stretchy="false">(</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{L=\log(1+\exp(-(\hat y(x_i)-\hat y(x_j))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>。优化过程和前面提到类似。</p><h2 id="nfm"><a class="markdownIt-Anchor" href="#nfm"></a> NFM</h2><p>NFM 和 AFM 两篇论文是同一个作者写的，所以文章的结构很相近。</p><p>FM 模型由于复杂度问题，一般只使用特征二阶交叉的形式，缺少对 higher-order 以及 non-liner 特征的交叉能力。NFM 尝试通过引入 NN 来解决这个问题。</p><p>NFM 的结构如下：第一项和第二项是线性回归，第三项是神经网络。神经网络中利用 FM 模型的二阶特征交叉结果做为输入，学习数据之间的高阶特征。与直接使用高阶 FM 模型相比，可以降低模型的训练复杂度，加快训练速度。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>N</mi><mi>F</mi><mi>M</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{y}_{N F M}(\mathbf{x})=w_{0}+\sum_{i=1}^{n} w_{i} x_{i}+f(\mathbf{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span></span></span></span></span></p><p>NFM 的神经网络部分包含 4 层，分别是 Embedding Layer、Bi-Interaction Layer、Hidden Layers、Prediction Score。</p><p><img src="https://media.xiang578.com/15643037118475.jpg" alt="NFM" /></p><ul><li>Embedding Layer 层对输入的稀疏数据进行 Embedding 操作。最常见的 Embedding 操作是在一张权值表中进行 lookup ，论文中作者强调他们这一步会将 Input Feture Vector 中的值与 Embedding 向量相乘。</li><li>Bi-Interaction Layer 层是这篇论文的创新，对 embedding 之后的特征两两之间做 element-wise product，并将结果相加得到一个 k 维（Embeding 大小）向量。这一步相当于对特征的二阶交叉，与 FM 类似，这个公式也能进行化简：</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>B</mi><mi>I</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">V</mi><mi>x</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo>⊙</mo><msub><mi>x</mi><mi>j</mi></msub><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">[</mo><msup><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">f_{B I}\left(\mathcal{V}_{x}\right)=\sum_{i=1}^{n} \sum_{j=i+1}^{n} x_{i} \mathbf{v}_{i} \odot x_{j} \mathbf{v}_{j} =\frac{1}{2}\left[\left(\sum_{i=1}^{n} x_{i} \mathbf{v}_{i}\right)^{2}-\sum_{i=1}^{n}\left(x_{i} \mathbf{v}_{i}\right)^{2}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.954008em;"><span style="top:-4.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li>Hidden Layers 层利用常规的 DNN 学习高阶特征交叉</li><li>Prdiction Layer 层输出最终的结果：</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>N</mi><mi>F</mi><mi>M</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msup><mi mathvariant="bold">h</mi><mi>T</mi></msup><msub><mi>σ</mi><mi>L</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">W</mi><mi>L</mi></msub><mrow><mo fence="true">(</mo><mo>…</mo><msub><mi>σ</mi><mn>1</mn></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">W</mi><mn>1</mn></msub><msub><mi>f</mi><mrow><mi>B</mi><mi>I</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">V</mi><mi>x</mi></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi mathvariant="bold">b</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow><mo>…</mo><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi mathvariant="bold">b</mi><mi>L</mi></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \hat{y}_{N F M}(\mathbf{x}) &amp;=w_{0}+\sum_{i=1}^{n} w_{i} x_{i} +\mathbf{h}^{T} \sigma_{L}\left(\mathbf{W}_{L}\left(\ldots \sigma_{1}\left(\mathbf{W}_{1} f_{B I}\left(\mathcal{V}_{x}\right)+\mathbf{b}_{1}\right) \ldots\right)+\mathbf{b}_{L}\right) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.2290660000000004em;vertical-align:-1.364533em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645330000000004em;"><span style="top:-3.8645330000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.364533em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645330000000004em;"><span style="top:-3.8645330000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.364533em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>实验结果：</p><p><img src="https://media.xiang578.com/15643059963915.jpg" alt="" /></p><h2 id="afm"><a class="markdownIt-Anchor" href="#afm"></a> AFM</h2><p>AFM(Attentional Factorization Machine), 在 FM 的基础上将 Attention 机制引入到交叉项部分，用来区分不同特征组合的权重。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>A</mi><mi>F</mi><mi>M</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msup><mi mathvariant="bold">p</mi><mi>T</mi></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo>⊙</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{A F M}(\mathbf{x})=w_{0}+\sum_{i=1}^{n} w_{i} x_{i}+\mathbf{p}^{T} \sum_{i=1}^{n} \sum_{j=i+1}^{n} a_{i j}\left(\mathbf{v}_{i} \odot \mathbf{v}_{j}\right) x_{i} x_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">p</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>单独看上面公式中的第三项结构：</p><p><img src="https://media.xiang578.com/15643076111641.jpg" alt="" /></p><ul><li>Embedding Layer 与 NFM 里面的作用一样，转化特征。</li><li>Pair-wise Interaction Layer 是将特征两两交叉，如果对这一步的结果求和就是 FM 中的交叉项。</li><li>Attention 机制在 Attention-based Pooling 层引入。将 Pair-wise Interaction Layer 中的结果输入到 Attention Net 中，得到特征组合的 score <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">{a_{i j}^{\prime} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.146664em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span></span>，然后利用 softmax 得到权重矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{a_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span>。</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold">h</mi><mi>T</mi></msup><mi mathvariant="normal">Re</mi><mo>⁡</mo><mi>L</mi><mi>U</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">W</mi><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo>⊙</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><mi mathvariant="bold">b</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">)</mo></mrow></mrow><mrow><munder><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mi mathvariant="script">R</mi><mi>x</mi></msub></mrow></munder><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo fence="true">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} a_{i j}^{\prime} &amp;=\mathbf{h}^{T} \operatorname{Re} L U\left(\mathbf{W}\left(\mathbf{v}_{i} \odot \mathbf{v}_{j}\right) x_{i} x_{j}+\mathbf{b}\right) \\ a_{i j} &amp;=\frac{\exp \left(a_{i j}^{\prime}\right)}{\sum_{(i, j) \in \mathcal{R}_{x}} \exp \left(a_{i j}^{\prime}\right)} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.723921em;vertical-align:-2.1119605em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6119605em;"><span style="top:-5.3554015em;"><span class="pstrut" style="height:3.634772em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0375215em;"><span class="pstrut" style="height:3.634772em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1119605em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6119605em;"><span style="top:-5.3554015em;"><span class="pstrut" style="height:3.634772em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord mathrm">R</span><span class="mord mathrm">e</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathbf">b</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.0375215em;"><span class="pstrut" style="height:3.634772em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.634772em;"><span style="top:-2.2600000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.733692em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4129719999999999em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7847720000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.21471em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1119605em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li>最后将 Pair-wise Interaction Layer 中的二阶交叉结果和权重矩阵对应相乘求和得到 AFM 的交叉项。</li></ul><p><img src="https://media.xiang578.com/15643086043204.jpg" alt="" /></p><p>和前一节的实验结果对比，AFM 效果比 NFM 要差一些。这大概就能说明为什么论文中提到 NFM，但是最后没有把 NFM 的结果贴出来，实在是机智。又回到，发论文是需要方法有创新，还是一味追求 state-of-the-art。</p><h2 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h2><blockquote><ul><li><a href="http://kubicode.me/2018/02/23/Deep%20Learning/Deep-in-out-Factorization-Machines-Series/#NFM">深入浅出Factorization Machines系列 | Kubi Code’Blog</a></li><li><a href="https://zhuanlan.zhihu.com/p/34666996">FM模型在LTR类问题中的应用 - 知乎</a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Factorization Machines(FM) 由日本 Osaka University 的 Steffen Rendle [1] 在 2010 年提出,是一种常用的因子机模型。&lt;/p&gt;
&lt;h2 id=&quot;fm&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="fm" scheme="https://blog.xiang578.com/tags/fm/"/>
    
  </entry>
  
  <entry>
    <title>(Wide&amp;Deep) Wide &amp; Deep Learning for Recommender Systems</title>
    <link href="https://blog.xiang578.com/post/wide-and-deep.html"/>
    <id>https://blog.xiang578.com/post/wide-and-deep.html</id>
    <published>2019-07-02T12:56:43.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h2><p>这是一篇推荐系统相关的论文，场景是谷歌 Play Store 的 App 推荐。文章开头，作者点明推荐系统需要解决的两个能力： memorization 和 generalization。</p><p><strong>memorization</strong> 指的是学习数据中出现过的组合特征能力。最常使用的算法是 Logistic Regression，简单、粗暴、可解释性强，而且会人工对特征进行交叉，从而提升效果。但是，对于在训练数据中没有出现过的特征就无能为力。</p><p><strong>generalization</strong> 指的是通过泛化出现过特征从解释新出现特征的能力。常用的是将高维稀疏的特征转换为低维稠密 embedding 向量，然后使用 fm 或 dnn 等算法。与 LR 相比，减少特征工程的投入，而且对没有出现过的组合有较强的解释能力。但是当遇到的用户有非常小众独特的爱好时（对应输入的数据非常稀疏和高秩），模型会过度推荐。</p><p>综合前文 ，作者提出一种新的模型 Wide &amp; Deep。</p><h2 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h2><p>从文章题目中顾名思义，Wide &amp; Deep 是融合 Wide Models 和 Deep Models 得到，下图形象地展示出来。</p><p><img src="https://media.xiang578.com/15610337156969.jpg" alt="Wide &amp; Deep Models" /></p><p><strong>Wide Component</strong> 是由一个常见的广义线性模型：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">{y=w^Tx+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span>。其中输入的特征向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span></span> 包括两种类型：原始输入特征（raw input features）和组合特征（transformed features）。</p><p>常用的组合特征公式如下：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ϕ</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><msubsup><mi>x</mi><mi>i</mi><msub><mi>c</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub></msubsup><mo separator="true">,</mo><msub><mi>c</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{\phi_k(x)=\prod_{i=1}^dx_i^{c_{ki}},c_{ki}\in\{0,1\}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7520519999999999em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.15066em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{c_{ki}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 代表对于第k个组合特征是否包含第i个特征。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>是布尔变量，代表第i个特征是否出现。例如对于组合特征 <code>AND(gender=female, language=en)</code> 当且仅当 x 满足<code>(“gender=female” and “language=en”)</code>时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{\phi_k(x)=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span></span>。</p><p><strong>Deep Component</strong> 是一个标准的前馈神经网络，每一个层的形式诸如：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{a^{(l+1)}=f(W^{(l)}a^{(l)} + b^{(l)})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。对于输入中的 categorical feature 需要先转化成低维稠密的 embedding 向量，再和其他特征一起喂到神经网络中。</p><p>对于这种由基础模型组合得到的新模型，常用的训练形式有两种：joint training 和 ensemble。ensemble 指的是，不同的模型单独训练，且不共享信息（比如梯度）。只有在预测时根据不同模型的结果，得到最终的结果。相反，joint training 将不同的模型结果放在同一个损失函数中进行优化。因此，ensmble 要且模型独立预测时就有有些的表现，一般而言模型会比较大。由于 joint training 训练方式的限制，每个模型需要由不同的侧重。对于 Wide&amp;Deep 模型来说，wide 部分只需要处理 Deep 在低阶组合特征学习的不足，所以可以使用简单的结果，最终完美使用 joint traing。</p><p>预测时，会将 Wide 和 Deep 的输出加权得到结果。在训练时，使用 logistic loss function 做为损失函数。模型优化时，利用 mini-batch stochastic optimization 将梯度信息传到 Wide 和 Deep 部分。然后，Wide 部分通过 FTRL + L1 优化，Deep 部分通过 AdaGrad 优化。</p><h2 id="实验"><a class="markdownIt-Anchor" href="#实验"></a> 实验</h2><p>本篇论文选择的实验场景是谷歌 app 商店的应用推荐，根据用户相关的历史信息，推荐最有可能会下载的 App。</p><p>使用的模型如下：<br /><img src="https://media.xiang578.com/15611212418726.jpg" alt="Wide &amp; Deep model structure for apps recommendation." /></p><p>一些细节：</p><ul><li>对于出现超过一定次数的 categorical feature，ID 化后放入到模型中。</li><li>Continuous real-valued features 通过 cumulative distribution function 归一化到 [0, 1] 区间。</li><li>categorical feature 由 32 维 embedding 向量组成，最终的输入到 Deep 部分的向量大概在 1200 维。</li><li>每天在前一天 embedding 和模型的基础上进行增量更新。</li></ul><p>实验结果：</p><p><img src="https://media.xiang578.com/15610335523493.jpg" alt="实验结果" /></p><p>Wide &amp; Deep 模型相对于其他两个模型毫无疑问有提升。但结果中也一个反常的现象：单独使用 Deep 模型离线 AUC 指标比单独使用 Wide 模型差，但是线上对比实验时却有较大的提升。论文中作者用了一句：线下实验中的特征是固定的，线上实验会遇到很多没有出现过的特征组合，Deep 相对于 Wide 有更好的模型泛化能力，所以会有反常现象。由于笔者工作中不关注 AUC，也没有办法继续分析。</p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>作者从推荐系统的的  memorization 和 generalization 入手，设计出新的算法框架。通过线上和线下实验实验，证明 Deep 和 Wide 联合是必须的且有效的。最终也在自己的业务场景带来提升。</p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/37733208">Wide &amp; Deep Learning for Recommender Systems - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/53361519">详解 Wide &amp; Deep 结构背后的动机 - 知乎</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;背景&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#背景&quot;&gt;&lt;/a&gt; 背景&lt;/h2&gt;
&lt;p&gt;这是一篇推荐系统相关的论文，场景是谷歌 Play Store 的 App 推荐。文章开头，作者点明推荐系统需要解决的两个能力： memoriza</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="lr" scheme="https://blog.xiang578.com/tags/lr/"/>
    
    <category term="dnn" scheme="https://blog.xiang578.com/tags/dnn/"/>
    
    <category term="ctr" scheme="https://blog.xiang578.com/tags/ctr/"/>
    
  </entry>
  
  <entry>
    <title>Best of iPhone 2019 软件清单</title>
    <link href="https://blog.xiang578.com/post/best-of-iphone-2019.html"/>
    <id>https://blog.xiang578.com/post/best-of-iphone-2019.html</id>
    <published>2019-06-22T13:32:22.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>一直想做一个推荐软件的系列文章，不过完成 2017 年的<a href="https://xiang578.com/post/iphone5s.html">iPhone软件清单</a> 后就没有动力……很多时候在思考，自己为什么一定要使用 iPhone？iOS 中的软件正是最好的答案，让每一个人享受科技带来的快乐。</p><p>这一篇文章和 2017 年的形式一样，删除常用的软件，推荐一些我认为有趣的软件。自从 iOS 12 中引入屏幕时间，今年的推荐顺序就按照屏幕时间中的排序。</p><p>目前使用设备：iPhone XR &amp; Apple Watch Series 4</p><ul><li>Inoreader：RSS 订阅服务商以及 RSS 阅读器。随着这两年对推荐算法相关的新闻阅读器批判，RSS 大有一股复新之势。可惜的是在去年年底左右，inoreader 中每个免费帐号只能关注 150 个订阅源。目前，我通过使用多个帐号来临时解决。</li><li>脉脉：职场社交软件。有匿名区以及公司圈，定期查看公司内部的吐槽和爆料。用 Leader 的话来说，整天操 M6 的心。</li><li>Keep/Nike Running/健身记录：锻炼相关 App 集合。Keep 和 Apple Watch 的配合太差，很多数据不能同步。自带的健身记录展示数据不够详细。Nike Running 不太用。</li><li>Overcast：免费且功能强大的播客软件，良心到只有少量的播客相关广告。喜欢智能播放和人声增强功能。最近，也支持章节播放功能。</li><li>AutoSleep：配合 Apple Watch 实现睡眠监控功能。原来大致为读取 Apple Watch 写入健康中的数据判断是否入睡以及睡眠质量。由于硬件的限制，很多时候还是不太准确。不过我也和网上说的一样，每天起来需要看这软件中的评分，判断昨天睡的如何……</li><li>Kindle：管它微信阅读如何火爆，不忘初心依旧选择 Kindle。配合 Kindle Unlimted，可以阅读很多好书。</li><li>Google 相册：免费强大的照片管理软件，允许谷歌优化照片质量的后，可以无限存储。</li><li>Quantumult：梯子软件，美区下载，比小火箭好用。</li><li>OmniFoucs：GTD 软件，居然使用的正版……</li><li>Anki：多年之后，我的摘抄终于有了存放之地。</li><li>Day One：日记软件，喜欢里面的去年今天功能，陆续把日记导入中。</li><li>Pocket：稍后读。</li><li>1 Password：密码软件，全平台通用。</li><li>熊猫吃短信：垃圾短信过滤，可以自己配置规则把公司的报警短信给屏蔽了。</li><li>Ulysses：Markdown 软件，iOS 版也包含在 SetApp 订阅。</li></ul><p>在与 2017 版相比，有两个趋势：1. 减少很多与学习强相关的软件。 2. 越来越多的付费或者订阅制软件。期待明年。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;一直想做一个推荐软件的系列文章，不过完成 2017 年的&lt;a href=&quot;https://xiang578.com/post/iphone5s.html&quot;&gt;iPhone软件清单&lt;/a&gt; 后就没有动力……很多时候在思考，自己为什么一定要使用 iPhone？iOS 中的软件正是</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="iOS" scheme="https://blog.xiang578.com/tags/iOS/"/>
    
    <category term="app" scheme="https://blog.xiang578.com/tags/app/"/>
    
    <category term="best of" scheme="https://blog.xiang578.com/tags/best-of/"/>
    
  </entry>
  
  <entry>
    <title>Practical Lessons from Predicting Clicks on Ads at Facebook(gbdt + lr)</title>
    <link href="https://blog.xiang578.com/post/gbdt_lr.html"/>
    <id>https://blog.xiang578.com/post/gbdt_lr.html</id>
    <published>2019-06-16T12:56:43.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>**主题：**Facebook 2014 年发表的广告点击预测文章。最主要是提出经典 GBDT+LR 模型，可以自动实现特征工程，效果好比于人肉搜索。另外，文章中还给出一个 online learning 的工程框架。</p><p><strong>问题：</strong></p><ul><li>GBDT 如何处理大量 id 类特征<ul><li>广告类对于 user id 的处理：利用出现的频率以及转化率来代替</li><li>id 特征放在 lr 中处理。</li></ul></li><li>GBDT+LR 和 RF+LR 的区别<ul><li>选出能明显区分正负样本的特征的变换方式，转换成 one hot 有意义</li><li>RF + LR 可以并行训练，但是 RF 中得到的区分度不高</li></ul></li></ul><p><strong>收获：</strong></p><ul><li>数据支撑去做决策，收获和实验数量成正比。</li><li>CTR click through rate，点击率</li><li>评价指标：<ul><li>Normalized Entropy：越小模型越好</li><li>Calibration：预测点击数除以真实点击数</li><li>AUC 正样本出现在负样本前面的概率。</li></ul></li><li>数据新鲜度：模型天级训练比周级训练在 NE 下降 1%。</li><li>GBDT 和 LR 模型采用不同的更新频率，解决训练耗时不同。但是 GBDT 重新训练之后，LR 必须要重新训练。</li></ul><h2 id="网络"><a class="markdownIt-Anchor" href="#网络"></a> 网络：</h2><h3 id="gbdt-lr"><a class="markdownIt-Anchor" href="#gbdt-lr"></a> GBDT + LR</h3><p>利用 GBDT 模型进行自动特征组合和筛选，然后根据样本落在哪棵树哪个叶子生成一个 feature vector 输入到 LR 模型中。这种方法的有点在于两个模型在训练过程从是独立，不需要进行联合训练。</p><p>GBDT 由多棵 CART 树组成，每一个节点按贪心分裂。最终生成的树包含多层，相当于一个特征组合的过程。根据规则，样本一定会落在一个叶子节点上，将这个叶子节点记为1，其他节点设为0，得到一个向量。比如下图中有两棵树，第一棵树有三个叶子节点，第二棵树有两个叶子节点。如果一个样本落在第一棵树的第二个叶子，将它编码成 [0, 1, 0]。在第二棵树落到第一个叶子，编码成 [1, 0]。所以，输入到 LR 模型中的向量就是 [0, 1, 0, 1, 0]</p><p><img src="https://media.xiang578.com/15529885839484.jpg" alt="" /></p><h3 id="online-learning"><a class="markdownIt-Anchor" href="#online-learning"></a> Online Learning</h3><p>文章中提到的 Online Learning 包括三个部分：</p><ul><li>Joiner 将每次广告展示结果（特征）是否用户点击（标签） join 在一起形成一个完成的训练数据；</li><li>Trainer 定时根据一个 small batch 的数据训练一个模型；</li><li>Ranker 利用上一个模块得到模型预测用户点击。</li></ul><p><img src="https://media.xiang578.com/15529904431696.jpg" alt="" /></p><p>注意的点：</p><ul><li>waiting window time：给用户展示广告之后，我们只能知道用户点击的广告，也就是模型中的正样本。负样本需要设置一个等待时间来判断，即超过某一个时间没有观测到用户点击某一个广告，就认为这是一个负样本。另外设置这个时间也是一个技术活，时间过短导致click没有及时join到样本上，时间太长数据实时性差以及有存储的压力。最后，无论如何都会有一些数据缺失，为了避免累积误差，需要定期重新训练整个模型。</li><li>request ID：人家的模型是分布式架构的，需要使用 request ID 来匹配每次展示给用户的结果以及click。为了实现快速匹配，使用 HashQueue 来保存结果。</li><li>监控：避免发生意向不到的结果，导致业务损失。我们的实时模型也在上线前空跑了好久。</li></ul><h2 id="实验"><a class="markdownIt-Anchor" href="#实验"></a> 实验：</h2><h4 id="有无-gbdt-特征对比"><a class="markdownIt-Anchor" href="#有无-gbdt-特征对比"></a> 有无 GBDT 特征对比</h4><p>训练两个 LR 模型，一个模型输入样本经过 GBDT 得到的特征，另外一个不输入。混合模型比单独 LR 或 Tree<br /><img src="https://media.xiang578.com/15529901354294.jpg" alt="" /></p><h4 id="学习率选择"><a class="markdownIt-Anchor" href="#学习率选择"></a> 学习率选择</h4><p>5 种学习率，前三个每一个特征设置一个学习率，最后两种全局学习率。<br /><img src="https://media.xiang578.com/15541928146842.jpg" alt="" /></p><p>结果：应该给每一个特征设置一个不同的学习率，而且学习率应该随着轮次缓慢衰减。<br /><img src="https://media.xiang578.com/15541931302704.jpg" alt="" /></p><h4 id="gbdt-参数相关实验"><a class="markdownIt-Anchor" href="#gbdt-参数相关实验"></a> GBDT 参数相关实验</h4><ul><li>前面的树会带来大量的收益，但是树越多训练越慢。</li><li>特征重要程度，累加不同树上某个特征的得分减少贡献。</li><li>两种特征：<ul><li>上下文，冷启动的时候比较重要，与数据新鲜度有关。</li><li>历史史特征，权重比较大，关键在于长时间积累。</li></ul></li></ul><h4 id="采样"><a class="markdownIt-Anchor" href="#采样"></a> 采样</h4><p>训练数据大多，需要进行采样。</p><ul><li><p>uniform subsampling ：无差别采样。使用 10 % 的样本，NE 减少 1 %<br /><img src="https://media.xiang578.com/15542640937514.jpg" alt="" /></p></li><li><p>negative down subsampling ：对负样本进行下采样。但不是负采样率越低越好，比如下面的图中0.0250就可能是解决了正负样本不平衡问题。最后的CTR指标结果需要重新进行一次映射。<br /><img src="https://media.xiang578.com/15542641884458.jpg" alt="" /></p></li></ul><h3 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h3><ul><li><a href="https://zhuanlan.zhihu.com/p/57987311">回顾Facebook经典CTR预估模型 - 知乎</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;**主题：**Facebook 2014 年发表的广告点击预测文章。最主要是提出经典 GBDT+LR 模型，可以自动实现特征工程，效果好比于人肉搜索。另外，文章中还给出一个 online learning 的工程框架。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;问题：&lt;/strong&gt;</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="gbdt" scheme="https://blog.xiang578.com/tags/gbdt/"/>
    
    <category term="machine learing" scheme="https://blog.xiang578.com/tags/machine-learing/"/>
    
    <category term="lr" scheme="https://blog.xiang578.com/tags/lr/"/>
    
  </entry>
  
  <entry>
    <title>「Rime 鼠须管」小鹤双拼配置指南</title>
    <link href="https://blog.xiang578.com/post/rime.html"/>
    <id>https://blog.xiang578.com/post/rime.html</id>
    <published>2019-06-15T13:21:14.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://media.xiang578.com/15599183665365.jpg" alt="" /></p><h2 id="引言"><a class="markdownIt-Anchor" href="#引言"></a> 引言</h2><p>如何将汉字输入到计算机中是一个编码有关的问题，目前市面上主流的方案包括音码、形码、音形码。和大多数人一样，之前我一直使用全拼，而且得益于 NLP 技术发展，使用搜狗输入法搭配云词库，输入效率可以媲美五笔输入法。</p><p>但是今天要和大家分享，是从年初开始使用的全新音码输入方案——小鹤双拼。最初关于双拼的概念来自李笑来《把时间当作朋友》：</p><blockquote><p>在很长的一段时间里，我常言之凿凿地对同学们说“练习打字完全是浪费时间。”我当时的逻辑是这样的。首先，我认为王码五笔字型输入法是给打字员用的。为什么要学它？难道你将来想要当个打字员？我总觉得五笔字型知识一种抄写输入法，因为用他输入时只能边看边打。而对真正创造内容的人来说，先用纸和笔写出来再录入电脑，还有比这更荒诞的事情吗？学习拆字学法已经很累人了，还要练什么指法，见鬼。更不用说这种所谓的输入法对思考的干扰——不仅要把字拆开再输入，还要按照莫名其妙的方法拆字。其次，盲打。我现在不是盲打，只是两根手指输入速度就已经很快了（至少比手写快）。</p><p>这样看来，我还有必要学习什么五笔字型和盲打吗？</p><p>在我有了这些定见很久之后，发生了一件事情。</p><p>那是在1997年，我25岁。当时互联网除了聊天室和论坛，几乎没有什么实际的应用。适逢windows捆绑了哈尔滨工业大学开发的“微软拼音输入法1.0”，某天下午，当我在网上和一位永远都不会知道是谁的女生放肆地聊了两个小时之后，突然发现自己竟已无师自通地学会了所谓的“盲打”了！在这之后的一段时间里，我身边甚至很多人羡慕我打字的速度。为了让自己的打字速度再快一点，我索性花了差不多20分钟，把原本默认的“全拼输入”改成了“”双拼输入“。而这还远远不够。后来，我增设了”慢放模糊音“（不区分z/zh、c/ch、s⇧），又把打字速度提高了一些。这时我第一次意识到‘有些认识，哪怕是简单的常识，也需要亲身经历后才能真正体会”。只有拥有无与伦比的打字速度，才会体会打字速度快的好处。</p><p>打字速度提升后，我发现自己不再讨厌在读书的时候做笔记了，因为在键盘上敲字相对于笔写字来说轻松太多。我开始大段地纪录感悟，有时甚至干脆整篇摘抄原文！</p></blockquote><p>李笑来思考的问题正是如何利用最小的代价快速的输入文字。这里代价包括两个方面，输入方案的学习成本以及输入文字的速度。简单分析一下，主流输入法需要用户在键盘上敲击一些字符，然后映射到汉字。就是说输入文字的速度和两个因数有关：敲击键盘的次数（对应计算机中的码长）以及重码的字符数量（对于拼音输入法来说，这里指的是每个拼音对应多少的字）。</p><p>从这两个指标来说，五笔应该是接近输入法的极限，五次敲击键盘肯定能选定你需要的汉字。但是学习五笔需要记忆大量的说是有序其实没有太多规律的字根，学习曲线不是一般的陡峭。几年前，自己尝试跟着网上的视频教程学习，最后还是太复杂而放弃。</p><p>这时候要介绍一下双拼输入法，它是一种基于全拼的激进改良版拼音输入法。简单来说，它将一个汉字的拼音分成声母和韵母两个部分，输入一个拼音只需要按两个键（减少键盘的敲击次数但是没有减少重码率）。比如对于“拼音”两个字来说，全拼需要输入 <code>pinyin</code> 六个字符，换成是双拼，只需要输入 4 个字符 <code>pbyb</code>。具体介绍可以看 <a href="https://sspai.com/post/32809">做少数派中的少数派：双拼输入快速入门</a>。</p><p>由于双拼有声母和韵母，需要先从键盘上进行一次映射，所以有很多的输入方案。我自己入门使用的是小鹤双拼，也推荐大家使用这个方案。主要原因有两点：声母和韵母全部放在字母键上（微软双拼中要用到 <code>;</code> 键，以及 iOS12 和 MacOS 中自带的输入法都支持这个方案（国内那几个流氓输入法更不用提）。</p><p>下图是一张小鹤双拼的输入法键位图，其中黑色的字符代表是键盘上的什么键，棕色的代表这个键表示声母时是什么，蓝色的代表这个键表示韵母时是什么。学习双拼的过程也很简单，拼音本身就会，无非是熟悉键位。从我自己的角度来说，每天抽出几分看一下键位图，再在 <a href="https://api.ihint.me/shuang/">双拼练习 @ BlueSky</a> （相关的介绍可以看：<a href="https://sspai.com/post/40185">快速上手双拼，可以尝试这个练习平台 - 少数派</a>）网站上练习 5 分钟，一周后可以完全脱离键位图来打字，之后就是孰能生巧的过程。</p><p><img src="https://media.xiang578.com/15600908556759.jpg" alt="" /></p><p>说回来当你学习了这么强大的内功之后，自然需要神兵来辅助你输入。在饱受国内的流氓输入法侵害之后（比如输入到一半给你跳一个什么斗图功能提示），我遇到今天的主角 <a href="https://rime.im/">RIME | 中州韻輸入法引擎</a>，它是由佛振开发的一种开源输入框架，业内人士称之为「神级输入法」。上一个有类似拉风的称号的软件还是「神级编辑器」—— Vim。Rime 有趣的一点是在不同的平台上有不同的名字，包括 Linux 上的「中州韵」，Win 上的「小狼毫」以及 Mac 上的「鼠须管」。稍微有文化的人可以反应过来，后面两个正是两种不同的毛笔名字。</p><p>简单总结一下为什么要使用鼠须管：一是安全，不会出现什么输入法读取你个人信息更甚者是密码发送到服务器，也不知道他们用来机器学习什么；二是配置全平台同步，解决多台设备的输入法配置问题；三是快，不会出现输入法跟不上我的打字速度而导致思路中断的情况。</p><h2 id="安装"><a class="markdownIt-Anchor" href="#安装"></a> 安装</h2><p>在 <a href="https://rime.im/download/">下載及安裝 | RIME | 中州韻輸入法引擎</a> 主页，你可以找到对应不同平台的安装方法。</p><p>对于 MacOS 来说，最简单的方式莫过于在终端中输入 <code>brew cask install squirrel</code> 安装软件本体。如何你想使用 <a href="https://github.com/rime/plum">rime/plum: 東風破</a>可以在终端中输入 <code>curl -fsSL https://git.io/rime-install | bash -s -- :preset double-pinyin</code> 。其中 <code>preset double-pinyin</code> 指定下载时默认包括小鹤双拼输入方案。</p><h2 id="配置"><a class="markdownIt-Anchor" href="#配置"></a> 配置</h2><p>防止配置时候出现各种意想不到的情况，首先推荐阅读官方文档 <a href="https://github.com/rime/home/wiki/CustomizationGuide">CustomizationGuide · rime/home Wiki</a>。</p><p>Rime 的配置文件默认放在 <code>~/Library/Rime</code>，而且是一种扩展 yaml 文件。默认的文件名为 <code>.schema.yaml</code>，比如小鹤双拼相关的默认配置在 <code>double_pinyin_flpy.schema.yaml</code> 中。如果我们自己想添加一些设置，推荐写在以<code>.custom.yaml</code> 结尾的新文件中，比如 <code>double_pinyin_flypy.custom.yaml</code></p><h3 id="defaultcustomyaml"><a class="markdownIt-Anchor" href="#defaultcustomyaml"></a> default.custom.yaml</h3><p>这个文件写一些全局的配置。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">switcher:</span></span><br><span class="line">    <span class="attr">caption:</span> <span class="string">〔方案选单〕</span></span><br><span class="line">    <span class="attr">hotkeys:</span> <span class="string">Control+grave</span></span><br><span class="line">  <span class="comment"># 候选词数量</span></span><br><span class="line">  <span class="attr">menu:</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">9</span></span><br><span class="line">  <span class="comment"># 使用的输入方案</span></span><br><span class="line">  <span class="attr">schema_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">schema:</span> <span class="string">luna_pinyin_simp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">schema:</span> <span class="string">luna_pinyin</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">schema:</span> <span class="string">double_pinyin_flypy</span></span><br><span class="line">  <span class="comment"># 输入法中英文状态快捷键</span></span><br><span class="line">  <span class="attr">ascii_composer/switch_key:</span></span><br><span class="line">    <span class="attr">Caps_Lock:</span> <span class="string">commit_code</span></span><br><span class="line">    <span class="attr">Control_L:</span> <span class="string">noop</span></span><br><span class="line">    <span class="attr">Control_R:</span> <span class="string">noop</span></span><br><span class="line">    <span class="comment"># 按下左 shift 英文字符直接上屏，不需要再次回车，输入法保持英文状态</span></span><br><span class="line">    <span class="attr">Shift_L:</span> <span class="string">noop</span></span><br><span class="line">    <span class="attr">Shift_R:</span> <span class="string">noop</span></span><br><span class="line">  <span class="comment"># 在一些软件中默认使用英文输入状态</span></span><br><span class="line">  <span class="attr">app_options:</span></span><br><span class="line">    <span class="attr">com.apple.finder:</span> <span class="meta">&amp;a</span></span><br><span class="line">      <span class="attr">ascii_mode:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">no_inline:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">com.googlecode.iterm2:</span> <span class="meta">*a</span></span><br><span class="line">    <span class="attr">com.alfredapp.Alfred:</span> <span class="meta">*a</span></span><br><span class="line">    <span class="attr">com.runningwithcrayons.Alfred-2:</span> <span class="meta">*a</span></span><br><span class="line">    <span class="attr">org.vim.MacVim:</span> <span class="meta">*a</span></span><br><span class="line">    <span class="attr">com.apple.Terminal:</span> <span class="meta">*a</span></span><br></pre></td></tr></table></figure><p>最后在修改配置时，可以查阅 <a href="https://github.com/LEOYoon-Tsaw/Rime_collections/blob/master/Rime_description.md">Rime_collections/Rime_description.md at master · LEOYoon-Tsaw/Rime_collections</a> 寻找相关信息。</p><h3 id="installationyaml"><a class="markdownIt-Anchor" href="#installationyaml"></a> installation.yaml</h3><p>配置文件多平台同步相关文件，<code>sync_dir</code> 指定同步文件夹的位置，配合例如坚果云之类的软件实现备份同步。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">distribution_code_name:</span> <span class="string">Squirrel</span></span><br><span class="line"><span class="attr">distribution_name:</span> <span class="string">&quot;鼠鬚管&quot;</span></span><br><span class="line"><span class="attr">distribution_version:</span> <span class="number">0.11</span><span class="number">.0</span></span><br><span class="line"><span class="attr">install_time:</span> <span class="string">&quot;Sun Dec 23 23:42:01 2018&quot;</span></span><br><span class="line"><span class="attr">installation_id:</span> <span class="string">&quot;mac_didi&quot;</span></span><br><span class="line"><span class="attr">sync_dir:</span> <span class="string">&quot;/Users/didi/Documents/rime_sync&quot;</span></span><br><span class="line"><span class="attr">rime_version:</span> <span class="number">1.4</span><span class="number">.0</span></span><br><span class="line"><span class="attr">update_time:</span> <span class="string">&quot;Mon Jun  3 07:18:30 2019&quot;</span></span><br></pre></td></tr></table></figure><p>从 <a href="https://sspai.com/post/55699">自由输入法RIME简明配置指南 - 少数派</a> 中了解到，rime 个人词典双向同步，用户配置单向同步。另外需要把配置文件上传到 git 中，方便不同设备使用。</p><h3 id="double_pinyin_flypycustomyaml"><a class="markdownIt-Anchor" href="#double_pinyin_flypycustomyaml"></a> double_pinyin_flypy.custom.yaml</h3><p>小鹤双拼相关的自用配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="comment"># 引用 `symbols.custom` 文件里面的符号</span></span><br><span class="line">  <span class="comment"># &#x27;punctuator/import_preset&#x27;: symbols.custom</span></span><br><span class="line">  <span class="attr">&#x27;recognizer/patterns/punct&#x27;:</span> <span class="string">&quot;^/([a-z]+|[0-9])$&quot;</span></span><br><span class="line">  <span class="comment"># 載入朙月拼音擴充詞庫</span></span><br><span class="line">  <span class="attr">&quot;translator/dictionary&quot;:</span> <span class="string">ryen</span></span><br><span class="line">  <span class="comment"># 更改‘西文’为‘英文’，‘增广’为‘扩展集’</span></span><br><span class="line">  <span class="attr">punctuator:</span></span><br><span class="line">    <span class="attr">import_preset:</span> <span class="string">symbols.custom</span></span><br><span class="line">    <span class="attr">half_shape:</span></span><br><span class="line">      <span class="string">&quot;#&quot;</span><span class="string">:</span> <span class="string">&quot;#&quot;</span></span><br><span class="line">      <span class="string">&quot;`&quot;</span><span class="string">:</span> <span class="string">&quot;`&quot;</span></span><br><span class="line">      <span class="string">&quot;~&quot;</span><span class="string">:</span> <span class="string">&quot;~&quot;</span></span><br><span class="line">      <span class="string">&quot;@&quot;</span><span class="string">:</span> <span class="string">&quot;@&quot;</span></span><br><span class="line">      <span class="string">&quot;=&quot;</span><span class="string">:</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">      <span class="string">&quot;/&quot;</span><span class="string">:</span> [<span class="string">&quot;/&quot;</span>, <span class="string">&quot;÷&quot;</span>]</span><br><span class="line">      <span class="string">&#x27;\&#x27;: [&quot;、&quot;, &#x27;</span><span class="string">\&#x27;]</span></span><br><span class="line">      <span class="string">&quot;&#x27;&quot;</span><span class="string">:</span> &#123;<span class="attr">pair:</span> [<span class="string">&quot;「&quot;</span>, <span class="string">&quot;」&quot;</span>]&#125;</span><br><span class="line">      <span class="string">&quot;[&quot;</span><span class="string">:</span> [<span class="string">&quot;【&quot;</span>, <span class="string">&quot;[&quot;</span>]</span><br><span class="line">      <span class="string">&quot;]&quot;</span><span class="string">:</span> [<span class="string">&quot;】&quot;</span>, <span class="string">&quot;]&quot;</span>]</span><br><span class="line">      <span class="string">&quot;$&quot;</span><span class="string">:</span> [<span class="string">&quot;¥&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;€&quot;</span>, <span class="string">&quot;£&quot;</span>, <span class="string">&quot;¢&quot;</span>, <span class="string">&quot;¤&quot;</span>]</span><br><span class="line">      <span class="string">&quot;&lt;&quot;</span><span class="string">:</span> [<span class="string">&quot;《&quot;</span>, <span class="string">&quot;〈&quot;</span>, <span class="string">&quot;«&quot;</span>, <span class="string">&quot;&lt;&quot;</span>]</span><br><span class="line">      <span class="string">&quot;&gt;&quot;</span><span class="string">:</span> [<span class="string">&quot;》&quot;</span>, <span class="string">&quot;〉&quot;</span>, <span class="string">&quot;»&quot;</span>, <span class="string">&quot;&gt;&quot;</span>]</span><br><span class="line">  <span class="attr">switches:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ascii_mode</span></span><br><span class="line">      <span class="attr">reset:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">states:</span> [<span class="string">&quot;中文&quot;</span>, <span class="string">&quot;英文&quot;</span>]</span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">full_shape</span></span><br><span class="line">      <span class="attr">states:</span> [<span class="string">&quot;半角&quot;</span>, <span class="string">&quot;全角&quot;</span>]</span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">zh_simp</span></span><br><span class="line">      <span class="attr">reset:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">states:</span> [<span class="string">&quot;漢字&quot;</span>,<span class="string">&quot;汉字&quot;</span>]</span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ascii_punct</span></span><br><span class="line">      <span class="attr">states:</span> [<span class="string">&quot;，。&quot;</span>, <span class="string">&quot;，．&quot;</span>]</span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">extended_charset</span> <span class="comment">#生僻字开关</span></span><br><span class="line">      <span class="attr">states:</span> [<span class="string">&quot;通用&quot;</span>, <span class="string">&quot;扩展集&quot;</span>]</span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">show_emoji</span> <span class="comment"># 该项为表情输入，具体内容可见下文中 [关于表情输入] 部分</span></span><br><span class="line">      <span class="attr">reset:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">states:</span> [ <span class="string">&quot;🈚️️\uFE0E&quot;</span>, <span class="string">&quot;🈶️️\uFE0F&quot;</span> ]</span><br><span class="line">  <span class="comment"># 输入双拼码的时候不转化为全拼码</span></span><br><span class="line">  <span class="attr">translator/preedit_format:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">simplifier:</span></span><br><span class="line">    <span class="attr">option_name:</span> <span class="string">zh_simp</span></span><br><span class="line">  <span class="comment"># 分号上屏二候选词；引号上屏三候选词</span></span><br><span class="line">  <span class="attr">&quot;key_binder/bindings&quot;:</span></span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">when:</span> <span class="string">has_menu</span>, <span class="attr">accept:</span> <span class="string">semicolon</span>, <span class="attr">send:</span> <span class="number">2</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">when:</span> <span class="string">has_menu</span>, <span class="attr">accept:</span> <span class="string">apostrophe</span>, <span class="attr">send:</span> <span class="number">3</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">when:</span> <span class="string">paging</span>, <span class="attr">accept:</span> <span class="string">bracketleft</span>, <span class="attr">send:</span> <span class="string">Page_Up</span> &#125;</span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">when:</span> <span class="string">has_menu</span>, <span class="attr">accept:</span> <span class="string">bracketright</span>, <span class="attr">send:</span> <span class="string">Page_Down</span> &#125;</span><br></pre></td></tr></table></figure><h3 id="squirrelcustomyaml"><a class="markdownIt-Anchor" href="#squirrelcustomyaml"></a> squirrel.custom.yaml</h3><p>自定义皮肤相关文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">color_scheme:</span> <span class="string">psionics</span></span><br><span class="line">    <span class="attr">horizontal:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">inline_preedit:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">candidate_format:</span> <span class="string">&quot;%c\u2005%@ \u2005&quot;</span>   <span class="comment"># 用 1/6 em 空格 U+2005 来控制编号 %c 和候选词 %@ 前后的空间。</span></span><br><span class="line">    <span class="attr">font_point:</span> <span class="number">16</span>                          <span class="comment"># 候选文字大小</span></span><br><span class="line">    <span class="attr">label_font_point:</span> <span class="number">14</span>                    <span class="comment"># 候选编号大小</span></span><br><span class="line">    <span class="attr">corner_radius:</span> <span class="number">5</span>                        <span class="comment"># 候选条圆角</span></span><br><span class="line">    <span class="attr">border_height:</span> <span class="number">0</span>                        <span class="comment"># 窗口边界高度，大于圆角半径才生效</span></span><br><span class="line">    <span class="attr">border_width:</span> <span class="number">0</span>                         <span class="comment"># 窗口边界宽度，大于圆角半径才生效</span></span><br></pre></td></tr></table></figure><p>最后，我的配置在 <a href="https://github.com/xiang578/rime">xiang578/rime</a> 同步。</p><h2 id="调试"><a class="markdownIt-Anchor" href="#调试"></a> 调试</h2><p>Debug 是折腾 rime 不得不面对的一步，主要方式是查看 rime 部署的时产生的 log 文件。对于鼠鬚管而言， log 文件保存在 <code>$TMPDIR/rime.squirrel.*</code> 中。</p><ul><li>在命令行中输入 <code>echo $TMPDIR</code> 获得路径</li><li>将地址输入到 「访达-前往-前往文件夹…」中跳转</li><li>右键点击 <code>rime.squirrel.WARNING</code> 文件，选择显示原身，并使用文本编辑器打开</li></ul><p>文件格式类似于下面：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Log file created at:</span> <span class="number">2019</span><span class="string">/06/07</span> <span class="number">23</span><span class="string">:31:54</span></span><br><span class="line"><span class="attr">Running on machine:</span> <span class="string">didideMiBook-Pro.local</span></span><br><span class="line"><span class="attr">Log line format:</span> [<span class="string">IWEF</span>]<span class="string">mmdd</span> <span class="string">hh:mm:ss.uuuuuu</span> <span class="string">threadid</span> <span class="string">file:line]</span> <span class="string">msg</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:31:54.549346</span> <span class="number">162086912</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:31:54.554167</span> <span class="number">162086912</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:31:54.560144</span> <span class="number">162086912</span> <span class="string">deployment_tasks.cc:179]</span> <span class="string">schema</span> <span class="string">list</span> <span class="string">not</span> <span class="string">defined.</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.133517</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.135843</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.149406</span> <span class="number">161013760</span> <span class="string">config_data.cc:62]</span> <span class="string">nonexistent</span> <span class="string">config</span> <span class="string">file</span> <span class="string">&#x27;/Users/didi/Library/Rime/luna_pinyin_simp.custom.yaml&#x27;</span><span class="string">.</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.154920</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.156643</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.331344</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.333066</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.668072</span> <span class="number">161013760</span> <span class="string">config_data.cc:62]</span> <span class="string">nonexistent</span> <span class="string">config</span> <span class="string">file</span> <span class="string">&#x27;/Users/didi/Library/Rime/stroke.custom.yaml&#x27;</span><span class="string">.</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.670761</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:13.672724</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:14.281919</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">punctuation.custom:/patch</span></span><br><span class="line"><span class="string">W0607</span> <span class="number">23</span><span class="string">:36:14.283246</span> <span class="number">161013760</span> <span class="string">config_compiler.cc:391]</span> <span class="attr">inaccessible node:</span> <span class="string">key_bindings.custom:/patch</span></span><br></pre></td></tr></table></figure><h2 id="按右-shift-切换输入法"><a class="markdownIt-Anchor" href="#按右-shift-切换输入法"></a> 按右 shift 切换输入法</h2><p>之前使用搜狗输入法时，特别喜欢的一个功能：按右 shift 切换输入法的输入状态，实现暂时切换到英文状态。Rime 作者在 <a href="https://gist.github.com/lotem/2981316">使用 Control 鍵切換中西文，上屏已輸入的編碼；令 Caps Lock 改變字母的大小寫</a> 中提到一种方案。例如下面：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">ascii_composer/good_old_caps_lock:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">ascii_composer/switch_key:</span></span><br><span class="line">    <span class="attr">Caps_Lock:</span> <span class="string">commit_code</span></span><br><span class="line">    <span class="attr">Shift_L:</span> <span class="string">noop</span></span><br><span class="line">    <span class="attr">Shift_R:</span> <span class="string">commit_code</span></span><br><span class="line">    <span class="attr">Control_L:</span> <span class="string">commit_code</span></span><br><span class="line">    <span class="attr">Control_R:</span> <span class="string">commit_code</span></span><br></pre></td></tr></table></figure><p>然而这样修改完成之后，不论按哪个 Shift 键，都会切换到英文输入状态。看前面那个网页下面作者与其他人的讨论中发现，鼠须管无法区分 Shift 键。</p><p>网上查了一下，简单实现的方法是通过 karabiner 软件来改键。详细步骤可以参考 <a href="https://github.com/rime/squirrel/wiki/%E7%A6%81%E7%94%A8-Squirrel-%E8%8B%B1%E6%96%87%E6%A8%A1%E5%BC%8F%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%B7%A6%E4%BE%A7-Shift-%E5%88%87%E6%8D%A2%E4%B8%AD%E8%8B%B1">禁用 Squirrel 英文模式，使用左侧 Shift 切换中英 · rime/squirrel Wiki</a>。</p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://github.com/xiang578/xiang578.github.io/issues/37">双拼 · Issue #37 · xiang578/xiang578.github.io</a></li><li><a href="http://zhizhi.betahouse.us/2018/10/17/rime-setup/">基于Rime的鼠须管输入法配置记录</a></li><li><a href="https://withdewhua.space/2019/01/30/rime-configuration">Rime 输入法配置记录</a></li><li><a href="https://mritd.me/2019/03/23/oh-my-rime/">Mac 下调校 Rime - 漠然的博客 | mritd Blog</a></li><li><a href="https://jdhao.github.io/2019/02/18/rime_configuration_intro/">最新版 Rime 输入法使用 - jdhao’s blog</a></li><li><a href="https://scomper.me/gtd/-shu-xu-guan-de-diao-jiao-bi-ji">「鼠须管」的调教笔记</a></li><li><a href="https://scomper.me/gtd/-shu-xu-guan-de-an-zhuang-he-bu-shu">「鼠须管」输入方案的添加</a></li><li><a href="https://whyhow.tk/2016/04/29/rime0429.html">RIME输入法在Finder中自动切换成英文 @ Why &amp; How</a></li><li><a href="https://placeless.net/blog/rime-squirrel-customization-2019#article">鼠须管配置 2019</a></li><li><a href="https://github.com/rime/squirrel/wiki/%E7%A6%81%E7%94%A8-Squirrel-%E8%8B%B1%E6%96%87%E6%A8%A1%E5%BC%8F%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%B7%A6%E4%BE%A7-Shift-%E5%88%87%E6%8D%A2%E4%B8%AD%E8%8B%B1">禁用 Squirrel 英文模式，使用左侧 Shift 切换中英 · rime/squirrel Wiki</a></li><li><a href="https://github.com/rime-aca/dictionaries">rime-aca/dictionaries: Rime詞庫</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://media.xiang578.com/15599183665365.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;引言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#引言&quot;&gt;&lt;/a&gt; 引言&lt;/h2&gt;
&lt;</summary>
      
    
    
    
    
    <category term="rime" scheme="https://blog.xiang578.com/tags/rime/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记</title>
    <link href="https://blog.xiang578.com/post/blog-log.html"/>
    <id>https://blog.xiang578.com/post/blog-log.html</id>
    <published>2019-06-15T05:39:49.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>记录博客修修补补的故事</p><p>210123: 博客进入 beta 0.3 时代 <s>我也想学习微信不写更新日志</s></p></blockquote><h2 id="beta-03"><a class="markdownIt-Anchor" href="#beta-03"></a> beta 0.3</h2><ul><li>换到 Github Action 构建</li><li>换到<a href="https://blog.k8s.li/">木子</a>修改的 <a href="https://github.com/muzi502/blog">hexo-themes-next</a> 主题</li></ul><h2 id="beta-02"><a class="markdownIt-Anchor" href="#beta-02"></a> beta 0.2</h2><p>长达 9 个月闲置之后，终于迎来一轮对博客的更新。</p><ul><li>本着闭环的原则，将评论系统从 Disqus 替换为基于 Github Issues 的 Gitalk。不过，依旧没有多少留言量。</li><li><s>博客主题从 Next 切换到</s> <a href="https://github.com/fi3ework/hexo-theme-archer">fi3ework/hexo-theme-archer: 🏹 A smart and modern theme for Hexo.</a></li><li>添加一个新的固定栏目 「每月分享」，目前正在持续探索具体形式中。</li><li>除继续使用百度统计之外，加上 Google Analytics 进行数据分析。</li></ul><h2 id="beta-01"><a class="markdownIt-Anchor" href="#beta-01"></a> beta 0.1</h2><ul><li>开始使用版本号来记录博客更新。从 beta 0.1 开始，预计完成博客发布会的计划后（参见：<a href="https://github.com/xiang578/xiang578.github.io/issues/23">博客发布会 · Issue #23</a>，切换到正式版本。</li><li>本次更新带来最大的变化是在博客中加入豆瓣个人<a href="/books">阅读</a>和<a href="/movies">观影</a>记录。感谢 <a href="https://github.com/mythsman/hexo-douban">hexo-douban: A simple plugin for hexo that helps us generate pages for douban books ,movies and games.</a> 提供技术支持。</li></ul><h2 id="beta-0"><a class="markdownIt-Anchor" href="#beta-0"></a> beta 0</h2><p>早期对博客进行的相关修改有：</p><ul><li><a href="/post/how-to-build-a-hexo-blog.html">从零开始利用 hexo + Github/Coding 搭建个人博客</a></li><li><a href="/post/add-return-button-to-blog.html">为博客添加返回顶部按钮</a>：WordPress</li><li><a href="/post/use-travis-ci-to-auto-build-blog.html">博客折腾记：使用 Travis CI 自动部署博客</a></li><li><a href="/post/fix-qiniu-test-url-error.html">博客折腾记：修复七牛云测试域名失效问题</a></li><li><a href="/post/use-cos-to-store-blog.html">博客折腾记：主题更新、迁移博客到腾讯云COS以及解决百度收录</a></li><li><a href="/post/meet-leancloud-counter-security-problem.html">博客折腾记：hexo-leancloud-counter-security 与标题中的引号冲突</a></li></ul><h2 id="博客专栏"><a class="markdownIt-Anchor" href="#博客专栏"></a> 博客专栏</h2><ul><li>【每周分享】：每周六更新，记录过去一周，我看到值得分享的内容</li><li>【月读】：每月更新，推荐本月我阅读的一本书</li><li>【数字生活】：我的数字生活实践</li><li>【博客公告】：分享与这个博客维护相关的内容</li></ul><h2 id="博客记录"><a class="markdownIt-Anchor" href="#博客记录"></a> 博客记录</h2><ul><li>本博客采用<a href="https://hexo.io/">hexo</a>搭建，使用<a href="https://github.com/ahonn/hexo-theme-even">Even</a>主题</li><li>托管：Coding Pages</li><li>域名：腾讯云</li><li>评论：Disqus</li><li>统计：百度统计</li><li>图床：七牛</li><li>20151006：恢复订阅功能</li><li>20160303：开启分类和请我喝一杯咖啡</li><li>20160623：重新开启评论和百度统计，与自己和解</li><li>20160624：更换主题大道至简Maupassant，增加favicon和apple-touch-icon</li><li>20170104：放弃github+hexo,投入vps+wordpress怀抱,依旧使用maupassant主题</li><li>20170722：主机系统升级失败,从备份中恢复博客,并采用 Twenty Twelve 主题</li><li>20171005：重新投入hexo怀抱，并托管于Coding Pages</li><li>20180101：开启功德箱</li><li>20180501：PV: 657 | UV: 242</li><li>20180528：使用 Travis CI 自动部署</li></ul><h2 id="除虫记录"><a class="markdownIt-Anchor" href="#除虫记录"></a> 除虫记录</h2><h3 id="error-cannot-find-module-node-sass-magic-importer"><a class="markdownIt-Anchor" href="#error-cannot-find-module-node-sass-magic-importer"></a> Error: Cannot find module ‘node-sass-magic-importer’</h3><p><a href="https://blog.csdn.net/Nalaluky/article/details/82598300">ERROR in Cannot find module ‘node-sass’（已解决） - line - CSDN博客</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install node-sass@latest</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;记录博客修修补补的故事&lt;/p&gt;
&lt;p&gt;210123: 博客进入 beta 0.3 时代 &lt;s&gt;我也想学习微信不写更新日志&lt;/s&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;beta-03&quot;&gt;&lt;a class=&quot;markdownIt-Anc</summary>
      
    
    
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="hexo" scheme="https://blog.xiang578.com/tags/hexo/"/>
    
    <category term="vps" scheme="https://blog.xiang578.com/tags/vps/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记：hexo-leancloud-counter-security 与标题中的引号冲突</title>
    <link href="https://blog.xiang578.com/post/meet-leancloud-counter-security-problem.html"/>
    <id>https://blog.xiang578.com/post/meet-leancloud-counter-security-problem.html</id>
    <published>2019-05-25T13:21:14.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>昨天按照 <a href="https://github.com/theme-next/hexo-theme-next/blob/master/docs/LEANCLOUD-COUNTER-SECURITY.md">hexo-theme-next/LEANCLOUD-COUNTER-SECURITY.md at master · theme-next/hexo-theme-next</a> 这个文档配置博客阅读次数时，遇到 <code>hexo-leancloud-counter-security</code> 插件的一个冲突。</p><p>完成配置使用 <code>hexo -d</code> 时，终端中出现下面的错误提示：</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> ATAL Something&#x27;s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html</span><br><span class="line">SyntaxError: Unexpected token h in JSON at position 30</span><br><span class="line">    at JSON.parse (&lt;anonymous&gt;)</span><br><span class="line">    at /Users/didi/Documents/personal/xiang578.github.io/node_modules/hexo-leancloud-counter-security/index.js:92:42</span><br><span class="line">    at arrayEach (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_lodash@4.17.11@lodash/lodash.js:516:11)</span><br><span class="line">    at Function.forEach (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_lodash@4.17.11@lodash/lodash.js:9344:14)</span><br><span class="line">    at Hexo._callee$ (/Users/didi/Documents/personal/xiang578.github.io/node_modules/hexo-leancloud-counter-security/index.js:83:27)</span><br><span class="line">    at tryCatch (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:62:40)</span><br><span class="line">    at Generator.invoke [as _invoke] (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:296:22)</span><br><span class="line">    at Generator.prototype.(anonymous function) [as next] (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:114:21)</span><br><span class="line">    at step (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_babel-runtime@6.26.0@babel-runtime/helpers/asyncToGenerator.js:17:30)</span><br><span class="line">    at /Users/didi/Documents/personal/xiang578.github.io/node_modules/_babel-runtime@6.26.0@babel-runtime/helpers/asyncToGenerator.js:28:13</span><br><span class="line">    at process._tickCallback (internal/process/next_tick.js:68:7)</span><br></pre></td></tr></table></figure><p>看提示貌似是利用 Json 解析字符串的时候出现问题。打开  <code>node_modules/hexo-leancloud-counter-security/index.js:92</code>，对应出现一个解析 JSON的：</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(memoData[memoIdx].<span class="title function_">substring</span>(<span class="number">0</span>, memoData[memoIdx].<span class="property">length</span> - <span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>js 没有怎么接触过，不知道能不能单步调试之类的，只好祭出输出调试大法，加上两个输出：</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(memoIdx)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(memoData[memoIdx])</span><br><span class="line">y = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(memoData[memoIdx].<span class="title function_">substring</span>(<span class="number">0</span>,memoData[memoIdx].<span class="property">length</span> - <span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>然后再执行 <code>hexo -d</code> 命令，命令行输出为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">28</span><br><span class="line">&#123;&quot;title&quot;:&quot;System.out.println(&quot;hello world!&quot;);&quot;,&quot;url&quot;:&quot;/post/hello-world.html&quot;&#125;,</span><br><span class="line">FATAL Something&#x27;s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html</span><br><span class="line">SyntaxError: Unexpected token h in JSON at position 30</span><br><span class="line">    at JSON.parse (&lt;anonymous&gt;)</span><br><span class="line">    at /Users/didi/Documents/personal/xiang578.github.io/node_modules/hexo-leancloud-counter-security/index.js:92:42</span><br><span class="line">    at arrayEach (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_lodash@4.17.11@lodash/lodash.js:516:11)</span><br><span class="line">    at Function.forEach (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_lodash@4.17.11@lodash/lodash.js:9344:14)</span><br><span class="line">    at Hexo._callee$ (/Users/didi/Documents/personal/xiang578.github.io/node_modules/hexo-leancloud-counter-security/index.js:83:27)</span><br><span class="line">    at tryCatch (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:62:40)</span><br><span class="line">    at Generator.invoke [as _invoke] (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:296:22)</span><br><span class="line">    at Generator.prototype.(anonymous function) [as next] (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_regenerator-runtime@0.11.1@regenerator-runtime/runtime.js:114:21)</span><br><span class="line">    at step (/Users/didi/Documents/personal/xiang578.github.io/node_modules/_babel-runtime@6.26.0@babel-runtime/helpers/asyncToGenerator.js:17:30)</span><br><span class="line">    at /Users/didi/Documents/personal/xiang578.github.io/node_modules/_babel-runtime@6.26.0@babel-runtime/helpers/asyncToGenerator.js:28:13</span><br><span class="line">    at process._tickCallback (internal/process/next_tick.js:68:7)</span><br></pre></td></tr></table></figure><p>JSON 在解析字符串<code>&#123;&quot;title&quot;:&quot;System.out.println(&quot;hello world!&quot;);&quot;,&quot;url&quot;:&quot;/post/hello-world.html&quot;&#125;</code> 时出现错误。对应的正是之前写的一篇名为 <code>System.out.println(&quot;hello world!&quot;);</code> 的文章，由于 JSON 格式中字符串是需要用<code>&quot;&quot;</code> 修饰，导致JSON 中出现了一个  <code>&quot;title&quot;:&quot;System.out.println(&quot;hello world!&quot;);&quot;</code> key-value 组合。然而实际上 JSON 只会将 <code>&quot;System.out.println(&quot;h</code> 解析成 value，之后出现的 <code>h</code> 被当成非法字符报错。</p><p>定位问题之后，暂时修改文章的标题为  <a href="https://xiang578.com/post/hello-world.html">hello world! | 算法花园</a>，绕过部署失败。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;昨天按照 &lt;a href=&quot;https://github.com/theme-next/hexo-theme-next/blob/master/docs/LEANCLOUD-COUNTER-SECURITY.md&quot;&gt;hexo-theme-next/LEANCLOUD-COU</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="hexo" scheme="https://blog.xiang578.com/tags/hexo/"/>
    
    <category term="hack" scheme="https://blog.xiang578.com/tags/hack/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记：主题更新、迁移博客到腾讯云COS以及解决百度收录</title>
    <link href="https://blog.xiang578.com/post/use-cos-to-store-blog.html"/>
    <id>https://blog.xiang578.com/post/use-cos-to-store-blog.html</id>
    <published>2019-05-19T07:44:09.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>本周有空对博客进行新一轮折腾，现在将这些尝试记下来和大家分享。</p><h3 id="1-主题更新"><a class="markdownIt-Anchor" href="#1-主题更新"></a> 1. 主题更新</h3><p>我在 <a href="http://xiang578.com/2018/05/28/use-travis-ci-to-auto-update/">博客折腾记：使用 Travis CI 自动部署</a> 中提到将主题以 modules 的形式加入主仓库。而且现在使用的主题 git 仓库是我自己 fork 的，也有一些修改。几个天之前，hexo-theme-even 的 master 接受 <a href="https://github.com/ahonn/hexo-theme-even/pull/236">feat: add LaTeX support by JieJiSS · Pull Request #236 </a> ，完成对  LaTeX 公式的支持。所以，我需要将使用的代码和最新的代码合并。</p><p>这里使用的是 github Pull request 功能。在你自己 fork 的仓库的网页上点击 <code>new pull request</code>，然后按照下图修改。就会生成一个新的  Pull request 。<br /><img src="https://media.xiang578.com/15582362469640.jpg" alt="-w1009" /></p><p>而且，如果你没有修改过原来的代码，PR 能自动合并。不过由于我对代码做了一些修改，会产生一些冲突，需要手动解决冲突（这里推荐使用 VS code）。出现下图的情况即成功合并两个库。<br /><img src="https://media.xiang578.com/15582366459115.jpg" alt="-w1046" /></p><p>完成 PR 后，进入你站点下面的对应主题目录，使用 <code>git checkout master</code> 切换到主题的 master 分支，使用 <code>git pull origin master</code> 拉取最新的代码。回退到站点目录下，利用 <code>git add</code> 更新。</p><h3 id="2-迁移博客到腾讯云cos"><a class="markdownIt-Anchor" href="#2-迁移博客到腾讯云cos"></a> 2. 迁移博客到腾讯云COS</h3><p>利用腾讯云存储博客的静态文件，并配合使用 CDN 可以加快国内的访问速度。参考 <a href="https://segmentfault.com/a/1190000018752657?utm_source=tag-newest">Hexo博客迁移之旅（Coding到腾讯云COS）+ Travis CI持续集成 - 个人文章 - SegmentFault 思否</a> 以及 <a href="https://cloud.tencent.com/developer/article/1185253">如何在腾讯云COS部署HEXO博客 - 云+社区 - 腾讯云</a> 。</p><p>记录两个我遇到的坑。</p><h4 id="新的域名解析"><a class="markdownIt-Anchor" href="#新的域名解析"></a> 新的域名解析</h4><p>完成 COS 配置后，需要将博客域名解析到腾讯提供CDN节点上的地址。</p><h4 id="添加持续集成自动发布到costravis-ci"><a class="markdownIt-Anchor" href="#添加持续集成自动发布到costravis-ci"></a> 添加持续集成自动发布到COS（Travis CI）</h4><p>为了发布到 COS，站点的 <code>_config.yml</code> 会添加下面的代码。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attr">deploy:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">cos</span></span><br><span class="line">  <span class="attr">secretId:</span> <span class="string">XXX_ID</span></span><br><span class="line">  <span class="attr">secretKey:</span> <span class="string">XXX_KEY</span></span><br><span class="line">  <span class="attr">appId:</span> <span class="number">1252086360</span></span><br><span class="line">  <span class="attr">bucket:</span> <span class="string">blog-1252086360</span></span><br><span class="line">  <span class="attr">region:</span> <span class="string">ap-shanghai</span></span><br></pre></td></tr></table></figure><p>其中出现的 secretId 以及 secretKey 是私钥，不要在公开仓库展示。通过Travis-ci 中添加 Environment Variables 解决。</p><p>很多教程里，他们的 <code>_config.yml</code> 不会出现 secretId 和 secretKey 这两行，取而代之的是让你在 <code>.travis.yml</code> 添加几行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">script </span><br><span class="line">- hexo d</span><br><span class="line">env:</span><br><span class="line"> global:</span><br><span class="line">   - secretId: $&#123;secretId&#125; # Environment Variables 中配置</span><br><span class="line">   - secretKey: $&#123;secretKey&#125; # Environment Variables 中配置</span><br></pre></td></tr></table></figure><p>按照这样设置，build 时，出现错误提示如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123; error:</span><br><span class="line">   &#123; Code: &#x27;InvalidAccessKeyId&#x27;,</span><br><span class="line">     Message: &#x27;The access key Id format you provided is invalid.&#x27;,</span><br><span class="line">     Resource:</span><br><span class="line">      &#x27;blog-1252086360.cos.ap-shanghai.myqcloud.com/2012/01/23/2011/index.html&#x27;,</span><br><span class="line">     RequestId: &#x27;NWNlMDU3NzlfNWI5ZDA4MDlfNWVlMF81ZWUzNTg=&#x27;,</span><br><span class="line">     TraceId:</span><br><span class="line">      &#x27;OGVmYzZiMmQzYjA2OWNhODk0NTRkMTBiOWVmMDAxODc0OWRkZjk0ZDM1NmI1M2E2MTRlY2MzZDhmNmI5MWI1OTQyYWVlY2QwZTk2MDVmZDQ3MmI2Y2I4ZmI5ZmM4ODFjMDU3YThkNThjZmQ1NWVkMGY2ZDBiNGM1YTEyNGIzMGM=&#x27; &#125;,</span><br><span class="line">  statusCode: 403,</span><br><span class="line">  headers:</span><br><span class="line">   &#123; &#x27;content-type&#x27;: &#x27;application/xml&#x27;,</span><br><span class="line">     &#x27;content-length&#x27;: &#x27;513&#x27;,</span><br><span class="line">     connection: &#x27;keep-alive&#x27;,</span><br><span class="line">     date: &#x27;Sat, 18 May 2019 19:05:29 GMT&#x27;,</span><br><span class="line">     server: &#x27;tencent-cos&#x27;,</span><br><span class="line">     &#x27;x-cos-request-id&#x27;: &#x27;NWNlMDU3NzlfNWI5ZDA4MDlfNWVlMF81ZWUzNTg=&#x27;,</span><br><span class="line">     &#x27;x-cos-trace-id&#x27;:</span><br><span class="line">      &#x27;OGVmYzZiMmQzYjA2OWNhODk0NTRkMTBiOWVmMDAxODc0OWRkZjk0ZDM1NmI1M2E2MTRlY2MzZDhmNmI5MWI1OTQyYWVlY2QwZTk2MDVmZDQ3MmI2Y2I4ZmI5ZmM4ODFjMDU3YThkNThjZmQ1NWVkMGY2ZDBiNGM1YTEyNGIzMGM=&#x27; &#125; &#125;</span><br><span class="line">FATAL Something&#x27;s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html</span><br><span class="line">TypeError: Cannot read property &#x27;statusCode&#x27; of undefined</span><br><span class="line">    at uploadFileToCOS.catch.then.data (/home/travis/build/xiang578/xiang578.github.io/node_modules/hexo-deployer-cos/lib/deployer.js:42:16)</span><br><span class="line">    at process._tickCallback (internal/process/next_tick.js:68:7)</span><br></pre></td></tr></table></figure><p>出现这个问题是 <code>hexo -d</code> 时，_config.yml 无法获得环境变量 secretId 和 secretKey 的。会导致没有秘钥。</p><p>参考 <a href="https://zhuanlan.zhihu.com/p/37014376">使用 Travis CI 部署你的 Hexo 博客 - 知乎</a> ，在 .trvis.yml 文件的 <code>hexo d</code> 命令前，加入下面两行即可解决。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- sed -i &quot;s~XXX_ID~$&#123;secretId&#125;~&quot; _config.yml</span><br><span class="line">- sed -i &quot;s~XXX_KEY~$&#123;secretKey&#125;~&quot; _config.yml</span><br></pre></td></tr></table></figure><p>之后build 时，会自动利用环境变量中 secretId 和 secretKey 的值替换 <code>_config.yml </code> 文件缺省的值。</p><p>最后提供我的两份配置文件给大家参考：<a href="https://github.com/xiang578/xiang578.github.io/blob/hexo/_config.yml">_config.yml</a>、<a href="https://github.com/xiang578/xiang578.github.io/blob/hexo/.travis.yml">.travis.yml</a>。</p><h3 id="3-百度收录"><a class="markdownIt-Anchor" href="#3-百度收录"></a> 3. 百度收录</h3><p>之前，我一直将博客的静态文件存储在 github 的项目中，也使用插件生成 <a href="https://xiang578.com/baidusitemap.xml">baidusitemap</a> 文件。但是由于一些不为人知的秘密，百度的爬虫实际上无法爬取 github 上的资源，导致博客最新的文章没有被收录到百度中。</p><p>而且从百度提供的抓取诊断上来看，配置腾讯云 COS 后，百度的爬虫依然访问的是 github 上的仓库。</p><p><img src="https://media.xiang578.com/15582343082714.jpg" alt="-w558" /></p><p>一顿搜索之后，找到一个主动提交 hexo 博客链接至百度的插件 <a href="https://github.com/huiwang/hexo-baidu-url-submit">huiwang/hexo-baidu-url-submit</a>。</p><p>参考 <a href="https://hui-wang.info/2016/10/23/Hexo%E6%8F%92%E4%BB%B6%E4%B9%8B%E7%99%BE%E5%BA%A6%E4%B8%BB%E5%8A%A8%E6%8F%90%E4%BA%A4%E9%93%BE%E6%8E%A5/">Hexo插件之百度主动提交链接 | 王辉的博客</a> 以及 <a href="https://www.jianshu.com/p/f37452d4978e">Hexo百度主动提交链接 - 简书</a> 完成配置。</p><ul><li>安装插件 <code>cnpm install hexo-baidu-url-submit --save</code></li><li>修改根目录下面的 <code>config.yml</code> 文件，配置 baidu_url_submit 和 deploy。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">baidu_url_submit:</span><br><span class="line">  count: 100 ## 比如3，代表提交最新的三个链接</span><br><span class="line">  host: xiang578.com ## 在百度站长平台中注册的域名</span><br><span class="line">  token: your_token ## 请注意这是您的秘钥， 请不要发布在公众仓库里!</span><br><span class="line">  path: baidu_urls.txt ## 文本文档的地址， 新链接会保存在此文本文档里</span><br><span class="line"></span><br><span class="line">deploy:</span><br><span class="line">- type: cos</span><br><span class="line">  secretId: XXX_ID</span><br><span class="line">  secretKey: XXX_KEY</span><br><span class="line">  appId: 1252086360</span><br><span class="line">  bucket: blog-1252086360</span><br><span class="line">  region: ap-shanghai</span><br><span class="line">- type: baidu_url_submitter</span><br></pre></td></tr></table></figure><p>上面的代码中出现一个 token，由于这是一个私有的，不能出现在 github 公开的仓库中。所以也需要 Travis-ci 中添加 Environment Variables 解决。和前文提到相同，在 <code>.travis.yml</code> 中添加 <code>- sed -i &quot;s~your_token~$&#123;BD_TOKEN&#125;~&quot; _config.yml</code> 解决私钥问题。</p><p>最终在 travis-ci 中发现下面的日志即配置成功。另外一点，百度的站长平台的数据不能及时展示我们提交后的结果，需要耐心等待。</p><p><img src="https://media.xiang578.com/15582352091163.jpg" alt="-w866" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本周有空对博客进行新一轮折腾，现在将这些尝试记下来和大家分享。&lt;/p&gt;
&lt;h3 id=&quot;1-主题更新&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-主题更新&quot;&gt;&lt;/a&gt; 1. 主题更新&lt;/h3&gt;
&lt;p&gt;我在 &lt;a href=&quot;http://x</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="travis" scheme="https://blog.xiang578.com/tags/travis/"/>
    
    <category term="cos" scheme="https://blog.xiang578.com/tags/cos/"/>
    
  </entry>
  
  <entry>
    <title>ImageNet Classiﬁcation with Deep Convolutional Neural Networks(AlexNet)</title>
    <link href="https://blog.xiang578.com/post/alexnet.html"/>
    <id>https://blog.xiang578.com/post/alexnet.html</id>
    <published>2019-05-18T12:56:43.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<h2 id="作者以及相关性"><a class="markdownIt-Anchor" href="#作者以及相关性"></a> 作者以及相关性</h2><ul><li>Alex Krizhevsky</li><li>Ilya Sutskever</li><li>Geoffrey E. Hinton</li><li>本文被认为是这一轮深度学习浪潮的开端</li></ul><h2 id="主题"><a class="markdownIt-Anchor" href="#主题"></a> 主题</h2><ul><li>将 CNN 技术最先应用到图像识别领域，利用 CNN 参数共享的特性，减少网络的规模</li><li>解决深度网络难训练（速度慢）以及容易过拟合问题（更多数据或者网络技巧）</li></ul><h2 id="数据集与指标"><a class="markdownIt-Anchor" href="#数据集与指标"></a> 数据集与指标</h2><ul><li>ImageNet LSVRC-2010 contest: 图片 1000 分类</li><li>top-1 和 top-5 错误率为指标</li></ul><h2 id="模型实验结论"><a class="markdownIt-Anchor" href="#模型实验结论"></a> 模型/实验/结论</h2><h3 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h3><ul><li><p>由于当时的 GPU 显存限制，无法将所有的数据加载到单独 GPU 中，作者使用两个 GPU 并行训练。</p></li><li><p>整个模型如下图所示，由 5 个卷积层以及 3 个全连接层组成。其中在 CONV3、FC1、FC2、FC3 层进行两个 GPU 的数据交互。</p><ul><li>[227, 227, 3] INPUT: 原始论文中 224 为笔误。</li><li>[55, 55, 96] CONV1: (11*11*3,96) filters, Stride 4, pad 0</li><li>[27, 27, 96] MAX POOL1: (3*3) filters, Stride 2</li><li>[27, 27, 96] NORM1: Normalization layer</li><li>[27, 27, 256] CONV2: (5*5,256) filters, Stride 1, pad 2</li><li>[13, 13, 256] MAX POOL2: (3*3) filters, Stride 2</li><li>[13, 13, 256] NORM2: Normalization layer</li><li>[13, 13, 384] CONV3: (3*3,384) filters, Stride 1, pad 1</li><li>[13, 13, 384] CONV4: (3*3,384) filters, Stride 1, pad 1</li><li>[13, 13, 384] CONV5: (3*3,256) filters, Stride 1, pad 1</li><li>[6, 6, 256] MAX POOL3: (3*3) filters, Stride 2</li><li>[4096] FC1: 两个 GPU 中的 CONV 层结果进行全连接</li><li>[4096] FC2: FC1 进行全连接</li><li>[1000] FC3: FC2 进行全连接，最后输出分类结果</li></ul></li><li><p>参数数量 60 million</p></li></ul><p><img src="https://media.xiang578.com/15580111160071.jpg" alt="" /></p><ul><li>使用 ReLU 作为激活函数：比 tanh 计算开销小，以及收敛速度快。根据问题的特点选择激活函数（大模型、大数据集）</li><li>Local Response Normalization(Norm Layers)：局部响应归一化层，后来很少使用。<br />在经过 ReLU 作用之后，对相同空间位置上（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{b_{x,y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span>）的相邻深度（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mi>j</mi></msup></mrow><annotation encoding="application/x-tex">{b^j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span></span></span></span> ）的卷积结果做归一化。n 指定相邻卷积核数目，N 为该层所有卷积的数目。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><mi>n</mi><mo separator="true">,</mo><mi>α</mi><mo separator="true">,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">{k, n, \alpha, \beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span> 都是超参数。本文使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mi>n</mi><mo>=</mo><mn>5</mn><mo separator="true">,</mo><mi>α</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup><mo separator="true">,</mo><mi>β</mi><mo>=</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">{k=2, n=5, \alpha=10^{-4}, \beta = 0.75}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span></span></span></span></span>, 分别降低 top-1 和 top-5 错误 1.4% 和 1.2%</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>b</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>a</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><mi>i</mi></msubsup><mi mathvariant="normal">/</mi><msup><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mi>α</mi><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo>−</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></munderover><msup><mrow><mo fence="true">(</mo><msubsup><mi>a</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><mi>j</mi></msubsup><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo fence="true">)</mo></mrow><mi>β</mi></msup></mrow><annotation encoding="application/x-tex">b_{x, y}^{i}=a_{x, y}^{i} /\left(k+\alpha \sum_{j=\max (0, i-n / 2)}^{\min (N-1, i+n / 2)}\left(a_{x, y}^{j}\right)^{2}\right)^{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2577720000000001em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.839048em;vertical-align:-1.55002em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V300 H291 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000006em;"><span style="top:-1.8089950000000001em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5160049999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.078672em;"><span style="top:-3.327564em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V300 H457 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:2.289028em;"><span style="top:-4.5029200000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li>Pooling：s=2 &lt; z=3，有部分重叠，作者通过实验发现这种方法可以更好地避免过拟合。</li><li>data augmentation：<ul><li>对图像进行裁剪以及翻转，扩大数据。这种策略对测试带来影响，测试时裁剪出图片四个角落以及中间部分，得到 5 张图片，另外翻转得到 5 张图片，最后分类结果又这 10 图片的平均得分确定。</li><li>利用 PCA 改变 RGB 通道的强度。</li></ul></li><li>Dropout：每次训练的时候，从模型中 sample 出一个小的模型，减少过拟合。</li></ul><h3 id="实验"><a class="markdownIt-Anchor" href="#实验"></a> 实验</h3><ul><li><p>参数：dropout 0.5，batch size 128， SGD Momentum 0.9， Learning rate 1e-2 reduce by 10，L2 weight decay 5e-4</p></li><li><p>测试集上结果<br /><img src="https://media.xiang578.com/15581816832571.jpg" alt="" /></p></li><li><p>取出 CONV1 相关的 filters卷积侧重点不同，GPU1 颜色无关，GPU2 颜色相关。多次实验发现都存在这种现象，说明使用多个 GPU 训练是必要的，模型可以捕捉更多信息。<br /><img src="https://media.xiang578.com/15581833748303.jpg" alt="" /></p></li><li><p>取所有最后一个隐层向量，找到与测试图片欧拉距离最小的训练图片（下图中第一列为测试图片，之后几列是欧拉距离最小的训练集中图片）。肉眼可以发现，同一分类的图片有很大关联性。证明模型能学习图片之间的关系。<br /><img src="https://media.xiang578.com/15581820979738.jpg" alt="" /></p></li></ul><h3 id="结论"><a class="markdownIt-Anchor" href="#结论"></a> 结论</h3><ul><li>通过移除 AlexNet 网络中的某几层发现错误率均有提高，这个网络时必要以及有效的。</li><li>文章中作者通过大量的实验确定模型的细节问题，值得我们学习。</li><li>当时的 GPU 限制作者的想象力……</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;作者以及相关性&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#作者以及相关性&quot;&gt;&lt;/a&gt; 作者以及相关性&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Alex Krizhevsky&lt;/li&gt;
&lt;li&gt;Ilya Sutskever&lt;/li&gt;
&lt;li&gt;Ge</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="cnn" scheme="https://blog.xiang578.com/tags/cnn/"/>
    
    <category term="alexnet" scheme="https://blog.xiang578.com/tags/alexnet/"/>
    
  </entry>
  
  <entry>
    <title>2018 探索</title>
    <link href="https://blog.xiang578.com/post/2018.html"/>
    <id>https://blog.xiang578.com/post/2018.html</id>
    <published>2019-04-10T04:40:45.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>全文混乱。拖了 4 个月之后，强行完结。</p></blockquote><h2 id="毕业"><a class="markdownIt-Anchor" href="#毕业"></a> 毕业</h2><p>2018 最大的一件是自己终于艰难地从学校毕业。本来在学校属于 easy 模式，原本以为毕业很轻松。不过出于一些原因，比其他人多待一个月才拿到毕业证书，给我不太美好的大学生涯又多添几份痛苦。本来还准备写篇文章来总结一下大学生涯，拖到现在毕业都快一周年，也只能当成是毕业一周年的回忆文章。</p><h2 id="工作"><a class="markdownIt-Anchor" href="#工作"></a> 工作</h2><p>毕业之后，用我外婆说的一句话“一个人拉着两个行李箱就去工作了”。误打误撞和机器学习挂上一些关系。每天属于虽然工作很开心，但是好像没有干什么事情的状态。更多地吐槽也准备写在工作一周年的文章中。</p><h2 id="自我管理"><a class="markdownIt-Anchor" href="#自我管理"></a> 自我管理</h2><p>这个概念是年初感觉自己太混乱时提出来的，如果成为更好的自己。一年来有过很多想法和实践，但是现在还探索出来完整的系统。有机会再写。</p><h2 id="年度阅读"><a class="markdownIt-Anchor" href="#年度阅读"></a> 年度阅读</h2><p>说来惭愧，今年没有读多少本书，而且绝大部分都是在没有毕业时候读的。工作之后，完整看完地也只有一本《九败一胜》。这本书讲的是王兴的创业故事，总的感受是创业维艰。感觉王兴是为了创业而生的人，有知识基础，又有经济基础。在多次创业之后，培养了商业上的灵敏，管理上的艺术。最终能在千团大战中走出来，成就今天的美团帝国。可惜这个冬天，美团有些艰难，脉脉上给予他裁团（裁员，特别是应届生）、C团（绩效打 C，逼你走）的名声。比起王兴的故事，我更感兴趣的是程维创立滴滴的故事，不知道什么时候可以读到。</p><p>说回来在读过的书中，最推荐 <a href="https://book.douban.com/subject/26835090/">软技能</a>，之前也写过简单的<a href="https://xiang578.com/2018/05/28/soft-skills/">介绍</a>。用时髦的话来说，这本书教你成为一个斜杠青年。在基础的工资外，还有通过其他渠道有第二职业的收入，最后是睡后收入（表名上说的是睡觉时候获得的收入，第二层含义是一次生产，可以多次贩卖）。后来想想，自己可以二次出售什么？无法是什么时间管理、知识管理、理财、读书、写作之类的烂大街的东西。所以，自己还是需要加强抗击职业风险的能力，尽快找到自己的第二职业收入。</p><p>另外，自己也进行了一些主题阅读。年初的时候，对时间管理和知识管理感兴趣。读过<a href="https://book.douban.com/subject/25872118/">Evernote 100个做笔记的好方法</a>、<a href="https://book.douban.com/subject/24524405/">Evernote超效率数字笔记术</a>、<a href="https://book.douban.com/subject/26809387/">印象笔记留给你的空间</a>、<a href="https://book.douban.com/subject/26801390/">有道云笔记：记录，成为更好的自己</a>、<a href="https://book.douban.com/subject/4630664/">你的知识需要管理</a>，看完这些书多少有些收获，但也没有完全解答我的疑问，说回来，也不太推荐你们去看。不过，时间管理方面的两本书，<a href="https://book.douban.com/subject/3558629/">小强升职记</a>和<a href="https://book.douban.com/subject/26612471/">搞定Ⅰ</a>，却是五星推荐，看一看，多少能提高一些工作效率。</p><h2 id="年度观影"><a class="markdownIt-Anchor" href="#年度观影"></a> 年度观影</h2><p>今年看过的电影倒是比书多一些。不过，其中好多都是漫威的超级英雄片。自己感觉漫威伟大的地方在于创造了一个包括神话、物理、外星文明的电影宇宙，这个宇宙也许会成为我们这一代人的回忆。</p><p>说回来，今年看过的片子中，最推荐的是<a href="https://movie.douban.com/subject/6874741/">无问西东</a>。这部片子讲述了不同时期 4 个不同年代清华学子关于选择的故事，也许是因为没有他们这样的大学经历才会嫉妒。看完片子后，还抄录一些台词，大概能更加清晰的表达电影对我的影响。</p><p>吴岭澜（文科很好，理科很差）面对梅校长时候询问为什么不去读文科时的回答。</p><blockquote><p>因为最好的学生都读实科<br />我只知道，不管我将来做什么<br />在这个年纪，读书，学习都是对的<br />我何用管我学什么？<br />每天把自己交给书本，就有种踏实</p></blockquote><p>吴岭澜重新找到自己的目标之后，成为了清华大学的一名教授。在西南联大给学生上课时回忆自己的大学时光：</p><blockquote><p>当我在你们这个年纪，有段时间，我远离人群，独自思索，我的人生到底应该怎样度过？某日，我偶然去图书馆，听到泰戈尔的演讲，而陪同在泰戈尔身边的人，是当时最卓越的一群人，这些人站在那里，自信而笃定，那种从容让我十分羡慕。而泰戈尔，正在讲“对自己的真实”有多么重要，那一刻，我从思索生命意义的羞耻感中，释放出来。原来这些卓越的人物，也认为花时间思考这些，谈论这些，是重要的。今天，我把泰戈尔的诗介绍给你们，希望你们在今后的岁月里，不要放弃对生命的思索，对自己的真实。</p></blockquote><p>对吴岭澜的总结：</p><blockquote><p>梅校长说：“人把自己置身于忙碌当中，有一种麻木的踏实，但丧失了真实，你的青春也不过只有这些日子。”<br />什么是真实？<br />你看到什么，听到什么，做什么，和谁在一起<br />有一种，从心灵深处，满溢出来的不懊悔，也不羞耻的平和与喜悦</p></blockquote><p>后来吴岭澜领悟到了：<br />看到和听到的，经常令你们沮丧，世俗是这样强大，强大到生不出改变它们的念头。可是如果有机会提前了解了你们的人生，知道青春也不过只有这些日子，不知你们是否还会在意的，那些世俗让你们在意的事情，比如占有多少，才更荣耀，拥有什么，才能被爱。 等你们长大，你们因绿芽冒出土地而喜悦，会对出生的朝阳欢呼雀跃，也会给别人善意和温暖，但是却会在赞美别的生命的同时，常常，甚至永远忘了自己的珍贵。愿你在被打击的时，记起你的珍贵，抵抗恶意；愿你在迷茫时，坚信你的珍贵，爱你所爱，行你所行，听从你心，无问西东。</p><p>富家子弟沈光耀放弃学业，决定参加飞行队时，母亲不远万里来联大劝他。</p><blockquote><p>“当初你离家千里，来到这个地方读书，你父亲和我都没有反对过，因为，是我们想你，能享受到人生的乐趣，比如读万卷书行万里路，比如同你喜欢的女孩子结婚生子。注意不是给我增添子孙，而是你自己，能够享受为人父母的乐趣，你一生所要追求的功名利禄，没有什么是你的祖上没经历过的，那些只不过是人生的幻光。我怕，你还没想好怎么过这一生，你的命就没了啊！”</p></blockquote><p>同学在他牺牲后，去看望沈母时，屏幕上展现出一幅对联：三代五将护国定疆青史留正气，六韬三略擅用筹边御旨赞英豪。</p><p>这部电影的彩蛋标题是致敬时代的风骨，快速回顾在电影中出现过的时代名人。可惜自己没有认出多少个，真是悲哀。</p><h2 id="后记"><a class="markdownIt-Anchor" href="#后记"></a> 后记</h2><p>这篇文章写的有点杂，我只是看着 MWeb 中的存稿有点多，趁着这次机会消灭一些，来年有机会写些新的东西。</p><p>于北京回龙观</p><p>其他文章：</p><ul><li><a href="https://xiang578.com/post/2017.html">2017 迷茫</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;全文混乱。拖了 4 个月之后，强行完结。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;毕业&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#毕业&quot;&gt;&lt;/a&gt; 毕业&lt;/h2&gt;
&lt;p&gt;2018 最大的一件是自己终于艰难</summary>
      
    
    
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="movie" scheme="https://blog.xiang578.com/tags/movie/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 11 期</title>
    <link href="https://blog.xiang578.com/post/week-issues-11.html"/>
    <id>https://blog.xiang578.com/post/week-issues-11.html</id>
    <published>2019-03-16T12:56:43.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六不定时更新。</p></blockquote><h2 id="观点"><a class="markdownIt-Anchor" href="#观点"></a> 观点</h2><ul><li>美团和滴滴为什么要互相开展对方的业务：<ol><li>我记得罗振宇在某一年时间的朋友中提到一个观点：O2O 领域会出现一个超级公司，业务横跨所有场景。</li><li>从技术角度分析，外卖中比较难的点在于分单、时间估计以及路径规划。这也是出行服务中的技术难点。不过各有侧重，外卖中路径规划相当于最多不超过 20 个点（10 个商家处取餐，10 个顾客中送餐）的 TSP 问题。出行服务最关键的是如何有效的获取道路信息。（我有一个观点，人是有主观能动性的，会抄各种小道）</li><li>这两个服务都严重依赖地推服务，所以双方本身都有一支庞大的城市地推人员。我想开展不同业务的切换难度应该会小一些。</li></ol></li></ul><h2 id="读书刻意练习"><a class="markdownIt-Anchor" href="#读书刻意练习"></a> 读书《刻意练习》</h2><p>听这个名字很容易认为是一本鸡汤书，英文小标题中提到 New science of Experitse。本书打破的是之前很流行的 1 万小时天才理论，这个理论认为很多天才之所以是天才是他们的技能经过长时间的训练，有量变引起质变。新的研究发现，学习的本质是在大脑中建立心理表征，它是一种长时记忆单元，也是我们习得技能的结果。刻意练习就是如何高效地获得这个心理表征。鉴于这是一本脑科学的书，方法是否正确还应该是自己亲身体验才能知道。</p><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="https://sspai.com/post/46056">经过一年的思考，我重新梳理了我的印象笔记使用方法 - 少数派</a>：不知道为什么，我对这类文章特别地喜欢。这篇文章带来的新意是对知识的六种分类，之前我自己没有考虑过。不要过度沉溺于研究工具，而忘记学习的初心。</li><li><a href="https://www.zhihu.com/question/280483874/answer/420024531">教授说没有写过一千行代码就别想上大公司，这种说法对吗？ - 知乎</a>：之前看到这个问题就想直接喷，写一千行代码怎么去大公司。看完其他人的回答，才发现又一次陷入到了思维定势。从数学角度来说，写一千行代码去大公司是一个必要不充分条件，去大公司确实需要写代码，一千行是被包括的，但可能远远不够。</li><li><a href="https://blog.yitianshijie.net/2017/09/14/chinese-translation-of-steve-jobs-recording-on-iphone-x-event/">iPhone X 发布会乔布斯录音的中译（或当代汉语现状） – 一天世界</a>：一段英文白话翻译以及文言翻译对比，又一次体会到古典之美。<ul><li>There’s lots of ways to be as a person, and some people express their deep appreciation in different ways. But one of the ways that I believe people express their appreciation to the rest of humanity is to make something wonderful and put it out there. You never meet the people, you never shake their hands, you never hear their stories or tell yours. But somehow in the act of making something with a great deal of care and love, something’s transmitted there. And it’s a way of expressing to the rest of our species our deep appreciation. So we need to be true to who we are and remember what’s really important to us. That’s what’s gonna keep Apple, Apple, is if we keep us, us.</li><li>「李如一」译文：人生而有别，感恩之心亦可谓十人十色。创造神奇，示之于人，此为对人性感恩之一种也。彼二人或未曾握手相见，对各自生平事故复无相闻，惟细巧体贴之创造即足以千里传音。此即吾等人类传递感恩之心之法门也。故人必诚于其本色，忠于其所信。林檎之为林檎，端赖吾辈不忘初心也。愿与诸君共勉。</li><li>「@东莞大唐和尚」译文：人与人的生活方式千差万别，表达感恩的方式也是多种多样。但我认为，做出一件绝妙的东西，才是向这个世界表达感恩的最最深刻的方式。你没见过那些人，没跟他们握过手，你没听过他们的故事，也没跟他们讲过自己的经历，但就是通过你倾注心血做出的这样一件东西，你传达给了他们一些东西。这是向其他人表达我们感激的最深刻的方式。我们需要真诚地面对自我，永远记住对自己最重要的东西是什么。苹果之所以是苹果，我们之所以是我们，正在于此。</li></ul></li></ul><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><ul><li><a href="https://www.bilibili.com/bangumi/media/md97952/">人生一串 _ 纪录片 _ bilibili _ 哔哩哔哩弹幕视频网</a>：属于国人的深夜食堂，再搭配上神级文案，完美展示烧烤江湖。</li></ul><h2 id="后记"><a class="markdownIt-Anchor" href="#后记"></a> 后记</h2><p>这半年自己写的东西有点少，从第 10 期到这一次拖了好久。最初，是在阮一峰的鼓舞下开始这种形式的分享。不过后来由于种种原因，又展现出自己的本质。有些事情还是要坚持的，所以将这些存货发布出来。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六不定时更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;观点&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#观点&quot;&gt;&lt;/a&gt; 观点&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;美</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>2018 年消费指南</title>
    <link href="https://blog.xiang578.com/post/2018-consumer-report.html"/>
    <id>https://blog.xiang578.com/post/2018-consumer-report.html</id>
    <published>2019-01-13T11:05:14.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>去年在总结中提到了一些知识付费的内容，今年将内容扩展，和大家分享我在这一年购买的实物以及虚拟产品。</p><h2 id="实体购物"><a class="markdownIt-Anchor" href="#实体购物"></a> 实体购物</h2><p>工作之后，感觉自己每个月留不下多少钱，很大一部分用来购买一些号称提高工作效率有关的物件。现在毕竟钱都花出去了，至少要装模作样地总结它们给我带来的提升。</p><h3 id="键鼠"><a class="markdownIt-Anchor" href="#键鼠"></a> 键鼠</h3><p>入职之后，地主只给我提供了一把锄头（Macbook Pro 13 with touchbar），长时间在蝴蝶键盘上敲击不是很愉悦的感觉。所以自己产生了购买键盘和鼠标的念头。</p><p>众所周知，机械键盘是码农的标配，用手指在键盘上噼里啪啦快速敲击，想想就有画面感。之前在上学的时候，我拥有一把 IKBC G87 的青轴键盘。IKBC 的优点在于价格便宜，不过和同学的 Filco 圣手对比，手感不是那么的清脆。而且本着一步到位的想法，这次准备购买的键盘可以贵一些。再加上一些其他的条件，将自己的选择限定在了 Filco 和 HHKB 上。众所周知，HHKB 的价格差不多可以买两个 Filco。最后是遇到了少数派的优惠活动，才痛下决心买了一个 HHKB Professional BT（其实是多送了少数派的贴纸而已）。</p><p><img src="https://media.xiang578.com/15473651233100.jpg" alt="HHKB" /></p><p>评价 HHKB 最好的方式是引用其创始人和田英一下面这一段话：</p><blockquote><p>美国西部的牛仔们，会将死去的马儿留在原地，但是仍然会扛着马鞍长途跋涉，穿越一望无垠的沙漠。因为马儿是消耗品，而马鞍却是与人体融合在一起的“知己”。我们要有这样的观念：现在，电脑是消耗品，键盘却是传递情感，陪伴我们一生的“挚友”。</p></blockquote><p>HHKB 给人最大的感觉就是与众不同，一共只有 60 个按键。整个键盘长度和一张 A4 纸相当。看下面的布局图不难发现：</p><ol><li>没有 F1-F12 功能按键</li><li>没有方向键</li><li>Caps 键的位置上是 Control 键</li></ol><p><img src="https://media.xiang578.com/HHKB_Pro2_Layout.jpg" alt="HHKB_Pro2_Layout" /></p><p>咋一看，很难满足一般的工作需求。但是经过对工作方式的一些调整，可以很好的完成日程任务，而且键盘的手感不错（从 v2 上看到的形容是少女酥胸的手感，具体是不是我也没有体验过），长时间敲击没有疲劳感。我的编程主要在服务器上用 vim 完成，所以 hjkl 才是我的方向键，而且我也在 Jetbrain 的编辑器中安装了 vim 插件。对于其他情况下，使用 Karabiner Elements 对键盘进行一些改造（按住 Control 开启 vi 模式，hjkl 变成方向键），最后还可以用 Mac 系统自带的一些文本编辑相关的快就键。</p><p><img src="https://media.xiang578.com/Jietu20180823-223800.jpg" alt="Karabiner_Elements" /></p><p>有了键盘之后，不能没有鼠标。其实这里面也有两个选择：罗技 的 MX Master 2 和苹果的触摸板。不得不说， mnp 自带的触摸板用起来非常的爽快，但是单独购买触摸板价格也很感人，提前退出了购买范围。趁着双十一，在京东买下了 MX Master 2。</p><p><img src="https://media.xiang578.com/15473661736323.jpg" alt="MX Master 2" /></p><p>看上面的图片可以知道，这是一款人体工程学的鼠标，而且有一些按键可以编程（配合软件）。支持蓝牙以及接受器连接，可以记忆三个设备。据说，还实现了在一台电脑上复制，再另外一台电脑上粘贴。总体用下来也是中规中矩，除了中间的滚轮阻尼感有点差之外（侧边的滚轮手感很好，但是不能修改成上下滚动的效果），也没有太多缺点。</p><h3 id="bose-qc-35-二代"><a class="markdownIt-Anchor" href="#bose-qc-35-二代"></a> Bose QC 35 二代</h3><p>购买降噪耳机多少是出于无奈，离开学校的图书馆之后，很少能找到一个安静的地方，让自己静下心来干一些事情。特别是在开放的办公室中，不仅有其他同事的讨论声，还有空调的噪音。带上降噪耳机，在放上一曲喜欢的音乐，就感觉来到了另外一个世界。之前在知乎上看到的一个评价正好能形容这种感觉：</p><blockquote><p>有多安静我来描述一下，孩子数学成绩不好，你在银行做经理，维护客户关系，不上不下，有房贷和车贷，每月按揭五千。你老婆在市人民医院做护士，她妈有尿毒症透析多年，她不爱你。你年轻的时候觉得能成一番事业，但现在也就这样，朋友们混的都比你好，你下班在车库停稳车，关掉引擎，呜一声安静了下来。太安静了，你生命中少有这么安静的时刻，你打算发十分钟呆再上楼吃饭。<br />以上就是 BOSE QC 35 的降噪效果测评。</p></blockquote><p>所以充分证明，现在的耳机评测多么注重编故事的能力。说回来，带上耳机之后，空调之类的噪音基本上会被隔绝，其他人声只是轻微的减弱，就像他们在远处处聊天。总体来说，这副耳机达到了我的预期，也算是一笔合理消费。</p><h3 id="米家宇宙"><a class="markdownIt-Anchor" href="#米家宇宙"></a> 米家宇宙</h3><p>用这里来调侃一下，小米出的那么多智能家电。自己入手了米家台灯和小饭煲，搭配米家的 APP ，可以实现晚上当你拖着身体回来时有一盏灯为你亮起，清晨又有一锅粥等你去品尝。最近，米家 APP 通过捷径配合 Siri 使用，大大扩展了便利程度。未来真的快要来了。</p><p><img src="https://media.xiang578.com/15473720711543.jpg" alt="mijia" /></p><h2 id="年度虚拟产品"><a class="markdownIt-Anchor" href="#年度虚拟产品"></a> 年度虚拟产品</h2><p>与上面提到的实体产品相反的，就是虚拟产品，比如软件、文章、教程、视频等。用虚拟产品更好的总结这些消费的特点。其实很多人会觉得这些东西不值得花钱，网上找盗版的即可。但自己赞同一个观点，给优秀的内容付费，才能激励作者分享更多的知识。</p><h3 id="订阅服务"><a class="markdownIt-Anchor" href="#订阅服务"></a> 订阅服务</h3><p>在这一年中持续付费的产品有滴答清单、印象笔记、SetApp。滴答清单是最早购买的 GTD 软件，对于初学者来说，这是一个大而全的软件，从清单、日历到番茄时间应有尽有。不过，我没有打算继续在新的一年为它付费，我对 GTD 软件的要求是有强大的过滤功能，而不是那一些花里胡哨的噱头功能。印象笔记是自己选择的主力笔记软件，之前使用为知笔记，但是他在 Mac 上的功能很少，也很久没有大的更新了，而印象笔记特别是在中国区独立之后，有很多大的动静。</p><p>Setapp 是一个软件集中订阅服务，简单来说，你订阅了这个服务，可以使用很多需要购买的 Mac App。自己目前常用的有 Moneywiz（记账软件，mac 和 ios 都可以使用）、Timing（自动记录 Mac 上软件使用时间，可以看成是一个统计工作效率的软件）、Bartender（隐藏状态栏，看起来更加清爽）、iStat Menus（在状态栏显示网速、cpu使用率等系统状态）、MarginNote（比较强大的 PDF 阅读软件）、Ulysses（Markdown 写作软件）。除此之外，SetApp 还提供了 100 多款软件，总的来说是超值的服务。</p><p><img src="https://media.xiang578.com/15473675744474.jpg" alt="-w1252" /></p><h3 id="买断服务"><a class="markdownIt-Anchor" href="#买断服务"></a> 买断服务</h3><p>相比起付费服务，直接买断的软件就显得有点少。其中的原因有很多，最重要的是很多国外软件一次性买断价格是参考国外的物价，也许对于他们来说是一顿饭的价格，对应到国内就是好几百。</p><p>MacOS 上购买了 MWeb 3，也就是现在使用的 Markdown 软件。从二代开始入手使用，用来写一些文章的草稿。另外一点，用来管理博客文档也比较方便，可以一键将文章中出现的本地图片上传到图床。不过，上面提到 SetApp 中提供了更强的 Ulysses，也许明年的总结我会用 Ulysses 完成。</p><p>iOS 中，主要购买的是一些工具。Cloud Speed，测试不同国外云服务商的不同机房的速度，买了之后没有想象中的那么好。Taskmator，搭配 Mac 上的 Taskpaper 使用，之前想用他来做任务管理，不过后来放弃了。MoneyWiz 2，超值的记账软件，帮我养成了记账的习惯。之前用过网易有钱，无法忍受他的理财社区而卸载了。无相，一款神奇的浏览器，你可以指定一些其他网站的 CSS 样式（软件中有一个商店可以下载 CSS 文件），从而提升阅读体验，间接实现去除页面上的广告……</p><h3 id="知识付费"><a class="markdownIt-Anchor" href="#知识付费"></a> 知识付费</h3><p>罗振宇在 2016 年提出知识付费元年，可从我的角度来说，2018 才是我的知识付费元年。今年主要在两大平台进行内容消费，闲鱼以及少数派。</p><p>对的，你没有看错，闲鱼是我上半年的一个主要消费场所。有一句话，评价一个知识付费好不好，看它在闲鱼上有没有买就可以了。闲鱼上有很多倒卖的人，很可能是 N 道贩子，主要是通过百度云进行交易。比起原生的，体验是非常差的（得到的文章是长图片形式），胜在价格便宜（一两块到十几块不等）。可以用来简单判断一下内容，再决定是否需要去原网站购买。回过头来看，自己购买的绝大部分课程内容还静静地躺在百度云中……但也发现了一个精品课程，小能熊——陈华伟的《知识管理训练营》，这里面讲了很多老师自己使用 Mac 和 iPhone 进行知识管理的方法和体会。对于不是高阶的用户很是值得一看，原价是 99 元非常值得（可以在印象笔记公众号中找到）。我也做了一些笔记，一直比较忙，没有时间整理分享。搜索了一个其他人的笔记，大家可以看一下了解 <a href="https://www.jianshu.com/p/25b40b5c4d2b">21天知识管理训练营总结【笔记版1.0】 - 简书</a></p><p><img src="https://media.xiang578.com/15473703471065.jpg" alt="课程大纲" /></p><p>至于在少数派中，就花了很多钱够买其中的专栏。少数派是我看了好几年的一个数字资讯网站，他们的口号是「少数派致力于更好地运用数字产品或科学方法,帮助用户提升工作效率和生活品质」。自己购买了他们的会员通讯 <a href="https://sspai.com/series/9">Power+ 1.0</a> 以及还在持续更新中的 <a href="https://sspai.com/series/70">Power+ 2.0</a>，具体的内容介绍可以查看这两个网页。如果你也是那种喜欢折腾软件的人，这个东西非常超值。任务管理系列（<a href="https://sspai.com/series/69">用 OmniFocus 3 搭建任务管理系统</a>、<a href="https://sspai.com/series/1">用更现代的方式做任务管理</a>、<a href="https://sspai.com/series/22">TaskPaper 使用指南</a>），其实购买这三个完全是没有必要，你喜欢哪一个软件做 GTD，直接购买对应的教程就好了。最后也很推荐的是 <a href="https://sspai.com/series/3">从零开始做好个人记账</a>，教你使用 Moneywiz 记一手明白账（原理通用，也可以使用其他软件。）</p><p><img src="https://media.xiang578.com/15473712908061.jpg" alt="sspai" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;去年在总结中提到了一些知识付费的内容，今年将内容扩展，和大家分享我在这一年购买的实物以及虚拟产品。&lt;/p&gt;
&lt;h2 id=&quot;实体购物&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#实体购物&quot;&gt;&lt;/a&gt; 实体购物&lt;/h2&gt;
&lt;p&gt;工作之后，感觉自己</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记：修复七牛云测试域名失效问题</title>
    <link href="https://blog.xiang578.com/post/fix-qiniu-test-url-error.html"/>
    <id>https://blog.xiang578.com/post/fix-qiniu-test-url-error.html</id>
    <published>2018-12-20T19:39:14.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>毕业之后开始工作快要 5 个月了，然后也快有 3 个月没有更新博客。其实文本编辑器中还有很多的草稿，但是一直没有力量驱动自己完结他们，并且分享出来。另外，这一段时间也不是完全没有分享。在这个页面的上方有一个 <code>Tech</code> 的标签，可以连接到我新搭的博客。受限于当前使用的 hexo 主题无法配置 latex 数学公式，所幸新开博客分享算法学习的笔记。大家感兴趣的可以访问一下，不过也没有太多的内容。</p><p>这次在博客公告中要告诉大家的确是另外一件事情。屋漏偏风连夜雨，不知道从什么时候开始，七牛云开始图片使用测试域名，毫无疑问这个博客的图片都挂了。自己也一直没有动力修复，让这一段时间访问我博客的小伙伴受累了。</p><p>今天研究了一下如何修复这个图床问题。官方有一个帮助页面<a href="https://developer.qiniu.com/fusion/kb/1322/how-to-configure-cname-domain-name">如何配置域名的 CNAME - 七牛开发者中心</a>，大概就是你的存储空间之前有一个测试域名（比如我的是 <a href="http://7xkpe5.com1.z0.glb.clouddn.com">7xkpe5.com1.z0.glb.clouddn.com</a>），现在不允许通过测试域名访问图片，需要绑定一个备案过的域名才可以。所以我们需要两个步骤完成改造：首先，给空间绑定一个域名（比如现在使用的是 <a href="http://media.xiang578.com">media.xiang578.com</a> ）；最后，在域名解析平台添加一个 CNAME，将你指定的域名转发到七牛的记录上。</p><p>完成上一步后，图片还是不能正常显示。因为之前的文章中，图片的链接都是以测试域名开头的，比如<code>7xkpe5.com1.z0.glb.clouddn.com/15283589946007.jpg</code> ，现在我们要将它改成 下面的形式 <code>media.xiang578.com/15283589946007.jpg</code>。简单的方法是打开文本编辑软件，然后使用查找替换功能，一个一个文件处理。显然这很无聊，而且进入 <code>source/_posts</code> 目录下利用 <code>grep 7xkpe5 *.md | wc</code> 统计了一个，我大概需要修改的有 142 处。</p><p><img src="https://media.xiang578.com/15453335377518.jpg" alt="需要替换的字符串" /></p><p>幸运地是 linux 系统下有两大文本处理利器 <code>sed</code> 和 <code>awk</code>。我们使用 <code>sed</code> 可以将一个字符串转换为另外一个字符串。网上搜索了一下用法，很快写了出来</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i -r &quot;s/7xkpe5\.com1\.z0\.glb\.clouddn\.com/media\.xiang578\.com/g&quot; *.md</span><br></pre></td></tr></table></figure><p>这条命令中原始形态可以表示为 <code>sed 's/原字符串/替换字符串/g'</code>。其中参数 <code>-i</code> 代表替换文件中的所有匹配项，<code>-r</code> 代表批量替换支持扩展表达式。在原字符串和替换字符串中都出现了 <code>\.</code>，应为 <code>.</code> 在 <code>sed</code> 命令中代表匹配任意单个字符，加上转移字符后可以代表它本身。最后 <code>*md</code> 代表对目录下的 <code>md</code> 文件进行处理。</p><p>运行完成之后，我们在统计一下测试域名和正式域名的数量，可以发现完美的解决了这个问题，图片又能正常显示。</p><p><img src="https://media.xiang578.com/15453344578555.jpg" alt="修改后" /></p><p>所以，写下今天这一篇博客一切都是因为贫穷。如果有钱直接在主机上放置图片，有带宽提供出来访问，也就不会依赖七牛云了……</p><hr /><p>2019.11.09</p><p>为了减少博客依赖服务，参考 <a href="https://zealot.top/%E5%9B%BE%E5%BA%8A%E4%BB%8E%E4%B8%83%E7%89%9B%E4%BA%91%E8%BF%81%E7%A7%BB%E5%88%B0%E8%85%BE%E8%AE%AFCOS.html">图床从七牛云迁移到腾讯COS折腾笔记 | 思想就是武器</a> 将所有的图片全部从七牛上下载，利用 COS 存储。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;毕业之后开始工作快要 5 个月了，然后也快有 3 个月没有更新博客。其实文本编辑器中还有很多的草稿，但是一直没有力量驱动自己完结他们，并且分享出来。另外，这一段时间也不是完全没有分享。在这个页面的上方有一个 &lt;code&gt;Tech&lt;/code&gt; 的标签，可以连接到我新搭的博客</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="hack" scheme="https://blog.xiang578.com/tags/hack/"/>
    
  </entry>
  
  <entry>
    <title>字体的重要性</title>
    <link href="https://blog.xiang578.com/post/ImportanceOffont.html"/>
    <id>https://blog.xiang578.com/post/ImportanceOffont.html</id>
    <published>2018-09-03T23:41:14.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<h1 id="字体的重要性"><a class="markdownIt-Anchor" href="#字体的重要性"></a> 字体的重要性</h1><p>最近开始工作，基本上都和终端打交道，碰到几个误认字符的尴尬场面，记录一下。</p><p>第一个遇到的问题发生在输入账户密码时，公司发的小册子上写的密码大概形式如<code>xxxxxi|6xxx</code>。由于打印密码的字体是黑体，难免产生疑问 <code>|</code> 到底是 <code>I</code> 还是 <code>l</code>？观察到的细节是 <code>|</code> 这个字符下面比其他的字符长，不过由于之前很少在密码中使用过这个字符，所以以为这个细节是区分<code>I</code> 和 <code>l</code> 的。在密码错误 n 次后，眼光扫到键盘才发现回车键上面的 <code>|</code> 键。</p><p>第二个遇到的问题是在终端中，公司的堡垒机登陆比较复杂，一般都会写脚本来快速登陆。写完之后，运行指令的格式为</p><blockquote><p>jump ip 'auth'</p></blockquote><p>其中的 'auth' 部分为调用另外一个脚本生成一个二次验证的并作为 jump 命令的参数。其中这个 ' 符号被我认为是引号，后来查阅相关的 shell 命令（相关文章参考<a href="https://blog.csdn.net/a515983690/article/details/51554297/">linux下命令执行结果作为其他命令输入参数 - CSDN博客</a>），才明白为反引号（一般位于ESC 的下方）。</p><p>说完这两个问题，回到主题，每天和字母打交到，选着一款合适的字体是非常重要的。推荐一款我在几年前就使用的编程字体——<a href="https://github.com/source-foundry/Hack">Hack: A typeface designed for source code</a>。</p><p><img src="https://media.xiang578.com/15348602272400.png" alt="Hack 字体示意" /></p><p>上图就是这款字体的示意，最喜欢的点是 <code>0</code> 中间有一个小竖点，非常的传神。 以至于现在 IDE 中的 0 不是想上面这样处理，我都感觉不会编程了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;字体的重要性&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#字体的重要性&quot;&gt;&lt;/a&gt; 字体的重要性&lt;/h1&gt;
&lt;p&gt;最近开始工作，基本上都和终端打交道，碰到几个误认字符的尴尬场面，记录一下。&lt;/p&gt;
&lt;p&gt;第一个遇到的问题发生在输入账户</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="font" scheme="https://blog.xiang578.com/tags/font/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记：使用 Travis CI 自动部署博客</title>
    <link href="https://blog.xiang578.com/post/use-travis-ci-to-auto-build-blog.html"/>
    <id>https://blog.xiang578.com/post/use-travis-ci-to-auto-build-blog.html</id>
    <published>2018-09-03T23:05:50.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>已切换到 Github Action</p></blockquote><p>之前一周在封闭接受公司培训，最重要的任务是熟悉「项目开发全流程」。其中有一点：服务的稳定性。不知道为什么，前几天自己的博客崩溃了，输入域名只能看到 404 页面。当时以为是 Travis CI 的原因，所以进行了全面的一次排查：</p><ul><li>问题出现在 Github Pages 的 Custom domain 设置中。</li><li>具体表现：通过 Travis CI 推送博客静态文件到仓库中的 master 后，下图框中的域名就会变成空的，导致无法访问。</li><li>解决方法：在源文件的 source 目录下创建一个 CNAME 文件，写上你自己的域名。</li></ul><p><img src="https://media.xiang578.com/15358143289885.jpg" alt="" /></p><h2 id="travis-ci"><a class="markdownIt-Anchor" href="#travis-ci"></a> Travis CI</h2><p>其实看一眼就应该知道，我的博客是基于 hexo 搭建的，文件托管在 github 仓库中。不过，按照之前的设想博客应该在 Coding 中也有一份备份。后来由于一些原因，在利用 hexo 生成静态文件之后，自动推送到 Coding 上的命令不起作用。自己也没有时间去排查问题，所以最近访问速度有点慢。</p><p>传统的 hexo 博客更新过程是：在完成写作之后，利用命令行调用 <code>hexo g &amp;&amp; hexo d</code> 来生成静态博客文件以及并推送到远端的仓库中。这种方法会产生三个痛点：</p><ol><li>每一次修改源文件后都需要重新生成一边静态文件，当大量修改时，步骤就变得繁琐且无趣。</li><li>生成静态文件依赖电脑中的 hexo 和 node.js 环境，不方便在外出时临时写或修改博客。</li><li>博客源文件没有自动的备份功能，不符合安全原则。</li></ol><p>Travis CI 是一种持续集成开发所使用的工具，在写作过程中引入他可以解决上面我提到的痛点。Travis CI 具体的含义也不是很清楚，直接介绍我是怎么使用的。</p><p>博客依赖 3 个 git 仓库：</p><ul><li>原始文件 <a href="https://github.com/xiang578/blog">xiang578/blog</a></li><li>主题文件 <a href="https://github.com/xiang578/hexo-theme-even">xiang578/hexo-theme-even: A super concise theme for Hexo</a>（我对这个主题有一些修改，所以自己 fork 了一份</li><li>发布文件 <a href="https://github.com/xiang578/xiang578.github.io">xiang578/xiang578.github.io: Welcome to My blog!</a>。</li></ul><p>和大部分人一样，这个博客的静态文件保存在 github 的 <a href="http://xiang578.github.io">xiang578.github.io</a> 仓库 master 分支中。但是，我还创建了一个新的分支 hexo，用来保存博客源文件。每一次修改博客源文件之后，我不在本地生成静态文件，而是利用 git 命令，将所有的修改内容推送到仓库中的 hexo 分支。Travis CI 服务监听到新的 push 时，会根据你的配置将 git 仓库拉倒他的服务器上，编译源文件成为静态文件，并推送生成的文件到指定仓库的指定分支中。而且，如果编译静态文件失败，他也会通过邮件通知你结果。</p><p><img src="https://media.xiang578.com/15359362837525.jpg" alt="编译成功截图" /></p><h2 id="流程"><a class="markdownIt-Anchor" href="#流程"></a> 流程</h2><ol><li>将 github 上存放静态博客源文件的仓库拉下来，利用 <code>git checkout -b hexo</code> 创建并进入新的分支，删除分支内所有的文件。</li><li>将博客源文件复制到第一步中的文件夹中。</li><li>添加一个 <code>.travis.yml</code> 文件，文件内容可以参考下一节 Travis-ci 配置文件。</li><li><a href="https://travis-ci.org/">https://travis-ci.org/</a> 提供免费的持续集成服务，可以通过 github 登入，直接选择需要管理相关的项目。</li><li>第一次将源文件上传到 github 时，可能会遇到问题。主题 <code>themes/xxx</code> 是通过 git clone 下载的，无法直接 push 包含嵌套关系的 git 库。<s>删除 themes/xxx/.git</s> 正确的姿势是，最开始就使用 <code>git modules</code> 引用依赖库。所幸还能编辑 <code>.git/config</code>，添加下面几行代码解决：<br /><img src="https://media.xiang578.com/15274942502764.jpg" alt="" /></li><li>打开 <code>themes</code> 对应的 github 网页，你会看到主题链接到其他仓库（其中 @commitid 控制对应的版本）<br /><img src="https://media.xiang578.com/15274943487052.jpg" alt="" /></li><li>完成这样的设置，修改主题文件后，需要先将修改 push 到主题的仓库，然后在博客文件夹下 push 修改到远端仓库（修改依赖的 commitid）。最终，才能再网页上看到修改效果。</li></ol><h2 id="travis-ci-配置文件"><a class="markdownIt-Anchor" href="#travis-ci-配置文件"></a> Travis-ci 配置文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">language: node_js</span><br><span class="line">node_js:</span><br><span class="line">- 9.11.1</span><br><span class="line">cache:</span><br><span class="line">  directories:</span><br><span class="line">  - node_modules</span><br><span class="line">before_install:</span><br><span class="line">- export TZ=&#x27;Asia/Shanghai&#x27;</span><br><span class="line">- npm install hexo-cli -g</span><br><span class="line">install:</span><br><span class="line">- npm install</span><br><span class="line">script:</span><br><span class="line">- hexo clean</span><br><span class="line">- hexo generate</span><br><span class="line">after_script:</span><br><span class="line">  -  git clone https://$&#123;GH_REF&#125; .deploy_git  # GH_REF是最下面配置的仓库地址</span><br><span class="line">  - cd .deploy_git</span><br><span class="line">  - git checkout master</span><br><span class="line">  - cd ../</span><br><span class="line">  - mv .deploy_git/.git/ ./public/ </span><br><span class="line">  - cd ./public</span><br><span class="line">  - git config user.name &quot;xiang578&quot;</span><br><span class="line">  - git config user.email &quot;xiang578@foxmail.com&quot;</span><br><span class="line">  - git add .</span><br><span class="line">  # - git commit -m &quot;Deploy at $(date +&quot;%Y-%m-%d %T&quot;)&quot;</span><br><span class="line">  - git commit -m &quot;Travis CI Auto Builder at `date +&quot;%Y-%m-%d %H:%M&quot;`&quot;</span><br><span class="line">  # Github Pages</span><br><span class="line">  - git push --force --quiet &quot;https://$&#123;CI_TOKEN&#125;@$&#123;GH_REF&#125;&quot; master:master </span><br><span class="line">  # Coding Pages</span><br><span class="line">  # - git push --force --quiet &quot;https://xiang578:$&#123;Coding_TOKEN&#125;@$&#123;CO_REF&#125;&quot; master:master</span><br><span class="line"></span><br><span class="line">branches:</span><br><span class="line">  only:</span><br><span class="line">  - hexo</span><br><span class="line"></span><br><span class="line">env:</span><br><span class="line"> global:</span><br><span class="line">   # Github Pages</span><br><span class="line">   - GH_REF: github.com/xiang578/xiang578.github.io</span><br><span class="line">   # Coding Pages</span><br><span class="line">   # - CO_REF: git.coding.net/xiang578/xiang578.git</span><br></pre></td></tr></table></figure><h2 id="hexo-两个错误"><a class="markdownIt-Anchor" href="#hexo-两个错误"></a> hexo 两个错误</h2><p>在这一次的过程中，又遇到两个本地编译 hexo 的错误，一同记录一下。错误表现如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ERROR Plugin load failed: hexo-renderer-sass</span><br><span class="line">Error: Cannot find module &#x27;node-sass&#x27;</span><br><span class="line">    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:581:15)</span><br><span class="line">   ...</span><br><span class="line">ERROR Plugin load failed: hexo-renderer-scss</span><br><span class="line">Error: Node Sass does not yet support your current environment: OS X 64-bit with Unsupported runtime (64)</span><br><span class="line">For more information on which environments are supported please see:</span><br><span class="line">https://github.com/sass/node-sass/releases/tag/v4.8.3</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure><p>网上的建议是修改 npm 的源地址为淘宝的镜像，并且重新下载这两个包。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo npm config set registry https://registry.npm.taobao.org</span><br><span class="line">npm install hexo-renderer-sass --save</span><br><span class="line">npm install hexo-renderer-scss --save</span><br></pre></td></tr></table></figure><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://blog.csdn.net/qq_23079443/article/details/79015225">用TravisCI持续集成自动部署Hexo博客的个人实践 - CSDN博客</a></li><li><a href="https://segmentfault.com/a/1190000009928515">关于 git-submodule 的一些基本操作 - 个人文章 - SegmentFault 思否</a></li><li><a href="https://www.v2ex.com/t/260832">安装 npm install hexo-renderer-sass --save 出错，有什么办法没 - V2EX</a></li><li><a href="https://blog.csdn.net/xs20691718/article/details/81873921">hexo 发布之后 gitpage 自定义域名失效 - CSDN博客</a></li><li><a href="https://blog.zthxxx.me/posts/Build-Hexo-Blog-by-Travis-CI/">使用 Travis 自动构建 Hexo 到 GitHub | Zthxxx’s Blog</a></li><li><a href="https://juejin.im/post/5afe61f5f265da0b8d422a3e">使用travis-ci自动部署Hexo到github和coding - 掘金</a></li></ul><h2 id="changelog"><a class="markdownIt-Anchor" href="#changelog"></a> ChangeLog</h2><ul><li>180904：完成初稿</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;已切换到 Github Action&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;之前一周在封闭接受公司培训，最重要的任务是熟悉「项目开发全流程」。其中有一点：服务的稳定性。不知道为什么，前几天自己的博客崩溃了，输入域名只能看到 404 页面。当时以</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="hexo" scheme="https://blog.xiang578.com/tags/hexo/"/>
    
    <category term="github" scheme="https://blog.xiang578.com/tags/github/"/>
    
    <category term="travisci" scheme="https://blog.xiang578.com/tags/travisci/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 10 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-10.html"/>
    <id>https://blog.xiang578.com/post/week-issue-10.html</id>
    <published>2018-08-05T08:40:14.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="https://tech.meituan.com/deep_understanding_of_ffm_principles_and_practices.html">深入FFM原理与实践 -</a>：美团技术博客的文章之一，感觉比网上很多文章讲解的都深刻。不知道为什么文章中很多的参考资料都是网上的博文，有点遗憾。</li><li><a href="https://daily.zhihu.com/story/9691148">「华为公积金下调到 5%」，刚毕业的应届生可能不懂，这当中有什么套路</a>：前一段时间的热门，华为真是一家神奇的企业。从奋斗者协议到今天的调整公积金比例，不断地压榨着员工的极限。之前还看到有人说夸华为，至少给得钱对得起员工的时间，这次的调整无疑给已经买房的员工致命一击。</li><li><a href="http://erning.net/blog/2012/07/09/readme-driven-development/">Readme驱动开发 - Erning.write()</a>：这种开发方式又称 RDD。目前在公司开发时，发现大部分项目没有开发文档或者 wiki，项目的内容也只能靠口口相传。造成这样的局面，可能是公司之前发展速度太快。从另外一个角度来说，没有外部的文档是否可以开发人员本身有一些优势，防止被快速的替代？</li></ul><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><ul><li>新奇的创意，通过缺失表达战争造成的伤害。<br /><img src="https://media.xiang578.com/IMG_0664.jpg" alt="IMG_0664" /></li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>我经常骂孙笑川，心机自私膨胀，后来才发现我自己就是孙笑川，骂的都是现实中不争气的自己，人人都是孙笑川，却又都不想当孙笑川。每个人都在骂孙笑川，每个人都恶心孙笑川，因为每个人都知道自己就是孙笑川，但每个人都不想承认自己就是孙笑川。—— 网络时代，每个人都是小丑</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 9 期 看不懂的拼多多</title>
    <link href="https://blog.xiang578.com/post/week-issue-9.html"/>
    <id>https://blog.xiang578.com/post/week-issue-9.html</id>
    <published>2018-07-28T07:07:55.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ol><li><a href="https://mp.weixin.qq.com/s?__biz=MzIyMzg4MzE2OA==&amp;mid=2247483772&amp;idx=1&amp;sn=eac158cf591dca115ec96ac39422293d&amp;chksm=e8163bb3df61b2a5c2c85c35d86dd04e9d396ce6b14782c8b9b3469176d85759af892cec80d3&amp;mpshare=1&amp;scene=1&amp;srcid=07176nUXGlwcQDGmEjHWpHZq%23rd">拼多多的多和少</a>：拼多多应该会在本周上市，这篇文章是上周的微信热门文章之一，也是我见过分析拼多多最仔细的文章。说句实话，我对拼多多了解不多，也没有研究过他们的商业模式，从文章中可以看到拼多多的成长。现在也有一点为当初拒掉拼多多的 offer 而后悔，虽然辛苦但是给的多啊。</li><li><a href="http://malisper.me/my-approach-to-getting-dramatically-better-as-a-programmer/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=rss">My Approach to Getting Dramatically Better as a Programmer – malisper.me</a>：程序员成长相关。常思考两个问题：<ul><li>Learning how to solve problems I didn’t know how to solve before.</li><li>Learning how to write correct programs faster.<br />以及掌握方法：</li></ul><ul><li>Reading a paper.</li><li>Learning a new tool.</li><li>Reading several chapters of a book.</li><li>Recording my screen as I write a program. Then reviewing the footage and seeing how I could have written the program faster.</li></ul></li><li><a href="https://blog.codingnow.com/2018/07/share3.html">云风的 BLOG: 三人合租的房租公平分配方案</a>：现实中我也遇到了租房问题，不过还不太需要这些高深的知识来处理。这篇文章提供了2 、3 人分房的方案。<ul><li>2 人版：A 和 B 分两间房，由 A 写下对两间房的报价，然后由 B 选择自己住哪间房。如果两个人都在理性下完成这个任务，房间的价格会趋向于它本身的价值。</li><li>2 人版另外一种解法：A 和 B 同时写下对两间房的心里价格（两个房间的价格总和一定），然后每间房由开价最高的人居住，每个月需要支付的价格是两个人对这间房子开价的平均值。</li><li>3 人版：这个问题比前面两种情况更加复杂。A、B、C 三个人有不同的职责。<ul><li>A：写下对三间房的报价（报价的总和一定），A 是最后一个选择房间。</li><li>B：首先查看 A 对三间房的报价，思考是否有两间价格是合理的。如果是，那么在 C 选择一个房间后，依然有一个价格合理的房间可以选择。如果不是，那么标记两间他认为价格不合理的房间。</li><li>C：也是查看 A 对三间房的报价，思考是否有两间房的价格是合理的。如果是，那么他可以让 B 先进行选择，即使 B 认为有两间房价格是不合理的，还是有一间价格是合理的，C 也有至少有一间价格合理的房子可以选择。如果不是，那么标记两间价格不合理的房子，如果 B 认为是合理的，让 B 先进行选择，C 第二个进行选择。否则，B 与 C 标记的房子中重复的分给 A ，然后由 B 和 C 进入两人分房间。</li></ul></li></ul></li><li><a href="http://macshuo.com/?p=1454">如何「收集」知识 | MacTalk-池建强的随想录</a>：这一段时间一直思考的如何与知识更好相处的问题，这篇文章可以当成是入门参考，不要陷入研究工具的怪圈，而是找到一个适合自己的知识处理系统。</li></ol><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><ul><li><a href="https://www.youtube.com/watch?v=IeaD0ZaUJ3Y">How to Read a Paper Efficiently (By Prof. Pete Carr) - YouTube</a>：虽然没有去读研究生，但由于工作的性质也需要去大量的阅读论文。这一段小视频在如何读论文这个问题上提出了一种框架化的方法，适合新人去模仿实践。</li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>第三届国际华语辩论公开赛复赛，重温了经典辩题“金钱是不是万恶之源”。正方恐龙复生队对“恶”做了全新的定义：人世间所有的恶，都可以概括为“不把人当人”。—— 有感于前一段时间的疫苗问题，看到这一段文字依旧有力量。</li></ul><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><ul><li><a href="https://github.com/hunkim/DeepLearningZeroToAll">hunkim/DeepLearningZeroToAll: TensorFlow Basic Tutorial Labs</a>：非常好的 tensorflow 教程。另外说一句，利用 tensorflow 来写机器学习真是轻松。</li><li><a href="https://chrome.google.com/webstore/detail/%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%C2%B7%E7%8C%9C%E4%BD%A0%E5%96%9C%E6%AC%A2/ngjddnobeppdekpmimhiamkoonoaccdf">哔哩哔哩·猜你喜欢</a>：BiliBili 的客户端中有一个猜你喜欢的功能，杀时间利器。在信息化的时代，还有什么比调试一个符合自己口味的信息流更有成就感的事情？通过使用这个插件，可以在网页版上实现猜你喜欢功能。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>月读 | 睡眠革命</title>
    <link href="https://blog.xiang578.com/post/Sleep.html"/>
    <id>https://blog.xiang578.com/post/Sleep.html</id>
    <published>2018-07-21T09:28:48.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>前一段时间作息混乱，晚上躺在床上睡不着，然后玩手机，导致更加睡不着。第二天下午又很困，只好趴着睡一会儿。从而导致晚上睡不着又玩手机的恶性循环。当时一度觉得自己都不能从这个圈里面走出来了。不过，想起来之前在少数派看到过一篇文章，推荐过一本和睡眠相关的书——<a href="https://book.douban.com/subject/27023900/">睡眠革命</a>，抱着死马当活马医的心态看了一下。</p><p>书中作者主要介绍昼夜节律、睡眠类型、睡眠周期、睡前醒后、日间小睡、睡眠环境等多个方面的内容，我将自己在阅读时候记录的笔记整理一下，与大家分享。</p><h2 id="核心收获"><a class="markdownIt-Anchor" href="#核心收获"></a> 核心收获</h2><p>读完这本书最大的几个收获：</p><ul><li>人的睡眠类型有两种：早睡类型和晚睡类型。</li><li>失眠是过度清醒造成的，过度清醒又是担心自己会失眠所产生的。</li></ul><h2 id="昼夜节律"><a class="markdownIt-Anchor" href="#昼夜节律"></a> 昼夜节律</h2><p><img src="https://media.xiang578.com/15321615677483.jpg" alt="" /></p><blockquote><p>昼夜节律是生命体24小时的内循环，受我们的内置生物钟的管理。我们大脑中的这一生物钟，24小时调节着我们的多个内部系统，包括睡眠和饮食习惯、激素的分泌、体温、灵敏度、情绪和消化，使其与地球的自转相一致。我们的生物钟是根据一些外部线索而设定的，其中最主要的是日光，此外还包括温度、进食时间等其他因素。</p></blockquote><p>上面是书中的一张插图和一段文字。核心思想是，人的一天活动受自然规律控制，所以要在正确的时间干正确的事情。如同我最开始描述的状态一样，人体内也有一种正常的循环状态。在晚上褪黑素产生的时候，开始准备睡觉，我们会在2~3点时进入一个高效的睡眠阶段，从而在早晨可以按时起床，那么晚上对于睡眠的需求又会达到峰值，为我们再一次提供最佳的入睡时机。</p><h2 id="睡眠类型"><a class="markdownIt-Anchor" href="#睡眠类型"></a> 睡眠类型</h2><p>一直以来，我们的文化都提倡一点：早睡早起。但是在现实中，我们很多人却很喜欢睡懒觉。作者在书中指出，从基因上来看，人的睡眠分成两类：早睡早起类型 和 晚睡晚起类型。不应该强制两类人在相同的时间躺下和起床，而是寻找最合适他们的睡眠规律，如果昼夜节律图中描述的内容一样。当然，作者强调需要严格遵守自己的睡眠规律，不要轻易的打破，比如周末睡懒觉之类的。</p><blockquote><p>睡眠类型：智慧睡眠的7个要点<br />1．了解你和你的亲朋好友属于哪种睡眠类型。如果你不能确定，可以使用慕尼黑大学的问卷调查表。<br />2．巧妙规划好你一天的日程，在你状态最佳时做最重要的工作。<br />3．把咖啡因当成高效的表现增强剂使用，而不是出于习惯去喝咖啡，并且一天的咖啡因摄入量不要超过400毫克。<br />4．晚睡星人——如果你想要克服社交时差，就不要在周末睡懒觉。<br />5．在会议室、办公室和办公桌配置日光灯，提高员工的灵敏度、工作效率，并改善他们的工作情绪。<br />6．知道何时该上前、何时该退后。如果你是一个早起型的人，那么你该不该自告奋勇地在深夜比赛中参加点球大战呢？<br />7．如果你和你的伴侣属于不同的睡眠类型，你们应该学会彼此协调、彼此适应。</p></blockquote><h2 id="睡眠周期"><a class="markdownIt-Anchor" href="#睡眠周期"></a> 睡眠周期</h2><p>在我们的常识中，一直有一个8小时的推荐睡眠时间。作者澄清，8小时是每晚人均睡眠时间，一味追求8小时的睡眠会造成巨大的压力，反而对我们的睡眠起着破坏性极强的反作用，让我们无法获得真正需要的、因人而异的睡眠时间。</p><p>作者提倡一种新的睡眠时间方法：</p><blockquote><p>“R90”指的是以90分钟为一个周期，获得身体修复。“90”这个数字，并不是我从1—100中随意选择的。从临床上说，90分钟是一个人经历各个睡眠阶段所需的时间。这些睡眠阶段组成了一个睡眠周期。 我们的睡眠周期由4个（有时是5个）不同的睡眠阶段组成。你可以把度过不同的睡眠阶段、完成一个睡眠周期的过程，想象成走下几段楼梯、完成一段行程。当我们关灯上床、准备睡觉时，就像站在这几段楼梯之上，而想要得到的深睡眠，就像走到了这几段楼梯之下。</p></blockquote><p>实践这个 R90 睡眠方法的关键是，对睡眠进行统计。以周为统计周期，争取每周达到 35 个睡眠周期。然后根据自己的工作性质，确定一个固定的起床时间，反向推导出你应该在什么时候入睡。</p><h2 id="睡前醒后"><a class="markdownIt-Anchor" href="#睡前醒后"></a> 睡前醒后</h2><p>一般而言，我们只关心什么时候睡觉，而忽视了睡眠前以及醒来后的90分钟。从作者观点来看，应该利用好这一段时间，提高睡眠的质量。</p><blockquote><p>睡眠前后的例行程序：智慧睡眠的7个要点<br />1．睡眠前后的例行程序将直接影响你睡眠的质量，以及你清醒的一天：如果予以重视，整个白天和整个晚上就会更加高效。<br />2．在日间偶尔脱离电子设备，将此作为一种犒劳，并通过这种方式训练你的身体和心灵。<br />3．对于晚睡星人来说，睡眠后例行程序至关重要，如果他们不想输给早起星人的话。不要因为青睐于止闹按钮，而轻易放弃这些睡眠后例行程序。<br />4．不要在头脑不清醒的时候发送消息！先让自己清醒一点，再去拿手机。<br />5．让你的身体感受从温暖到凉爽的变化，有利于带来自然的体温下降。快速洗个温水浴，然后选择较凉爽的睡眠环境，能帮助你达到目的。<br />6．在上床前整理你的卧室，放空你的大脑，“下载”你的一天，就不会在该睡觉的时候想东想西、难以入眠。<br />7．执行睡眠前例行程序，是为了结束过去的一天——用鼻子呼吸、放松心情、实现从明亮到昏暗的过渡。执行睡眠后例行程序，是为了开启不匆不忙的新一天。这两段时间都只属于你，不属于别人。</p></blockquote><h2 id="日间小睡"><a class="markdownIt-Anchor" href="#日间小睡"></a> 日间小睡</h2><p>日间小睡分成两个部分：午睡以及傍晚的小憩。这一部分的睡眠的作用是对夜晚睡眠周期的补充，一般而言30分钟的小睡可以媲美晚上的一整个睡眠周期。</p><p>书中引用到美国国家航空航天局的一项调查专门研究了日间小睡的功效，在对执行长途飞行的飞行员进行调查后，他们得出结论：“日间小睡有助于维持或改善随后的表现，提高生理和心理的灵敏度，并能有效改善情绪。”</p><blockquote><p>日间小睡：智慧睡眠的7个要点<br />1．利用午后休憩时机（下午1—3点）给自己安排一个可控修复期，是弥补夜间睡眠周期的完美方法，这也与你的昼夜节律彼此协调。<br />2．黄昏（下午5—7点）是次优的休憩时机，因为此时人的睡眠需求极高。但这一时段的日间小睡应控制在30分钟之内，这样才不会影响晚上的睡眠。<br />3．白天睡不着？没关系。只要花30分钟放松一会儿，暂时脱离周围的世界片刻。<br />4．至少每隔90分钟休息一会儿，消除大脑的疲劳，提高注意力的集中水平。在休息时不要使用电子设备，你无需让自己自始至终地受到电子设备的控制。<br />5．不要受到你所在的企业文化的影响，切莫先入为主地给那些白天睡觉的人贴上“懒惰”的标签，而应着手构建一种接受日间小睡和休憩的企业文化——你若不打盹儿，就会输得很惨。<br />6．使用冥想或正念应用软件，或者把玩某个珍爱的私人物品，暂时脱离当前的环境。<br />7．如果你真的无法脱身，那就巧妙地安排一天的工作。在午后倦怠期，不要让自己困于太费神的工作</p></blockquote><h2 id="睡眠环境"><a class="markdownIt-Anchor" href="#睡眠环境"></a> 睡眠环境</h2><p>上面讲了那么多，都是一些比较虚的东西，最后分享一些作者对于睡眠环境的建议。首先一点，作者提倡在卧室中尽量只睡觉，不干其他活动。其次，作者提倡采用像婴儿一样的侧卧睡眠方式，要点包括：膝盖自然弯曲、两条手臂放在身前，并轻轻交叠在一起，颈部、脊柱和臀部形成一条平滑的直线。</p><p>最后，是一些关于寝具套装选择的建议：</p><blockquote><p>1．学会以胎儿姿势睡眠，躺向非主要的身体一侧（惯用左手的人向右侧睡，惯用右手的人向左侧睡）。<br />2．检测床垫，了解什么样的床垫对你来说软硬适中。让你的伴侣也这样做。<br />3．循序渐进：7年间分两次各花500英镑在你的床垫上，而不是一次花1000英镑。可以考虑购买能够经常换洗的床垫。<br />4．使用低过敏性、透气舒适的床上用品，无论你是否属于过敏体质。避免潜在的睡眠障碍因素，并注意调节好温度。<br />5．床的尺寸很重要——能买多大，就买多大。特大号床垫是值得一对儿夫妇考虑的最小型号（只要卧室中放得下）。双人床是给一个人睡的。<br />6．不要盲目购置寝具！可以根据销售人员的介绍，了解你能买到什么样的寝具。但在做出最后决定时，记得运用你在本章中学到的知识。<br />7．记住床垫和床架重要性比率：你可以把100％的预算全部花在购置床垫上，因为床架主要是装饰性的</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前一段时间作息混乱，晚上躺在床上睡不着，然后玩手机，导致更加睡不着。第二天下午又很困，只好趴着睡一会儿。从而导致晚上睡不着又玩手机的恶性循环。当时一度觉得自己都不能从这个圈里面走出来了。不过，想起来之前在少数派看到过一篇文章，推荐过一本和睡眠相关的书——&lt;a href=&quot;h</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="Sleep" scheme="https://blog.xiang578.com/tags/Sleep/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 8 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-8.html"/>
    <id>https://blog.xiang578.com/post/week-issue-8.html</id>
    <published>2018-07-20T13:37:00.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ol><li><p><a href="https://mp.weixin.qq.com/s/FoyDuO_iTxfp1gltRi97Zw">唐爽：坦途的人生有时候经不起一次搭错车</a>：前一段时间很火的周立波事件，当事人之一回复，唐爽说的话很有逻辑，不愧是博士。</p></li><li><p>德鲁克谈《自我管理》——《哈佛商业评论》史上最受欢迎的文章(某些原因不提供链接，拿关键字搜索一下就可以找到原文)：开始工作之后，越来越关注自我提升的内容。</p></li><li><p><a href="http://blog.richardweitech.cn/2018/07/01/use-zsh/">Shell 中的极品-- Zsh - Richard Wei</a>：推荐的几个插件都很有用，shell 的美观程度又提高了一个层次。</p></li><li><p><a href="https://www.phodal.com/blog/evolution-how-to-practise/">演进：在工作的前三年里快速成长（练习篇） - Phodal | Phodal - A Growth Engineer</a>：职业成长系列。</p></li></ol><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>为什么越长大觉得时间过得越快？因为小时候是在发现发掘，而长大后是在不断重复。“有的人30岁就死了，80岁才埋葬。”这句话说的就是这个理，小时候，我们把一年过成了365天，长大后，我们把一年过成了365次。“回程总比去程快”佐证了一件事情：“时间”和我们接收了多少信息有关——信息能够延长时间。</li><li>区块链是一种分布式数据存储、点对点传输、共识机制、加密算法等计算机技术的新型应用模式，这是一个典型的去中心化应用，建立在 p2p 网络之上。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 7 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-7.html"/>
    <id>https://blog.xiang578.com/post/week-issue-7.html</id>
    <published>2018-07-15T23:05:03.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="https://ift.tt/2EV2F86">I have forgotten how to read</a>：碎片化时代对于阅读的反思。</li><li><a href="http://blog.devtang.com/2016/06/05/tech-talk-notes/">技术演讲中最容易被忽视的问题</a>：参考文章，内容不错</li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>感谢大学四年里遇到的所有人，或萍水，或至交；或平平淡淡四年的柴米油盐，或惊鸿一瞥不期的遇见；或心酸的讥讽，不屑的嘲笑；或热情的洋溢，真心的赞美；所有形形色色的人和林林总总的事，无论是相逢于青山绿水还是最终相忘于江湖，感谢你们漫步庭前看花谢，坐卧塔下笑清风。人生匆忙，百年过往，他日相逢，此情莫忘。泛菊杯深，吹梅角远， 同在京城，聚散匆匆， 教人怎不伤情？ 觉几度，魂飞梦惊。 后夜相思，尘随马去，月逐舟行。诸位，一世顺意！（毕业论文结束语）</li><li>直到毕业的时候我才明白，当你要致谢的人和环境并没有那么美好时，有些话是无论如何都说不出口的。于是乎，我也使用了前人的套路，留下几句客套话后便匆匆赶往下一站了。</li><li>高考做错的每一道题，都是为了遇见对的人。</li><li>那些办公室的白领们，总是自以为自己的表现领先于父母。认为父母落伍了……其实，这不过是因为经济结构转型造成的误会而已。 现在各种写字楼里格子间里，哼哧哼哧做重复 ppt 的年轻人，和当年踩着缝纫机的女工们，其实没有本质区别。 同理，当年父母在菜场讨价还价，多一份还是少一分，和现在年轻人在群里争先恐后的抢红包，状态也都差不多。 父母当年非要给电视剧遥控器套个塑料袋，和现在年轻人非要给手机套个壳差不多。 当然，现在每天拿着手机刷朋友圈和微博的人，和当年蹲在墙角嗑瓜子的人，也没什么区别！ 点评：从某种意义上来说，社会从未改变。它只是在不停的轮回。所谓的变化，只不过是外在形式和工具而已。 也同样，随着新一轮经济的转型，这些在写字楼里做 PPT 的白领，也即将重复当年那些纺织女工被淘汰时的情景……</li><li>互联网时代的学习，学得太多，做得太少。恰恰正是“学习”知识剥夺了我们实践和内化知识的机会。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>我常用的自动化流程</title>
    <link href="https://blog.xiang578.com/post/auto-workflow.html"/>
    <id>https://blog.xiang578.com/post/auto-workflow.html</id>
    <published>2018-07-07T06:09:22.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<h2 id="什么是自动化"><a class="markdownIt-Anchor" href="#什么是自动化"></a> 什么是自动化</h2><p>日常工作学习中，我们需要使用不同的工具来应对各种各样的任务。比如，用印象笔记收集网页，利用图库管理博客中的图片。但是，由于大部分工具不是同一家公司发布的，彼此之间很难进行简单的协作。如果你有编程能力，可以利用很多工具提供的 API（应用程序接口），让信息在不同的软件中流动。<br />对于普通人而言，目前市面上也有很多 App 提供这种功能，可以解决少部分的问题。我对这些功能的定义就是自动化流程，通过使用这些功能，可以减少一些重复机械的工作，使我们更好的享受生活。老罗在吹锤子系统时，提到过「One Step」，在我心目中也是自动化的一种。自动化流程指的是我自己在实践中，配置的一些软件使用流程。</p><h2 id="workflow"><a class="markdownIt-Anchor" href="#workflow"></a> Workflow</h2><p>Workflow (新手入门请看<a href="https://sspai.com/post/43849">iOS 效率神器 Workflow 怎么用？跟着这篇入门指南从零开始 | 新手问号</a>）是 iOS 上的一款自动化软件。似乎是去年被苹果收购，现在在 App Store 中可以免费下载。前一段时间的 WWDC 上，也公布了进行版本，能利用 Siri 的「捷径」App。</p><p><img src="https://media.xiang578.com/15309425389934.jpg" alt="" /></p><p>在 iPhone 上，我最常用的 workflow 动作是碎片知识摘记，实现利用 iPhone 阅读时，将值得多次阅读的内容，集中保存到印象笔记中。有关这个动作更多的介绍可以查看 <a href="https://sspai.com/post/35281">Workflow + 印象笔记，定制高效碎片知识管理工作流 | Matrix 精选 - 少数派</a>。</p><p>《奇特的一生》在时间管理领域如雷贯耳，很多人都按照柳比歇夫的那种方法进行时间。如果你希望可以使用 Workflow 来记录时间，可以进一步阅读少数派中 <a href="https://sspai.com/post/44579">想学柳比歇夫？用这个Workflow来帮你一把</a>。</p><p>最后，授人以鱼不如授人以渔，少数派的 <a href="http://workflow.sspai.com/#/main/workflow">Workflow Gallery</a> 提供很多相关的工作下载，可以自行前往挑选。</p><h2 id="aflred"><a class="markdownIt-Anchor" href="#aflred"></a> Aflred</h2><p>Aflred 是 Mac 上的一款效率工具。之前我在自己的博客中也有分享过，<a href="https://xiang578.com/2017/07/02/alfred-lists/">Alfred 使用记录 - RyenX</a>。这里，我就补充介绍几个自己目前在用的功能。</p><p>由于我平时是使用 Markdown 进行写作的，难免会遇到需要插入很多链接的时候，比如现在正在写的这一篇文章。Afled 中有一个 workflows 「<a href="https://github.com/fallroot/copy-url-for-alfred">fallroot/copy-url-for-alfred</a>」，通过这个动作可以将 Chrome 或者 Safari 中的当前正在浏览的网页的标题以及网址以 Anchor 、URL、Title、Markdown 等多种形式复制到当前的输入框或者是剪贴板。<br /><img src="https://media.xiang578.com/15309430608042.png" alt="" /><br /><a href="https://github.com/ngreenstein/alfred-process-killer">ngreenstein/alfred-process-killer: An Alfred 2 workflow that makes it easy to kill misbehaving processes. It is, in essence, a way to easily find processes by name and kill them using <code>kill -9</code>.</a>：快速结束 Mac 中的某些进程。<br /><img src="https://media.xiang578.com/15309434519054.jpg" alt="-w607" /></p><h2 id="ifttt"><a class="markdownIt-Anchor" href="#ifttt"></a> IFTTT</h2><p>Workflow 和 Aflred 需要在自己的 iPhone 或者 Mac 上才可以运行，说起来多少还有些不自动。我经常使用的另外一个自动化服务「<a href="https://ifttt.com/">IFTTT</a>」就可以解决这个问题。IFTTT 是什么？它是英文 <strong>IF This Then That</strong> 的首字母缩写，它是一个提供自动化服务的网站。它的功能可以从字面猜测出来大概，完整地解释是「如果A完成事件1，那么就让B完成事件2」。简单来说，你可以通过设置一些规则，让它帮你自动完成一些重复工作。比如设置规则实现当你发布一条微博后，IFTTT 自动将微博同步到印象笔记中。所以，IFTTT 对我的意义是将不同的应用连接在了一下，方便我造各种工作流。</p><p><img src="https://media.xiang578.com/15309318778409.png" alt="" /></p><p>与上面的形式相同，继续介绍一下我目前在使用的规则。</p><h3 id="碎片阅读"><a class="markdownIt-Anchor" href="#碎片阅读"></a> 碎片阅读</h3><p>互联网的发展，使每个人有更多表达自己的机会，越来越多的人开始通过文字展示自己。碎片阅读指的正是阅读这些散落在不同平台上的文章。对于我而言，一般是先将在网上看到的想要阅读的文章放到稍后读软件 <a href="https://getpocket.com/">Pocket</a> 中。之后在自己空闲时，打开 Pocket 网站阅读。比起直接阅读这样的好处有二：</p><ol><li>不是每一个网站或者平台都有良好的阅读环境，比如很多广告、字体字号。</li><li>Pocket 提供丰富的 API 接口，通过 IFTTT 可以很好的和 Evernote、Airtable 等软件写作。</li></ol><p><a href="https://ifttt.com/applets/79292089d-if-new-favorite-item-then-append-to-a-note-in-evernote">If New favorite item, then Append to a note in Evernote - IFTTT</a>：古语「不动笔墨不读书」，很多文章有值得记录地方，而且也希望可以将自己所做的笔记集中在一处。针对这个问题，很多人会复杂，并且再粘贴到某一个文档中。这种方法做起来简单粗暴，却打断了阅读的连续性。通过我这个动作，可以将在 Pocket 中高亮的句子，直接添加到印象笔记的一条特定笔记中。</p><p><img src="https://media.xiang578.com/15309335067450.jpg" alt="印象笔记中效果" /></p><p><a href="https://ifttt.com/applets/75619425d-if-item-archived-then-create-record-in-airtable">If item archived , then create record in airtable</a>：这一个动作是实现阅读数据的统计，当我在 Pocket 中归档一篇文章之后，会在 Airatble 指定的表单里添加一条相关的阅读记录。</p><p><img src="https://media.xiang578.com/15309336298823.jpg" alt="Airtable record" /></p><h3 id="任务管理"><a class="markdownIt-Anchor" href="#任务管理"></a> 任务管理</h3><ul><li><a href="https://ifttt.com/applets/75605766d-github-issues-assigned-to-me-todoist">Github issues assigned to me Todoist</a>：这个规则可以实现，在 Github 中有人分配给我 issue 时，自动在 Todoist 中创建相关任务。</li><li><a href="https://ifttt.com/applets/75612887d-log-completed-todoist-tasks-to-airtable">Log completed Todoist Tasks to Airtable</a>：记录所有完成的任务到 Airtable 中。</li><li><a href="https://ifttt.com/applets/75612567d-if-todoist-task-with-label-is-completed-create-new-task">If Todoist task with label is completed, create new task - IFTTT</a>：实现 Todoist 中的任务循环。</li></ul><h3 id="创意"><a class="markdownIt-Anchor" href="#创意"></a> 创意</h3><p>IFTTT 中有一个与 RSS 相关的触发器，而且如下图所示，提供了对文章进行关键字匹配的选项。<br /><img src="https://media.xiang578.com/15309338021730.jpg" alt="IFTTT RSS" /></p><p>前一阵子是 618 年中大促，正好我想购买一个 QC35 的耳机。为了追求优惠，大部分人会不停的查看想购买商品的页面，看看有没有什么新的变化。而我利用 IFTTT 搞了一个监控 QC35 全网优惠的监控。具体思路如下：什么值得买中有一个<a href="https://www.smzdm.com/jingxuan/">精选好价</a>的频道，很多人会在上面爆料商品的优惠信息。幸运的是，这个频道提供 RSS 订阅链接。所以，配合上面提到的 RSS 相关触发器，我写了 <a href="https://ifttt.com/applets/75671738d-if-new-feed-item-matches-qc35-from-http-faxian-smzdm-com-feed-then-send-me-an-email-at-xiang578-foxmail-com">If new feed item matches ‘qc35’ from http://faxian.smzdm.com/feed, then send me an email at xiang578@foxmail.com - IFTTT</a> 以及 <a href="https://ifttt.com/applets/75621100d-if-new-feed-item-matches-qc35-from-http-feed-smzdm-com-then-send-me-an-email-at-xiang578-foxmail-com">If new feed item matches ‘QC35’ from http://feed.smzdm.com, then send me an email at xiang578@foxmail.com - IFTTT</a> 两个规则。从而实现，有人爆料 QC35 相关的价格优惠时，我会收到一条由 IFTTT 发送的邮件。</p><p><img src="https://media.xiang578.com/15309346475002.jpg" alt="qc" /></p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2><ul><li><a href="https://sspai.com/post/43731">玩转 IFTTT，互联网自动化也可以很简单 - 少数派</a></li></ul><h2 id="changelog"><a class="markdownIt-Anchor" href="#changelog"></a> Changelog</h2><ul><li>20180707：完成初稿</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;什么是自动化&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#什么是自动化&quot;&gt;&lt;/a&gt; 什么是自动化&lt;/h2&gt;
&lt;p&gt;日常工作学习中，我们需要使用不同的工具来应对各种各样的任务。比如，用印象笔记收集网页，利用图库管理博客中的图片。但是，由</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="workflow" scheme="https://blog.xiang578.com/tags/workflow/"/>
    
    <category term="alfred" scheme="https://blog.xiang578.com/tags/alfred/"/>
    
    <category term="ifttt" scheme="https://blog.xiang578.com/tags/ifttt/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 6 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-6.html"/>
    <id>https://blog.xiang578.com/post/week-issue-6.html</id>
    <published>2018-07-07T02:06:17.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="卡片写作"><a class="markdownIt-Anchor" href="#卡片写作"></a> 卡片写作</h2><h3 id="熊猫慢递"><a class="markdownIt-Anchor" href="#熊猫慢递"></a> 熊猫慢递</h3><p>上周《纪实72小时》，北京熊猫慢递。写给未来的一封这个概念很早就接触过，自己之前也尝试写过。再看那封信会有一些伤心，辜负了过去努力的自己。有一段时间为了使自己在考试时集中注意力，都会在试卷写上一句，不要辜负过去点点滴滴的努力。有机会，就去这个熊猫慢递写给两年后的自己一封信。</p><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="http://ifoxfactory.com/2017/01/17/2016-and-My-Digital-Life/">细枝末节都交给 App，我只负责享受生活 | 2016与我的数字生活 - 沨沄的博客 | FoxGeeker Blog</a>：博主从意识到数字生活开始的一系列改变，文章内容很充实。</li><li><a href="https://zhuanlan.zhihu.com/p/38850313">LPL心理教练黄菁：“心”备竞赛（上）——RNG的锐变</a>：看了半年多的 LPL，了解一下背后的故事。</li><li><a href="http://ishanshan.top/selfedu/HbOutputOwetoWorkFlowy.html">卡片助力输入输出，工具我选 WorkFlowy | ishanshan’s blog</a>：使用印象笔记之后，创建了很多只有几句话的笔记。这种情况下印象笔记很难管理，需要去寻找另外一个工具，有幸发现 Workflowy 这类大纲软件。</li><li><a href="http://ishanshan.top/selfedu/TipsWeekly.html">用心写周报的同事，绩效不会太差 | ishanshan’s blog</a>：与上一篇文章的作者相同，最近自己也要入职了，拿这一篇文章来参考一下，其实不光工作可以写周报，学习也可以尝试写周报，反思是取得进步的途径。题外话，作者是来自开智学堂的，从我侧面的一些了解，这家公司对于工作规范要求比较高，也可以当成数字生活的参考。</li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>哪里会有人喜欢孤独，不过不喜欢失望。（挪威森林）</li><li>感谢大学四年里遇到的所有人，或萍水，或至交；或平平淡淡四年的柴米油盐，或惊鸿一瞥不期的遇见；或心酸的讥讽，不屑的嘲笑；或热情的洋溢，真心的赞美；所有形形色色的人和林林总总的事，无论是相逢于青山绿水还是最终相忘于江湖，感谢你们漫步庭前看花谢，坐卧塔下笑清风。人生匆忙，百年过往，他日相逢，此情莫忘。泛菊杯深，吹梅角远， 同在京城，聚散匆匆， 教人怎不伤情？ 觉几度，魂飞梦惊。 后夜相思，尘随马去，月逐舟行。诸位，一世顺意！</li><li>直到毕业的时候我才明白，当你要致谢的人和环境并没有那么美好时，有些话是无论如何都说不出口的。于是乎，我也使用了前人的套路，留下几句客套话后便匆匆赶往下一站了。</li><li>高考做错的每一道题，都是为了遇见对的人。</li></ul><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><ul><li><code>Mweb 3</code>：是 Mac 上一款专业的 markdown 写作软件。目前，我自己用它来管理平时的卡片写作、机器学习笔记以及博客文章更新。最近，这个软件正在搞首发优惠，比较惊喜得是发现软件中隐藏的沉浸模式。<br /><img src="https://media.xiang578.com/15307063751497.jpg" alt="Mweb3" /></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;卡片写作&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#卡片写作&quot;&gt;&lt;/a&gt; 卡片写作&lt;/h2&gt;
&lt;h3 id=</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 5 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-5.html"/>
    <id>https://blog.xiang578.com/post/week-issue-5.html</id>
    <published>2018-06-29T23:52:43.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ol><li><a href="https://sspai.com/post/45442">想尝鲜 iOS 12，请先看这份 Public Beta 升降级指南 - 少数派</a>：前几周就尝试开发者预览版了，升级之后，明显可以感觉到流畅度的提升，而且也多了屏幕时间等一些统计数据。</li><li>澎湃新闻的英文版发表这篇 <a href="https://ift.tt/2N7NQTA">Outside the Green Bubble of China’s Super-App</a>，介绍一些人为什么要逃离微信？从自己的角度来看，这一年多以来，加了很多好友和群，有时候打开微信就是一排的群消息，不想看又不好退群，朋友圈还能通过屏蔽来净化。不可否认微信已经成为一个超级 APP，更进一步可以说是小型操作系统。手机只要能装上微信，几乎可以不安装其他软件。但是一群人却反其道而行之，接受种种的不变从而达到放弃微信。微信最大的问题是封闭，公众号中的文章很难被外部检索，人为的造成了一些信息的孤岛。第二就是野蛮，从最早朋友圈封杀支付宝，到现在的抖音、今日头条，完全不顾用户的感受。最后一点是自由，聊天消息被监控，严重的会转移到司法机关处理。以及谣传利用聊天数据进行广告推荐。不知道有没有其他一款通讯软件能挑战微信的地位。</li><li><a href="http://blog.devtang.com/2016/06/05/tech-talk-notes/index.html">技术演讲中最容易被忽视的问题 | 唐巧的博客</a></li></ol><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><ul><li>推特上新学到的名词：无产中产阶级，自己也将成为其中的一员，却又没有机会逃离。<br /><img src="https://media.xiang578.com/DgHl0dzV4AA1pxP.jpg" alt="无产中产阶级" /></li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ol><li><p>能脱离原来的阶层思考问题，却与家人朋友有更深的隔阂，却依旧在贫穷与疾病里挣扎。命运并没有改变，只是更理解命运的无奈而已。</p></li><li><p>功利性的学习是对知识的一种浪费，异化的知识观念让学习变成了一场场知识与世俗的交易。</p></li><li><p>如今的朋友圈已经成为了每个人自我形象塑造和对外表达的关键平台。</p></li><li><p>一方面，优质教育资源可以向更广泛的地区辐射，惠及有需要的人群。另一方面，师生关系不再如以往那般界限分明。每个人都是相互学习、共同成长的分享者与传播者。</p></li><li><p>大多数互联网和技术人都还是有种理想主义情怀（非贬义）在身上的；我们希望通过技术让世界更好，我们也希望能把前辈留给我们的那个包容开放自由的互联网传承下去，有些先驱们甚至用生命捍卫了这些价值与理念。</p></li></ol><h2 id="卡片写作"><a class="markdownIt-Anchor" href="#卡片写作"></a> 卡片写作</h2><h3 id="派出所的故事"><a class="markdownIt-Anchor" href="#派出所的故事"></a> 《派出所的故事》</h3><p>这几天一直在看《派出所的故事》，电视剧由《炊事班的故事》原班人马打造，每个人的性格也差不多继承。看完这部剧的第一感受，艺术源于生活，又高于生活，所有的巧合都集中发生。不过后来仔细一下，这部电视剧也是奶头乐中的一种，没有深度可以思考的内容。</p><h3 id="地下交通站"><a class="markdownIt-Anchor" href="#地下交通站"></a> 《地下交通站》</h3><p>这两天又高强度看完了一部情景喜剧《地下交通站》。这部片子以抗战时期河北安邱（虚拟）的鼎香楼为背景，展示我军情报人员如何与敌人斗志斗勇的故事。情节虽然短平快，却难逃抗日篇的通病，敌我黑白分明，好人聪明机智，某些特殊的还出场自带BGM，坏人这是一事无成。或许我能得出这种结论是因为站在了全知视角，没有将自己代入到故事中。有趣的一点，最近看的电视剧，经常发现某些演员重复出现，弹幕则疯狂地刷这个人之前的台词，为观剧添加了更多的期待。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 4 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-4.html"/>
    <id>https://blog.xiang578.com/post/week-issue-4.html</id>
    <published>2018-06-23T15:29:43.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><ul><li><a href="https://github.com/fouber/blog/issues/41">一个程序员的成长之路 · Issue #41 · fouber/blog</a>：之前一直在思考如何将一些分享展示出来，从这篇文章中得到启发，将 ppt 全部转换成图片，并且配上文字解说。</li><li><a href="https://zhuanlan.zhihu.com/p/22341499">超一流作家的写作利器：用卡片提升创意的密度</a>：卡片写作法，下一个阶段学习的重点之一。离线杂志的内容和形式也很有趣，不过目前停更了。</li><li><a href="https://mp.weixin.qq.com/s?__biz=MzA4NzUxNTg5Mw==&amp;mid=2649549496&amp;idx=2&amp;sn=aa54043a09cdd891f9fcefd4e244e12f&amp;chksm=88207d22bf57f434122140d7a7281b0d029080c03805ddb7a4162fdd0887d7eee85cd2c926bc&amp;mpshare=1&amp;scene=1&amp;srcid=0613j7fnLgnawhapF8eNkTRg%23rd">校长钟晓敏寄语2018届毕业生：拥抱时代，创造幸福</a>：毕业季，贴出自己学校校长的毕业典礼演讲稿。从内容上来说平淡无奇，毫无在互联网上火爆的可能。听完之后，只记下了一句「我们每个人都是由自己一再重复的行为所铸造的。因而优秀不是一种行为，而是一种习惯。」</li></ul><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><ul><li>微博中图片，有一种共建二流的错觉。好的学校创建世界一流，普通学校创建国内一流，就没有安心当二流的学校。<br /><img src="https://media.xiang578.com/697c1dc3gy1fsg9wk289aj21400u0di3.jpg" alt="697c1dc3gy1fsg9wk289aj21400u0di3" /></li></ul><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><ul><li><a href="https://www.youtube.com/watch?v=YXW6GxYafp8">2018世界杯足彩竞猜：一个稳赚不赔的方法是什么？李永乐老师教你足球彩票对冲套利（2018最新） - YouTube</a><br />最近世界杯，网上一大堆赌球的截图。这个视频虽然标题写的是稳赚不赔的方法，看完这个方法的数学原理之后才发现足彩公司的强大。<br /><img src="https://media.xiang578.com/Jietu20180619-162246.jpg" alt="Jietu20180619-162246" /></li></ul><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><ul><li>这一改革，适应新时代我国社会主要矛盾的变化，聚焦发展所需、基层所盼、民心所向，为的就是建设服务型政府，更好服务人民，更加让人民满意。</li><li>［一棵妒忌另外一棵树，恨不得自己变成斧头］：雪山下有一只二头鸟名为共命鸟，其两头分别值守日夜彼此轮流休息。由于一个头总是得享美味果实，另一头心生嫉恨，于是吞下毒果，两头同归于尽。</li><li>大多数互联网和技术人都还是有种理想主义情怀（非贬义）在身上的；我们希望通过技术让世界更好，我们也希望能把前辈留给我们的那个包容开放自由的互联网传承下去，有些先驱们甚至用生命捍卫了这些价值与理念。</li><li>但是作为个人，我希望的互联网应该是更开放的，这也是为什么我们会说微信做的不好：因为互联网应该让信息更流通，而非人为地制造信息孤岛。</li><li>一个人是有多自恋，才会觉得几十光年以外，老久以前发生的天文现象，就为了暗示他的人生里的那点事。</li></ul><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><ul><li>autojump：命令行中实现目录快速跳转</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>007 践行反思</title>
    <link href="https://blog.xiang578.com/post/007-aciton-reflection.html"/>
    <id>https://blog.xiang578.com/post/007-aciton-reflection.html</id>
    <published>2018-06-21T14:24:31.000Z</published>
    <updated>2024-05-12T11:15:03.461Z</updated>
    
    <content type="html"><![CDATA[<p>写这篇文章之前，查看了一下 007 公众号里面的数据，加入 83 班已经 134 天。但是自我感觉出了一些问题，借这次作业反思一下。</p><h2 id="问题"><a class="markdownIt-Anchor" href="#问题"></a> 问题</h2><ol><li>主题。刚开始践行的时候，为了解决每周量产一篇文章的问题，自己想过每月文章主题的安排，但是现在更多地是随心所欲。</li><li>拖延。最近几次作业，虽然很早就知道要写什么内容，但是总拖到最后一天才打开会电脑开始写。</li><li>评论。说点题外话，由于自己一直有独立博客，所以认为评论数量是评价一个博客质量的标准。对上下楼文章的评论，也是 007er 每周作业中一个重要环节。其实每周对战友的评价很多时候是草草了事，蛮对不起战友的。</li><li>写作流。写作流属于工作流中的一个概念，工作流是一种规范化重复劳动的方法。刚开始有想过写作流，但也没有按照之前所写的实践。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">## 写作工作流</span><br><span class="line"></span><br><span class="line">1. 输入环节：通过阅读寻找灵感</span><br><span class="line">2. 加工整理：通过印象笔记里面的积累，来拓展思路</span><br><span class="line">3. 建立体系：搭建思考框架，通过回答 Why，What，How，How Good</span><br><span class="line">4. 写作输出</span><br><span class="line">    1. 快速输出草稿，使用录音宝App，口头费曼</span><br><span class="line">    2. 卡片式费曼，番茄工作法，幕布列出大纲</span><br><span class="line">    3. 文字素材迭代，文章中引入准确的数据、翔实的事例、有说服力的论述和观点</span><br><span class="line">    4. 图片素材及排版，复制html文本到简书中（图片设置居中）</span><br><span class="line">    5. 校对</span><br><span class="line"></span><br><span class="line">## 写作工作流 </span><br><span class="line">1. 收集资料</span><br><span class="line">2. 使用幕布列出大纲</span><br><span class="line">3. 按照大纲生成初稿</span><br><span class="line">4. 修改初稿</span><br><span class="line">5. 按照少数派稿件要求修改初稿并校对</span><br><span class="line">6. 以 html 格式复制到简书，在博客上发布</span><br><span class="line">7. 如果还发现错误，只修改博客上的文本</span><br></pre></td></tr></table></figure><h2 id="反思"><a class="markdownIt-Anchor" href="#反思"></a> 反思</h2><p>针对上面发现的问题，自己想了一下解决的方案。</p><p>根据自己的特点，整理出四个主题。未来以月为单位，每周写其中的一个主题相关文章。主题如下：</p><ol><li>月读：整理分享本月所读的一本书</li><li>卡片写作法：前几天加入的《笨方法学写作》课程，需要完成教练所提供的习题</li><li>数字生活：我的效率类软件实践。</li><li>机器之心：下一阶段学习的重点，机器学习入门的笔记。</li></ol><p>关于拖延。每月确定这个月需要写的文章类型，在写作软件中搭好框架，争取每天写一点。更重要的，预留出一些文章作为备份，应对一些冲击。</p><p>关于评论。学习每个组长的方式，将自己对战友的点评整理成文章，发表在简书上。</p><p>最后，重新整理写作工作流。尝试按照少数派编辑部的写作方式，利用 todoist 管理选题，在 Mweb 中创作。</p><h2 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h2><p>在反思之后，发现还有几个遗留的问题，先在这里罗列一下。</p><ol><li>图片问题。很多文章需要配图，mac 有什么简单的软件可以压缩图片？</li><li>简书与个人博客的同步。一般而言，自己还是使用 Mweb 配合 Markdown 语法进行写作，但是复制到简书时会遇到问题，外部图床不能使用，每次都需要重新传一遍图片。如何解决这个麻烦？</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;写这篇文章之前，查看了一下 007 公众号里面的数据，加入 83 班已经 134 天。但是自我感觉出了一些问题，借这次作业反思一下。&lt;/p&gt;
&lt;h2 id=&quot;问题&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#问题&quot;&gt;&lt;/a&gt; 问题&lt;/h2&gt;
&lt;</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="7" scheme="https://blog.xiang578.com/tags/7/"/>
    
    <category term="wrtiting" scheme="https://blog.xiang578.com/tags/wrtiting/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 3 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-3.html"/>
    <id>https://blog.xiang578.com/post/week-issue-3.html</id>
    <published>2018-06-16T09:39:04.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="文章"><a class="markdownIt-Anchor" href="#文章"></a> 文章</h2><p>1、 <a href="https://zhuanlan.zhihu.com/p/37954828">GitHub 和开源是对穷人的恩赐 - 来自知乎专栏，作者: 园长</a><br />想起之前PAT老师过来宣传PAT时（我不是很看好这个考试），将到企业通过学校来筛选候选人是因为应聘者太多，企业只需要找到合适的人，不需要考虑社会公平。这篇文章中谈到的观点，通过 Github 给开源世界贡献代码，能记录你学习成长的过程（git commit 还可以修改，是不是区块链技术适合这个场景），让更多的人认识你，逃过企业的一些过滤器。校招时，也在简历上写过 github 地址，在网易游戏面试，面试官还夸了一下。某一刻突然认识到，你需要找到属于自己的产品。</p><p>2、<a href="https://sspai.com/post/44946">重新捡起GTD —— 读《软技能》有感 - 少数派</a><br />少数派上关于工作效率探讨的文章之一，我在月读中也推荐过《软技能》，这篇文章的作者结合里面的原理，打造了属于自己的工作流，有一定的参考意义，也可以当成是开始实现 GTD 的范本。</p><p>3、<a href="https://zhuanlan.zhihu.com/p/24709748">矩阵求导术（上）</a><br />学习机器学习时遇到的困难之一，这篇文章介绍的很详细，最后也分析了几个机器学习中的例题。</p><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><p>1、中国看待世界的方法。小时候总以为世界上只有两个国家，中国和外国。<br /><img src="https://media.xiang578.com/IMG_0520.jpg" alt="IMG_0520" /></p><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><p>1、<a href="https://weibo.com/6525927484/GkT3eDSJV?type=comment">一条穿过河北农村的海底隧道｜大史记 Vol.6… 来自史里芬Schlieffen - 微博</a>：魔幻现实主义，拥有中国特色的海洋馆，之前没有想过还可以建造龙宫。大史记还有好几个更这种类似的视频，介绍国内一些疯狂的建筑。</p><p>2、<a href="https://v.qq.com/x/cover/814qe0slfkkskwk/x002699zoip.html">第1集 长沙：解放西路旁的小餐厅_纪实72小时(中国版)_腾讯视频</a>：纪实72小时是日本 NHK 电视台的节目，每期选择一个地点连续拍摄 72 小时。之前在 B 站上看过这个系列很多的，现在腾讯搞了一个中文版的。看完第一集之后，没有日版的味道，感觉日版选择餐厅主题时，会平衡食物与故事之间的分配，长沙这个餐厅中，注重煽情。还是期待未来能去更多的地方拍摄。</p><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><p>1、币圈生存法则不是已经告诉你了么 倾家荡产四大捷径：1，追涨杀跌；2，期货杠杆；3，融资融币；4，短线神操作。 人生巅峰四条大道：1，踏实工作；2，闲钱投资；3、长线持有；4，按时吃饭睡觉。 还有再加一条: 远离空气币。——勃学日常反投机语录之一</p><p>2、我对于主播粉丝感到非常费解的一个地方，就是能够把极高的信任授予某一本质上并非双向认识的一个人。 ——目睹之前绝地求生主播圈内的开挂风波的感叹</p><p>3、当别人知识体系已经汇编成执行节点，不仅达到成熟运转，还设计了升级调整的节奏，你的知识体系却还远远没有完善。</p><p>4、无非三本的学生不仅仅在初筛的时候会失去很多机会，并且在推销证明自己的时候，需要拿出比985学生更多的东西出来。 ——又快要到了高考填志愿的时候，不同选择的差距所在。前面也提到过这个观点。</p><h2 id="微博写作训练"><a class="markdownIt-Anchor" href="#微博写作训练"></a> 微博写作训练</h2><p>1、从少数派 Power+ 中看到的文章——颜色与身份统一。很多软件设置项目的颜色（比如日历软件中事件的颜色，todoist 中项目的颜色等等），思考将这些颜色对应一个现实中的身份进行统一（比如个人-绿色、家庭-紫色、工作/学校-棕色、其他-黄色），在不同的软件中进行统一（todoist、toggl、日历、文件夹）。在无法设置颜色的软件中利用 Emoji 解决。#效率思维#<br />少数派中文章是专属的，所以不放链接。放上知乎上一篇类似的文章：<a href="https://zhuanlan.zhihu.com/p/37343086">彩虹分类法：用七种颜色管理时间</a><br />。</p><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><p>1、<a href="https://sspai.com/post/44908">苹果设计奖的赢家，集日历、任务管理、笔记于一身的应用：Agenda - 少数派</a>：看起来不错的一款多功能应用，由于之前的系统迁移成本有些太高，这一次都没有尝试的兴趣。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;文章&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#文章&quot;&gt;&lt;/a&gt; 文章&lt;/h2&gt;
&lt;p&gt;1、 &lt;a href</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>大学书单</title>
    <link href="https://blog.xiang578.com/post/universiy-booklist.html"/>
    <id>https://blog.xiang578.com/post/universiy-booklist.html</id>
    <published>2018-06-14T14:27:44.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大学书单"><a class="markdownIt-Anchor" href="#大学书单"></a> 大学书单</h1><p>这几年学校一直有一个传统，会将毕业生大学期间在图书馆的借阅记录整理打印，形成一份特殊的书单。前几天，我就收到了这一份礼物，正好用来回忆一下自己在图书馆借过的书。</p><p><img src="https://media.xiang578.com/IMG_0516.jpg" alt="书单" /></p><p>书单制作的很精美，基于成本考虑没有能做成一个小册子倒是蛮遗憾的。图书馆寄语：「世态炎凉于指尖低回婉转，人生百态于页上妙趣横生。流年不虚度，不负诗与书。」第二页写的是，四年里你最常去的阅览室。我感觉这个数据是错误的，阅览室门口没有可以统计次数的仪器，大概推测是分别在哪个阅览室借过多少本书吧。由于自己所学的是计算机专业，毫无疑问，在自然类的阅览室借阅最多。之后是哲学社科以及文学艺术，也没有太大的惊讶。</p><p>第三页开始，就是罗列我的借书记录了。这份书单上没有写，查询知道大学四年总借图书121本，号称打败了 93.4% 的小伙伴。从最后一行记录开始查看，多少可以见证自己思维的成长。刚开始借的书很杂，什么小说、教辅、人文社科都有。之后由于求职的压力，更多看地是专业技能的书籍。</p><p>书单很长也很杂，推荐 5 本我看过比较喜欢的图书。</p><p>1、<a href="https://book.douban.com/subject/4006425/">我是一只IT小小鸟</a>：这本是大四才看的书，我却想把他放在第一本。这本书一些博文总集，邀请一些毕业后从事计算机领域的工程师、教授写的关于如何走上 IT 的故事。很多人是大学科班出身，他们讲到自己是如何学习计算机专业知识的，对迷茫的新生应该会有很多帮助。也有一些是转行干 IT，也很符合目前知乎上的劝退风潮。</p><p>2、<a href="https://book.douban.com/subject/1041482/">万历十五年</a>：黄仁宇的作品，国内一直很火。去年热映的《人民的名义》中，高小凤正是因为这本书才与高育良搭上关系。这本书分析不同的人物（张居正、申时行、戚继光、海瑞、李蜇），去揭示明朝衰败的开端。黄教授多年在海外教学，书中的叙事逻辑更偏西式。对于我这种深受国内历史教科书迫害的人来说，有醍醐灌顶之效。</p><p>3、<a href="https://book.douban.com/subject/6709783/">浪潮之巅</a>：吴军博士的《XX之X》系列中的一本（还有文明之光、数学之美、大学之路）。讲述站在技术浪潮之巅的科技公司的故事，可以快速了解目前美国的一些大型公司成长的历程与规律，提高专业素养。</p><p>4、<a href="https://book.douban.com/subject/4849382/">搞定</a>：GTD 的开山之作，引领了一股风潮。于我而言，重要的是接触 GTD 之后，思维方式的转变，对事情开始进行规划和反思。每一个人都不一定需要去实践完整地 GTD 流程，但是不能不知道这种方法。</p><p>5、<a href="https://book.douban.com/subject/6709809/">暗时间</a>：刘未鹏的博文集，一本看完之后，直接在网上下单购买的书。内容很杂，很难简单的讲清楚，以后有机会再详细推荐。</p><h2 id="借阅记录"><a class="markdownIt-Anchor" href="#借阅记录"></a> 借阅记录</h2><p>1软技能:代码之外的生存指南:the software developer’s life manual(美) John Z. Sonmez著<br />2Qt 5开发实战(韩) 金大〓著<br />3大教堂与集市(美)Eric S. Raymond著<br />4人月神话(美) 小弗雷德里克·布鲁克斯著<br />5数学之美吴军著<br />6我是一只IT小小鸟胡江堂主编<br />7美语音标赖世雄编著<br />8统计学习方法李航著<br />9硅谷钢铁侠:埃隆·马斯克的冒险人生(美) 阿什利·万斯著<br />10构建之法:现代软件工程:effective software engineering邹欣著<br />11小狗钱钱(德)博多·舍费尔著<br />12Word排版艺术侯捷著<br />13乔布斯的魔力演讲.第3版(美) 卡迈恩·加洛 (Carmine Gallo) 著<br />14搞定.III,平衡工作与生活的艺术,Winning at the game of work and business of life:最新版.第2版(美) 戴维·艾伦著<br />15小强升职记邹鑫著<br />16不要等到毕业以后.修订版张志著<br />17硅谷钢铁侠:埃隆·马斯克的冒险人生(美) 阿什利·万斯著<br />18奇特的一生:柳比歇夫坚持56年的“时间统计法”(俄)格拉宁著<br />19搞定.I,无压工作的艺术,The art of stress-free productivity:最新版.第2版(美) 戴维·艾伦著<br />20别闹了, 费曼先生:科学玩童的故事(美) R·费曼著<br />21好好学习:个人知识管理精进指南成甲著<br />22有道云笔记:记录，成为更好的自己有道云笔记主编<br />23公务员考试,申论的规矩粉笔科技编著<br />24你的知识需要管理田志刚著<br />25论可计算数:图灵与现代计算的诞生:the birth of computer science(美) 克里斯·伯恩哈特著<br />26苏东坡传林语堂著<br />27统计学习方法李航著<br />28Word排版艺术侯捷著<br />29高频交易员:华尔街的速度游戏:a Wall Street revolt(美) 迈克尔·刘易斯著<br />30人月神话(美) 小弗雷德里克·布鲁克斯著<br />31盖洛普优势识别器2.0(美) 汤姆·拉思著<br />32毛泽东选集.第1卷毛泽东著<br />33穿越抑郁的正念之道:freeing yourself from chronic unhappiness(英) 马克·威廉姆斯 … [等] 著<br />34大学之路:陪女儿在美国选大学吴军著<br />35大学之路:陪女儿在美国选大学吴军著<br />36编程之美:微软技术面试心得《编程之美》小组著<br />37Redis设计与实现黄健宏著<br />38尽在双11:阿里巴巴技术演进与超越阿里巴巴集团双11技术团队著<br />39程序员修炼之道:从小工到专家(美)Andrew Hunt, (美)David Thomas著<br />40编码:隐匿在计算机软硬件背后的语言:the hidden language of computer hardware and software(美)Charles Petzold著<br />41日本围棋故事.修订本薛至诚编译<br />42统计学习方法李航著<br />43编程之美:微软技术面试心得《编程之美》小组著<br />44剑指Offer:名企面试官精讲典型编程题何海涛著<br />45淘宝技术这十年子柳著<br />46Linux内核完全剖析赵炯编著<br />47计算机考研指导全书赵霖<br />48技术之瞳:阿里巴巴技术笔试心得阿里巴巴集团校园招聘笔试项目组著<br />49人生十八局:现在我将这样下(日]吴清源著<br />50阶梯围棋教室.从入门到业余初段.第2版黄希文主编<br />51布局日本棋院编<br />52计算几何:算法与应用:algorithms and applicationsMark de Berg … [等] 著<br />53数据库原理及应用.第2版雷景生, 叶文珺, 楼越焕编著<br />54只是为了好玩:Linux之父林纳斯自传:the story of an accidental revolutionary(美) Linus Torvalds, (美) David Diamond著<br />55围棋入门.第3版胡懋林, 马自正编著<br />56向死而生:我修的死亡学分李开复著<br />57神奇的老大日记有时右逝著<br />58计算几何:算法与应用:algorithms and applicationsMark de Berg … [等] 著<br />59数字电子技术(美) Thomas L. Floyd著<br />60经济学原理.宏观经济学分册(美) 曼昆著<br />61旧制度与大革命(法)托克维尔著; 冯棠译<br />62离线·黑客.NO.002主编李婷<br />63数字电子技术(美) Thomas L. Floyd著<br />64黑客与画家:硅谷创业之父Paul Graham文集:big ideas from the computer age(美)Paul Graham著<br />65菊与刀:日本文化模式论(美)鲁思·本尼迪克特著<br />66酒国莫言著<br />67电路与电子学习题解答与实验指导李景宏, 刘淑英主编<br />68煮酒探西游:吴闲云详解西游记吴闲云著<br />69悟空传今何在作品<br />70晨间日记的奇迹(日) 佐藤传著<br />71学习vi和Vim编辑器Arnold Robbins，Elbert Hannah，Linda Lamb著<br />72Evernote 100个做笔记的好方法:数字化重整你的工作和人生异尘行者著<br />73善用佳软:高效能人士的软件应用之道张玉新, 陈勇, 吴放著<br />74黑天鹅:如何面对不可预知的未来:the impact of the highly improbable(美) 纳西姆·尼古拉斯·塔勒布著<br />75寻秦记:终结篇.陆黄易著<br />76寻秦记.伍黄易著<br />77构建之法:现代软件工程:effective software engineering邹欣著<br />78寻秦记黄易著<br />79寻秦记.叁黄易著<br />80寻秦记黄易著<br />81寻秦记黄易著<br />821984(英) 奥威尔 (G. Orwell) 著<br />83四十一炮莫言著<br />84红高粱莫言著<br />85数据结构学习与实验指导陈越 … [等] 编著<br />86电路与电子学习题解答与实验指导李景宏, 刘淑英主编<br />87怎样解题:数学思维的新方法-1版(美)G·波利亚著<br />88万历十五年黄仁宇著<br />89图论算法理论、实现及应用王桂平, 王衍, 任嘉辰主编<br />90老子汤漳平, 王朝华译注<br />91魔方宝典:风靡世界的智力玩具之终极指南(美) 杰瑞·斯洛克姆 … [等] 著<br />92中国哲学简史:修订译本冯友兰著<br />93挑战程序设计竞赛(日)秋叶拓哉，(日)岩田阳一，(日)北川宜稔著<br />94文明之光吴军著<br />95数学之美吴军著<br />96把时间当作朋友:运用心知获得解放李笑来著<br />97浪潮之巅.第2版吴军著<br />98浪潮之巅.第2版吴军著<br />99暗时间刘未鹏著<br />100Vim实用技巧:edit text at the speed of thought(英) Drew Neil著<br />101编程之美:微软技术面试心得《编程之美》小组著<br />102货币战争.2,金权天下宋鸿兵编著<br />103北大往事:珍藏版:纪念北京大学建校110周年橡子，谷行著<br />104C++ Primer Plus (第6版) 中文版(美) Stephen Prata著<br />105数据结构学习与实验指导陈越 … [等] 编著<br />106C++ Primer Plus (第6版) 中文版(美) Stephen Prata著<br />107鸟哥的Linux私房菜:基础学习篇.3版鸟哥著<br />108搞定.Ⅱ,提升工作与生活效率的52项原则,52 productivity principles for work and life(美) 戴维·艾伦著<br />109搞定.Ⅲ.Ⅲ,平衡工作与生活的艺术,Winning at the game of work and business of life(美)戴维·艾伦著<br />110搞定.Ⅰ.Ⅰ,无压工作的艺术,the art of stress-free productivity(美) 戴维·艾伦著<br />111美国种族简史(美)托马斯·索威尔著<br />112一万小时天才理论(美)丹尼尔·科伊尔(Daniel Coyle)著<br />113番茄工作法图解:简单易行的时间管理方法(瑞典) Staffan Noteberg著<br />114越读者郝明义著<br />115C++ Primer中文版Stanley B. Lippman, Josee Lajoie, Barbara E. Moo著<br />116Vim实用技巧:edit text at the speed of thought(英) Drew Neil著<br />117计算机科学导论(美)贝鲁扎.佛罗詹著<br />118ACM/ICPC算法训练教程余立功主编<br />119C程序设计谭浩强著<br />120数学分析习题集.2版Б. П. 吉米多维奇著<br />121高等数学全程学习指导与习题精解:同济六版滕加俊, 滕兴虎编著</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;大学书单&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#大学书单&quot;&gt;&lt;/a&gt; 大学书单&lt;/h1&gt;
&lt;p&gt;这几年学校一直有一个传统，会将毕业生大学期间在图书馆的借阅记录整理打印，形成一份特殊的书单。前几天，我就收到了这一份礼物，正好用来回</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="zufe" scheme="https://blog.xiang578.com/tags/zufe/"/>
    
    <category term="reading" scheme="https://blog.xiang578.com/tags/reading/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 2 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-2.html"/>
    <id>https://blog.xiang578.com/post/week-issue-2.html</id>
    <published>2018-06-11T15:34:50.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。<br />毕业季脱更几天</p></blockquote><h2 id="新闻"><a class="markdownIt-Anchor" href="#新闻"></a> 新闻</h2><p>1、<a href="https://bestswifter.gitbook.io/effectivemac/">EffectiveMac - EffectiveMac</a> 一份 Mac 系统教程</p><p>2、Evernote 和印象笔记终于拆分了，国内的公司独立开发。为知笔记半死不活的情况下，还是希望印象笔记能给我们带来更多的惊喜。<a href="https://mp.weixin.qq.com/s/7kKSrZROTi8Q968WAGrRwA">来源</a></p><p>3、<a href="https://zhuanlan.zhihu.com/p/37781310">离开毛坦厂，去吻我爱的女孩</a>：又是一年高考时，这篇文章从不同的角度去感受被称为高考军工厂的毛坦厂，可惜当年我没有这样的感受。</p><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><ul><li><p><a href="https://www.thoughttrain.cc/#download">Thought Train for MacOS – Simple Note App for MacOS</a>：有意思的小工具，在 Mac 状态栏上显示一些话。<br /><img src="https://media.xiang578.com/15280104676054.jpg" alt="" /></p></li><li><p><a href="https://chrome.google.com/webstore/detail/rooster-for-chrome/pimolnhbniceppehbgmibnbgcnhpkhfh">Rooster for Chrome™</a>：在新标签页统计每天浏览各个网站的时间。<br /><img src="https://media.xiang578.com/15283589946007.jpg" alt="" /></p></li></ul><h2 id="文摘"><a class="markdownIt-Anchor" href="#文摘"></a> 文摘</h2><p>1、<a href="http://www.infoq.com/cn/articles/kanban-step-guide?utm_campaign=infoq_content&amp;utm_source=infoq&amp;utm_medium=feed&amp;utm_term=global">看板使用指南：从三列看板到灵活的布局设计</a><br />思考了一下，个人管理在于项目比较少的时候不是很适合这种方法，还是比较适合软件团队使用。看完这篇文章，学习到的是泳道这个概念。</p><p>2、<a href="https://www.zhihu.com/question/19714540/answer/334686351">如何理解傅里叶变换公式？ - 知乎</a></p><p>3、<a href="https://ift.tt/2sgdQCo">机器学习最佳实践：Google 官方指南</a></p><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><p>1、索引卡的妙用<br /><img src="https://media.xiang578.com/Jietu20180608-074432.jpg" alt="Jietu20180608-074432" /></p><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><p>1、<a href="https://www.youtube.com/watch?v=UM19H3CC5UE">預告分析 《蜘蛛人：返校日》 ： 少年超級英雄的進化(一) | 誰不重要 - YouTube</a><br />台湾一名电影自媒体，看问题的方式更加的深刻。</p><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><p>1、这是创业者最坏的时代，因为你很难再打情怀牌同情牌，要直面巨头们的烧钱大战。你能做的极限就是杀进决赛接受巨头投资。这也是创业者最好的时代，因为靠包装和营销的骗子们更加难以持续，劣币的离场速度显然是快于良币的。世界最终未必是你的，但一定是属于和你一样的人的。</p><p>2、评家罗世宏说，脸书作恶并非首次，“脸书强大的信息过滤和投放能力，代替人们开展正常的社交活动，也代替了人们自行选择接触什么信息的决定权。这次脸书再度陷入丑闻，或许最好的结果并不是脸书从此幡然改悟，善尽社交媒体平台的社会责任，而是扎克伯格的总统梦破灭了。（我并）不期待它从此改邪归正，但盼最终能把脸书这样的网络巨人和它所掌控的超大权力，逐步关到笼子里面去。</p><p>3、在一个知识更新如此迅猛的时代里，人们借助各种工具，将日常碎片化的时间充分利用起来，以更少的时间快速获取知识。这一点本来无可厚非。鲁迅先生也曾说，“哪里有天才,我是把别人喝咖啡的时间都用在写作上了”。但是，碎片化的学习不代表知识获得可以有捷径可走，更不等于打着知识付费的旗号去做知识的买卖。</p><p>4、其实，消费的本质就是考量成本与收益。这些新的名词后面的内核，是重新回到消费的本源，是为了使用价值而不是符号价值去消费；是为了提高生活品质的需要去消费，而不是追求炫耀的资本；为了获得身体和内心的享受去消费，而不是仅仅满足自己被裹挟的欲望。</p><h2 id="微博写作训练"><a class="markdownIt-Anchor" href="#微博写作训练"></a> 微博写作训练</h2><p>1、淘宝与拼多多的商业模式</p><blockquote><p>淘宝由于通过商品展示赚钱，倾向于推荐客单价比较大的商品，很多长尾商家就没有那么多导入流量。拼多多正是瞄准这一点，利用微信进行裂变式发展，做低价标品的拼团。此外为了促进消费，拼多多在系统的设计上取消了购物车、收藏夹、评论等功能。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;br /&gt;
毕业季脱更几天&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;新闻&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#新闻&quot;&gt;&lt;/a&gt; 新闻&lt;/h2&gt;</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>《机器学习》 第 3 章 线性模型 读书笔记</title>
    <link href="https://blog.xiang578.com/post/machine-learning-ch-03.html"/>
    <id>https://blog.xiang578.com/post/machine-learning-ch-03.html</id>
    <published>2018-06-09T08:29:21.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>西瓜书 周志华 2016 年 12 月第 14 次印刷</p></blockquote><h2 id="31-基本形式"><a class="markdownIt-Anchor" href="#31-基本形式"></a> 3.1 基本形式</h2><p>线性模型的预测函数为：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>w</mi><mi>d</mi></msub><msub><mi>x</mi><mi>d</mi></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">{f(x)=w_1x_1+w_2x_2+...+w_dx_d+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span></span></p><p>写成向量模式得到：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">{f(x)=w^Tx+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span></span></p><h2 id="32-线性回归"><a class="markdownIt-Anchor" href="#32-线性回归"></a> 3.2 线性回归</h2><p>线性回归能在给定数据集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{D=\{(x_1,y_1),(x_2,y_2),...,(x_m,y_m)\}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">;</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo separator="true">;</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">;</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>d</mi></mrow></msub><mo stretchy="false">}</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">{x_i =\{x_{i1};x_{i2};...;x_{id}\},y_i\in\mathbb{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span></span>学到一个线性模型从而进行预测。</p><p>考虑最简单情况，当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 为一维时，问题转换为求下式：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">{f(x_i)=wx_i+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span></span></span></p><p>使得</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>≃</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{f(x_i)\simeq y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>使用平方损失函数作为衡量线性规划模型性能的指标，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{f(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> 越接近，代表平方损失函数越小。即得到：<br /><img src="https://media.xiang578.com/15285348597249.jpg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;西瓜书 周志华 2016 年 12 月第 14 次印刷&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;31-基本形式&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#31-基本形式&quot;&gt;&lt;/a&gt; 3.1 基本形式&lt;/h</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="MachineLearning" scheme="https://blog.xiang578.com/tags/MachineLearning/"/>
    
  </entry>
  
  <entry>
    <title>那些年听过的播客</title>
    <link href="https://blog.xiang578.com/post/podcast-list.html"/>
    <id>https://blog.xiang578.com/post/podcast-list.html</id>
    <published>2018-06-07T06:59:22.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>前几天在刷微博时，突然发现 Checked 休更。蛮震惊的，于是在他下面留了言。<br /><img src="https://media.xiang578.com/15283538399580.jpg" alt="" /></p><p>后来仔细一想，接触播客也快四年多了。刚开始疯狂地时候，走路的时候也带着耳机在听。不过现在胆子越来越小，主要在跑步的时候通过无线耳机收听节目。四年多的时间里面，有播客听过，有播客开始，也有些播客半死不活。正好借这个机会分享一下我听过的播客。</p><p>播客是什么？其实有两种解释：一是一种数字广播，制作方将节目以音频的形式放在指定网站上，用户可以将节目下载到自己喜欢的硬件中收听。二是特指 iOS 中的一个软件——Podcast，通过这个软件能订阅以及收听音频节目。</p><h2 id="科技"><a class="markdownIt-Anchor" href="#科技"></a> 科技</h2><h3 id="it-公论"><a class="markdownIt-Anchor" href="#it-公论"></a> <a href="https://itgonglun.com/">IT 公论</a></h3><p>说起中文播客，就不得不提 IPN 播客网络，他们旗下有很多的博客节目，IT 公论正是其中的一个。由李如一和 Rio 主持，主要探讨科技和人文的关系，由于主播的限制，更多关心 Apple 生态下的新闻。可惜的是于 2106 年停播，不过早期的一些节目还是值得一听。</p><h3 id="checked"><a class="markdownIt-Anchor" href="#checked"></a> <a href="http://checked.fm/">Checked</a></h3><p>本文最开始提到的节目，有文刀汉三、千千、Hum三个人主持，主要讨论如何使用 App 进行数字化生活。比较经典的有<a href="http://checked.fm/1">#1: 日历/待办事项/GTD</a>、<a href="http://checked.fm/2">#2: 如何记一手明白账</a>、<a href="http://checked.fm/49">#49: 访谈「也谈钱」: 你的钱是可以给你赚钱的</a>，也可以说是我听过后实践最多的节目。</p><h2 id="生活"><a class="markdownIt-Anchor" href="#生活"></a> 生活</h2><h3 id="太医来了"><a class="markdownIt-Anchor" href="#太医来了"></a> <a href="https://overcast.fm/p697861-JDgotv">太医来了</a></h3><p>一档医生谈话类节目。之前很喜欢的节目，高考之前也有学医的想法，听三位太医讲他们大学生活以及医院工作都有一种触动。更关键地是，这个节目也是很好的获得一些基础医学常识的渠道。比如其中有一期节目讲解了<a href="http://taiyilaile.com/124">医生的字</a>，听完之后才了解到龙飞凤舞的字迹主要是不希望患者看明白。</p><h3 id="狗熊有话说"><a class="markdownIt-Anchor" href="#狗熊有话说"></a> <a href="https://overcast.fm/itunes544563053">狗熊有话说</a></h3><p>主播大狗熊，注重分享设计、生活、运动、阅读等方面的知识。更重要的是，通过收听这么长的节目，可以看见狗熊的成长轨迹。从当初的云南昆明，如何通过自己的规划，最终全家移民新西兰。</p><h3 id="bytecoffee"><a class="markdownIt-Anchor" href="#bytecoffee"></a> <a href="https://overcast.fm/p756257-COwMrN">Byte.Coffee</a></h3><p>比较杂的节目，主播 MilkShake 羊，斯坦福博后，目前在南京一所大学任教。</p><h3 id="在北大不吐槽会死"><a class="markdownIt-Anchor" href="#在北大不吐槽会死"></a> <a href="http://pkuspot.org/">在北大不吐槽会死</a></h3><p>三名北大学生的吐槽会，取材也是方方面面，从他们的大学生活到现在毕业之后对工作的感悟。内容有些时候比较脏。</p><h3 id="纽约文化沙龙"><a class="markdownIt-Anchor" href="#纽约文化沙龙"></a> <a href="https://overcast.fm/itunes1039668127">纽约文化沙龙</a></h3><p>在美国留学的学生主办，每期会邀请一些嘉宾，讲述特定主题的内容。我知道的类似组织还有安城文化沙龙，不过他们只分享视频。</p><h3 id="蒋勋细说红楼梦"><a class="markdownIt-Anchor" href="#蒋勋细说红楼梦"></a> <a href="https://overcast.fm/itunes1300467229">蒋勋细说红楼梦</a></h3><p>蒋勋的红楼梦应该是很有名的节目，某一位粉丝通过播客形式将这些音频分享出来。其实之前我也搞过这方面的内容，WordPress 有专门的播客插件，从技术角度来说发布播客还是很简单的。</p><h2 id="编程"><a class="markdownIt-Anchor" href="#编程"></a> 编程</h2><h3 id="内核恐慌"><a class="markdownIt-Anchor" href="#内核恐慌"></a> <a href="https://kernelpanic.fm/">内核恐慌</a></h3><p>这是另外一档由 Rio 主持的节目，听名字就很硬派。讨论过程序员的方方面面，比如编辑器、字体、键盘、自由职业等等。可惜目前保持半年更新的频率。</p><h3 id="teahourfm"><a class="markdownIt-Anchor" href="#teahourfm"></a> <a href="http://teahour.fm/">Teahour.fm</a> 以及代码时间</h3><p>这两个都是访谈类节目，邀请过各种各样的程序员都有。对于立志投身于软件产业的人具有一定的参考价值。</p><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><p>收听播客大概有两种主要的工具，第一种是专用的软件，比如喜马拉雅、蜻蜓 FM等，能直接在软件内部搜索你想听的节目收听，而且我在上面的介绍的节目大多都会在这些平台发布。但是，我更推荐第二种方法，使用泛用性客户端收听节目。在 iOS 中，系统自带播客软件，也可以去下载如<a href="https://itunes.apple.com/cn/app/overcast-podcast-player/id888422857?mt=8&amp;ign-mpt=uo%3D4">Overcast</a>或者<a href="https://itunes.apple.com/cn/app/castro-podcast-player/id1080840241?mt=8&amp;ign-mpt=uo%3D4">Castro Podcasts</a>等第三方软件。目前我自己常用的是 Overcast，比起系统自带的，提供了人声增强（能解决部分播客音质太差问题）以及智能变速（自动调整速度）等功能。在 Android 中，推荐 360 Podcast ，老周的公司出品的良心应用，良心到国内都没有推广过……<br />最后，对于一些只有在喜马拉雅等地方可以收听的节目，可以使用<a href="http://getpodcast.xyz/">播客 RSS Feed</a>这个网站获得订阅链接。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前几天在刷微博时，突然发现 Checked 休更。蛮震惊的，于是在他下面留了言。&lt;br /&gt;
&lt;img src=&quot;https://media.xiang578.com/15283538399580.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;后来仔细一想，接触播客也快四年多</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="podcast" scheme="https://blog.xiang578.com/tags/podcast/"/>
    
  </entry>
  
  <entry>
    <title>《机器学习》 第 1 章 绪论 读书笔记</title>
    <link href="https://blog.xiang578.com/post/machine-learning-ch-01.html"/>
    <id>https://blog.xiang578.com/post/machine-learning-ch-01.html</id>
    <published>2018-06-06T14:31:16.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>西瓜书 周志华 2016 年 12 月第 14 次印刷</p></blockquote><h2 id="11-引言"><a class="markdownIt-Anchor" href="#11-引言"></a> 1.1 引言</h2><p>机器学习：利用经验来决策</p><h2 id="12-基本术语"><a class="markdownIt-Anchor" href="#12-基本术语"></a> 1.2 基本术语</h2><p>根据数据是否拥有标记信息分类：</p><ol><li>监督学习 supervised learning<ul><li>分类 classification</li><li>回归 regression</li></ul></li><li>无监督学习 unsupervised learning<ul><li>聚类 clustering</li></ul></li></ol><h2 id="13-假设空间"><a class="markdownIt-Anchor" href="#13-假设空间"></a> 1.3 假设空间</h2><p>假设空间指的是所有跟问题相关的假设所组成的空间，学习过程是从假设空间中进行搜索，目标是找到与训练集「匹配」（fit）的假设。</p><p>在这么多的假设中，可能存在一些假设，得出的结果和训练集一致，这些假设组成的空间叫做「版本空间」（version space）。</p><h2 id="14-归纳偏好"><a class="markdownIt-Anchor" href="#14-归纳偏好"></a> 1.4 归纳偏好</h2><p>对于数据集中没有出现过的情况，算法可能会按照自己的偏好来预测结果，这种情况称为「归纳偏好」。为算法选取偏好时，可以使用「奥卡姆剃刀」原则，即有多个假设与观察一致，则选最简单的那个。但是什么是最简单的也需要仔细思考。</p><h3 id="没有免费的午餐定理no-free-lunch-theorem-nfl"><a class="markdownIt-Anchor" href="#没有免费的午餐定理no-free-lunch-theorem-nfl"></a> 没有免费的午餐定理（No Free Lunch Theorem, NFL）</h3><ol><li>在所有问题出现的机会相同时，所有的算法的期望性能相同。</li><li>任何一个算法都有表现好的问题，也有表现差的问题。</li><li>针对具体的学习问题研究算法。脱离具体问题，研究什么算法更好毫无意义。</li></ol><h2 id="17-阅读材料"><a class="markdownIt-Anchor" href="#17-阅读材料"></a> 1.7 阅读材料</h2><p>其他科学研究中采用的假设选择原则<br />古希腊哲学家伊壁鸠鲁 「多释原则」：保留与经验观察一致的原则。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;西瓜书 周志华 2016 年 12 月第 14 次印刷&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;11-引言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#11-引言&quot;&gt;&lt;/a&gt; 1.1 引言&lt;/h2&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="智能路" scheme="https://blog.xiang578.com/categories/%E6%99%BA%E8%83%BD%E8%B7%AF/"/>
    
    
    <category term="MachineLearning" scheme="https://blog.xiang578.com/tags/MachineLearning/"/>
    
  </entry>
  
  <entry>
    <title>每周分享第 1 期</title>
    <link href="https://blog.xiang578.com/post/week-issue-1.html"/>
    <id>https://blog.xiang578.com/post/week-issue-1.html</id>
    <published>2018-06-01T15:15:33.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里记录过去一周，我看到的值得分享的东西，每周六更新。</p></blockquote><h2 id="新闻"><a class="markdownIt-Anchor" href="#新闻"></a> 新闻</h2><p>1、<a href="https://3g.163.com/exclusive/article/DIG3PRP1000199ET.html">伊朗迷你裙消亡史_手机网易网</a><br />历史居然可以导流……</p><p>2、<a href="http://dbaplus.cn/news-73-1510-1.html">欧盟GDPR有多狠？未合规的数据处理活动或将被叫停！ - 大数据 - DBAplus社群——围绕数据库、大数据、PaaS云，运维圈最专注围绕“数据”的学习交流和专业社群</a> <a href="https://sspai.com/post/44706">关于 GDPR 你需要了解的一切 - 少数派</a><br />最近收到很多跟这个相关的邮件</p><p>3、<a href="http://slide.tech.sina.com.cn/internet/slide_5_18966_116884.html#p=1">2018互联网女皇报告中文完整版呈现！</a></p><p>4、<a href="https://www.zhihu.com/question/279208326">如何评价ry(Ryan Dahl)的新项目deno? - 知乎</a><br />这个新闻关键不在于这个新的项目，而是在于国内和多的开发者在项目的 Issues 页面灌水，引起其他人的反感。</p><h2 id="工具"><a class="markdownIt-Anchor" href="#工具"></a> 工具</h2><ul><li><a href="https://kanban.ist/">Kanbanist | The Missing Kanban Board for Todoist</a><br />前几天还在考虑如何将 todoist 与看板结合，也看了一下 todoist 相关的 api 文档，之后在网上搜索时就发现了这个产品。功能还不是很强大，不知道作者什么时候可以完善。<br /><img src="https://media.xiang578.com/15274182963792.jpg" alt="" /></li></ul><h2 id="文摘"><a class="markdownIt-Anchor" href="#文摘"></a> 文摘</h2><p>1、 <a href="https://www.zhihu.com/question/269039116/answer/345980050">大学的双休日应该如何充实地度过？ - 知乎</a><br />这一个回答是我见过关于大学如何渡过比较好的解释，希望还没有毕业的同学可以不辜负四年。</p><blockquote><p>你如果找准了目标，自然自己会有一个答案。每个人只要认准一件事情好好做下去，最后的结果不一定会差。虽然我自己是走传统路线的学生，GPA+英语+竞赛都稍微拿得出手，但是其实我并不喜欢现在的自己。其实你发现，除了顶级大牛，大多数大学所谓的好学生，其实都是一个模子刻画出来的。国家奖学金(其他综合奖学金)+90左右的均分+各类学科竞赛+各类荣誉称号+各类传奇的社会经历活动等等。当然，本科毕业后，人生不会太多波折，但是回首望去，这样的本科未必真的是自己想要的本科。</p></blockquote><p>2、前几周加了民科微信群（不知道有没有人还记得当年发现电荷不存在的“民间科学家”），很难理解他为什么会这么执迷不悟，下面这一段话大概可以解释一下。</p><blockquote><p>一个人不需要做什么惊天动地的大事，但是对自己做的事情必须有认同感，如果做学术的自己都觉得自己在灌水，理由是身边大多数人也是在灌水，那么我不明白我为什么要去做它。</p></blockquote><p>3、<a href="https://www.zhihu.com/question/276647705/answer/388456459">哪些经济学论文让你发出「脑洞才是第一生产力」的感叹？ - 童话李的回答 - 知乎</a><br />生活处处皆皆学问，从篮球比赛中的「手感」出发，抽象「这个球命中概率是否与下一个球命中概率正相关」，然后去统计数据研究，最后给出下面的结论。</p><blockquote><p>The belief in the hot hand and the “detection” of streaks in random sequences is attributed to a general misconception of chance according to which even short random sequences are thought to be highly representative of their generating process. （一小段完全随机的结果，却被认为对整体有很高的代表性。）</p></blockquote><p>4、<a href="http://www.zreading.cn/archives/6412.html">我的5个经济学思维 – 左岸读书</a></p><blockquote><p>折现、机会成本、边际效用递减、沉没成本、复利</p></blockquote><h2 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h2><p>1、以 GDPR 为背景创建的图片<br /><img src="https://media.xiang578.com/15276714913984.png" alt="以 GDPR 为背景创建的图片" /></p><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><p>1、<a href="https://www.youtube.com/watch?v=G2nAwFAkEzI">2018 4 18 德云一队新街口剧场《朱夫子》高峰 栾云平 - YouTube</a></p><h2 id="金句"><a class="markdownIt-Anchor" href="#金句"></a> 金句</h2><p>1、坚持读书，坚信自己可以读完一些东西，坚信自己可以承受读书的强度——无论读的是什么，这过程本身就是一种信念，并且这份信念会让我们抵达心中的目的地。</p><p>2、许多时候，我们身处信息传导的末端。当一个问题反复多年都没有解决方法的时候，就应该怀疑是否信息上游的路径已经锁死？可能在你自己原有的知识体系和知识框架内并不存在解决方法，无论耗费多少时间和精力都不能解决问题。那么，这时候应该考虑迁移到其它陌生的领域中去，也许，你要的答案早就放在那里，只是你一直没有发现而已。你的问题，也许对那个领域里的人而言，只是他们工作的一个副产品，甚至都不会太在意。——和菜头</p><p>3、所有的科技公司，解决的都是人、信息、物品三方之间的关系。简化来说：谷歌解决的是人与信息的关系，亚马逊解决的是人与物的关系，Facebook解决的是人与人的关系，微软，解决的是企业人的问题。 ——如同答辩老师对我所说，做硬件才有意义。</p><p>4、元认知是对认知的认知。元认知是自省的能力。一个人能够理性的反思自我，自然就会知道许多麻烦，并非是外界的存在，而是自己暴戾所引发的。执迷于无知，甚至以无知为傲骄，才是最可怕的贫穷。</p><p>5、我觉得大多数幸福的人的生活就是这样的，没有什么高大上，也没有那么多的风花雪月，而就是这样简简单单、快快乐乐地用自己的努力和自己心爱的人一起为更美好的生活脚踏实地地奋斗着。</p><p>6、当一个学生从某一所知名大学毕业后，他不需要再把母校的名字天天挂在嘴边；当一个学生从一所二三流大学毕业后，那所学校今后会因为曾经出了这样一个学生感到自豪。这样的大学经历就堪称完美了。——快要离开学校时，思考自己的价值。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里记录过去一周，我看到的值得分享的东西，每周六更新。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;新闻&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#新闻&quot;&gt;&lt;/a&gt; 新闻&lt;/h2&gt;
&lt;p&gt;1、&lt;a href=</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="weekly" scheme="https://blog.xiang578.com/tags/weekly/"/>
    
  </entry>
  
  <entry>
    <title>月读|软技能——代码之外的生存指南</title>
    <link href="https://blog.xiang578.com/post/soft-skills.html"/>
    <id>https://blog.xiang578.com/post/soft-skills.html</id>
    <published>2018-05-28T14:21:29.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>本月推荐的书是 John Z. Sonmez 写的<a href="https://book.douban.com/subject/26835090/">《软技能——代码之外的生存指南》</a>。本书作者之前是一名程序员，目前更多的是充当程序员的人生导师角色，通过博客、播客、vlog等多种形式介绍自己的软技能，借此希望能推动其他人事业进步，过上更充实的生活。</p><p>本书总共分成七大篇：</p><ul><li>职业篇，介绍了程序员从公司选择、面试、工作、辞职、创业等职业相关的方方面面内容</li><li>自我营销篇，从博客开始，打造自己的个人品牌</li><li>学习篇，作者自己领悟的「十步学习法」学习新的知识</li><li>生产力篇，自由职业者的自我管理方法</li><li>理财篇，探讨收入、投资、债务以及退休等问题</li><li>健身篇，下面的图片就是作者本人，和一般的程序员形象有很大的区别</li><li>精神篇，心灵、情感等问题探讨</li></ul><p><img src="https://media.xiang578.com/15275002437247.jpg" alt="作者博客" /></p><p>从上面的介绍可以看出，这本书基本上把一个程序员可以面对的所有问题，都给囊括了。从形式上来看，这本书像是各种主题的博文合集，有些散乱。总的来说都是关注于「更好地经营生活」。</p><h2 id="自我营销"><a class="markdownIt-Anchor" href="#自我营销"></a> 自我营销</h2><p>这一个主题是书中我最感兴趣的内容。知识付费的兴起，朋友圈中经常能看到有人分享付费课程的图片，图片中的老师各种头衔酷炫狂霸叼咋天，自我营销的成本真的是已经低到一种程度。万物互联，每一个人都有一次成名的机会。</p><p>本书中的自我营销，介绍了一系列的过程，作者推荐个人品牌的建立从博客开始。对于程序员来说，维护一个自建博客是很轻松的事情，而且可以分享的内容也很广泛，工作中的技能学习、遇到的问题分析。将博客当成自己的名片，从而实现让更多的人认识你，认可你。</p><p>书中介绍维护一个博客，要从两个方面入手，一是内容质量，二是更新计划。之前，自己的博客都是随心所欲的更新。重新思考一下，给博客增加了几个栏目：</p><ul><li>【每周分享】：每周六不定时更新，记录过去一周，我看到值得分享的内容</li><li>【月读】：每月不定时更新，推荐本月我阅读的一本书</li><li>【数字生活】：我的数字生活实践</li><li>【博客公告】：分享与这个博客维护相关的内容</li></ul><p>另外一方面，对于我这样的博客来说，最主要的流量来源是搜索引擎，所以花时间进行了一些 SEO 优化。通过在百度搜索和谷歌搜索相关页面提交网站，实现文章更快的收入。除此之外，需要在社交账号中更多的绑定博客，寻求其他的主动点击。</p><h2 id="生产力"><a class="markdownIt-Anchor" href="#生产力"></a> 生产力</h2><p>这个主题，是我大半年以来一直感兴趣的。之前没有注意到，像作者这样的自由职业者更应该是效率大师。其实各种效率方法流程大致相同，更多的是细节的实现。作者在做周计划时，倾向于利用看板来展示任务，这个给我一个新的启示。我考虑过利用 Github + Zenhub 来管理一些大的项目，不过平时没有什么动力打开 Github 网站。</p><p><img src="https://media.xiang578.com/15275062870334.jpg" alt="Github Issues" /></p><p>所以，需要一种更加简单地方法。网上查找了一下，发现一个网站 <a href="https://kanban.ist">Kanbanist | The Missing Kanban Board for Todoist</a>。Kanbanist 最大的优势是能直接读取 Todoist 的数据，用起来会更加方便吧。不过，如何融合进入日常工作流中，又值得我自己仔细思考一下。</p><p><img src="https://media.xiang578.com/15275066078950.jpg" alt="Kanbanist" /></p><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>读这本书，最大的感受是读到很多点的时候，我都打开了电脑进行实践。功利地说，这是一本实用的书，推荐大家有空都来挑选自己感兴趣的内容阅读。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本月推荐的书是 John Z. Sonmez 写的&lt;a href=&quot;https://book.douban.com/subject/26835090/&quot;&gt;《软技能——代码之外的生存指南》&lt;/a&gt;。本书作者之前是一名程序员，目前更多的是充当程序员的人生导师角色，通过博客、播客</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="gtd" scheme="https://blog.xiang578.com/tags/gtd/"/>
    
  </entry>
  
  <entry>
    <title>博客折腾记：使用 Travis CI 自动部署</title>
    <link href="https://blog.xiang578.com/post/use-travis-ci-to-auto-update.html"/>
    <id>https://blog.xiang578.com/post/use-travis-ci-to-auto-update.html</id>
    <published>2018-05-28T07:44:09.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>前几天，看到其他人在 V2 上讨论利用 Docker 更新 hexo 博客。不过自己对使用 Docker 不是很感兴趣，倒是了解到 Travis CI 的作用。</p><p>参考<a href="https://blog.zthxxx.me/posts/Build-Hexo-Blog-by-Travis-CI/">使用 Travis 自动构建 Hexo 到 GitHub | Zthxxx’s Blog</a>和<a href="https://juejin.im/post/5afe61f5f265da0b8d422a3e">使用travis-ci自动部署Hexo到github和coding - 掘金</a>这两篇文章，完成了博客自动部署的修改，也解决了一些，之前没有在意的问题，写下来备忘一下。</p><p>介绍一下与这个博客先关的 git 项目。博客相关的原始文件放在 <a href="https://github.com/xiang578/blog">xiang578/blog</a>，主题文件放在 <a href="https://github.com/xiang578/hexo-theme-even">xiang578/hexo-theme-even: A super concise theme for Hexo</a>（我对这个主题有一些修改，所以自己 fork 了一份，最后发布的文件放在<a href="https://github.com/xiang578/xiang578.github.io">xiang578/xiang578.github.io: Welcome to My blog!</a>（实际上这也是一个备份，访问时的文件是从 coding 服务器上读取的）。</p><p>按照上面两篇博文配置好 Travis CI 之后，每次向存放博客原始文件的仓库 push 时，<a href="http://travis-ci.com">travis-ci.com</a> 都会拉取代码进行 build ，成功之后会出现下图。</p><p><img src="https://media.xiang578.com/15274940169141.jpg" alt="" /></p><p>之前都是使用 git clone 下载主题的，如果把本机上的博客相关文件直接推送到 github 上会遇到问题。简单地说就是一个 git 文件夹包含了另外一个 git 文件夹。所以，需要使用 <code>git modules</code> 来解决。通过这种方法可以在 clone 主仓库时，会自动clone子仓库。</p><p><img src="https://media.xiang578.com/15274942502764.jpg" alt="" /></p><p>博客仓库中会链接到其他仓库，其中 @ 之后的那一串就是 commit 编号，主要是用来做版本控制的。</p><p><img src="https://media.xiang578.com/15274943487052.jpg" alt="" /></p><p>完成这样的设置，修改主题文件后，需要先将修改 push 到主题的仓库，然后在博客文件夹下 push 修改到远端仓库。最终，才能再网页上看到修改效果。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前几天，看到其他人在 V2 上讨论利用 Docker 更新 hexo 博客。不过自己对使用 Docker 不是很感兴趣，倒是了解到 Travis CI 的作用。&lt;/p&gt;
&lt;p&gt;参考&lt;a href=&quot;https://blog.zthxxx.me/posts/Build-Hex</summary>
      
    
    
    
    <category term="不老阁" scheme="https://blog.xiang578.com/categories/%E4%B8%8D%E8%80%81%E9%98%81/"/>
    
    
    <category term="hexo" scheme="https://blog.xiang578.com/tags/hexo/"/>
    
    <category term="travis" scheme="https://blog.xiang578.com/tags/travis/"/>
    
  </entry>
  
  <entry>
    <title>月读 | 数学之美</title>
    <link href="https://blog.xiang578.com/post/the-beauty-of-math.html"/>
    <id>https://blog.xiang578.com/post/the-beauty-of-math.html</id>
    <published>2018-05-07T14:24:30.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>其实从<a href="https://book.douban.com/subject/10750155/">《数学之美》</a>这书名上看就可以知道，这是一本科普类的图书。这本书收集吴军博士早期发布在谷歌黑板报上解释搜索相关的数学原理的文章。吴军博士之前在谷歌和腾讯都从事搜索相关领域的研究，自然而然的有很多独特见解。除了这本书之外，他还有《浪潮之巅》、《大学之光》等科普图书，也是值得一读。</p><p>虽然是科普类读物，但是本书还是有一些阅读门槛的。大二的时候也看过这本书，当时的数理基础不够，囫囵吞枣翻完后。事后大概只记得自然语言处理、马尔科夫链等等的名词。这一段时间正好自己也在做文本搜索相关的工作，所以又从图书馆中借来一读。</p><p>本书大概介绍了 Google 整个搜索引擎的基本框架，包括资料获取、分词、索引、排名、分类、相似度计算等知识。这一次读完之后，印象最深刻的是关于从通信模型推导出语言翻译模型的转变。这里和大家分享一下我的简单见解，如果想要更加深入的理解可以阅读《数学之美》的第 5 章 隐含马尔可夫模型。</p><p>大二的时候上过《通信原理》这门课，其中讲解如下图所示的简单通信系统。一般包括五个最基础的要输，分别是信源、变换器、信道、反变换器、信宿。从字面上很难理解这些东西是，所以简单的解释一下。通信系统是对通信过程的抽象概括，比如你和其他人发微信时，你就是信源，信息的发送方。变换器的作用是编码，计算机只能处理 0 和 1，所以需要将你的消息通过一定的方法（协议）转化成为由 0 和 1 组成的序列。之后的信道指的是信息发送的通道，可以理解为发送微信时需要有网。反变换器顾名思义作用和变换器相反，从一个二进制序列还原成和你聊天的人（信宿，和你聊天的人）可以理解的消息。</p><p><img src="https://media.xiang578.com/15256624201151.jpg" alt="" /></p><p>当时学到这里的时候，没有去发散思维，思考这个模型在其他领域的应用。《数学之美》书中，讲到统计语言模型时，将它衍生到机器翻译的过程中。在日常生活中，我们和其他人交流的时，一般是在脑子中有一个想法（信源），然后在说出来（编码），声音在空气中传播（信道），最后被另外的人（信宿）听到，并且在脑子中思考理解（解码）做出相应的回应。对于翻译问题，可能我说出来的是中文，如果听到的是美国人，他需要将你说的转化为英文。所以产生的一个问题是，如何实现将中文与英文对应起来，也就是翻译问题了。为了解决这个问题，科学奖们运用了贝叶斯概率、隐含马尔科夫模型、大数定理等数学知识来处理。</p><p>这只是书中的一个简单例子，吴军博士在自然语言处理与搜索领域的经历令人难以望其项背，书中关于这两个领域在近代的发展的小故事比比皆是，作者更是和这些人谈笑风声。所以，我推荐所有对数学有爱好的人，都可以看一下这本书，感受一下数学原理的力量。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;其实从&lt;a href=&quot;https://book.douban.com/subject/10750155/&quot;&gt;《数学之美》&lt;/a&gt;这书名上看就可以知道，这是一本科普类的图书。这本书收集吴军博士早期发布在谷歌黑板报上解释搜索相关的数学原理的文章。吴军博士之前在谷歌和腾讯都从事</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
  </entry>
  
  <entry>
    <title>利用 GTD 原则完成一次讲座</title>
    <link href="https://blog.xiang578.com/post/use-gtd-to-speach.html"/>
    <id>https://blog.xiang578.com/post/use-gtd-to-speach.html</id>
    <published>2018-04-28T10:04:32.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>前几天，在导师的邀请下，给17计算机班的同学们进行了一次分享讲座。内容大概是关于去年在滴滴实习时做的一些工作以及主观意愿下的大学学习建议。作为一个号称实践 GTD 的人，必不可少的要将 GTD 原则使用到这一次分享准备过程中。</p><h2 id="自然式计划模式"><a class="markdownIt-Anchor" href="#自然式计划模式"></a> 自然式计划模式</h2><p>这样子的一次活动，正好符合 GTD 中关于项目的定义。《搞定1》第 3 章中提到了「控制项目：纵向管理项目的5个阶段」。现在结合五个阶段，来复盘一下我准备讲座的过程。</p><h3 id="1-定义目标和原则"><a class="markdownIt-Anchor" href="#1-定义目标和原则"></a> 1. 定义目标和原则</h3><blockquote><p>你为什么做这件事？<br />做这件事的真正目的或动机是什么？<br />做到什么程度才算是成功？<br />你的目标是否足够清晰明确？<br />什么样的行为可能会损害我正在进行的工作？<br />我怎样才能防止这类情况的发生？</p></blockquote><p>我决定做这一次分享时，主要有下面的4方面原因。</p><p>第一，整理。每一次分享都是一次自己我反思。所以我需要整理一下之前在滴滴工作时留下的资料，以及梳理前几年的学习感悟。<br />第二，演讲。说句实话，我的演讲的能力很弱。体现在，口齿不清楚、演讲时语速太快和听众没有交流。众所周知，演讲能力是现代社会必不可少的一项能力。提升演讲的关键在于实践，所以给其他人讲解我熟悉的内容正是一次绝好的机会。<br />第三，回馈。虽然私下里和其他人骂过很多学校和学院的规章制度之类，但也不能忽视学校所提供给我的成长机会和空间。之前书记也在一次党会上说过，我们很多党员的材料中，只有那一年考了多少名，又获得什么奖这些的，没有和群众交流。<br />第四，参考。作为一个软弱的人，我很少会去谈给其他人有什么影响，也不会整天去批评这个那个，只希望自己的经历给其他人一个参考。所以，我很喜欢学院里面搞的《榜样的力量》栏目。通过这些，可以了解到学长学姐有多么努力，获得了什么样的成就。事实是，我们这样的普通学校中，很多优秀的人都已经模板化了，集中在绩点多少高，获得过什么奖学金，当过什么部门的什么而已。真正的大学教育，应该培养的学生达到「千人千样」。</p><h3 id="2-展望结果"><a class="markdownIt-Anchor" href="#2-展望结果"></a> 2. 展望结果</h3><blockquote><p>成功是一番什么景象？听上去会怎样？有什么感觉？专注！创造出清晰可见的结果。只做积极性思考，不考虑不利因<br />素</p></blockquote><p>对于我个人来说，这一次分享是一次宝贵的锻炼机会。是实践 GTD 原则，是完成一次公众演讲，也是完成一次和学弟学妹的交流。不过，由于个人经历的限制，我所分享的东西，终将是少数同学所感兴趣的，只希望这部分人听到我的一些观点，未来的学习会有那么一点点不同。也许多年之后，互联网上有一段文字记录，提起那个晚上我所讲的观点。</p><h3 id="3-头脑风暴集思广益"><a class="markdownIt-Anchor" href="#3-头脑风暴集思广益"></a> 3. 头脑风暴/集思广益</h3><blockquote><p>在这张的纸的反面的正中央写上项目名称，开始头脑风暴。追求数量，不求质量，不判断，不质疑，不评估，不批判。<br />不要急于分析组织。1）目的？2）害怕什么？3）我所不知道的？4）有哪些不利因素？</p></blockquote><p>上面写了这么多，终于到了最关键的一步。由于这是一次个人分享，所以也谈不上什么集思广益。不知道现阶段有没有什么头脑风暴的工具，我直接掏出几张草稿纸就开始搞了。上面的介绍也提到了，头脑风暴的原则，将大脑中的想法排空，为下一步工作做准备。</p><p><img src="https://media.xiang578.com/IMG_0321.jpg" alt="头脑风暴" /></p><h3 id="4-组织整理"><a class="markdownIt-Anchor" href="#4-组织整理"></a> 4. 组织整理</h3><p>在完成头脑风暴之后，我开始使用幕布来整理之前想到的想法。上图中蓝色的对勾就是在整理时的记号，标记整理到大纲中的内容。最后导出一张思维导图，到这里为止我就清晰的知道自己要分享的内容。</p><p><img src="https://media.xiang578.com/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%A4%A7%E7%BA%B2.png" alt="路径规划那些事大纲" /></p><h3 id="5-明确下一步的行动方案"><a class="markdownIt-Anchor" href="#5-明确下一步的行动方案"></a> 5. 明确下一步的行动方案</h3><p>目前我是在使用 Emacs 中的 org-mode 管理这些项目。所以，我就将自己要做的事情放到一个文件中。下图是完成这个项目之后的结果，当然也有些行动被我取消了。</p><p><img src="https://media.xiang578.com/15248181125952.jpg" alt="组织" /></p><h2 id="回顾"><a class="markdownIt-Anchor" href="#回顾"></a> 回顾</h2><p>来总结一下这次讲座之后的想法。</p><p>从辅助工具上来说，自己的 PPT 水平很差，也就认为不能把时间都放在准备 PPT 上。所以思考过其他一些工具，但都不是很乐观。考虑过两种类型的工具，可以生成 ppt 的软件，比如 Marp（利用 markdown 生成）以及 org-ioslide （利用 org-mode 生成），这两个工具很难实现图文混排。另外，就是幕布的演示模式，使用时需要展开和折叠大纲，有点麻烦，也容易导致出错。最后，还是只能硬着头皮去做了一个简单的 ppt 。</p><p><img src="https://media.xiang578.com/15248187817583.jpg" alt="幕布演示模式" /></p><p>从演讲效果来说，内容是很丰富的，但是我的演讲能力很差，之前在上面提到的问题，都暴露无疑，还是需要加强锻炼。也由于时间上的一些原因，我的准备不够充分，试讲次数也太少了，导致节奏控制也不好。还要对浪费17计算班同学的时间，表示一些歉意。</p><p><a href="https://github.com/xiang578/xiang578.github.io/blob/master/file/0425.pdf">点击查看我使用的ppt</a>，文字形式的分享等我有空再来整理吧。</p><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><ul><li><a href="http://files.cnblogs.com/files/speeding/%E6%90%9E%E5%AE%9AGTD%EF%BC%9A%E8%87%AA%E7%84%B6%E5%BC%8F%E8%AE%A1%E5%88%92%E6%A8%A1%E5%BC%8F2016.pdf">自然式计划模式</a></li><li><a href="http://www.cnblogs.com/speeding/archive/2012/05/19/2499566.html">【搞定GTD】用iPhone打造GTD实践1年后的心得体会 - 申龙斌的程序人生 - 博客园</a></li><li><a href="https://github.com/JimmyLv/jimmylv.github.io/issues/136">《搞定1:无压工作的艺术》 · Issue #136 · JimmyLv/jimmylv.github.io</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前几天，在导师的邀请下，给17计算机班的同学们进行了一次分享讲座。内容大概是关于去年在滴滴实习时做的一些工作以及主观意愿下的大学学习建议。作为一个号称实践 GTD 的人，必不可少的要将 GTD 原则使用到这一次分享准备过程中。&lt;/p&gt;
&lt;h2 id=&quot;自然式计划模式&quot;&gt;&lt;a</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="zufe" scheme="https://blog.xiang578.com/tags/zufe/"/>
    
    <category term="gtd" scheme="https://blog.xiang578.com/tags/gtd/"/>
    
  </entry>
  
  <entry>
    <title>采访一则</title>
    <link href="https://blog.xiang578.com/post/interview.html"/>
    <id>https://blog.xiang578.com/post/interview.html</id>
    <published>2018-04-21T05:34:05.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>前一整子学院内有关部门对我进行的采访，正好放在这里记录一下。【】这个内部是我现在补充的内容。</p><blockquote><p>Q1：在大学学习的这几年里，可有一事令你感触颇深，对你影响巨大？能否与大家分享一下？</p></blockquote><p>【没有回答，现在很难被一件事情所影响】</p><blockquote><p>Q2：很少有人在人生的道路上总是一帆风顺，你可曾遇到过难以解决的挫折？你是怎样克服它的？</p></blockquote><p>【没有回答，向前看，不回头】</p><blockquote><p>Q3：学长一直以来都是成绩优异，然而大学生活必定不能只有学习，学长是如何合理安排自己的时间的呢？</p></blockquote><p>最简单的方法是善于利用日历软件。每学期将自己的课表以及固定时间要做的事情（比如每周二、四下午都要训练）输入到软件里面，作为已经分配的时间。每周、每天将必须要完成的任务找到一个截止日期前的时间块填入。复杂一点可以去尝试学习 GTD。<br />【比起和安排时间，更重要的是控制欲望】</p><blockquote><p>Q4：作为信工学子，大家都知道你的代码十分厉害，能否跟学弟学妹透露一下学习的妙招？</p></blockquote><p>平时多写算法题目或者是多做项目。刚开始可以从书籍、博文、mooc等渠道找到自己喜欢的内容模仿，然后自己在这个基础上尝试添加的代码。<br />【上一篇博文中有过类似的感叹，其实我的基础也很不扎实】</p><blockquote><p>Q5：学长曾经参加过许多国家级乃至国际的竞赛，初次参加大型竞赛时可会紧张？你是如何克服这些心态上的问题的呢？</p></blockquote><p>一般来说，编程比赛时间比较长，相对来说是比较自由的。紧张时可以尝试先趴着睡一觉，然后等到心情平复之后，再发挥出自己的正常水平就好了。不要有太多成绩上的压力或者是幻想。<br />【刚开始以为自己参加比赛能有奇迹发生，后来开始期待队友能 Carry。最后发现只能做自己，顺其自然。】</p><blockquote><p>Q6：学长刚毕业就接到滴滴出行的offer，令人羡慕不已，每个人都想变得优秀，学长可不可以分享一下努力的过程？</p></blockquote><p>凡事预则立不预则废。 很多时候，我们想要做的事情都是有前人做过的，所以可以从网上收集大量的资料。对于找工作来说，很多人会在博客或者论坛上分享面经，通过收集这些，看一下企业一般会考察本科生哪些方面知识，以及什么样的经历会给自己加分。然后朝着这些方向去努力。<br />【这些话是我自己经历找工作痛苦之后，才总结出来。人生就是一张信息战。】</p><blockquote><p>Q7：图书馆是许多同学经常待的地方，你最喜欢哪一类的书籍？对哪本书印象最为深刻？</p></blockquote><p>好像没有特别喜欢的一类书，大概什么类型的书都看，一般是了解到某一本感兴趣的书，就会去图书馆找一下。另外，我大部分时候去图书馆都是看报纸和杂志。<br />这么多时间下来，看完之后收获最大的书是《搞定I：无压工作的艺术》。这本书是 GTD( Getting things done) 的入门读物，主要介绍了一套个人任务管理的方法。如果你感觉生活杂乱无章，可以尝试学习这套方法来规划生活。<br />【不知道为什么，我一直想给身边的人推广 GTD 的原则。】</p><blockquote><p>Q8：在学习与代码之余，你有什么十分热爱的东西，并为它坚持不懈吗？能否与大家分享一二？</p></blockquote><p>写日记。这个爱好从高中开始，最初是写在笔记本上，由于不会搞手账之类的东西，日记的形式很单调。后来受到《晨间日记的奇迹》启发，开始使用为知笔记来记日记，可以同时记录今天拍摄的照片或者是视频。另外，每个日期开一篇笔记，每年都在同一篇笔记上更新，可以手动实现去年今日功能。<br />【记日记可以发现自己吧】</p><blockquote><p>Q9：每个人都拥有属于自己的生活习惯，学长有哪些良好的生活习惯能与学弟学妹分享一下吗？</p></blockquote><p>充分挖掘手机或者电脑的功能来体验数字化生活。推荐一些我自己使用的软件给大家吧。<br />个人任务管理：OmniFocus<br />笔记软件：Evernote、Wiznote<br />时间记录：Toggl、Forest<br />记账：MoneyWiz<br />如果想要具体了解这些软件如何提高工学学习效率，推荐大家去少数派上找相关文章阅读。<br />【其实我想说的是一个「数字游民」的概念，通过使用这些优秀的软件，记录自己的成长以及提高自己的效率。】</p><blockquote><p>Q10：最后，请学长给学弟学妹们分享一段寄语，鼓励一下大家吧！</p></blockquote><p>大学时光是短暂的，希望你们能早点找到自己想做的事情，并为之奋斗。</p><p><a href="https://info.zufe.edu.cn/xx_nry.jsp?urltype=news.NewsContentUrl&amp;wbtreeid=1074&amp;wbnewsid=7926">新闻稿的链接</a><br />查看更多我的随笔，请点击 <a href="http://xiang578.com/">ZenTalk</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前一整子学院内有关部门对我进行的采访，正好放在这里记录一下。【】这个内部是我现在补充的内容。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Q1：在大学学习的这几年里，可有一事令你感触颇深，对你影响巨大？能否与大家分享一下？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;【没有回答，</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="zufe" scheme="https://blog.xiang578.com/tags/zufe/"/>
    
  </entry>
  
  <entry>
    <title>构建之法 第 0 次个人作业</title>
    <link href="https://blog.xiang578.com/post/build-to-win-homework-0x00.html"/>
    <id>https://blog.xiang578.com/post/build-to-win-homework-0x00.html</id>
    <published>2018-04-16T04:01:41.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>最近重新看邹欣写的<a href="https://book.douban.com/subject/25965995/">构建之法</a>，发现他的第一章课后作业很有意思，所以决定自己也来写一下。有关的作业说明在<a href="http://www.cnblogs.com/ChildishChange/p/7363123.html">2017BUAA软工助教 第0次个人作业 - ChildishChange - 博客园</a>中。</p><h2 id="结缘计算机"><a class="markdownIt-Anchor" href="#结缘计算机"></a> 结缘计算机</h2><blockquote><p>你为什么选择计算机专业？你认为你的条件如何？和这些博主比呢？（必答）<br />计算机是你喜欢的领域吗？是你擅长的领域吗？<br />你热爱这一专业吗？你对计算机的热爱是怎样的？仅仅是口头的吗？</p></blockquote><p>与大部分人差不多，在高考前我也没有对规划未来。考的也不是很好，没有太多的选择。所幸自认为还是有学习的劲头，想着大学找机会去转专业一波。当时也没有太在意专业的填报，最后机缘巧合来到了财经读计算机。大一下时，确实得到了转专业的机会。在面试时，突然感觉自己对转过去的专业也没有太多的好感，就和面试我的老师说放弃转专业，他们只能口头上鼓励我，男生学计算机也不错。大概就是这样子，就在计算机专业混到了大四。</p><p>比起这些博主来说，我没有他们那么强的主观能动性吧，能自觉地了解学习计算机各个领域的知识。而我从除了学校内的课程安排之外，自己了解其他知识都是浅尝而止。从大一开始差不多就点弯了天赋树，基本上课余时间都在写算法题目，参加各种各样的算法竞赛。幸运地拿了一些大大小小的奖，但是这也导致在知识面上和企业认为的计算机专业学生有很大的区别。目前来说，正在通过自己的努力，加强学习基础知识，希望能补齐自己的短板。</p><p>记得之前有一句话说，「数学是神造学科，计算机是人造学科」。在三年多的学习中，无时无刻不感受到前人思维的巧妙与严谨。比如 CPU 中的加法器，能通过简单的元器件和门电路搭配实现二进制加法以及进位。另外，计算机专业也能及激发最深处的好奇心。当你查阅相关的文档，实现软件的某些功能时，是否能想起童年某个午后拼成的模型？</p><h2 id="在计算机系学习"><a class="markdownIt-Anchor" href="#在计算机系学习"></a> 在计算机系学习</h2><blockquote><p>你对你的大学生活有什么想要吐槽的地方吗？你理想的大学教育应该是什么样子的？跟学校给你的有什么区别？比较你在中国大学的经历，你的老师和学校能做到和国外那样吗？如果不能，请分析一下为什么。（必答）  （8.26修改）<br />迄今为止，你写了多少代码，描述你做的最复杂的软件项目/作业。（必答）（8.24修改）<br />科班出身和北大青鸟有什么区别？<br />速成的培训班和打基础的大学教育还有mooc之间有区别吗？<br />学线性代数和概率论的时候，你是否有过这样的疑问「我们为什么要学这么多数学，这和我们的计算机有关系吗」，你现在是否还有这样的疑问？对这个问题，你有自己的解答了吗？那么其他学科呢？</p></blockquote><p>对于专业来说，我记得辅导员曾经在年级会议上讲过这样一段话：「有些人和我说，为什么高等数学这么难？这些书都是在大学没有扩招前编的，以你们的成绩当时都可能上不了大学。而且，我们学校搞计算机系，只是发现有很多教计算机基础的老师才开设的。」所以，也可以知道这个专业在学校的尴尬地位。</p><p>托尔斯泰说「幸福的家庭总是相似的,不幸的家庭却各有各的不幸」。反而对于计算机专业来说，感觉「普通学校的问题总是相似的，强势学校的优点却各有不同」。蒋宇东在<a href="https://book.douban.com/subject/4006425/discussion/22791674/">梦断计院 为梦前行</a>中写道他自己的学校计院有三大问题：1.学生基础薄弱 2.学风不正，溃散成性 3. 实践环节薄弱，人才位置错放。之前，我也一直在想一件事情：是老师水平太差学生懒得学还是学生水平太差还是老师懒得教？看到上面的三个问题才明白，冰冻三尺非一日之寒，事物发展都是相辅相成的。学生大部分都是过来享受大学美好生活的，对于有挑战的专业基础课比如编译原理、离散数学等都会用脚投票让他离开课程表。有幸能勉强开下去的课程，也会被改成能突击几天通过的样子。</p><p>记得大二导师前往台湾进修前找我谈过一次话。他希望我能自己养成一些良好的学习习惯，多去钻研计算机专业知识。并且还说，学院每年毕业的学生中，没有超过十个学生明白计算机是怎么一回事？三年多的时间里，我也接触过网上的一些 Mooc，不过差不多完全听完的只有浙江大学陈越教授的<a href="http://www.icourse163.org/course/zju0901-93001">数据结构</a>和吴恩达教授的机器学习。能坚持学习完这两门课，背后都是兴趣使然。数据结构是 ACM 比赛中很重要的一个知识点，当时自己学校还没有开设这门课，而且看书自学也不是很懂，所以就花大半学期的时间在网上去学习。机器学习则是希望未来能从事机器学习相关方面的工作才了解的。</p><p>陈越教授放在网上的数据结构课程相对于浙大内部来说，最大的变化是将教学语言从英文变成了中文，而且也适当的删除了部分内容（不是很确定？）。之前也在知乎上看到浙大计算机专业的课程安排，主干课程选用外国原版教材，以及使用英文授课。另外陈老师在讲解相关算法时，只介绍原理和思想。相关的实践需要你课后花时间进行，并且要求提交程序设计平台上进行黑箱测试。对比后来在自己学校开设的数据结构课程中，直接给你展示代码，也不强求你写的代码能正确运行，只要粘贴在实验报告中提交即可。《机器学习》的课程展示了美国教育的特点，每一周的课程都会包含一个小 quiz ，以及在课程中插入适量的编程大作业，学习的困难程度也就可想而知。</p><p>这些授课方式的不同，我认为是不同大学对于教育的理解不同。对于浙大之类的重点大学来说，所给予学生的是精英教育，侧重于培养学生的计算机科学基础。而下面的学校更多是大学教育成为通识教育的产物，本应该培养专业型人才，传授计算机技术，却由于种种原因没有这样开展。Mooc 的出现，打破了原有的时间、空间的限制，让我这样的普通学习接触到了国内外顶尖大学的教育资源，有利于教育公平。但失败之处也在于它的灵活性，不得不承认需要很强的自我约束能力才能完整地学习完网上的课程，不知你还记不记得那个当时看得热血沸腾的课程时，被你遗忘在哪个角落了？</p><p>最后，我觉得 Mooc 还缺少的同辈压力。吴军博士在《大学之路》中写道「当许多聪明、求知欲强、具有同情心而又目光敏锐的年轻人聚到一起时，即使没有人教，他们也能互相学习。他们互相交流，了解到新的思想和看法、看到新鲜事物并且掌握独到的行为判断力。」这大概就是学什么不重要，重要的是和谁一起学吧。一些 Mooc 虽然提供在线社区交流，但还是没有线下那种碰出火花的感觉。</p><p>对比完这些，计算机专业学生的另外一个主题不可能忽视——“自学”。最开始的作业说明给出的很多参考博文也说明了这一点。我印象最深的一个方法是徐宥在<a href="https://book.douban.com/subject/4006425/discussion/22802960/">掉进读书的兔子洞</a>中写道的「一字不漏敲入一本书的程序成了我推荐别人学习语言的最好办法」。古语读书百遍其义自见，计算机是一门实践的学科，只有在实践中才会学习到技术的本义。目前，自己在看《机器学习实战》时（相关代码和读书笔记见<a href="https://github.com/xiang578/MachineLearningAction">参考链接5</a><br />），也差不多用的是这个方法，将书中提到的机器学习算法一个字符一个字符地敲进编辑器，一次又一次地调试运行直到出现满意的结果。</p><p>在这样的学习中，我也可以回答这一部分的最后一个问题，我们为什么要学这么多数学，这和我们的计算机有关系吗？对于机器学习来说，本身是建立在概率论和线性代数的基础上，毕竟解释机器为什么能学习都需要用到霍夫丁不等式等相关知识。数学是一种工具，通过数学能将很多的计算机实践经验理论化，以此得到更好的发展。对比功力性很强的培训机构来说，接受科班教育的结果是有机会受到严格的数理化训练，这也能间接决定你在这个行业从事工作的层次和上限。</p><h2 id="未来规划"><a class="markdownIt-Anchor" href="#未来规划"></a> 未来规划</h2><blockquote><p>对于你未来在IT行业的发展，你有什么样的梦想或者未来想从事什么样的工作？你准备怎样来规划你技术道路，职业道路和社会道路？（必答）<br />你对于实现自己的梦想已经做了或者计划做什么样的准备？<br />你们马上就要面临实习了，你打算在企业内实习还是在实验室实习？<br />实习经验究竟有多重要？是否需要马上开始积累实习经验？</p></blockquote><p>前文也提到了，以我的目前的情况来看，大学中接受的教育和自己所学的技能都是和市场脱节的。所以，前一段时间也很迷茫，自己能做什么。所幸看到之前公司的同事所写的知乎专栏文章「谈“圈外”在校生如何更靠谱的拿到大厂算法/ML实习机会」（不知道为什么被删除了，所以无法提供链接），大意就是可以曲线救国，先就业再择业。</p><p><img src="https://media.xiang578.com/15236805736051.jpg" alt="" /></p><p>所以，我还是推荐出去实习的。不仅是走出象牙塔，感受一下工业界的需求。更重要的是大一点的企业都会安排专人对实习生进行相应的指导，使其能更快地朝工程师方向发展。</p><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><ol><li><a href="http://www.cnblogs.com/xinz/p/3803035.html">现代软件工程 第一章 【概论】练习与讨论 - SoftwareTeacher - 博客园</a></li><li><a href="http://www.cnblogs.com/ChildishChange/p/7363123.html">2017BUAA软工助教 第0次个人作业 - ChildishChange - 博客园</a></li><li><a href="https://book.douban.com/subject/4006425/discussion/22791674/">蒋宇东：梦断计院 为梦前行</a></li><li><a href="https://book.douban.com/subject/4006425/discussion/22802960/">徐宥：掉进读书的兔子洞</a></li><li><a href="https://github.com/xiang578/MachineLearningAction">xiang578/MachineLearningAction: 《机器学习实战》</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近重新看邹欣写的&lt;a href=&quot;https://book.douban.com/subject/25965995/&quot;&gt;构建之法&lt;/a&gt;，发现他的第一章课后作业很有意思，所以决定自己也来写一下。有关的作业说明在&lt;a href=&quot;http://www.cnblogs.com</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
  </entry>
  
  <entry>
    <title>使用 TaskPaper 实现 3 Things</title>
    <link href="https://blog.xiang578.com/post/how-to-use-taskpaper-to-do-3-thigns.html"/>
    <id>https://blog.xiang578.com/post/how-to-use-taskpaper-to-do-3-thigns.html</id>
    <published>2018-04-08T07:51:23.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>这几个月，一直在尝试 GTD 方法。有没有改善生活不知道，反正是软件尝试了一个又一个。前几天，又接触到了一款纯文本任务管理软件——<a href="https://www.taskpaper.com/">Taskpaper</a>。简单的尝试了一下，发现可以将这款软件结合进入 3 things 体系。</p><h2 id="3-things"><a class="markdownIt-Anchor" href="#3-things"></a> 3 Things</h2><p>看过很多时间管理的方法之后，才明白时间是不可以管理的。一个人独处的时候，明知道有很重要的考试需要准备，但还是会不知不觉地打开手机刷微信。很多时候，需要管理的不是时间，而是欲望。所以，在自我控制力很弱时，时间管理会加重你的疲劳感。</p><p>说到底，一个人的精力优先，能做的事情也很少。有一个很有名的原则叫做“二八原则”，套入到这里来就是，我们的生活是由 20% 的关键任务 + 80% 的普通任务组成。在理想的状况下，我们应该将 80% 的时间投入到那些 20% 的重要任务中。如何安排这 20% 的任务时，3 Things 的体系就孕育而生了。3 Things 指的是每天优先挑选出最关键的三件事情，优先处理。这三件事情的选择，需要结合你自身的目前情况、长久目标而决定。对于这个选择，你可以问自己，如果完成了其他事情，没有完成这三件事情，这一天不合格吗？如果完成了这三件事情，而没有完成其他事情，这一天合格吗？</p><h2 id="taskpaper"><a class="markdownIt-Anchor" href="#taskpaper"></a> Taskpaper</h2><p>如同前文所说，Taskpaper 是一款纯文本软件，所以界面非常的简洁。下图右侧就是他的主界面，和大家经常使用的文本编辑器没有太大的区别。软件通过一些语法来实现任务管理，比如 <code>:</code> 实现一个项目，用 <code>-</code> 实现一条任务，再使用 <code>@</code>开头实现标签。软件更强大的地方在于，可以自定义 CSS 文件，所以可以很轻松地将一些标签搞上不同的颜色。</p><p>有点遗憾的是，TaskPaper 只用 macOS 版本，其他平台只能通过文本编辑器+插件的方式实现，比如 Sublime Text 中有一个能实现类似功能的插件 <a href="https://github.com/aziz/PlainTasks">aziz/PlainTasks: An opinionated todo-list plugin for Sublime Text editor (version 2 and 3)</a>。<br /><img src="https://media.xiang578.com/15230982087065.jpg" alt="" /></p><h2 id="系统工作流"><a class="markdownIt-Anchor" href="#系统工作流"></a> 系统工作流</h2><p>其实，能想起来用 Taskpaper 做三件事情，是受到了<a href="https://www.bilibili.com/video/av18698116">《18分钟》：如何用18分钟变身效率达人？| 狗熊月读64</a>影响。视频中，大狗熊老师介绍了一个习惯，会每天在文本文档中，列出5项需要完成的任务（对的，比三件事情多出了两项），而且会对事情进行估计，包括四象限中的位置、预计完成时间以及和自己人生的那个目标有关。</p><p><img src="https://media.xiang578.com/15230987994151.png" alt="" /></p><p>四象限法则是时间管理中的一个重要理论，它将我们需要处理的事情分成了下图显示的四类，并且指导在日常生活中应该关注重要但是不紧急的事情，也就是第二象限。<br /><img src="https://media.xiang578.com/15230990545088.jpg" alt="" /></p><p>一般的 GUI 任务管理软件，列出事情还算比较方便，但是做评论却没有那么便利。TaskPaper 比起在文本文档中直接写，体现出强大的整合能力。比如，我可以选定 MachineLerninginAction 的标签，可以快速的将我之前安排过的相关任务整合到一起。</p><p><img src="https://media.xiang578.com/15230993446908.jpg" alt="" /></p><p>所以，每天晚上睡觉前的 10 分钟，我会回顾一下今天完成的事情，并给第二天安排需要做的 3 Things。确保第二天醒来，我可以直接开始做当天的重点。达到从头到尾、逐一处理、不避不拖、一次一事的 GTD 执行境界。</p><h2 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h2><ul><li><a href="https://github.com/xiang578/xiang578.github.io/issues/11">纯文本任务管理思考 · Issue #11 · xiang578/xiang578.github.io</a></li><li><a href="https://github.com/JimmyLv/jimmylv.github.io/issues/288">重回纯文本，兼谈电子化时代 GUI 工具的弊端与反思 GTD · Issue #288 · JimmyLv/jimmylv.github.io</a></li><li><a href="https://sspai.com/series/22/list">TaskPaper 使用指南的所有文章 - 少数派</a></li></ul><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这几个月，一直在尝试 GTD 方法。有没有改善生活不知道，反正是软件尝试了一个又一个。前几天，又接触到了一款纯文本任务管理软件——&lt;a href=&quot;https://www.taskpaper.com/&quot;&gt;Taskpaper&lt;/a&gt;。简单的尝试了一下，发现可以将这款软件结合进</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="gtd" scheme="https://blog.xiang578.com/tags/gtd/"/>
    
    <category term="taskpaper" scheme="https://blog.xiang578.com/tags/taskpaper/"/>
    
  </entry>
  
  <entry>
    <title>「只言片语」| 2018/03/07</title>
    <link href="https://blog.xiang578.com/post/excerpt-2018-03-07.html"/>
    <id>https://blog.xiang578.com/post/excerpt-2018-03-07.html</id>
    <published>2018-03-07T13:13:09.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>多年之前阅读《读者》时，最喜欢杂志中的语丝栏目。所以准备向其致敬，收集每周我在阅读中收获的只言片语。</p></blockquote><h2 id="1-学习"><a class="markdownIt-Anchor" href="#1-学习"></a> 1. 学习</h2><ul><li>“当我在你们这个年纪，有段时间，远离人群，独自思索，我的人生到底应该怎样度过。某日，我偶然去图书馆，听到泰戈尔的演讲，而陪同在泰戈尔身边的人，是当时最出名的学者。那些人站在那里，自信而笃定，那种从容让我十分羡慕，而泰戈尔正在讲对自己的真实有多么重要，那一刻我从思索生命意义的羞耻感中释放出来，原来这些卓越的人物也会花时间思考这些，他们也觉得这些是重要的。”<ul><li>语出《无问西东》的吴岭澜给学生介绍泰戈尔时。“自信而笃定”，简单五个字，回味无穷。</li></ul></li><li>凡是机器或者人工智能能够代替的能力，就是不值得花时间去训练的能力；凡是不能迁移到其他领域的能力，也是不重要的能力。<ul><li>机器学习的火热带来思考，如何才能避免自己在未来被替代。</li></ul></li><li>只要你停下来认真思考一下就会明白，投资比特币简直愚蠢至极。这是不安好心的坏人们鼓吹的疯狂泡沫，引诱人们追求不劳而获、一夜暴富的妄梦…… 你知道，黄金之所以具备流通价值，是因为人类根本无法轻易地得到黄金，因此黄金才显得稀有。相信我，人类完全有能力创造出更多的比特币——尽管他们会告诉你由于种种限制无法这么做。千万不要相信这些鬼话，当好处足够多的时候，坏事就会发生。<ul><li>根据所学为数不多知识判定，比特币之类的数字货币已经成为24小时不断线的赌场</li></ul></li></ul><h2 id="2-理性"><a class="markdownIt-Anchor" href="#2-理性"></a> 2. 理性</h2><ul><li>总体来说，给我的感悟就是老罗成长了，做实事才是真正锻炼人的，相比罗振宇哪个挤眉弄眼心高气傲的样子，罗永浩讲起来自己的产品那种娓娓道来朴实坦诚的样子让我能容易喜欢。<ul><li>语出知乎网友评价罗振宇对罗永浩的专访。记得有一段时间，疯狂地看罗永浩的演讲视频，完全被他的行为所喜迎，记得印象最深的一句是通过干干净净的赚钱，让人相信干干净净的赚钱是可能的。可不知道为什么不喜欢看《罗辑思维》，现在找到答案了。</li></ul></li><li>对熟人宽容大度，对陌生人零容忍。<ul><li>有另外一种印象：坏人远在天边，好人都近在眼前。</li></ul></li><li>罗辑思维搞了四年，知乎上大家骂了四年。四年中罗辑思维从最初一个靠打赏的小书童，成长为一个创业者，继而成长成一个做平台的知识服务提供商，甚至邀请了一众精英在主流媒体和新媒体上大搞跨年演讲，钱赚得盆满钵满，影响力也是一日千里。而那些罗辑思维的黑粉，四年来又收获了什么？罗胖的一句话，黑粉真的可以好好琢磨琢磨，原话忘了，大概的意思是：我不会再否定一个人，因为否定他，是关闭了我自己观察世界的一扇门。<ul><li>知乎网友对得到的评价。因为这个，开始接触一些自己之前无名抵触的东西，还是有收获的。</li></ul></li><li>毕业20年之后，去参加一下同学聚会，不是要你去攀比人生成就，也不是要你去利用同学资源，而是看看人生20年长跑之后，决胜千里的东西究竟是什么，输掉人生长跑的东西又是什么？</li><li>我想不起来有什么真正的机会是稍纵即逝，追悔莫及的，我想不明白为什么人们非得那么迫不及待，惶惶不可终日。错过了成为 Netscape、Yahoo 的机会，你可以成为 Google ；错过了成为 Google 的机会，你可以成为 Facebook ；错过了成为 Facebook 的机会，你可以成为微信，成为滴滴，成为 ofo。如果区块链真的是一个大机会，它怎么可能会是一个手慢无的机会？况且，有哪个真正的大机会，从一开始就孕育出了空前绝后的大项目？有哪项有前景的伟大技术，不是慢慢成就它的伟大？<ul><li>区块链或者数字货币火热的反思</li></ul></li></ul><h2 id="3-欢喜"><a class="markdownIt-Anchor" href="#3-欢喜"></a> 3. 欢喜</h2><ul><li>世界于你而言，无意义无目的，却又充满随心所欲的幻想，但又有谁知，也许就在这闷热令人疲倦的正午，那个陌生人，提着满篮奇妙的货物，路过你的门前，他响亮地叫卖着，你就会从朦胧中惊醒，走出房门，迎接命运的安排。<ul><li>泰戈尔《爱者之殆》，可能现实中叫醒你的就是你自己。</li></ul></li><li>好看的皮囊是确实好看，有趣的灵魂是自以为有趣。<ul><li>取“好看的皮囊千篇一律，有趣的灵魂独一无二”之反</li></ul></li></ul><h2 id="4-番外"><a class="markdownIt-Anchor" href="#4-番外"></a> 4. 番外</h2><ul><li>Timetrack：计时软件，点击图标就能开始计时，配合 URL Scheme 直接跳转到你预设的 App 中。</li></ul><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;多年之前阅读《读者》时，最喜欢杂志中的语丝栏目。所以准备向其致敬，收集每周我在阅读中收获的只言片语。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1-学习&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-学习&quot;</summary>
      
    
    
    
    <category term="随想集" scheme="https://blog.xiang578.com/categories/%E9%9A%8F%E6%83%B3%E9%9B%86/"/>
    
    
    <category term="timetrack" scheme="https://blog.xiang578.com/tags/timetrack/"/>
    
  </entry>
  
  <entry>
    <title>解决 OmniFocus 中 Applescrpit 脚本输出文件中文乱码问题</title>
    <link href="https://blog.xiang578.com/post/AppleScript-encode-error.html"/>
    <id>https://blog.xiang578.com/post/AppleScript-encode-error.html</id>
    <published>2018-03-05T08:45:30.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>在学习<a href="https://sspai.com/series/27">OmniFocus 入门与进阶 - 少数派</a>教程中，了解到了一个 Applescript 脚本 <a href="http://forums.omnigroup.com/showthread.php?t=23290">Weekly project report generator（周报生成器）</a>。这个脚本可以将 OmniFocus 中前七天活跃的项目以及完成的动作导出成为一个<code>.md</code>文件。这样子，可以大大减轻周回顾时回忆本周完成任务的压力，也可以将生成的文本粘贴到周报中使用。</p><p>但是当我第一次运行这个脚本时，生成的文件中所有的中文字符都变成了问号。</p><p><img src="https://media.xiang578.com/15202379974944.jpg" alt="错误" /></p><p>由于，之前没有接触过中文显示为问号的问题。所以，与少数派教程的作者联系，他很快给我回复了一份邮件，并给出两个建议。</p><p><img src="https://media.xiang578.com/15202381199945.jpg" alt="回信" /></p><p>按照邮件中的建议，我进行了下面三个尝试。</p><ol><li>Sublime Text中安装转化编码方式的插件<code>ConvertToUTF8</code>，最终发现无法识别出生成文件的默认编码。</li><li>使用系统自带的文本编辑打开时，还是显示编码错误。</li><li>利用<code>homebrew</code>安装了<code>enca</code>软件，使用<code>enca -L zh_CN file</code>无法检测出文件的编码方式。</li></ol><p>无奈这些方式都没有找出问题的所在，只好打开脚本编辑器，查看这个脚本是怎么写的。</p><p>如下图所示，该脚本将需要输出的字符串指定为<code>Unicode text</code> 格式，用 <code>write</code> 将这个字符串写进文本中。<br /><img src="https://media.xiang578.com/15202388604296.jpg" alt="" /></p><p>根据之前的编程经验，输出文本一般都能指定编码方式。所以又用 <code>Dash</code> 来查看 AppleScript 中 <code>Write</code> 的相关语法。</p><p><img src="https://media.xiang578.com/15202391269270.jpg" alt="" /></p><p>最终，找到 <code>as</code> 可以用来指定编码方式，成功解决乱码问题。</p><p><img src="https://media.xiang578.com/15202392024378.jpg" alt="" /></p><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在学习&lt;a href=&quot;https://sspai.com/series/27&quot;&gt;OmniFocus 入门与进阶 - 少数派&lt;/a&gt;教程中，了解到了一个 Applescript 脚本 &lt;a href=&quot;http://forums.omnigroup.com/showthre</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="applescript" scheme="https://blog.xiang578.com/tags/applescript/"/>
    
    <category term="omnifocus" scheme="https://blog.xiang578.com/tags/omnifocus/"/>
    
    <category term="dash" scheme="https://blog.xiang578.com/tags/dash/"/>
    
  </entry>
  
  <entry>
    <title>GTD 实践 1 个月心得</title>
    <link href="https://blog.xiang578.com/post/gtd-one-month.html"/>
    <id>https://blog.xiang578.com/post/gtd-one-month.html</id>
    <published>2018-02-28T08:03:32.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>不知不觉混到大四，突然感觉有一堆事情把我压的喘不过气来。所以就想学习一种任务管理方法。GTD 正好在这个时候重新进入我的视线中。根据 wikipedia 上的介绍：GTD，全称 Getting Things Done ，中文一般翻译为搞定，是一种行为管理的方法，也是戴维·艾伦写的一本书的书名。GTD 的方法根据一个理念，大脑是用来思考的，好比计算机中的 CPU。所以，我们需要把要做的事情从大脑中移除，放在一个可靠的外部系统中，这就是 GTD 系统。</p><p>根据网上的教程，学习 GTD 第一步是阅读戴维·艾伦的书《搞定I：无压力工作的艺术》（<a href="https://mubu.com/doc/lY8ROqZ43">读书笔记链接</a>）。这本书，其实我在大一就借来看过，但是由于翻译的实在是太差了，所以没有看完就还回去了。所以这一次重新学习时，我选择从阅读《小强升职记》（<a href="https://mubu.com/doc/8PMZziWB3">读书笔记链接</a>）开始，这一本书通过讲述一个职场新人小强的虚拟故事，介绍了很多任务管理、项目管理、个人心智成长的方法。最后，还阅读前人实践的心得。貌似 GTD 这几年不是很热门，很多文章都很旧了，没有太多的实际意义。我只推荐两个系列文章，第一个是申龙斌的博客园博客<a href="http://www.cnblogs.com/speeding/category/307423.html">搞定GTD - 随笔分类 </a>，他践行 GTD 五年多的时间，写下很多心得体会，是很不错的参考资料，目前他选择在微信公众号（申龙斌的程序人生）中更新为主。最关键的一点，他也是一名007er。第二个是<a href="https://zhuanlan.zhihu.com/timehack">滴答清单与GTD时间管理</a>知乎专栏，从名字中可以看出这个系列的特点。不要因为你不用滴答清单而错过里面的内容，毕竟 gtd 方法是通用的。</p><p>开始打造 gtd 系统之前，还需要挑选一些工具。《搞定》书中是介绍的是利用纸笔和篮子来完成gtd，这是一个不错的方法。但是，结合实际，我没有太多的实体材料，所以选择使用软件。前几年，我也使用过很多任务管理软件，有 2Do、奇妙清单和滴答清单等。考虑到目前使用的组合是 iPhone + MacBook Pro，所以我选择了 OmniFocus 。第一次打开这个软件简直让我头皮发麻，功能很强大，但是需要深度学习才能运用自如。我是跟着这一个教程<a href="https://sspai.com/series/27">OmniFocus 入门与进阶 - 少数派</a>，才掌握初步的使用方法。OmniFocus 吸引我的是任务过滤功能，也就是透视。简单来说，通过定义一些规则，来展现你的任务。</p><p>介绍 gtd 时，我将结合下面这张图，来讲讲我是怎么做的。一般来说，gtd包括 5 个步骤：收集、厘清、组织、回顾和执行。</p><p><img src="https://media.xiang578.com/15198098685374.png" alt="" /></p><p>（一） 收集<br />对应图中开始的一步，将材料放入系统的工作篮（inbox）。这里的材料是一个很广泛的概念，可以是你要做的事、想读的一本书或者是要学的技能等等。根据最开始的介绍，成为一个可靠的系统，需要将你所有的材料都放进这个inbox。所以，你在打造系统前，需要找个空闲的时间（书中说是2天）和过去做一个告别，好好的把任务整理出来。</p><p>在第一次收集前，我利用幕布把自己的材料来源整理了一下，主要分布在手机和电脑的一些软件中。根据这张大纲的顺序，最后整理完成时大概有300多件。完成这一次整理后，再有要做的任务记录到inbox中，自己定时清空就完成这一步了。</p><p><img src="https://media.xiang578.com/GTD%E6%95%B4%E7%90%86%E6%80%9D%E8%80%83.png" alt="GTD整理思考" /></p><p>（二）厘清</p><p>在完成上一步收集后，我们需要开始第一次过滤这些事情。从inbox的顶端开始一件件评估我们收集的事情，对于每一件事情，考虑这件事件需要现阶段去做吗？对于不需要去做的事情，我们需要将他们分成三类：垃圾（没有任何价值，直接抛弃）、将来/也许（以后有机会做，放在一个专门的列表中）、参考资料（需要时再来参考）。</p><p>（三）组织</p><p>这是GTD中最复杂的一步。我们把需要现阶段去做的事情继续分类：第一类是行动，只需要一步完成的任务，第二类是项目，需要执行多个步骤才能完成的任务。首先是项目，书中提供了一种分析项目的方法：自然项目分析法，通过这个方法可以有效的把项目搞明白。当然，对于我们这样的新手，虽然有了这个强力的武器，但还是不容易一开始就将项目拆解的明明白白。这时候，我们只需要考虑一个问题：下一步行动是什么？比如说，如果你看了我的文章，也想要学习 GTD ，这时候就有了一个项目：学习 GTD。由于你更本不知道这是什么东西，所以无法分析项目，所以只能考虑下一步行动：利用搜索引擎来搜索 GTD 相关的介绍。完成这个行动之后，下一步行动就可能变成去买几本书了。通过这种每次思考一步的方法，来完成大的项目。说完项目，接下来就是动作。这里又诞生了一个很厉害的方法：两分钟原则。如果在组织的时候，这个动作可以在两分钟之内完成，那就直接去完成它，不用下面的步骤，特别声明这里的两分钟指一种很短的时间。对于其他动作，你还要考虑是否可以由其他人完成，如果是直接去委托他人完成。对于有时间限制的事情，比如明天下午开一个会之类的，就要写进日程表来提醒了。如果都不是，那么就放进你的文件夹中，等待后续执行。</p><p>（四）回顾</p><p>可能有些奇诡，事情还没有执行，怎么就开始回顾了。是的，书中就是这么安排的。这里的回顾是指，看看你做了什么，有什么需要反思的。主要用两种方式，第一种：完成项目之后回顾；第二种：定时回顾，可以是日回顾、周回顾、月回顾以及年回顾。目前，我主要做的是日回顾和周回顾，日回顾主要是简单看一下做了什么，周回顾有专门的检查清单，以及会写回顾记录。</p><p><img src="https://media.xiang578.com/15198152921763.jpg" alt="" /></p><p>（五）执行</p><p>这里就要认识到任务管理的本质是管理任务，而不是帮你完成任务。所以，还是需要你去执行。GTD 提供的只是一种简单的挑选方法。当你没有空闲时，考虑当前的情景（在什么户外还是家中，有手机还是电脑），有多少时间可以用，当前精力（精力旺盛还是昏昏欲睡）以及有没有重要的事情需要做。综合这些情况，找出需要做的事情，然后去做吧。</p><p>最后，根据一些人的说法。GTD 执行一年之后，才能算是懂了，上面就是我这个执行一个月的菜鸟的见解。由于时间有限，GTD 的六个层次、三个原则、自然分析法都没有写到。更关键的是，也没有结合 OmniFocus 来写我是具体怎么执行的。总结一下，这一个多月来，我第一次认识到要做的事情居然有这么多，真是时不我待。用原来的方法确实能做很多事情，但是接触 GTD 之后，我开始关注目标制定以及回顾方面的实践。</p><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不知不觉混到大四，突然感觉有一堆事情把我压的喘不过气来。所以就想学习一种任务管理方法。GTD 正好在这个时候重新进入我的视线中。根据 wikipedia 上的介绍：GTD，全称 Getting Things Done ，中文一般翻译为搞定，是一种行为管理的方法，也是戴维·艾</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="omnifocus" scheme="https://blog.xiang578.com/tags/omnifocus/"/>
    
    <category term="gtd" scheme="https://blog.xiang578.com/tags/gtd/"/>
    
    <category term="evernote" scheme="https://blog.xiang578.com/tags/evernote/"/>
    
    <category term="mubu" scheme="https://blog.xiang578.com/tags/mubu/"/>
    
  </entry>
  
  <entry>
    <title>小学十周年同学聚会</title>
    <link href="https://blog.xiang578.com/post/primary-school-classmate-10th-anniversary-party.html"/>
    <id>https://blog.xiang578.com/post/primary-school-classmate-10th-anniversary-party.html</id>
    <published>2018-02-21T06:58:10.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>不知不觉中，小学毕业快要十年了（2008-2018）。前几个月，就有同学开始策划组织聚会。就这样把我的思绪拉回十年前的。</p><p><img src="https://media.xiang578.com/WechatIMG21.jpeg" alt="学校校门" /></p><p>看上面的图可以知道，学校的名字叫做——晓村小学。值得注意地是，晓村不是地名。根据一般的套路，这样取名都是有故事的。查阅百科可以看到下面的介绍：「晓村小学位于沿海的椒北平原，创办于1929年2月26日，当年，中共地下党员、著名教育家林迪生、地下党的外围组织—“乙丑读书社”社员陈鹤亭，留日学生陈诗斋，当地豪绅陈孔彰等发起创办了这所红色的学校。当年他们效法南京晓庄师范“教学做”合一的模式创办,故把把学校取名为晓村小学。随后，陈叔亮、徐明清等一大批地下党员相继来晓村任教，宣传马克思主义，传播革命真理，创造了晓村校歌，颁布了晓村校训，办学方向十分明确。大革命时期，他们以学校作为地下党活动场所，曾先后有十多位地下党员驻足晓村小学，从事革命活动并创造了许多惊天动地。可歌可泣的辉煌业绩，被誉为“荒原里的灯塔”，享誉椒江南北两岸。」所以，这是一所有革命传统的学校。目前来说，学校以及异址重建，和百度百科中的介绍还有关系的只有校名和校歌。</p><p><img src="https://media.xiang578.com/WechatIMG23.jpeg" alt="校歌" /></p><p><img src="https://media.xiang578.com/WechatIMG22.jpeg" alt="学校旧样" /></p><p>如果让我来评价的话，说到底是一所农村学校。记得我自己当时的时候，教育水平是很差的，不知这么多年过去了有没有提高。当年的校舍也很朴素，但是前几年，也进行了现代化改造，总的来说比我们当年的条件不知道好到哪里去。</p><p><img src="https://media.xiang578.com/WechatIMG20.jpeg" alt="教室旧样" /></p><p>聚会定于大年初五举行，下午一点的时候我就差不多达到了学校。找到原来班级的时候，也有很多人在里面了，很多同学我们都十年没有见过了，却发现还能叫出他的名字。和各位老板聊到了3点左右，才开始活动。</p><p><img src="https://media.xiang578.com/Jietu20180221-194437.jpg" alt="学校新样" /></p><p>翻出下面的老照片，后面一排的左边罗伟迪大佬已经出国工作。中间的陈子翔同学没有来参加聚会，也不知道近况如何。右边就是我。前面一排左边的是陈凌超，右边是罗飞。见到他们，发现他们是越来越强壮。说起来，我还和陈哥一起演过小品。陈哥当时演的角色，用现在来说就是女装大佬。演完之后，我还听见当时有人说“原来这个是男的”。可见我陈哥功力深厚。罗哥是我同桌，被我坑过很多次。</p><p><img src="https://media.xiang578.com/WechatIMG26.jpeg" alt="WechatIMG26" /></p><p>教室里大概来了三十多位同学以及三位老师。在班长的提一下，我们首先进行了自我介绍，然后三位老师讲了一些话。</p><p>第一位是六年级那年教数学的郑必君老师。还记得当年最后一节数学课时，老师讲起自己的小学同学，很多人到那时候都没有再见过面了。谁知道，再次见到他也是十年后了。他又讲了自己的其他故事，82年高中毕业，高考失败之后，顶替老爸过来教书，很多同学进行高复，现在都当了官。自己由于有了工作，便没有继续去高考了，安心从事小学教育工作。当有同学和他联系举办同学会时，非常高兴，特地找出毕业时拍的照片。</p><p>第二位是教过我最多的数学陈平芬老师。最早是在二年级的时候，当时教我的数学老师怀孕了，然后她过来代课。之后一直到五年级时，她自己怀孕了，由其他老师代课，就再也没有教过我们了。陈老师回忆自己刚开始教书时，就像我们现在这么大。没有太多想法，只想着怎么把我们教好。印象最深的是，有一次找我上去写题目，写完之后，看见我最后算错了答案，说了一句“太粗心了，昨天的试卷也这样算错了”。不知道，当时如果改正了这个错误，现在会在哪里……</p><p>最后一位是四到六年的教授语文同时也是班主任的陈菊红老师。印象中，听写没有通过，我还抄过50遍的课后词组。</p><p>完成介绍之后，班长开始播放精心制作的<a href="http://xiaoying.tv/v/z5qfqz/1/?fromApp=XiaoYing&amp;toApp=wechat&amp;from=groupmessage&amp;isappinstalled=0">十周年会议视频</a>。视频播放的时候，点点停停，给我们介绍老照片中的每一个人。十年光阴，弹指一挥间就过去了。</p><p><img src="https://media.xiang578.com/WechatIMG17.jpeg" alt="教室新样" /></p><p>最后，在小雨中留下了一张合影。很可惜，许多同学由于种种原因，没有机会过来合影。也不知道剩下的时光。还可以留下多少张这样合影。</p><p><img src="https://media.xiang578.com/WechatIMG18.jpeg" alt="2018年照片" /></p><p><img src="https://media.xiang578.com/WechatIMG27.jpeg" alt="2008年毕业照" /></p><p>晚餐选在了一家海鲜餐厅，不过大家有些拘束，酒准备好了，都没有讲故事的人。反倒是吃完饭之后的抢红包调动了全场的气氛，微信群中出现的红包之后，伴随着激动和叹息，可惜我自己抢到了很多0分的红包。天下无不散的宴席，最终我们散了。下次再赴十年之约。</p><p>在这次聚会之前，我看到了下面的两段话。</p><blockquote><blockquote><p>毕业十年的同学聚会，大概是最“丑陋”的同学会。此时，人生的分水岭已清晰可见。同学已完全褪去学生时代的单纯。每个人都变得居心叵测，面目狰狞。华丽的包厢里全是人生的演员，华丽的衣服里全是生活的褶皱。同学们言语之间未必是炫耀，但我们会以为他在炫耀；同学之间未必没真情，但我们已经扭曲了真情。因为人到中年，纯真已经退却，人生尚未悟透；危机四伏，刀光剑影。</p></blockquote></blockquote><blockquote><blockquote><p>毕业20年之后，去参加一下同学聚会，不是要你去攀比人生成就，也不是要你去利用同学资源，而是看看人生20年长跑之后，决胜千里的东西究竟是什么，输掉人生长跑的东西又是什么？</p></blockquote></blockquote><p>显然，这两段话是对于大学毕业来说的。但让我下定决心去参加聚会的，正是这“看一下决胜千里的东西究竟是什么？”十年间，很多人事业有成，很多人娶妻生子，还有一些像我这样还没有走出校园，如同新华字典中所说，我们都有光明的前途。现在回想起来，小学真是无忧无虑，每天上课听讲，写作业，老师的有些教育方法很野蛮，但也学到了知识。放学后，和同学去附近采桑叶养蚕，去池塘边钓龙虾，周末一起玩游戏王。回忆是美好的，可人终究要去看看世界有多大。</p><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不知不觉中，小学毕业快要十年了（2008-2018）。前几个月，就有同学开始策划组织聚会。就这样把我的思绪拉回十年前的。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://media.xiang578.com/WechatIMG21.jpeg&quot; alt=&quot;学校校门&quot; /&gt;&lt;</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="school" scheme="https://blog.xiang578.com/tags/school/"/>
    
  </entry>
  
  <entry>
    <title>007 不出局活动与我</title>
    <link href="https://blog.xiang578.com/post/007-and-me.html"/>
    <id>https://blog.xiang578.com/post/007-and-me.html</id>
    <published>2018-02-13T07:32:02.000Z</published>
    <updated>2024-05-12T11:15:03.461Z</updated>
    
    <content type="html"><![CDATA[<p>最初看到 007 活动是在申斌龙的公众号中，当时没有什么在意，也没有深入了解。之后，我在知乎上的一个专栏文章中，看到了这个活动的详细介绍。吸引我“冲动”消费加入这个社群的是“每7天写一篇文章，连续写7年。”这种运作方式。简单的计算了一下7年是2555天（简化问题，不计算闰年情况），一共需要写365篇文章才能坚持到最后。而且只需要花369元，相当于你每写一篇就能赚一块多。</p><p>除了上面的计算，选择加入007活动的另外一个原因是，战友之间的互相点评。从自己的情况来看，在网上消费了很多文章、视频，很少会去留言以及发弹幕。自己写博客3年多以来，也没有收到多少有价值的留言。所以，除了坚持写作，更需要外部的力量来推动自己进步。</p><p>最后一个原因是，我相信了解一个人，最有趣的方式是通过不断地阅读他的文字，见证他的成长历程。</p><p>在83班的班级群中，我发了下面的自我介绍，现在贴在这里再介绍一下我自己。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">【编号】007-6253</span><br><span class="line">【姓名】 Ryen</span><br><span class="line">【城市】 杭州</span><br><span class="line">【职业】 学生</span><br><span class="line">【公众号】 简书：学涯湖畔 博客：xiang578.com</span><br><span class="line">【标签】 </span><br><span class="line">【爱好】 阅读、研究和分享软件</span><br><span class="line">【愿帮助大家】 分享基础的算法知识，推荐能促进生产力的工具，主流的个人博客搭建</span><br><span class="line">【愿得大家帮助】 分享各自的生活感悟</span><br><span class="line">【从哪里得知的007】知乎</span><br><span class="line">【加入007理由】  坚持持续写作，从写作中获得成长的力量</span><br><span class="line">【对83班的期望】共同成长</span><br><span class="line">【7年后想成为什么样的自己】体会到GTD理念中的心如止水</span><br></pre></td></tr></table></figure><p>前几天阅读到一个有意思的文章<a href="http://www.cnfeat.com/blog/2018/01/19/Community15Ask/">社群十五问 - 笨方法学写作</a>，今天也在这里分享一下我的回答。</p><ol><li>你的名字、地区、职业、长时间持续做的一件事、博客/公众号/简书 是什么？<ul><li>Ryen，杭州，计算机科学与技术专业大四学生，即将踏入红尘。</li><li>大学阶段持续参加程序设计竞赛，博客上有一些相关的流水账：<a href="http://www.xiang578.com/2017/12/18/icpc-ecl-shanghai-2017/">2017年上海 ACM/ICPC ECL-Final - ZenTalk</a>、<a href="http://www.xiang578.com/2017/11/05/icpc-xian-2017/">2017年西安区域赛 - ZenTalk</a>、<a href="http://www.xiang578.com/2017/04/23/zjp-2017/">浙江省第十四届程序设计竞赛总结 - ZenTalk</a>、<a href="http://www.xiang578.com/2017/01/29/icpc-beijing-2016/">2016年北京区域赛 - ZenTalk</a>、<a href="http://www.xiang578.com/2016/06/04/lanqiaobei2016/">第七届蓝桥杯决赛杂记 - ZenTalk</a></li><li>博客：<a href="http://www.xiang578.com/">ZenTalk</a> 折腾WordPress、Hexo</li><li>算法博客：<a href="http://blog.csdn.net/xinag578">禅境花园 - CSDN博客</a> 之间写的一些算法题解</li><li>简书：<a href="https://www.jianshu.com/users/2ce0a88c0452/timeline">简书 - 学涯湖畔</a></li></ul></li><li>如果你要讲一个让人记住你的小故事。你会讲什么？<ul><li>写纸质日记4年（高一-大一），目前写电子日记。尝试过晨间日记、时间日志。</li><li>在中考前100天，我准备每天写一篇日记，最终只留下的30多篇。在高考前100天，又有了这个念头，最终留下了100篇日记。</li></ul></li><li>如果你要问社群中所有人一个问题，你要问什么？可特别指定三个人回答，被指定的人可自愿回答。<ul><li>你获取信息的途径，存储的方式，复习的方式，即你是如何管理知识的？</li></ul></li></ol><p>按照博客中的介绍，还需要补上价值观12问，但目前我还在重建价值观，所以以后有机会再来分享我的价值观12问回答。</p><p><img src="https://media.xiang578.com/IMG_0233.JPG" alt="IMG_0233" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最初看到 007 活动是在申斌龙的公众号中，当时没有什么在意，也没有深入了解。之后，我在知乎上的一个专栏文章中，看到了这个活动的详细介绍。吸引我“冲动”消费加入这个社群的是“每7天写一篇文章，连续写7年。”这种运作方式。简单的计算了一下7年是2555天（简化问题，不计算闰年</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="7" scheme="https://blog.xiang578.com/tags/7/"/>
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
  </entry>
  
  <entry>
    <title>重构笔记本系统</title>
    <link href="https://blog.xiang578.com/post/rebuild-notebook-system.html"/>
    <id>https://blog.xiang578.com/post/rebuild-notebook-system.html</id>
    <published>2018-01-13T12:22:26.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>几天前在手机上使用为知笔记时，发现已经完成创建1000条笔记的成就。记不太清楚这个账号是什么时候开始使用的，但是笔记的数量确实吓自己跳。原来已经这么多了，说句实话，很多内容也只是简单的收藏了一下，之后都再没有碰过，而且自己的笔记本分类很混乱，借这个机会准备重构笔记本系统。</p><p>知乎上面关于笔记本系统或者体系的讨论有很多，之前就是参考相关回答的，但都没有坚持搞下去。所以，这次的重构我找的是其他的参考资料，最主要的是陈华伟的知识管理训练营的第五、六两讲。说来也巧，陈华伟几年前在知乎上也分享过他构建笔记本系统的思路，当时我也看过，收藏了，但是到今天都没有按照他说的实践。</p><p>这里分享我在他知识管理训练营里面学习到的方法。</p><p>搭建笔记本系统分成三个步骤：<br />第一步，利用<em>思维导图</em>梳理自己的知识体系，明确知识获取的途径。<br />第二步，在笔记软件中建立相应的文件夹，将获取的知识存储到笔记本软件中。<br />第三步，在实践中不停的迭代思维导图以及文件夹，这一步是最重要的，因为没有人可以一步到位，完成一个完美的笔记本系统。</p><p>然后，我认为这个课程最有价值的部分在于如何给笔记软件中的文件夹命名。陈老师提出了一种综合杜威十进制分类以及Wikipedia分类的方法。将一个文件夹的名字分成三个部分，即 <code>数字编号 - 四大分类 | 具体名称</code>。其中数字编号是从杜威十进制（美国图书馆图书分类方法）中学习得到，通过数字编号，笔记软件可以自动对文件夹进行排序。这是我最佩服的一点，经常在图书馆学习借书，却没有想到学习这种方法来分类笔记本。四大分类是参考Wikipedia，将所以的文件夹分成工作、学习、生活、兴趣四个维度。最后具体名称就是文件夹内放的笔记相关的命名了，我想大部分人之前也才做到这一步吧。</p><p>通过这种方法之后，我快速的整理出了新的笔记本系统。</p><p><img src="https://media.xiang578.com/%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%B3%BB%E7%BB%9Fv1.1.png" alt="笔记本系统v1.1" /></p><p>如果你也想学习这种方法，建议去找上文提到的课程学习一下。</p><p>本文写作过程中，使用幕布搭建框架。幕布是一个简洁、高效的大纲软件。你可以通过<a href="https://mubu.com/inv/47235">我的邀请链接</a>注册，并将免费获赠15天幕布高级版。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;几天前在手机上使用为知笔记时，发现已经完成创建1000条笔记的成就。记不太清楚这个账号是什么时候开始使用的，但是笔记的数量确实吓自己跳。原来已经这么多了，说句实话，很多内容也只是简单的收藏了一下，之后都再没有碰过，而且自己的笔记本分类很混乱，借这个机会准备重构笔记本系统。&lt;</summary>
      
    
    
    
    
    <category term="wiznote" scheme="https://blog.xiang578.com/tags/wiznote/"/>
    
    <category term="system" scheme="https://blog.xiang578.com/tags/system/"/>
    
  </entry>
  
  <entry>
    <title>2017 迷茫</title>
    <link href="https://blog.xiang578.com/post/2017.html"/>
    <id>https://blog.xiang578.com/post/2017.html</id>
    <published>2017-12-31T04:40:45.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>每年年底，都有很多人在各种地方发表这样的总结，看得我煞是羡慕。去年也想学习<a href="http://freemind.pluskid.org/misc/2016-summary/">2016 无限大</a>中这位大佬这样好好搞一番。最终的结果是，写了一些之后，就放弃了，然后现在草稿都找不到了。今天，终于鼓起勇气，准备在图书馆好好总结一下2017年经历过的事情。那么多年以来，感觉今年经历的事情最多也最复杂，很多事情到现在都没有讲明白。</p><p>上半年大三，现在大四，今年在学校上的课实际上是很少的。上半年自己选的只有python入门和软件工程，不知道为什么，对学校的教育是彻底的失望了。MOOC方面，不知道托了多少个月，换了几个班，终于把吴恩达的机器学习给看完了。这样匆忙下来，所学的东西到今天基本也忘得差不多了。前几周，又决定去听一下《机器学习基石》和《机器学习技法》，希望可以坚持下去。另外，还看了一下候老的《深入浅出STL》，收获很大。</p><p>应该是寒假的时候，没有多少思考，在陈老师的鼓动之下，又给自己的ACM生涯续了一年左右。队友实在是太给力了，以致于前几天陈老师还说出，我们几个人好好训练，还有机会打进总决赛。抱大腿之下，成绩倒是不错，省赛金、邀请赛金、区域赛金、ecl银，但这和我没有多的的关系。印证了陈老师的一句话，带着功利的目的参加ACM比赛没有好的结果。人家的没有好的结果指的是获不了奖，我的没有好结果是人生的迷茫。</p><p>由于没有去考研的原因，也把自己推向了就业，但我都没有准备好。打击在找实习的时候就来了，上一届的学长推荐，很早就面阿里，发挥的很不好，毫无疑问的挂了。自己后知后觉，春招快结束了，都没有找到好一点的公司。幸运地是，在差不多接受去一家杭州本地的游戏公司实习时，突然接到滴滴北京的offer，终于拯救了一下自己。</p><p><img src="https://media.xiang578.com/944_2017-08-29_11-17-42.jpeg" alt="944_2017-08-29_11-17-42" /></p><p>6月到8月这3个月的时间，自己都在北京实习。这一段小结准备了好久都没有写完，这里简单的介绍一下。那边的部门是路径规划小组，所以我的主要工作就是写最短路……这三个月时间对我来说，最主要的是体验，感受了互联网公司的氛围，认识了很多优秀友善的同事，他们也教了我很多工作上的技能。最重要的是，我也发现自己的不足，工程能力太弱，学历太低等等。三个月的时间很快，还没有在那边做太多的项目就结束了。另外一方面，在北京也去过很多地方体验，文化之都名不虚传，这个也等有机会再写。</p><p>回来之后，又是一番秋招。抱着在杭州找一份工作的信念，我面试了很多，贴出9月和10月的日历来留念一下。</p><p><img src="https://media.xiang578.com/15147039584801.jpg" alt="" /></p><p><img src="https://media.xiang578.com/15147040250293.jpg" alt="" /><br />最终由于自己的实力问题，结果不是很乐观。这么多面试，唯一想记一下的就是微软面试，有一刻我彻彻底底地感受到了自己的不足，英语水平太差，思维定势。接下来的两个月，就只好老老实实地待在学校，每天不是在寝室就是在图书馆度过。</p><p>另外，寒假的时候，突然有兴致想学围棋，又是报live，又是买书、又是买围棋。坚持了几个月之后，发现真的不是时候，没有了太多空闲时间来培养兴趣，也许早个一两年，可以培养出这个兴趣。现在感觉，可惜这些冲动而买下的东西。说回来，这一年空闲的时间大多花在网上，看视屏、看直播、刷论坛，明知很多事情没有意义，却又控制不住自己。</p><p>所以，又开始关注个人管理。最大的投入是换了一台Mac，终于不用再忍受原来低配thinkpad的卡顿。这几个月里面，倒是每天都抱着在用，感觉生命都得到加速。不过，现在感觉自己的电子设备有点多，选择什么设备干什么成了新的问题。2017年也是知识付费地兴起的元年（这个是我一直追求的，如果觉得我的哪篇文章把你逗笑了，打开about页面，扫一下二维码支持一下）。在这方面的投入主要是知乎live，由于冲动，也交过一些智商税。比如下面图中知乎最有名的&quot;智商税&quot;之一：</p><p><img src="https://media.xiang578.com/15147059504193.jpg" alt="" /></p><p>其他的还有<a href="https://www.zhihu.com/lives/837669764146003968">如何自学计算机专业课程？</a>，道理都懂，不知道自己当时为什么要买这个东西……当然也有不错的比如围棋相关的<a href="https://www.zhihu.com/lives/specials/804814796859011072">从入门到入段</a>，这个live最大的优点是配套服务完善。上面也讲了，自己没坚持，才没有学会围棋。前几天买少数派的效率大礼包，还送了一个什么live私家课，又是一个坑……其实我一直很反感知乎live的形式，语音不能检索，聊天信息流的形式不适合深度讨论，最重要的一点，网页端功能太弱，完全想直接喷。有过这些教训之后，应该把知识获取的重心放在课堂以及书本中。在网络上的另一笔花销就是购买软件服务。目前自己周期购买的包括为知笔记会员、滴答清单会员、蓝灯会员、腾讯云服务器以及域名。对于这些还是比较满意。换到Mac之后，自己也购买了一些软件。遗憾的是由种种原因，偶尔还用通过不正常手段获得的软件。</p><p>由于这一年感触比较多，也捡起了原来写日记的习惯，毕竟自己忘的实在是太快。之前尝试过很多写日记的方法，比如晨间日记、九宫格日记，或者是纸笔记录，都没有满意的方案。目前搞的一种笔记式的方法再探索。</p><p><img src="https://media.xiang578.com/15147053326968.jpg" alt="" /></p><p>大致思路是为知笔记上面按每一个月创建一个文件夹，每天创建一篇笔记。在笔记里面可以写东西，贴照片，传附件，保证自由很多样性。然后第二年同一天打开这篇笔记，可以去年今日，再写下新的感悟。更重要的是，通过这种方法可以将之前写的日记整合进去。家中的初中和高中日记本也有机会处理了。</p><p>最后，就是关于博客的折腾。年初的时候自己把博客改成了wordpress，但是一年都没有坚持下来，又回到了hexo怀抱，真是呼吸不止，折腾不息。但不应该忘记，博客的本质是分享，现在自己差不多是舍本逐末吧。所以，定一个小目标，新的一年里面更新博客频率不低于每周一篇。</p><p>于浙财图书馆。</p><h2 id="阅读"><a class="markdownIt-Anchor" href="#阅读"></a> 阅读</h2><p>上半年基本上没有看完什么书，大部分都是下半年从北京回来之后看的，所幸都有一些简短的记录，特地复制过来记录一下。</p><ul><li><a href="https://book.douban.com/subject/4822685/">编码</a>：顾名思义，这本书讲解的是计算机内部编码的原理。书中主要包括两部分<br />，一是编码的理论基础，用多种方式表示字符或者操作指令，二是编码的硬件基础，如何设计硬件处理各种编码以实现相应的功能。</li><li><a href="https://book.douban.com/subject/26998040/">尽在双11：阿里巴巴技术演进与超越</a>：听名字就知道这本书很厉害，结果可想而知。本书讲解的是阿里一些架构演变的历史，里面有太多技术相关的名词，水平太差根本看不懂这些东西，希望有一天能恍然大悟。</li><li><a href="https://book.douban.com/subject/1152111/">程序员修炼之道</a>：看不懂，有缘再读。</li><li><a href="https://book.douban.com/subject/26929955/">腾讯传</a>：之前在知乎查评价时，很多人不是很推荐。这本书主要记录一些腾讯发展过程中重要的里程碑，比如OICQ、QQ秀、QQ空间、微信等等。没有读出这些事件背后深刻的意义。书中另外一个重点是对马化腾的大夸特夸……有种天不生化腾，万古如长夜的感觉。作者号称写这书花了五年时间，实在没有找出什么重磅的料啊。</li><li><a href="https://book.douban.com/subject/26584286/">大学之路</a>：大学生活马上就要结束了，才想起来看这本书。最近深刻体会到高等教育额的价值，对比吴军博士在书中所写的各式各样的美国大学，我们国内的大部分学校除了校名不同，就没有什么其他差别了。最后，吴军博士本人也很励志，从进入清华开始到博士毕业花了18年，真是终生学习的典范。</li><li><a href="https://book.douban.com/subject/25985021/">人类简史 : 从动物到上帝</a>：这本书大概读了五分之一，很多观点比较深刻，但是提不起我的兴趣，所以就选着了放下。另外一方面反映我的人文社科阅读能力实在是太差了。</li><li><a href="https://book.douban.com/subject/26873680/">出梁庄记</a>：这本书和上一本，都是我在三联奋韬书店里看的。有点区别的是，这一本我看完了……作者通过采访生活在各地的梁庄人，反映了生活的不易。当时正是北漂，引起了共鸣</li><li><a href="https://book.douban.com/subject/26361652/">高频交易员</a>：没有仔细看，现在回想起来，自己记住的就是，通过信息传输的时间差来获利，以此来抨击美国金融市场的不公平。</li><li><a href="https://book.douban.com/subject/10799765/">盖洛普优势识别器2.0</a>：这本是最重要的就是配套的测试吧，图书馆借的书没有测试码，所以也很无聊了。</li><li><a href="https://book.douban.com/subject/1070134/">毛泽东选集（第1卷）</a>：这本书里面，其实我只挑了《湖南农民运动考察报告》来看。这篇报告的特点是逻辑清晰，和现在的报告对比，缺少数据分析。</li><li><a href="https://book.douban.com/subject/3004255/">编程之美</a>：为了准备微软面试而读，最后发现没有用到</li><li><a href="https://book.douban.com/subject/6966465/">剑指offer</a>和<a href="https://book.douban.com/subject/27008702/">剑指Offer：名企面试官精讲典型编程题（第2版）</a>：第一版是在软件工程课上读完的，由于之前参加过算法竞赛，所以很多题目都是秒杀的。第二版是在去苏州的火车上看完的，比第一版多了一些题目，质量也不错。确实很多面试都是从这本书里面找的题目。</li><li><a href="https://book.douban.com/subject/26638586/">程序员代码面试指南：IT名企算法与数据结构题目最优解</a>：之前一直黑左神，但他这本书还不错。有一次笔试，我有一道题目没有写出来，听人家一说是这里面的，龙与地下城。去微软面试之前，准备看一下这本书里面的大数据相关题目，但是时间匆忙没有机会了。后来发现面试的时候就问了一道里面的大数据题目，最后gg了。在百度和拼多多面试时，也被问道里面相关的题目。</li><li><a href="https://book.douban.com/subject/26902177/">技术之瞳——阿里巴巴技术笔试心得</a>：为了准备阿里笔试而借的书，说句实话不推荐。书很薄，但是很贵。知识总结也很少，所谓的笔试真题，也只有答案。借用一句话，对于没有解析的书，自己答案印错了都不知道。纯属阿里巴巴骗钱之作。最后吐槽一下，阿里笔试是要招全栈工程师吗？什么问题都有。</li><li><a href="https://book.douban.com/subject/24335672/">淘宝技术这十年</a>：听学长讲座后借的书，由于不是很懂里面的故事，所以我就当成故事书来看了。印象最深的一个多隆的大神，技术伴随着淘宝发展的成长，前几周看到，好像他成了阿里的合伙人。</li><li><a href="https://book.douban.com/subject/25819566/">王道程序员求职宝典</a>：又是一本为了面试而看的书，对于我这种基础不是很扎实的，感觉看起来很不错。王道论坛在计算机考研的口碑应该也是挺好的。</li><li><a href="https://book.douban.com/subject/26912767/">深入理解计算机系统（原书第3版）</a>：五星推荐，串联起了我学过的知识。</li><li><a href="https://book.douban.com/subject/25708312/">C++ Primer 中文版（第 5 版）</a>：这也不错。</li><li><a href="https://book.douban.com/subject/3076818/">围棋入门</a>：围棋入门挺不错的书，上半年想学围棋时而读的。不过目前已经绝版了，我也是买的淘宝复印版。</li></ul><h2 id="观影"><a class="markdownIt-Anchor" href="#观影"></a> 观影</h2><p>这一年来看了不少的电影和记录片。不过我用的形式是优酷ViP区的电源以及B站上面的记录片。</p><ul><li><a href="https://www.ted.com/talks/jia_jiang_what_i_learned_from_100_days_of_rejection#t-919858">Jia Jiang: What I learned from 100 days of rejection</a>：蛮有意思的一个TED演讲，但是我没有勇气去实践。</li><li><a href="http://www.bilibili.com/video/av5021994/">Professional-职业人的作风 围棋棋士 井山裕太</a>: 这部记录片主要介绍日本围棋史上首位获得国内全部头衔的棋士井山裕太的生活以及一些比赛。</li><li><a href="http://www.bilibili.com/video/av6262225/">纪实72小时 沉浸在围棋的魔力中</a>: 记录日本的一个围棋茶馆72小时，看完之后感觉也只有在日本才会有这样的茶馆，很多人会在店中待上一个周末。在围棋当中，忘记自己的一切，只有黑与白之间的交锋。对其中的两句话印象深刻，第一句是提问武宫正树儿子有关职业围棋的问题，他回答到，下这盘棋的时候我们的出场费是一样的，如果我输了，我就没有了机会。第二句是提问一位下棋的人为什么这么长时间都待在这里，回答我没有家。原来只是听说日本老年化社会，看完这个视频才对这个问题有感触。接下来，我又看了很多这个系列的记录片，感受到了日本的温度，这是我们所缺失的。</li><li><a href="https://movie.douban.com/subject/2133323/">白日梦想家</a>: 有过很多想法,最终却成了空想,每次半夜的激情,醒来之后还有多少?</li><li><a href="https://movie.douban.com/subject/26616155/">现代生活的秘密规则：算法 The Secret Rules of Modern Living: Algorithms</a>: 里面的很多算法自己都接触过,但看这部纪录片又有了很多新的感悟.</li><li>人民的名义：这是我这几年第一部看完的国产剧吧，喜欢他的原因是讲了很多我原来都没有关注过的反腐问题。</li><li>战狼2：今年最火的电源，主题也很深刻，不过现实还是很残酷的。</li><li>硅谷四季：一部讲述美国geek创业的故事，很励志，但我却没有一颗创业的心。</li><li>华尔街之狼：我觉得看的很爽。</li><li>雷神1、2：去年把漫威宇宙中的电源都找出来看了一遍，唯独没有雷神系列，最终补上了。我最喜欢的一个设定是，雷神在远古中出现，但由于时间太久，人类选择认为是神话。这里，我想起了易中天在《中华史》里面提到过的一个观点，也是神话是真的存在过，只是我们后来的记录夸张了那些，比如那时候人很少，而且有足够的水果当成是食物，所以人们不用劳动就能生活。</li><li>盗火者：中国教育改革调查：大一的时候听高数老师讲起过，一群不合主流的中国教育者故事。</li><li>奇异博士：漫威宇宙中的新作，反正是无脑看的。</li><li>西部世界：很烧脑的美剧，反正我是靠知乎剧透才看懂的，还有很多谜题都没有解决，不知道什么时候有新的一季。</li><li>权力的游戏：从大一开始就听过这部美剧和书，然后到大四才开始看。到目前为止，看了4季，资源太难获取，就不看了。看他的原因是，讲述了低魔世界的传奇。</li><li><a href="https://www.bilibili.com/video/av14251008/index_2.html?t=1615#page=1">如何实现你的儿时梦想</a>：蛮有名的演讲，少年可期。</li><li>超级工程：这也属于很早就听过名字，但是没有机会看的。很多东西确实震撼，但是自己没有机会参与其中。</li><li>人生七年：已经快60年的社会学实验，看下来很多结论是很残酷的。</li><li><a href="https://www.bilibili.com/video/av8937215/?t=644">我更关心的是怎么样不做事 老树画画：做一个梦</a>：这也有感动。</li><li>B站的历史记录有限，很多看过的记录片很遗憾没有记录下来。</li><li>暴走大世界：之前很喜欢的一个综艺节目，但是最近却脱粉了。理由很简单，王尼玛居然是一个符号。我确实没有仔细的思考这个问题，当人家爆出来的时候，我也很震惊！</li><li>旗门镖局：阿瓦隆的汉化版，很有意思的逻辑综艺节目。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;每年年底，都有很多人在各种地方发表这样的总结，看得我煞是羡慕。去年也想学习&lt;a href=&quot;http://freemind.pluskid.org/misc/2016-summary/&quot;&gt;2016 无限大&lt;/a&gt;中这位大佬这样好好搞一番。最终的结果是，写了一些之后，就放弃了</summary>
      
    
    
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="movie" scheme="https://blog.xiang578.com/tags/movie/"/>
    
  </entry>
  
  <entry>
    <title>iPhone软件清单</title>
    <link href="https://blog.xiang578.com/post/iphone5s.html"/>
    <id>https://blog.xiang578.com/post/iphone5s.html</id>
    <published>2017-12-30T13:32:22.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>本来打算双十二买一部小米6，谁知道当天没有优惠，转而买了一部mix2。当时准备写一篇文章来纪念一下我的第一部智能手机。可谁知道，拿到的mix2品控太差，一周不到前置摄像头就进灰了，果断退货。</p><p>目前在用的手机是高中毕业之后买的，当时记得是4500块送1000块话费而买下的。8G的存储空间，对于我这种不拍照的来说也还可以接受。不过最大的问题是电池，实在是太不经用了，而且还有天冷关机的问题。所以，退了手机之后，就在京东上买了一块品胜的电池和线下装机服务。用了大概一周，目前还比较满意。前几天，Apple终于为电量低降频的事情道歉了，而且将换电池的价格从五百多降到了两百多一点。我感觉之后，苹果换电池就很划算了。可惜下一部不想买iPHone了。</p><p>QQ、微信、支付宝之类的不写，记录一下，我自己在用，但比较小众的软件。</p><ul><li>inoreader：免费里面比较好用的RSS软件，不使用其他服务，墙外的博客都可抓下来，不过图片有很大的问题……几个月之前在国内AppStore被下架了，所以目前绝版，网页版很早就被墙了。</li><li>Castro：播客软件，我认为最大的优点是界面优美，从破解版用到它免费，目前还有Castro 2可以选择。</li><li>欧路词典 Pro：最大的优势是可以自己装字典，配合网上的盗版资源非常的棒，而且价格也很便宜。</li><li>每日英语听力：偶尔听听</li><li>诗词之美：有时候掏出来，抄一篇之前背过的诗词。之前这个App还叫西窗烛，后来那个软件加上了很多社交功能，就单独出了一个只能看看诗词的版本。</li><li>白描：ocr软件，买少数派效率大礼包时候送的。</li><li>熊猫吃短信：通过iOS 11新机制，使用机器学习过滤短信。</li><li>Battery Life：查看电池寿命</li><li>Scanner Pro：扫描软件，Reedle出品，质量保证。</li><li>LastPase：密码软件和chrome上的插件配合使用</li><li>Authenticator：两步验证，部分网站支持，在实习时必备。</li><li>AppZpp：可以订阅App更新和价格变动</li><li>网易有钱：记账，最大的优点是可以同步支付宝的账单。</li><li>Forest：集中注意力？可以在手机上种树？</li><li>滴答清单：清单+日历</li><li>kindle：阅读</li><li>脉脉：查看程序员八卦，行业内人员变动消息传的早，公司内部撕逼等等</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本来打算双十二买一部小米6，谁知道当天没有优惠，转而买了一部mix2。当时准备写一篇文章来纪念一下我的第一部智能手机。可谁知道，拿到的mix2品控太差，一周不到前置摄像头就进灰了，果断退货。&lt;/p&gt;
&lt;p&gt;目前在用的手机是高中毕业之后买的，当时记得是4500块送1000块话</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="iOS" scheme="https://blog.xiang578.com/tags/iOS/"/>
    
    <category term="app" scheme="https://blog.xiang578.com/tags/app/"/>
    
  </entry>
  
  <entry>
    <title>2017年上海 ACM/ICPC ECL-Final</title>
    <link href="https://blog.xiang578.com/post/icpc-ecl-shanghai-2017.html"/>
    <id>https://blog.xiang578.com/post/icpc-ecl-shanghai-2017.html</id>
    <published>2017-12-18T07:33:38.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>前几周和教练申请，愿意自费出去比赛，所以才有了这一次机会。这也是3年多以来第一次自费出来。</p><p>今年的比赛时间安排不是很好，可能是区域赛安排到了12月初的原因。由于周六要参加六级考试，我是那天晚上坐高铁前往上海的，幸亏这些都是轻车熟路。唯一值得记一下的是，我从场中路地铁站出来后，周围比较冷清，只好用滴滴打车去宾馆，这一次司机直接开到推荐上车点来接到我，没有使用电话沟通。前几个月在北京实习时，弦哥经常在内部说这个功能的重要性，可以给滴滴剩下近千万的虚拟号码开销。现在终于享受到了这个好处。</p><p>来到宾馆之后，找队友拿了队员证以及衣服。惊喜的是今年谷歌送的小礼品是 Google Cardboard ，平民级别的 VR 眼镜，记得之前内核恐慌里面听 Rio 他们提起过。拿到之后研究了一下，确实蛮有意思的。</p><p>由于前几个月在学校内修仙比较严重，睡得比较晚，导致第二天8点10多分，听到外面有人的动静才起来。匆匆的洗漱了一下，就和同学一起前往上海大学。</p><p>到达比赛现场之后，惊奇地发现，他们已经把午餐给发下来了，所以直接开始吃零食……</p><p>刚开始都比较正常，我也在那里简单地看看题目。然后，看都L题，题目比较简单，看起来像是一道博弈题，由于没有上机的机会，所以我知道简单的推一下，大概推了10以内的情况，我认为自己找到了规律，所以上去写，不过第一次没有通过。下来之后，我再推了一下16的情况，明天自己刚才错在哪里，所以就重新上去写了一下。在111分钟的时候，我们通过了这一题。最后半小时内，我和老王一起写H题，凭借着他强大的逻辑能力，在289分钟的时候通过了。最后由于人多人会写的J题，我们没有通过，所以只有以7题遗憾结束。</p><p>算上打星队伍的排名大概是73名，获得银奖。<br /><img src="https://media.xiang578.com/15135845100259.jpg" alt="" /></p><p>最后在等待领证书的时候，一个志愿者突然跑过来，问我们要一包零食，说上午到现在都没有吃东西。我拿出一包豆腐干给了他，祝福每一个努力拼搏的人。ACM生涯在续费一年之后，就结束了。</p><p>照片不知道为什么不能调整方向，就放在这里治疗颈椎病吧<br /><img src="https://media.xiang578.com/get_thumbnail.jpeg" alt="get_thumbnail" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前几周和教练申请，愿意自费出去比赛，所以才有了这一次机会。这也是3年多以来第一次自费出来。&lt;/p&gt;
&lt;p&gt;今年的比赛时间安排不是很好，可能是区域赛安排到了12月初的原因。由于周六要参加六级考试，我是那天晚上坐高铁前往上海的，幸亏这些都是轻车熟路。唯一值得记一下的是，我从场中</summary>
      
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>2017年西安区域赛</title>
    <link href="https://blog.xiang578.com/post/icpc-xian-2017.html"/>
    <id>https://blog.xiang578.com/post/icpc-xian-2017.html</id>
    <published>2017-11-05T11:20:49.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>怎么开头呢？<br />10月20多号的时候，教练通知我们，一定要在赛前训练一场。仔细一想，上次训练在5个月前……整容倒是没有太大变化，周神（通过微软、腾讯、今日头条、京东和拼多多面试）和God王（曾经在阿里实习过），三个人暑假都在外面实习，回到学校之后也没有心情训练。10月25日（周三），我们拉了一场貌似是印度那边的区域赛，打了一下，感觉手感还行。周四就带着学弟学妹们坐火车前往西安，这也是我校继2015年EC-final之后，再一次派出多支队伍去打区域赛。</p><p>周五上午抵达西安站，由于一些情况，果断卖掉学弟学妹，我和队友3个人提前打车去了酒店。到达之后，发现他们离酒店还远，就在旁边找了一家饭店吃法。点了几个菜，到现在都觉得手撕羊肉不错，毕竟60多一斤。然后，就是常规的办理入住手续。上半年过来的时候和其他学校一起住在别墅，还能泡温泉，美滋滋。这次人来太多，经费紧张，就只能让我们住在标间。虽然环境还是可以吐槽的，但至少有wifi可以用了……</p><p>晚上，一群人又出去吃了一顿火锅，西安的物价真便宜，最后剩下好多蔬菜没有吃……</p><h2 id="day1-热身赛"><a class="markdownIt-Anchor" href="#day1-热身赛"></a> day1 热身赛</h2><p>早上起来之后，发现喉咙有点痛，和队友表达了明天可能会失声的担忧，并且表示不想去医院看，看好了多尴尬。10点左右集结队伍徒步前往西北工业大学。</p><p>这次比赛的地点和上一次不一样，终于搬到了体育馆。不过确实大，都能放下350+队伍，多年之后会不会有学校租个鸟巢打比赛？领完衣服，拍了照片。我们就高兴的去了食堂吃饭。吃完之后，我和周神一起去校园逛了一下，果真是强校，实在是太大了。</p><p>下午3点左右，抵达比赛场地，准备热身赛。老王让我上去打一些头文件，我感觉，如果今天一道题目都不会写，不是就白打了吗？队友想了一下，只能无奈地看着我……</p><p>比赛开始之后</p><p>我快速地看完A题，说了一下题意，队友就开始写了。在决定猜什么数字的时候，周神强烈要猜2017，我说了一句傻子才会猜2017，然后他们就Yes了，我无法可说……<br />B题，简单模拟题，周神搞了一下就通过了。</p><p>最后就是C题，三个人一起看了好久，没有什么想法。我开始自告奋勇地说要写一个暴力，他们奇迹般的同意了我的方案。于是就获得了上机的机会，写到一半时，后面的队伍就欢呼通过了C题。综合他们一系列的反应来看，绝对是暴力过的，我的心也就放下了。由于好久没有写题目，所以用几分钟调试。通过这题之后发现，排名居然是第三，而且和第一名才差1分钟。毫无疑问，队友对我展开批判，痛失热身赛冠军……</p><p><img src="https://media.xiang578.com/v2-28df8e8bd4ceebc2cc3ac8b461201f54_b.jpg" alt="v2-28df8e8bd4ceebc2cc3ac8b461201f54_b" /></p><p>之后的时间就是学习其他人大佬，一顿乱试。时间还有多，队友上机打了一个表，验证一个猜想，就想出了C题的标算。最后，实在没有什么可以干了，决定提前半小时离场吃饭……路上队友怕今天把明天的人品败光，我告诉他，正真的共产主义者是无所畏惧的。这样我们高高兴兴地吃完了晚饭，然后搭车回到了秦龙。</p><p>晚上，一个队友在网上认识的河南农业大学大佬请他吃烧烤，我又跟过去混了一顿。和他们聊了一下子，我说了一句，你们一定会成功的。果不其然，青岛赛区他们获得了银奖……</p><h2 id="day2-正赛"><a class="markdownIt-Anchor" href="#day2-正赛"></a> day2 正赛</h2><p>参加过这么多场比赛，第一次遇到口号是“安全第一”的赛区，周神的祖传行李箱不让带，所以他去寄存。我抱着一大堆书籍和打印的资料走进了体育场，路上还听到有人议论。从赛后来看，这些东西都没有用到……</p><p>比赛开始后，一切都比较顺利。老王单人ACB题，周神一秒钟猜出了F的公式，然后我就鼓励他们不用想其他样例就把猜想给交了。85分钟地时候，老王不动声色的AC了G。看完H题意之后，我和周神说这个贪心地取就好了。他想了一下，决定用线段树。然后在他快要写完的时候，我看有那么多人都过了，感觉不是很像，后来出来一问，暴力也能通过……</p><p>之后做的是L题，有关lol的题目。前一天翔哥还和我吹周神是财经faker，但我发现他居然不知道banpick，于是乎解释了好久。看完第一个样例的后，我决定自己算一下。这时候，突然弹出一个公告，告诉我们怎么计算样例，就这样完全明白了题意。然后队友就给了一个任务，让我去把第二组样例打出来……500个01组成的字符串，我机智的想到去讨论版提问，能不能发送一份样例过来，毫无疑问的no response……所幸老王想出了4个for循环的暴力，复杂度高达10*1e8，出于对西安赛区判题机的信任，他就开始写了。然后，懒得输入样例，膨胀到在写完之后就交。果不其然wa了，多组输入忘记数组清空，改。又是一发wa，看了一下有操作逻辑写反了，再改，AC。接下来就是自我安慰把这40分钟当成输入样例的时间……</p><p>之后我们就陷入长达1个小时的僵局，三个人看着A题感叹世界真是神奇……后来老王不得不放弃这一题，从而转战K题，想了半个多小时，就开始上机码。写完的东西神奇的re了，然后派出换上周神上去改。不知道后来发生了什么，折腾到269分钟AC。之后就是估计排名时间，根据封榜前的排名估计了一下我们大概在32名左右，感觉有点悬……又开始对A题进行一顿乱搞，在最后几分钟里面提交了好多次，但是都没有返回结果……</p><p>离场前气球合影，可惜最后一小时过的题目不发气球。<br /><img src="https://media.xiang578.com/IMG_6227.JPG" alt="IMG_6227" /></p><p>所以带着最后的悬念来到了颁奖典礼，在等待的过程中，发现学弟遗憾的只是铜首……滚动46名时，发现我们飘到32名。再加上看到下图是，我在学校的群里说了一句最差34名，就这样获得了自己的第一块区域赛金牌，学校acm史上的第二金。</p><p><img src="https://media.xiang578.com/15098883232922.jpg" alt="" /></p><p>最终排名也是32名，这个世界真是神奇。</p><p><img src="https://media.xiang578.com/15098883805024.jpg" alt="IMG_6227" /></p><p>然后又是我上台高高兴兴地领奖。</p><p><img src="https://media.xiang578.com/15098884634419.jpg" alt="" /></p><p>三人合影留念</p><p><img src="https://media.xiang578.com/15098885107468.jpg" alt="" /></p><p>搞完这些之后，坐着校车来到了韦曲南站。我带头冲向上半年吃过的烧烤店，后来发现，老王没有一个能吃的，真是尴尬，其他人也没有什么兴致，最后就当我请客了……然后在旁边找了一家宾馆就睡下了……</p><h2 id="day3-归来"><a class="markdownIt-Anchor" href="#day3-归来"></a> day3 归来</h2><p>12点左右，在火车站附近开了一间房，把我们的行李都放下了。然后，在周神的带领下，前往回民街。逛了好久，没有太多意思。19点火车返程杭州。西安区域赛就这样结束了……</p><p>最后还要感叹一下，周神和老王还真厉害，带着我都能获金奖，不过说回来还是喜欢去年自己在北京拿的铜。自己的贡献是一场比一场小……如果没有ec-fianl的话，acm生涯到这里就结束了吧，也留下一些遗憾，如果有来生，我也愿意信来生，再见……</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;怎么开头呢？&lt;br /&gt;
10月20多号的时候，教练通知我们，一定要在赛前训练一场。仔细一想，上次训练在5个月前……整容倒是没有太大变化，周神（通过微软、腾讯、今日头条、京东和拼多多面试）和God王（曾经在阿里实习过），三个人暑假都在外面实习，回到学校之后也没有心情训练。1</summary>
      
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>Mac软件清单</title>
    <link href="https://blog.xiang578.com/post/mac-software.html"/>
    <id>https://blog.xiang578.com/post/mac-software.html</id>
    <published>2017-09-18T14:11:31.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>最近痛下血本买了一台Mac，这里记录一下我装的软件。</p><blockquote><p>君子生非异也，善假于物也。</p></blockquote><h3 id="更新"><a class="markdownIt-Anchor" href="#更新"></a> 更新</h3><ol><li>2017年9月20日：Anaconda</li><li>2017年9月21日：lantern、Dash、Xcode</li><li>2017年12月10日：虚拟机相关</li></ol><h3 id="clion"><a class="markdownIt-Anchor" href="#clion"></a> Clion</h3><ul><li>C++ IDE</li></ul><h3 id="pycharm"><a class="markdownIt-Anchor" href="#pycharm"></a> Pycharm</h3><ul><li>Python IDE</li></ul><h3 id="alfred-3"><a class="markdownIt-Anchor" href="#alfred-3"></a> Alfred 3</h3><ul><li>替换默认的搜索工具</li><li>搭配workflow使用效果更佳</li></ul><h3 id="mweb"><a class="markdownIt-Anchor" href="#mweb"></a> MWeb</h3><ul><li>MacOS 下面最喜欢的Markdown编辑器</li><li>常用的高级功能有发布WordPress博客和自动将图片上传到图床</li></ul><h3 id="wiznote"><a class="markdownIt-Anchor" href="#wiznote"></a> Wiznote</h3><ul><li>用官方的话来讲Mac功能少是小而美</li><li>如果不是会员到2020年结束，我一定会转到Evernote上去</li></ul><h3 id="iina"><a class="markdownIt-Anchor" href="#iina"></a> iina</h3><ul><li>视频播放软件</li></ul><h3 id="shadowsocksx-ng"><a class="markdownIt-Anchor" href="#shadowsocksx-ng"></a> <s>ShadowsocksX-NG</s></h3><ul><li>看名字就知道干什么的</li><li>突然发现自己买不起服务器，转向蓝灯</li></ul><h3 id="parallels-desktop"><a class="markdownIt-Anchor" href="#parallels-desktop"></a> Parallels Desktop</h3><ul><li>虚拟机软件</li></ul><h3 id="sublime-text-3"><a class="markdownIt-Anchor" href="#sublime-text-3"></a> Sublime Text 3</h3><ul><li>性感的编辑器？</li><li>处理小文本时使用，写题目还是喜欢vim</li></ul><h3 id="iterm2"><a class="markdownIt-Anchor" href="#iterm2"></a> iTerm2</h3><ul><li>用来替换默认的Terminal</li><li>推荐主题：<code>solarized-dark</code></li><li>推荐字体：<code>Hack</code></li></ul><h3 id="homebrew"><a class="markdownIt-Anchor" href="#homebrew"></a> Homebrew</h3><ul><li>Terminal内下载软件</li><li>使用：<code>brew update;brew install vim</code></li><li>查看软件信息：<code>brew info vim</code></li><li>临时替换：<code>export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles</code></li><li><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/">清华大学镜像地址</a></li><li><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/brew.git">中国科学技术大学源地址</a></li></ul><h3 id="tmux"><a class="markdownIt-Anchor" href="#tmux"></a> tmux</h3><ul><li>增强终端功能</li><li>配置文件：<a href="https://github.com/gpakosz/.tmux">.tmux</a></li><li>更新配置文件：<code>tmux source ~/.tmux.conf</code></li><li>常用快捷键<ul><li><code>prefix s</code> 查看/切换sessoin</li><li><code>prefix d</code> 离开session</li><li><code>prefix $</code> 重命名当前session</li><li><code>prefix c</code> 新建窗口</li><li><code>prefix space</code> 切换到上一个活动的窗口</li><li><code>prefix &amp;</code> 关闭一个窗口</li><li><code>prefix 窗口号</code> 使用窗口号切换</li><li><code>prefix o</code> 切换到下一个窗格</li><li><code>prefix q</code> 查看所有窗格的编号</li><li><code>prefix “</code> 垂直拆分出一个新窗格</li><li><code>prefix %</code> 水平拆分出一个新窗格</li><li><code>prefix z</code> 暂时把一个窗体放到最大</li></ul></li></ul><h3 id="oh-my-zsh"><a class="markdownIt-Anchor" href="#oh-my-zsh"></a> Oh My ZSH!</h3><ul><li>用<code>zsh</code>来替换默认的shell</li><li>推荐主题：<code>agnoster</code></li><li>最喜欢的是对git的增加以及git相关快捷键的缩写</li><li>常用快捷键<ul><li><code>gaa</code>: git add .</li><li><code>gb</code>: git branch</li><li><code>gcm</code>: git checkout master</li><li><code>gcmsg</code>: git commit -m</li><li><code>gst</code>: git status</li></ul></li></ul><h3 id="vim"><a class="markdownIt-Anchor" href="#vim"></a> vim</h3><ul><li>配置文件：spf3，已经不想折腾这些东西</li><li>常用快捷键<ul><li><code>dd</code>: 删除当前行,并把删除的行存在剪贴板里面</li><li><code>*#</code>: 匹配当前光标所在的单词移动到下一个或者上一个匹配的单词</li><li><code>%</code>: 匹配括号移动</li><li><code>:set number</code>: 显示绝对行号</li><li><code>:set relativenumber</code>: 显示相对行号</li><li><code>r</code>: 将光标所在的字符替换掉</li><li><code>&lt;&lt;</code>: 将当前行向左移动一个偏移宽度</li><li><code>&gt;&gt;</code>: 将当前行向右移动一个偏移宽度</li></ul></li></ul><h3 id="powerline-fonts"><a class="markdownIt-Anchor" href="#powerline-fonts"></a> Powerline fonts</h3><ul><li>vim中的状态栏以及zsh某些主题正确显示的核心</li></ul><h3 id="istat-menus"><a class="markdownIt-Anchor" href="#istat-menus"></a> iStat Menus</h3><ul><li>系统增强工具</li><li>在状态栏显示当前网速、CPU占用以及温度等信息</li></ul><h3 id="jietu"><a class="markdownIt-Anchor" href="#jietu"></a> Jietu</h3><ul><li>腾讯为数不多的良心之作，截图软件</li></ul><h3 id="坚果云"><a class="markdownIt-Anchor" href="#坚果云"></a> 坚果云</h3><ul><li>良心同步软件，每个月上传流量不多，但是够用</li><li>iCloud默认空间实在是太少</li></ul><h3 id="anaconda"><a class="markdownIt-Anchor" href="#anaconda"></a> Anaconda</h3><ul><li>python 科学计算包？</li><li>最主要使用是jupyter notebook</li><li>根据之前在公司安装时得到的经验，完成安装之后还需要更新zsh相关的配置，否者在iTerm中依旧无法使用</li><li>在 <code>.zshrc</code> 中添加一条记录：<code>export PATH=&quot;/Users/xiangrunye/anaconda3/bin:$PATH&quot;</code> 注意这里需要写绝对地址</li><li>更新配置文件：<code>source ~/.zshrc</code></li></ul><h3 id="lantern"><a class="markdownIt-Anchor" href="#lantern"></a> Lantern</h3><ul><li>捍卫互联网自由？</li></ul><h3 id="dash"><a class="markdownIt-Anchor" href="#dash"></a> Dash</h3><ul><li>快速查阅各种语法的文档</li><li>配合Alfred食用更佳，建议将 keyword 改为 <code>ds</code></li></ul><h3 id="xcode"><a class="markdownIt-Anchor" href="#xcode"></a> Xcode</h3><ul><li>感觉自己可以转ios开发</li><li>下这东西才知道，国内连AppStore网络有多差</li></ul><h3 id="parallels-desktop-2"><a class="markdownIt-Anchor" href="#parallels-desktop-2"></a> Parallels Desktop</h3><ul><li><a href="https://bitmingw.com/2017/04/24/windows-thin-pc-download-install-activate/">win镜像获取</a></li></ul><h3 id="chrome"><a class="markdownIt-Anchor" href="#chrome"></a> Chrome</h3><ul><li>看中的是插件多的特点</li><li>MacOS设置为英文的环境下，Chrome里面下载时经常出现文件名乱码，找到了这个网页<a href="http://blog.csdn.net/maxsky/article/details/52411977"> Mac OS X 下修改 Google Chrome 显示语言的方法</a></li></ul><h3 id="参考链接"><a class="markdownIt-Anchor" href="#参考链接"></a> 参考链接</h3><ul><li><a href="http://macshuo.com/?p=625">MacTalk:Alfred</a></li><li><a href="http://blog.jobbole.com/87584/">Tmux 速成教程：技巧和调整</a></li><li><a href="http://macshuo.com/?p=1045">vim 学习卡</a></li><li><a href="http://macshuo.com/?p=769">vim 帮助和配置 </a></li><li><a href="https://sspai.com/post/32979">从零开始学习Alfred</a></li><li><a href="https://github.com/tiann/markdown-img-upload">markdown.wordflow</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近痛下血本买了一台Mac，这里记录一下我装的软件。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;君子生非异也，善假于物也。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;更新&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#更新&quot;&gt;&lt;/a&gt; 更</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="mac" scheme="https://blog.xiang578.com/tags/mac/"/>
    
    <category term="software" scheme="https://blog.xiang578.com/tags/software/"/>
    
  </entry>
  
  <entry>
    <title>使用 BackWPup 恢复 WordPress</title>
    <link href="https://blog.xiang578.com/post/restore-wordpress-from-backWPup.html"/>
    <id>https://blog.xiang578.com/post/restore-wordpress-from-backWPup.html</id>
    <published>2017-07-22T14:13:33.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>昨天晚上手贱点了升级服务器上的 Ubuntu 版本,然后发现 WordPress 不能用了…删了nginx装上 Apache 才解决,之后发现主题有问题,一激动就提交工单把服务器重装了…</p><p>接下来就是 WordPress 重装的过程,自己一直使用BackWPup 每周备份 WordPress ,所以本以为重装会很轻松.</p><p>早上起来将 WordPress 以及 BackWPup 装好.然后就在 BackWPup 里面翻了好久都没有发现怎么还原的按钮…又用百度谷歌搜了一下,也没有教程…</p><p>没有办法,只好硬着头皮去看插件的官网,找到 <a href="https://backwpup.com/docs/how-to-restore-a-wordpress-backup">How to restore a WordPress backup? – BackWPup Docs</a>,按照这篇文章的提示成功恢复 WordPress.</p><h2 id="恢复数据库"><a class="markdownIt-Anchor" href="#恢复数据库"></a> 恢复数据库</h2><p>由于我用的是<code>phpmyadmin</code>,所以登录到服务器的<code>phpmyadmin</code>管理页面.选择数据库<code> WordPress</code>,点击导入,上传BackWPup备份压缩文件中的<code>.sql</code>文件,点击执行,这样数据库中的内容就还原了.</p><p><img src="https://media.xiang578.com/15006908280096.jpg" alt="-w1277" /></p><h2 id="恢复-wordpress文件"><a class="markdownIt-Anchor" href="#恢复-wordpress文件"></a> 恢复 WordPress文件</h2><p>这一步只需要将备份文件里面的文件上传到服务器新的网站目录下覆盖就可以了.由于我用的是iTerm2,所以可以在本地使用<code>scp</code>命令</p><h2 id="尾声"><a class="markdownIt-Anchor" href="#尾声"></a> 尾声</h2><p>zz插件,连个一键还原都没有…</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;昨天晚上手贱点了升级服务器上的 Ubuntu 版本,然后发现 WordPress 不能用了…删了nginx装上 Apache 才解决,之后发现主题有问题,一激动就提交工单把服务器重装了…&lt;/p&gt;
&lt;p&gt;接下来就是 WordPress 重装的过程,自己一直使用BackWPup</summary>
      
    
    
    
    
    <category term="wordpress" scheme="https://blog.xiang578.com/tags/wordpress/"/>
    
    <category term="backwpup" scheme="https://blog.xiang578.com/tags/backwpup/"/>
    
  </entry>
  
  <entry>
    <title>Alfred 使用记录</title>
    <link href="https://blog.xiang578.com/post/alfred-lists.html"/>
    <id>https://blog.xiang578.com/post/alfred-lists.html</id>
    <published>2017-07-02T12:34:39.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>昨天晚上在看MacTalk时,发现一篇文章<a href="http://macshuo.com/?p=625">神兵利器——Alfred</a>,随后将里面提到的软件下载下来.接触不到一天的时间,就感觉到这个软件的强大.下面就记录一些我用到的功能以及插件.</p><h3 id="原生功能"><a class="markdownIt-Anchor" href="#原生功能"></a> 原生功能</h3><h4 id="terminal"><a class="markdownIt-Anchor" href="#terminal"></a> terminal</h4><p>最近在公司工作,都要求连接到服务器上去写代码,所以对terminal的需求很大.目前自己用的是iTerm2+zsh的组合,还有类似于powerline的状态栏,工作效率杠杠的.Alfred可以使用一个字符触发terminal,默认的是<code>&gt;</code>以及打开Mac自带的终端.<br /><img src="https://media.xiang578.com/macbook/1498980452413.png" alt="" /><br />由于<code>&gt;</code>这个字符比较难打,我将Prefix修改为<code>;</code>,而且也将修改terminal为iTerm2(参考<a href="https://www.iterm2.com/version3.html">这个链接最下面提到的Alfred Support</a>).</p><h4 id="网页搜索"><a class="markdownIt-Anchor" href="#网页搜索"></a> 网页搜索</h4><p>给定关键字打开浏览器在特定的网页搜索,例如下图<br /><img src="https://media.xiang578.com/1498980953061.png" alt="" /><br />实现起来也比较简单,在<code>Feature-&gt;Web Search</code>中添加类似于下面的即可.<br /><img src="https://media.xiang578.com/1498981126331.png" alt="" /></p><h4 id="计算器"><a class="markdownIt-Anchor" href="#计算器"></a> 计算器</h4><p>输入表达式通过Alfred计算<br /><img src="https://media.xiang578.com/1498981253943.png" alt="" /></p><h3 id="workflows"><a class="markdownIt-Anchor" href="#workflows"></a> WorkFlows</h3><p>这个是我觉得Alfred最强大功能,毕竟编程改变一切,下面推荐几个插件.</p><h4 id="markdown-img"><a class="markdownIt-Anchor" href="#markdown-img"></a> Markdown img</h4><p>这个插件的功能是直接将系统的剪贴板里面的图片上传到七牛图床,并把图片链接复制到当前的编辑器和剪贴板.这篇文章的截图就是通过这个插件完成的,终于不用像之前一样苦逼的一张张上传图片.<a href="https://github.com/tiann/markdown-img-upload">下载地址</a></p><h4 id="workflow-searcher"><a class="markdownIt-Anchor" href="#workflow-searcher"></a> Workflow Searcher</h4><p>通过Alfred来搜索workflow并且跳转到下载页面<br /><img src="https://media.xiang578.com/1498981706560.png" alt="" /></p><h4 id="v2ex"><a class="markdownIt-Anchor" href="#v2ex"></a> v2ex</h4><p>快速浏览v2ex的帖子.<br /><img src="https://media.xiang578.com/1498981846450.png" alt="" /></p><h4 id="douban"><a class="markdownIt-Anchor" href="#douban"></a> Douban</h4><p>查看豆瓣的电影,音乐,图书等信息</p><h4 id="wunderlist"><a class="markdownIt-Anchor" href="#wunderlist"></a> Wunderlist</h4><p>可以连接奇妙清单,正好符合我这种轻量级用户.<br /><img src="https://media.xiang578.com/1498982157857.png" alt="" /></p><h4 id="有道翻译加强版"><a class="markdownIt-Anchor" href="#有道翻译加强版"></a> 有道翻译加强版</h4><p>满足查字典的需求,虽然mac原生的也很强大,但这个能翻译啊<br /><img src="https://media.xiang578.com/1498982371845.png" alt="" /></p><h4 id="百度搜索"><a class="markdownIt-Anchor" href="#百度搜索"></a> 百度搜索</h4><p>虽然国内口碑不好,但我还是觉得百度更懂中国人…<br /><img src="https://media.xiang578.com/1498982451913.png" alt="" /></p><p>最后吐槽几句,垃圾为知笔记,mac版就没有多少功能,发个博客都没有,可惜我剩下三年的vip,这篇文章还是靠 Mweb 发布的.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;昨天晚上在看MacTalk时,发现一篇文章&lt;a href=&quot;http://macshuo.com/?p=625&quot;&gt;神兵利器——Alfred&lt;/a&gt;,随后将里面提到的软件下载下来.接触不到一天的时间,就感觉到这个软件的强大.下面就记录一些我用到的功能以及插件.&lt;/p&gt;
&lt;h3</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="Mac" scheme="https://blog.xiang578.com/tags/Mac/"/>
    
    <category term="Alfred" scheme="https://blog.xiang578.com/tags/Alfred/"/>
    
  </entry>
  
  <entry>
    <title>计算机基础：计算机网络</title>
    <link href="https://blog.xiang578.com/post/computer-base-network.html"/>
    <id>https://blog.xiang578.com/post/computer-base-network.html</id>
    <published>2017-04-29T13:57:37.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>电路交换与分组交换的区别？ 优劣对比。</p></li><li><p>OSI有哪几层，知道主要几层的各自作用。</p><ol><li>物理层：定义通信与传输借口硬件的机械、电气、功能和过程特性，实现比特流的透明传输。</li><li>数据链路层：无差别传送以帧为单位的数据。</li><li>网络层：选择合适的路由和交换结点，分组或者包。</li><li>运输层：端到端、或者进程到进程的无差别传送。</li><li>会话层：对数据传输的同步进行管理</li><li>表示层：信息加密和解密，正文压缩和还原</li><li>应用层：</li></ol></li><li><p>TCP/IP有哪几层，会画出来，知道所有层数的作用，会列举各层主要的协议名称。</p><ol><li>网络接口层：x.25</li><li>网际层：IP</li><li>运输层：TCP和UDP</li><li>应用层：HTTP、FTP等</li></ol></li><li><p>硬件(MAC)地址的概念及作用。</p><ol><li>媒体访问控制子层：前6位16进制IETF分配。</li><li>区分不同的硬件</li></ol></li><li><p>ARP协议的用途 及算法、在哪一层上会使用 ARP ？</p><ol><li>地址解析协议：IP地址到MAC地址的映射</li><li>网络层</li><li></li></ol></li><li><p>知道各个层使用的是哪个数据交换设备。（交换机、路由器、网关）</p><ol><li>物理层：中继器、集线器</li><li>数据链路层：网桥或者交换机</li><li>网络层中继系统：路由器</li><li>网络层以上：网关</li></ol></li><li><p>IP报文的格式，格式的各个字段的含义要理解。</p></li><li><p>MTU的概念，啥叫路径MTU？ MTU发现机制，TraceRoute(了解)。</p></li><li><p>RIP协议的概念 及算法。</p></li><li><p>ICMP协议的主要功能。</p><ol><li>网际控制报文协议，提高IP数据报成功交付的机会，报告差错和异常情况。</li></ol></li><li><p>组播和多播的概念，IGMP的用途。</p></li><li><p>Ping协议的实现原理，ping 命令格式。</p><ol><li>应用层，使用网络层的ICMP协议</li></ol></li><li><p>子网划分的概念，子网掩码。</p><ol><li>A类子网掩码：255.0.0.0，划分：8位+子网X位+主机24-X位</li></ol></li><li><p>IP地址的分类，如何划分的，及会计算各类地址支持的主机数。</p></li><li><p>DNS的概念，用途，DNS查询的实现算法。</p></li><li><p>TCP与UDP的概念，相互的区别及优劣。</p><ul><li>TCP和UDP是OSI模型中的运输层中的协议。TCP提供可靠的通信传输，而UDP则常被用于让广播和细节控制交给应用的通信传输。</li><li>TCP面向连接，UDP面向非连接即发送数据前不需要建立链接</li><li>TCP提供可靠的服务（数据传输），UDP无法保证</li><li>TCP面向字节流，UDP面向报文</li><li>TCP数据传输慢，UDP数据传输快</li></ul></li><li><p>UDP报文的格式，字段的意义。</p></li><li><p>TCP 报文的格式，字段的意义。</p></li><li><p>TCP通过哪些措施，保证传输可靠？</p></li><li><p>三次握手，四次断开过程。</p><ol><li>客户端向服务器发送一个SYN j</li><li>服务器向客户端响应一个SYN k，并对SYN j进行确认 ACK j+1</li><li>客户端向服务器发送一个ACK k+1</li><li>一端发送一个FIN</li><li>另一端接收到这个FIN分节后，执行被动关闭，对这个FIN进行确认，继续传输数据。</li><li>发送数据之后，发送一个FIN</li><li>接受到FIN，结束传输。</li></ol></li><li><p>TIME_WAIT状态的概念及意义。</p></li><li><p>滑动窗口协议 与 停止等待协议的区别。</p></li><li><p>TCP的流量控制和拥塞控制实现原理(会画拥塞控制的典型图)。</p></li><li><p>TCP的快速重传与快速恢复算法。</p></li><li><p>TFTP 与 FTP的区别。</p></li><li><p>阻塞方式和非阻塞方式，阻塞connect与非阻塞connect。(比较难，有兴趣可以了解)</p></li><li><p>HTTP基本格式。（java程序员必须掌握）</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;电路交换与分组交换的区别？ 优劣对比。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OSI有哪几层，知道主要几层的各自作用。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;物理层：定义通信与传输借口硬件的机械、电气、功能和过程特性，实现比特流的透明传输。&lt;/li&gt;
&lt;li&gt;数据链路</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="network" scheme="https://blog.xiang578.com/tags/network/"/>
    
    <category term="computer" scheme="https://blog.xiang578.com/tags/computer/"/>
    
  </entry>
  
  <entry>
    <title>浙江省第十四届程序设计竞赛总结</title>
    <link href="https://blog.xiang578.com/post/zjp-2017.html"/>
    <id>https://blog.xiang578.com/post/zjp-2017.html</id>
    <published>2017-04-23T14:11:10.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<p>昨天是我第三次参加浙江省赛，比赛地点依旧设置在浙大。上午和其他人一起坐车过去，然后就是都差不多的流程。</p><p>由于一些原因，这一次我的两个队友异乎寻常的厉害（高质量就业：阿里研发工程师+京东算法工程师的组合）。赛前内心毫无波澜，不过周神教导我，作为浙财的五队，我们只要保个铜就可以了。</p><p>上午9点25左右，热身赛开始。打开试题册看了一下，我们发现热身赛题目跟去年一样，快速通过A和C题。周神机智的想起去年最后一题（输入一个数对一个非常的大梅森数取模，并判断结果的奇偶性）大数据只有四组，通过一番测试之后，今年也是一样。他写了一个程序直接判小的数据，开始枚举最后四组答案的排列组合。我们大概交了10次左右，就发现枚举的地方出现错误，然后改了一下又重新交，最后枚举到13(1101)的时候过了。本着写完热身赛去吃饭的原则，God王让我们开始写B题。不过仔细想了一下发现，万一写完发现是错的，是去吃饭还是不去吃饭，这是个很大的问题。所以，我们直接前往食堂。</p><p>12点15分左右，比赛正式开始。我自告奋勇的从A题开始看，本着看样例猜题意的指导思想，我大胆猜想出写法，趁他们两个不注意直接拿起键盘开始写。由于年纪大了，速度更比不上那些年轻人，所以也写了一会儿，交完之后大概有70只队伍通过。之后God王上来平推了B和D。我看一下C题，发现这是个简单题，把题意告诉老王之后，他也很快做了出来。至此，比赛大概过去45分钟。我们写完全部的签到题，完成保的铜的目标。</p><p>三个人继续分头看题目，没过多久他们两个人又开始讨论F题的写，很快也想出一个非常巧妙的方法，不过后来发现这个是超时的，所幸God王又想出了线段树的写法。我和周神开始研究E题的写法，很快也验证了用数位DP的正确性，不过也想到这其中有很多细节要考虑。说到这里，不得不讲一下，我昨天晚上就打印了两页模版，其中一个就是数位DP的模版。God王改完F之后，勇敢提交，直接返回了WA。然后我们三个看了好久代码，都没有找出错误来。God王直接出去逛了一下，我和周神开始写E题。God王发现周神读题目没有讲要输出子树的数量，改之就过了。之后，三个人共同推了E。接下来的时间差不多就是在挣扎了，H题God王写来写去都是超时的，G题周神说要找规律，打印了14页数据开始找没多久，就告诉我想的全部是错的。17点14分59秒，God王最后交了一份H题代码，没有什么奇迹，我们结束了这一次省赛。</p><p>晚上，在小剧场举行颁奖，这一个环节最主要的就是听听队名。当本科组银奖没有报到我们的时候，我的内心十分的开心。听到第一批金牌也没有报到我们的时候，周神对我讲了一句，是不是下面没有我们，今天就是冠军。事实证明这是幻想，然后他就高高兴兴的上台领奖了，毕竟昨天晚上特意做了一个发型……</p><p>总的来说，这次省赛比浙大校赛难了很多，所以写完签到题不要错太多的都可以拿铜。中间过度居然拿了一道数位DP和一道线段树，命题人直接高估了浙江省程序设计的教育水平。最后面的几题，我们三个人共享完题意之后，完全没有思路，其他参赛选手也差不多，完全沦为观赏题。后来想一想，这一份题目只是在错误的时间出现，毕竟比赛的覆盖面是final到专科。但是，我感觉这样的比赛，一个人五小时也能做5题，生不逢时，为什么去年没有这么好的命啊。不过还是要感谢两位大佬带我体验了一下省赛获金的感觉。这一次，同场的还有学军和杭二的高中生，颁奖时，有以为领导还感叹大学生不如高中生。殊不知对于这些高中生来说考上浙江大学都是失败。</p><p>不知道明年还有没有机会参加。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;昨天是我第三次参加浙江省赛，比赛地点依旧设置在浙大。上午和其他人一起坐车过去，然后就是都差不多的流程。&lt;/p&gt;
&lt;p&gt;由于一些原因，这一次我的两个队友异乎寻常的厉害（高质量就业：阿里研发工程师+京东算法工程师的组合）。赛前内心毫无波澜，不过周神教导我，作为浙财的五队，我们只</summary>
      
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>C#聊天软件实现</title>
    <link href="https://blog.xiang578.com/post/Csharp-chat-softwave.html"/>
    <id>https://blog.xiang578.com/post/Csharp-chat-softwave.html</id>
    <published>2017-04-19T12:42:55.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>前几天面试，被问如何实现一个类似微信的聊天软件。当时说了一个大概的想法，面试官没有怎么评价，只是最后建议我有空多做一些项目。正好最近不怎么忙，就实现一下。写了一个简易的模型，在这个过程中应用了很多原来学过的东西，当然还有很多问题没有解决。</p><ol><li><p>这个软件选择C/S架构，所以写了一个服务器端程序和一个客户端程序，然后通信使用的是TCP协议。</p></li><li><p>利用socket完成通信，大致的过程如下图所示。</p></li></ol><p><img src="https://media.xiang578.com/%E5%A5%97%E6%8E%A5%E5%AD%97.JPG" alt="" /><br />3. 服务器上开两个线程<code>threadListenConnect</code>和<code>threadReceivePacket</code>。服务器上的<code>socket</code>利用<code>bind</code>绑定服务器的ip和端口号。第一个线程死循环监听端口，是否有新的<code>connect</code>请求，并将新的连接<code>socket</code>保存到list中。再利用第二个线程接受客户端发来的数据包，并拆包执行进行相关功能。服务器之后，按照包中的内容判断是否需要发送到其他特定的客户端还是广播消息。</p><ol start="4"><li><p>客户端中开一个线程<code>threadReceivePacket</code>。先和服务器连接，然后利用这个线程接受服务器发过来的数据包。这里也实现了发送给某个特定的客户端和广播。发包和拆包过程和服务器上差不多。</p></li><li><p>数据包主要包括发送方ip、端口和接收方ip、端口，以及操作代码。不同的数据段用‘|’分割，接收方也按这样拆包就可以了。</p></li><li><p>TCP是面向连接的协议，拥有缓存窗口，所以可能会有粘包现象，可能将程序一次产生的命令，分成多次发送。所以数据包里面还要标记一下，我用了’\a’做新的包开始标记，用’\t’做结束标记，如果聊天内容里面有相同的标记的，可以强行转化一下。</p></li><li><p>这个程序还可以加上数据库搞出注册以及保存聊天消息，然后自己也没有去写消息的排序以及私聊功能，待做。</p></li><li><p>最后相关代码放在github上面<a href="https://github.com/xiang578/NewChat"></a></p></li></ol><p>服务器端：<img src="https://media.xiang578.com/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF.jpg" alt="" /></p><p>客户端1：<img src="https://media.xiang578.com/%E5%AE%A2%E6%88%B7%E7%AB%AF1.jpg" alt="" /></p><p>客户端2：<img src="https://media.xiang578.com/%E5%AE%A2%E6%88%B7%E7%AB%AF2.jpg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前几天面试，被问如何实现一个类似微信的聊天软件。当时说了一个大概的想法，面试官没有怎么评价，只是最后建议我有空多做一些项目。正好最近不怎么忙，就实现一下。写了一个简易的模型，在这个过程中应用了很多原来学过的东西，当然还有很多问题没有解决。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="network" scheme="https://blog.xiang578.com/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>为博客添加返回顶部按钮</title>
    <link href="https://blog.xiang578.com/post/add-return-button-to-blog.html"/>
    <id>https://blog.xiang578.com/post/add-return-button-to-blog.html</id>
    <published>2017-02-11T14:16:49.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>适用于WordPress</p></blockquote><p>由于主题没有自带的返回顶部按钮，所以我一直在寻找一种解决方案。之前使用的是wordpress插件提供的返回顶部按钮，后来在网上乱逛，发现有Xnces – 衔铁部落的返回顶部按钮非常的酷炫，正是我要寻找的。于是，我在那个博客下留言询问制作方法。<br />前几天，看到那个博客上出现了一篇文章<a href="https://www.xnces.com/back-to-top.html">-本博客的返回顶部效果</a>。<br />按照上面的方法，折腾一会儿，我也制作出来了，特地记录一下。</p><ol><li><p>首先，先加载一下环境。在后台<code>functions.php</code>中找到<code>ms_scripts()</code>函数，添加<code>wp_enqueue_script( 'jquery' );</code>调用wordpress默认的JQuery文件。</p></li><li><p>我将这个效果有关的js代码放在了主题目录下新建的<code>themes.js</code>文件中。所以在上面的函数中添加下面两句话导入这个文件<code>wp_register_script( 'themes_js', THEMEPATH  . '/themes.js',array());</code>和<code>wp_enqueue_script( 'themes_js' );</code></p></li><li><p>CSS代码我直接加在了主题<code>style.css</code>中。</p></li><li><p>重新打开网站就能看到效果了。</p></li></ol><p><code>themes.js</code>文件中代码如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bigfa_scroll = &#123;</span><br><span class="line">    <span class="attr">drawCircle</span>: <span class="keyword">function</span>(<span class="params">id, percentage, color</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> width = <span class="title function_">jQuery</span>(id).<span class="title function_">width</span>();</span><br><span class="line">        <span class="keyword">var</span> height = <span class="title function_">jQuery</span>(id).<span class="title function_">height</span>();</span><br><span class="line">        <span class="keyword">var</span> radius = <span class="built_in">parseInt</span>(width / <span class="number">2.20</span>);</span><br><span class="line">        <span class="keyword">var</span> position = width;</span><br><span class="line">        <span class="keyword">var</span> positionBy2 = position / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> bg = <span class="title function_">jQuery</span>(id)[<span class="number">0</span>];</span><br><span class="line">        id = id.<span class="title function_">split</span>(<span class="string">&quot;#&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> ctx = bg.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> imd = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> circ = <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">var</span> quart = <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>;</span><br><span class="line">        ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">        ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">        ctx.<span class="property">strokeStyle</span> = color;</span><br><span class="line">        ctx.<span class="property">lineCap</span> = <span class="string">&quot;square&quot;</span>;</span><br><span class="line">        ctx.<span class="title function_">closePath</span>();</span><br><span class="line">        ctx.<span class="title function_">fill</span>();</span><br><span class="line">        ctx.<span class="property">lineWidth</span> = <span class="number">3</span>;</span><br><span class="line">        imd = ctx.<span class="title function_">getImageData</span>(<span class="number">0</span>, <span class="number">0</span>, position, position);</span><br><span class="line">        <span class="keyword">var</span> draw = <span class="keyword">function</span>(<span class="params">current, ctxPass</span>) &#123;</span><br><span class="line">            ctxPass.<span class="title function_">putImageData</span>(imd, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            ctxPass.<span class="title function_">beginPath</span>();</span><br><span class="line">            ctxPass.<span class="title function_">arc</span>(positionBy2, positionBy2, radius, -(quart), ((circ) * current) - quart, <span class="literal">false</span>);</span><br><span class="line">            ctxPass.<span class="title function_">stroke</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">draw</span>(percentage / <span class="number">100</span>, ctx);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">backToTop</span>: <span class="keyword">function</span>(<span class="params">$this</span>) &#123;</span><br><span class="line">        $this.<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">jQuery</span>(<span class="string">&quot;body,html&quot;</span>).<span class="title function_">animate</span>(&#123;</span><br><span class="line">                <span class="attr">scrollTop</span>: <span class="number">0</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="number">800</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">scrollHook</span>: <span class="keyword">function</span>(<span class="params">$this, color</span>) &#123;</span><br><span class="line">        color = color ? <span class="attr">color</span>: <span class="string">&quot;#000000&quot;</span>;</span><br><span class="line">        $this.<span class="title function_">scroll</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> docHeight = (<span class="title function_">jQuery</span>(<span class="variable language_">document</span>).<span class="title function_">height</span>() - <span class="title function_">jQuery</span>(<span class="variable language_">window</span>).<span class="title function_">height</span>()),</span><br><span class="line">            $windowObj = $this,</span><br><span class="line">            $per = <span class="title function_">jQuery</span>(<span class="string">&quot;.per&quot;</span>),</span><br><span class="line">            percentage = <span class="number">0</span>;</span><br><span class="line">            defaultScroll = $windowObj.<span class="title function_">scrollTop</span>();</span><br><span class="line">            percentage = <span class="built_in">parseInt</span>((defaultScroll / docHeight) * <span class="number">100</span>);</span><br><span class="line">            <span class="keyword">var</span> backToTop = <span class="title function_">jQuery</span>(<span class="string">&quot;#backtoTop&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (backToTop.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> ($windowObj.<span class="title function_">scrollTop</span>() &gt; <span class="number">200</span>) &#123;</span><br><span class="line">                    backToTop.<span class="title function_">addClass</span>(<span class="string">&quot;button--show&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    backToTop.<span class="title function_">removeClass</span>(<span class="string">&quot;button--show&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                $per.<span class="title function_">attr</span>(<span class="string">&quot;data-percent&quot;</span>, percentage);</span><br><span class="line">                bigfa_scroll.<span class="title function_">drawCircle</span>(<span class="string">&quot;#backtoTopCanvas&quot;</span>, percentage, color);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">jQuery</span>(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">jQuery</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;div id=&quot;backtoTop&quot; data-action=&quot;gototop&quot;&gt;&lt;canvas id=&quot;backtoTopCanvas&quot; width=&quot;48&quot; height=&quot;48&quot;&gt;&lt;/canvas&gt;&lt;div class=&quot;per&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> T = bigfa_scroll;</span><br><span class="line">    T.<span class="title function_">backToTop</span>(<span class="title function_">jQuery</span>(<span class="string">&quot;#backtoTop&quot;</span>));</span><br><span class="line">    T.<span class="title function_">scrollHook</span>(<span class="title function_">jQuery</span>(<span class="variable language_">window</span>), <span class="string">&quot;#555555&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>CSS文件要添加的代码</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#backtoTop</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>:<span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">bottom</span>:<span class="number">10%</span>;<span class="attribute">height</span>:<span class="number">48px</span>;</span><br><span class="line">    <span class="attribute">position</span>:fixed;</span><br><span class="line">    <span class="attribute">right</span>:-<span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">48px</span>;</span><br><span class="line">    <span class="attribute">transition</span>:<span class="number">0.5s</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>:<span class="number">0.5s</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#backtoTop</span><span class="selector-class">.button--show</span>&#123;</span><br><span class="line">    <span class="attribute">right</span>:<span class="number">10px</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.per</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">48px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>:<span class="number">48px</span>;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">text-align</span>:center;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">48px</span>;</span><br><span class="line">    <span class="attribute">color</span>:<span class="number">#555</span>;</span><br><span class="line">    <span class="attribute">cursor</span>:pointer</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.per</span><span class="selector-pseudo">:before</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="built_in">attr</span>(data-percent)</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.per</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:before</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;↑&quot;</span>;<span class="attribute">font-size</span>:<span class="number">20px</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;适用于WordPress&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;由于主题没有自带的返回顶部按钮，所以我一直在寻找一种解决方案。之前使用的是wordpress插件提供的返回顶部按钮，后来在网上乱逛，发现有Xnces – 衔铁部落的返回顶部按钮非常</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="wordpress" scheme="https://blog.xiang578.com/tags/wordpress/"/>
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>2016年北京区域赛</title>
    <link href="https://blog.xiang578.com/post/icpc-beijing-2016.html"/>
    <id>https://blog.xiang578.com/post/icpc-beijing-2016.html</id>
    <published>2017-01-29T14:13:28.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>今年，一队发挥出色，拿到全部赛区的名额，而且大三也没有多少队伍。所以我们这种弱队还有机会去参加第二场比赛。</p><p>作为第三次去北大，流程都是非常熟悉的。周四下午坐Z10出发，第二天上午到达北京。周五下午我一个人去了前两次来北京都没有机会参观的故宫。</p><p><img src="https://media.xiang578.com/9c7_2016-11-11_13-57-43_compressed.jpg" alt="" /></p><p>故宫之旅并不是很好，主要是游客太多，紫禁城失去了往日的威严。不过，另外加收门票的钟表馆很棒，皇室的藏品居然如此花哨。有些钟表的滴答声一百多年之后依旧飘荡在场馆之内。出了故宫之后，走了半个小时才找到一个地铁站，这个设计非常的愚蠢吧，之后就动身前往北大。</p><p><img src="https://media.xiang578.com/9c7_2016-11-11_14-38-43_compressed.jpg" alt="" /></p><p>周六下午热身赛，我们出来的比较早，在体育馆的看台上做了一会儿，看着下面排列整齐的两百多台电脑，心中生出一丝感动。之后就是进入场馆搞事情，电脑是五位数的戴尔移动工作站，外接了鼠标、键盘、和显示器。和我自己在寝室里面干的差不多。海巨表示显示器大看着爽，不过也发现键盘上有日文符号，这就比较影响我的发挥了。然后是例行看一下 周围的队伍，前面是北师、后面是北航、右上方有杭电一队，感觉压力又好大，虽然他们根本不会在乎我们。</p><p>比赛开始之前，队友想起在大连时，我讲了一句热身赛只要看一下AC是什么颜色就好了，最后被我成功奶死，全部是WA，所以告诫我不要乱说话。拿到题目之后，我们看了一下，发现题目是前几年北大出的区域赛和网络赛的。其中B题还是我们前几周训练过的题目，我拿起键盘表示这次终于有机会拿个一血了，马上写了起来，队友还是表示不相信。当我写完提交后，邪恶战胜了正义，果真发挥了一个WA，此时其他有一个队伍拿到这题的一血，彻底骨折。所幸改了一下还是过了，之后C题也是原来写过的，上去写了一下就过了。之后就讨论了一会儿A题，不过没有得出什么答案，感觉暴力上去肯定会超时，D题也不会写，最后上去让海巨测了一下机器和各种返回就去吃饭了。晚上回去才发现A题比我们想的还要暴力，没有勇气啊。</p><p>由于我们知道不会来北大吃太多餐，所以晚饭比较丰盛。一遍吃一遍感叹北大的伙食真好，早知道原来好好读书了。回到宾馆后，海巨在找题目写，翔哥想着阴阳师靠他的符偷渡欧洲，我看着炉石直播学习技术。又是一天。</p><p>周日，因为经费紧张，住的宾馆离北大比较远，我们三个7点就出发了，8点半左右到达北大赛场，然后等待比赛的开始。<br /><img src="https://media.xiang578.com/9c5_2016-11-13_08-15-51_compressed.jpg" alt="" /></p><p>9点比赛正式开始，开场顺利的写完了两道签到题，然后我们看了一下一道搜索题，我感觉可以写了，另外两个人去看了一下I题。我写差不多后，海巨上来写了I，也很快的写完并提交了，不过返回了WA。换我上去继续写搜索题，很快我写的超时了，只好改的优雅一点，翔哥也指出海巨理解错了题目，他们两想了一下决定帮我一起改搜索题，小改了一些东西之后，又提交了两次，返回两个WA。当时我们很紧张了，不过没有办法，海巨在看代码，我在写最暴力的准备对拍，翔哥在那里构造数据。最后，翔哥构造出了一组强力的数据，成功把我的代码hack了，我发现改掉一点就会对，不过没有想明白怎么回事，就改了一下记录答案的方式，最后自信的提交返回AC。然后我们将目光聚集到了K题，这个破题，题目就看了好久才明白，不过数据范围居然有10的100次方，我们搞了好久才都没有想出来，我感叹了已经上次在大连也是死在这种恶心的题目上，还是要想，我们写了一个10的9次以内的暴力程序打表，神奇的发现最大符合要求的个数只有样例给的83个，然后他们开始推规律，我在那里划水。想着写不出来，只要让海巨上去写一个只要83个答案表的程序，赌一发梦想。虽然感觉北大不会蠢到把最后一个答案告诉你，海巨还是写了，不过交上去还是WA。之后就陷入了江局，封榜后一会儿，我算了一下发现15位数随便填的情况下1就有10的16次左右个了，果断抢来电脑，不知道是什么力量让我点开海巨WA的代码，我看了一下差点吐血，找一个最大不超过n的值被写成立找一个最小超过n的值，我问了一下海巨，他还不知道，我直接改了一下就交上去，再赌一个梦想，然后就AC。我们马上点开排名，不过只能现实封板前的排名103，这题交了应该会前进一些，但是北大只有93个奖牌。海巨表示把I题写了才能稳，我看了一下I题，果断表明我不会数学题，只能靠你们了。然后实力分析一波之后，感觉要ntt操作，找了一下发现没有带这个模版，只好告诉海巨要么你想个其他的方法，要么自己创造一个ntt算法。我也没有找到其他组说的图论题是哪一个，只好提前选择死亡，吃起了发的午餐，果真像赛前说的一样吃东西就等于放弃了，最后还有10分钟结束的时候，我们三个人都愉快的吃起了午餐，把自己的命运交给其他小笨蛋来掌握。边吃边感叹这是第一次在正赛封榜后过题以及终于不是什么题数靠前的队伍了。</p><p><img src="https://media.xiang578.com/9c5_2016-11-13_14-01-11_compressed.jpg" alt="" /></p><p>比赛结束之后，不知道结果怎么样，我们只好在那里等待，这要是在之前可以直接会师火车站了。北大搞了一堆事情，才开始滚榜，判完我们题目的时候好像跳到了81名去了，他们两个开始统计超过我们的人，又过了一会儿，发现最后名次固定在了85名，然后三个人都好高兴。滚完铜牌区之后，开始颁奖，我也有幸登上北大的领奖台。之后，那些也和我们没有什么关系了，反正两年多的努力有了回报就可以。</p><p><img src="https://media.xiang578.com/9c5_2016-11-13_16-19-49.jpeg" alt="" /></p><p>从北大出来，直奔麦当劳买了一下晚餐就去火车站了。我特地点了一杯拿铁，稳如拿铁。还是要相信科学。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;今年，一队发挥出色，拿到全部赛区的名额，而且大三也没有多少队伍。所以我们这种弱队还有机会去参加第二场比赛。&lt;/p&gt;
&lt;p&gt;作为第三次去北大，流程都是非常熟悉的。周四下午坐Z10出发，第二天上午到达北京。周五下午我一个人去了前两次来北京都没有机会参观的故宫。&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>为知笔记写博客测试</title>
    <link href="https://blog.xiang578.com/post/use-wiznote-to-write-blog.html"/>
    <id>https://blog.xiang578.com/post/use-wiznote-to-write-blog.html</id>
    <published>2017-01-19T14:19:06.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>适用于WordPress</p></blockquote><p>如果你可以看到这一篇文件，就表示我测试成功了！</p><h4 id="tips"><a class="markdownIt-Anchor" href="#tips"></a> tips:</h4><ul><li>为知笔记中的标签自动变成博客文章的标签</li><li>选择发布时，会自动检测是新发布文章还是修改文章</li><li>自带markdown优化，轻松解决wordpress没有什么好用markdown编辑器的问题</li></ul><p>参考连接：<a href="http://www.wiz.cn/wiz-plugin-blog-writter.html">发布笔记到博客，更好的博客离线撰写工具</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;适用于WordPress&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果你可以看到这一篇文件，就表示我测试成功了！&lt;/p&gt;
&lt;h4 id=&quot;tips&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#tips&quot;&gt;&lt;/a&gt; t</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="wordpress" scheme="https://blog.xiang578.com/tags/wordpress/"/>
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="wiznote" scheme="https://blog.xiang578.com/tags/wiznote/"/>
    
  </entry>
  
  <entry>
    <title>iPad Pro 开箱</title>
    <link href="https://blog.xiang578.com/post/newipad.html"/>
    <id>https://blog.xiang578.com/post/newipad.html</id>
    <published>2016-11-25T12:51:29.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>好久没有更新博客，差不多都忘记 hexo 的指令了。<br />上周六在苹果官网订了 9.7 英寸 iPad Pro WLAN 32GB - 金色 ，前几天刚好到了，所以写一篇庆祝一下。</p><span id="more"></span><p>自己买一个刻字版的Ipad，发货速度比正常的慢了3天左右。Ipad是从四川那边用顺风次日达发过来的，难道苹果工厂往内陆迁了？</p><p>外包装就是一个普通的纸盒，蛮干净的，所以路上没有遭遇暴力投递。<br /><img src="https://media.xiang578.com/IMG_5405.jpg" alt="" /></p><p>封口处有一个小箭头提示，从那里轻轻一拉，就打开了包装。<br /><img src="https://media.xiang578.com/IMG_5404.jpg" alt="" /></p><p>跟一般的包裹不同，里面没有填充其他减震物。<br /><img src="https://media.xiang578.com/IMG_5406.jpg" alt="" /></p><p>然后就是精心包装的iPad。<br /><img src="https://media.xiang578.com/IMG_5407.jpg" alt="" /></p><p>迫不及待的打开盒子，新鲜的“苹果味”扑面而来。<br /><img src="https://media.xiang578.com/IMG_5408.jpg" alt="" /></p><p>取出iPad，里面还附赠充电器和Lightning的数据线，只不过没有耳机。<br /><img src="https://media.xiang578.com/IMG_5410.jpg" alt="" /></p><p>撕掉iPad的保护膜，翻到背面，就能看见刻的字。本来打算刻两行头文件，却被提示刻字内容不能包含有尖括号或者双引号。最终选择下面这两句符合要求的话。<br /><img src="https://media.xiang578.com/IMG_5411.jpg" alt="" /></p><p>最后，按照提示一路设置iPad，然后就有一台价值4000+的游戏机。下次有空再来 记录一下自己都装了什么App。<br /><img src="https://media.xiang578.com/IMG_5413.jpg" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;好久没有更新博客，差不多都忘记 hexo 的指令了。&lt;br /&gt;
上周六在苹果官网订了 9.7 英寸 iPad Pro WLAN 32GB - 金色 ，前几天刚好到了，所以写一篇庆祝一下。&lt;/p&gt;</summary>
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="ipad" scheme="https://blog.xiang578.com/tags/ipad/"/>
    
  </entry>
  
  <entry>
    <title>杭电OJ AC500题</title>
    <link href="https://blog.xiang578.com/post/hdu500.html"/>
    <id>https://blog.xiang578.com/post/hdu500.html</id>
    <published>2016-08-08T02:00:05.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>距离AC400题，过去了135天。</p><blockquote><p>有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。</p></blockquote><span id="more"></span><p><img src="https://media.xiang578.com/hdu500.png" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离AC400题，过去了135天。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
    <category term="hdu" scheme="https://blog.xiang578.com/tags/hdu/"/>
    
  </entry>
  
  <entry>
    <title>第七届蓝桥杯决赛杂记</title>
    <link href="https://blog.xiang578.com/post/lanqiaobei-2016.html"/>
    <id>https://blog.xiang578.com/post/lanqiaobei-2016.html</id>
    <published>2016-06-03T23:46:56.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>反正最近不想干什么正经事，回忆一下这些东西也好。</p><span id="more"></span><p><img src="https://media.xiang578.com/%E6%80%BB%E5%86%B3%E8%B5%9B.jpg" alt="" /></p><p>总的来说，这是我第二次去北京参加蓝桥杯决赛。去年获得了优秀奖，换句话来说就是重在参与。不过，今年成绩比去年好一点。</p><p>（订的宾馆一如既往的温馨就不说了）首先，今年我的比赛地点是在北京建筑大学（西城校区）。顾名思义就知道这所学校的建筑系比较有名，不过这和我没有什么关系。这学校位于北京市内，又由于建的比较早，所以进去之后发现植被非常的茂盛，另一方面就是校园建筑看起比较破旧，或者是有历史感。比较有意思的是，他们的计算中心是位于地下的，所以比赛的时候我就是在地下编程了……</p><p><img src="https://media.xiang578.com/%E5%8C%97%E4%BA%AC%E5%BB%BA%E7%AD%91%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6.jpg" alt="" /></p><p>决赛从周六上午9点开始到下午1点结束，一共4个小时。题目有6道，两道填空题，一道代码填空题，和三道编程题。第一题，就是解一个二元一次方程x+y的最小值。第二题，是一个大暴力题，自己想了好久才想出一种方法，不幸的是最后和别人对答案的时候，发现自己想错了。第三题，我模拟了一下正确的转换方式和题目中代码给的转换方式对比想出填入的代码。第四题，枚举了一个每一行第一个字母暴力解出来。第五题是一道计算几何的题目，好像是外国比赛的原题，反正我连凸包都不会。第六题是什么生成树计数，本来想写一个暴力绝杀的，但是在最后还有10分钟的时候发现自己写了40分钟的代码是错的，多么绝望。其实后来发现，这后面两道题目的区分度几乎为0，周神都只写了暴力的上去，不知道理工的final选手有没有完全写出来。</p><p>周六下午我就开始干来北京的正事了，和周神坐地铁来到天安门。参观了天安门广场、中国国家博物馆、并且还登上了天安门城楼。最后，还是感觉中国国家博物馆有意思，很多原来在课堂上见过的藏品都亲眼所见了，不过自己上的艺术课程还是太少了，对于很多东西没有鉴赏能力。不过也有遗憾，毛主席纪念馆是每天上午8点到12点开放，没有去成，故宫是从天安门后面的午门进入，不过每天4点停止售票，也没有去成。</p><p><img src="https://media.xiang578.com/%E5%A4%A9%E5%AE%89%E9%97%A8%E5%9F%8E%E6%A5%BC.jpg" alt="" /></p><p>周日就是到北大领取小礼品和参加颁奖典礼，虽然我们三个人都是观众。由于去的比较早，我们在未名湖边坐了一会儿。对岸的未名湖石碑人来人往，感觉能看一整天。坐着那里才会明白，为什么那么多人向往着北大。我们在学校中只是生存，他们却是生活，鸟语花香，春意盎然。</p><p><img src="https://media.xiang578.com/%E6%9C%AA%E5%90%8D%E6%B9%96%E4%B8%80%E8%A7%92.jpg" alt="" /></p><p>颁奖典礼在邱德拔体育馆举行，这也是2008年奥运会乒乓球场馆，里面到现在为止还保留着奥运元素。典礼是一个奖项颁奖加一个或两个节目交叉进行的。也请了一些小明星过来唱歌，其中映象比较深刻的是《明天的烦恼交给明天》的mv。自己觉得拍的很有创意，两名歌手一个来自北大的历史专业，另一个来自考古专业。其他的就是看着理工的三个人拿着四架无人机回去，都可以玩无人机编队了……</p><p><img src="https://media.xiang578.com/%E5%8C%97%E5%A4%A7%E4%BD%93%E8%82%B2%E9%A6%86.jpg" alt="" /></p><p>当天晚上和其他三个人一起去了全聚德前门起源店。到达后，发现人比较多，取了号后等了一会儿。</p><p><img src="https://media.xiang578.com/%E5%85%A8%E8%81%9A%E5%BE%B7%E5%89%8D%E9%97%A8%E5%BA%97.jpg" alt="" /></p><p>之后就是普通的点菜，一只优秀的鸭子比普通的鸭子才贵30块，不过其他菜还是比较贵的。</p><p><img src="https://media.xiang578.com/%E5%8C%97%E4%BA%AC%E7%83%A4%E9%B8%AD.jpg" alt="" /></p><p>厨师切好拼盘后，服务员还不忘提醒我们拍照发朋友圈。我和老王纷纷表示，没有周神，怎么可能吃这么高档的东西。</p><p>最后，周一下午做火车回到杭州，结束了北京之旅。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;反正最近不想干什么正经事，回忆一下这些东西也好。&lt;/p&gt;</summary>
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>只是为了好玩——Linux之父林纳斯自传</title>
    <link href="https://blog.xiang578.com/post/just-for-fun.html"/>
    <id>https://blog.xiang578.com/post/just-for-fun.html</id>
    <published>2016-05-03T06:28:48.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<ol><li>这个是我为了学习Linux操作系统，而从图书馆精心挑选的书。</li><li>林纳斯眼中的人生意义：生存、社会秩序和娱乐。</li><li>Linux起源于林纳斯对于Minx的不满足，壮大于开源运动。</li><li>Linux也是世界上最大的开源协作项目。</li><li>内容和题目一样，不过也没有太多有趣的故事。</li><li>林纳斯的思想朴实情切，不高深。</li><li>至少读完之后，你会了解到没有他那样的基础和机遇去创造新的操作系统。</li><li>书中出现了例如微内核、分页管理等计算机组成原理中的名词。</li><li>现在已经不能说出这些具体含义了。</li><li>希望有一天可以去看Linux源代码。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;这个是我为了学习Linux操作系统，而从图书馆精心挑选的书。&lt;/li&gt;
&lt;li&gt;林纳斯眼中的人生意义：生存、社会秩序和娱乐。&lt;/li&gt;
&lt;li&gt;Linux起源于林纳斯对于Minx的不满足，壮大于开源运动。&lt;/li&gt;
&lt;li&gt;Linux也是世界上最大的开源协作项目</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
  </entry>
  
  <entry>
    <title>浙江省第十三届程序设计竞赛总结</title>
    <link href="https://blog.xiang578.com/post/zjp-2016.html"/>
    <id>https://blog.xiang578.com/post/zjp-2016.html</id>
    <published>2016-04-26T05:59:02.000Z</published>
    <updated>2024-05-12T11:15:03.473Z</updated>
    
    <content type="html"><![CDATA[<p>周六冒雨前往浙大紫金港校区比赛</p><p>最终写了4题</p><p>获得铜奖</p><p>遗憾</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;周六冒雨前往浙大紫金港校区比赛&lt;/p&gt;
&lt;p&gt;最终写了4题&lt;/p&gt;
&lt;p&gt;获得铜奖&lt;/p&gt;
&lt;p&gt;遗憾&lt;/p&gt;
</summary>
      
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
  </entry>
  
  <entry>
    <title>杭电OJ AC400题</title>
    <link href="https://blog.xiang578.com/post/hdu400.html"/>
    <id>https://blog.xiang578.com/post/hdu400.html</id>
    <published>2016-03-26T06:00:05.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>距离上次AC300题，过去了106天。</p><blockquote><p>有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。</p></blockquote><span id="more"></span><p><img src="https://media.xiang578.com/hdu400.png" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离上次AC300题，过去了106天。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
    <category term="hdu" scheme="https://blog.xiang578.com/tags/hdu/"/>
    
  </entry>
  
  <entry>
    <title>道长写作每日一句01-20</title>
    <link href="https://blog.xiang578.com/post/english-writing-01.html"/>
    <id>https://blog.xiang578.com/post/english-writing-01.html</id>
    <published>2016-03-06T13:45:00.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>行百里者半九十。<br />200906：可惜这件事情也没有坚持下去。</p></blockquote><span id="more"></span><p><strong>1 People respectively choose jogging, playing basketball, swimming, skating, climbing or riding as their regular exercises because exercises never fail to make us stronger and more energetic.</strong></p><ul><li>人们分别将慢跑、打篮球、游泳、滑雪、爬山或者骑自行车做为自己的日常运动。这其中的原因在于有规律运动会使我们变得更加强壮和精力充沛。</li><li>参考译文：人们分别选择慢跑、打篮球、游泳、滑冰、爬山或骑车作为日常锻炼，这是因为这些运动总是使我们更强壮和精力充沛。</li></ul><p><strong>2 City residents suffer a great deal from public hazards, such as noise and air pollution, while in the country, far away from numerous exciting activities, one may feel isolated or bored.</strong></p><ul><li>城市居民忍受着例如噪音和空气污染之类的公共问题，然而居住在乡村中，却又有远离大量有趣活动导致的孤独感和无聊感。</li><li>参考译文：城市居民饱受噪音和空气污染等公共问题的困扰。而在乡村，人们无法参加众多精彩的活动，可能会感到孤独和无聊。</li></ul><p><strong>3 We often hear frustrating parents complain that their children are behaving unreasonably while many a child would so often say that his or her parents are just hopelessly old-fashioned.</strong></p><ul><li>我们经常听到沮丧的父母报怨他们子女的表现不可理解，与此同时，孩子们也经常说父母太过于守旧。</li><li>参考译文：我们经常听到父母抱怨孩子们的行为难以理解，而很多孩子们总是说父母们不可救药地落伍了。</li></ul><p><strong>4 Covering all kinds of topics from daily life to political issues, from individual thoughts to world events, Microblogs offer readers anything they might be interested in.</strong></p><ul><li>覆盖从日常生活到政治议题，从个人思想到世界大事的所有的主题 ，微博提供使用者任何他们也许感兴趣的事情。</li><li>参考译文：微博涉及各种话题，从日常生活到政治热点，从个人思想到世界大事，为读者提供他们可能感兴趣的任何内容</li></ul><p><strong>5 Over the course of thousands of years, the Chinese people have created their own unique customs and traditions, and passed them on from one generation to the next.</strong></p><ul><li>在上千年的历史进程中，中国人创造了独一无二的风俗与传统，并将此一代代的传承下去。</li><li>参考译文：在几千年的历程中，我国人民创造了自己独特的风俗和传统，并把它们一代代传给后人。</li></ul><p><strong>6 A lonely heart tends to regard genuine love from other people as the greatest happiness, and a man confined to a wheelchair will have no other wish than to walk like a normal person.</strong></p><ul><li>孤独的人会将他人真诚的爱作为最大的幸福，坐轮椅的人没有比像正常人一样行走更大的愿望。</li><li>参考译文：一个孤独的人往往把其他人给予的真爱视为最大的幸福，而一个坐轮椅的人除了希望能像普通人一样走路之外别无他求。</li></ul><p><strong>7 Today, whether in Bangkok, Beijing or Berlin, the roads of the world’s most populous cities are more crowded with motor vehicles than at any other time in history.</strong></p><ul><li>如今无论在曼谷、北京还是柏林，这些世界上人口众多城市的道路因为机动车问题而堵塞超过历史时期。</li><li>参考译文：如今，无论在曼谷、北京还是柏林，这些世界上人口最稠密的城市的道路上挤满了机动车，数量比历史上任何时候都要多。</li></ul><p><strong>8 In the case of a blotched operation, the patient could end up with an unsightly appearance, or at least one that is worse than his or her pre-op appearance.</strong></p><ul><li>在一个手术之后，病人会以一个难看的外表结束，或者至少比他之前的外貌更糟。</li><li>参考译文：在手术失败的情况下，患者可能会变得难看，或者至少比手术前丑。</li></ul><p><strong>9 An advantage of online shopping is that it allows people to find the cheapest price with a flick of the mouse.</strong></p><ul><li>网上购物的一个优势是人们通过鼠标的点击可以买到最便宜的东西。</li><li>参考译文：网上购物的一个优势就是让人们只需轻按鼠标就能找到最便宜的价格。</li></ul><p><strong>10 Internet technology is becoming increasingly advanced and its development is indeed eye-catching.</strong></p><ul><li>网络技术变得越来越高级，它的发展也十分的吸引眼球。</li><li>参考译文：因特网技术越来越先进，它的发展确实引人注目。</li></ul><p><strong>11 We can get a better understanding of the flora and fauna as well as local customs and practices of the country we are visiting.</strong></p><ul><li>当在一个国家旅行时，我们会更的观察当地动植物和体验风土人情。</li><li>参考译文：我们可以更好地了解所游览国家的动植物资源以及当地的风土人情。</li></ul><p><strong>12 Shoddy products would expose the consumers to health and safety risks.</strong></p><ul><li>假冒伪劣产品会给消费者带来健康和安全的风险。</li><li>劣质产品会使消费者面临健康和安全风险。</li></ul><p><strong>13 China’s lower mortality rate, when combined with the one-child policy, has resulted in a rapid aging of China’s population, which will lead to a pension problem for the Chinese government.</strong></p><ul><li>中国的低死亡率和独生子女政策加速了人口的老龄化，这些将给政府带来在养老金方面的问题。</li><li>参考译文：我国较低的死亡率以及独生子女政策造成了我国人口的迅速老龄化，这将给我国政府带来养老金问题。</li></ul><p><strong>14 There is a growing recognition that people with a master’s degree will have a competitive advantage over those with only a bachelor’s degree.</strong></p><ul><li>现在越来越多的人认为那些具有硕士学历的人比只有本科学历的更加有竞争优势。</li><li>参考译文：越来越多的人认识到，和那些只有学士学位的人相比，拥有硕士学位的人将具有竞争优势。</li></ul><p>**15 On the one hand, there is no denying that the Internet is currently one of the most efficient media for interpersonal communication.  **</p><ul><li>在另一个方面，互联网毫无疑问的成为了当前个人之间交流最有效的方式。</li><li>参考译文：一方面，不可否认因特网目前是人际交流使用的最高效媒介之一。</li></ul><p><strong>16 Although physical education is a part of adolescent education, a good many students go through their formative years without developing a lasting interest in sports.</strong></p><ul><li>尽管体育教育是青少年教育中重要的一个组成部分，但是大量的学生在生长发育时期没有养成一个持续的体育爱好。</li><li>参考译文：虽然体育教育是青少年教育的一部分，但是许多学生在他的的性格形成时期并没有培养起来对体育运动的长期兴趣。</li></ul><p><strong>17 Mental illness is often difficult to recognize and even more difficult to treat if a person isn’t aware of his or her illness.</strong></p><ul><li>精神疾病通常更难被识别，当本人对自己的病情不关心时就更加难被治愈了。</li><li>参考译文：心理疾病一般很难发现，而且如果人们不知道自己有心理问题，那么治疗起来更是难上加难。</li></ul><p><strong>18 A large number of people consider university education as a springboard for good jobs and high salaries.</strong></p><ul><li>大量的人们认为大学教育是满意工作和高薪的跳板。</li><li>很多人把大学教育视为找到好工作、拿高薪的起点。</li></ul><p><strong>19 Although spending 10 to 15 hours a week in a fast-food restaurant doesn’t seem to take up too much time, it still reduces the time that should otherwise be spent studying.</strong></p><ul><li>尽管一周在快餐店花费10到15小时看起来不是很多，但是这仍然减少了本应该用来学习的时间。</li><li>参考译文：虽然每周在快餐店工作10到15个小时似乎并不占太多时间，但这仍然减少了学生本应用在学习上的时间。</li></ul><p>**20 While self-reliance is a crucial quality that everyone should strive to develop, it is also vital that we learn how to accept other’s help. **</p><ul><li>参考译文：虽然自立是每个人都应该努力培养的重要品质，学会如何接受他人的帮助也是非常重要的。</li></ul><p><strong>21 Unemployment causes young people to suffer from an unstable income as well as the psychological stress of not knowing when they will get their next paycheck.</strong></p><ul><li>失业除了导致年轻人没有稳定的收入，还给他们增加了不知道下次什么时候获得薪水的压力。</li><li>参考译文：失业使年轻人收入不稳定，并承受不知何时才能再次领到薪水的心理压力。</li></ul><p><strong>22 The craze for government posts has become a phenomenon that cannot be ignored, and has stirred a heated debate.</strong></p><ul><li>government posts 公务员</li><li>对公务员狂热的已经成为一种不可以忽视的现象，这引起了公众热烈的讨论。</li><li>参考译文：公务员热已经成为一种不能忽视的现象，引发了人们热烈的讨论。</li></ul><p><strong>23 The media could play an active role in encouraging energy-efficient measures.</strong></p><ul><li>媒体可以在鼓励节能上发挥出重要的作用。</li><li>参考译文：媒体在鼓励节能举措方面可以发挥积极的作用。</li></ul><p><strong>24 Another harmful human activity is our over-utilization of the limited farmland without allowing land the time it takes to replenish nutrients.</strong></p><ul><li>其他有害的人类活动还有对有限的土地的过度使用，导致它们没有时间恢复养分。</li><li>参考译文：人类进行的另一种有害活动是我们对有限农田的过度使用，而不给土地所需的补充营养的时间。</li></ul><p><strong>25 Urbanization has some negative effects on society as large concentrations of people compete for limited resources.</strong></p><ul><li>城市化对社会也有许多消极的影响，比如高度集中的人口争夺有限的资源。</li><li>城市化对社会有一些负面的影响，因为大量集中的人口要争夺有限的资源。</li></ul><p><strong>26 As a green lifestyle, a low-carbon life advocates low energy consumption, thereby reducing CO2 emissions.</strong></p><ul><li>与绿色生活类似，低碳生活提倡减少能源消耗，以此减少二氧化碳排放</li><li>作为一种绿色的生活方式，低碳生活提倡低能耗，由此减少了二氧化碳的排放量。</li></ul>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;行百里者半九十。&lt;br /&gt;
200906：可惜这件事情也没有坚持下去。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="writing" scheme="https://blog.xiang578.com/tags/writing/"/>
    
    <category term="english" scheme="https://blog.xiang578.com/tags/english/"/>
    
  </entry>
  
  <entry>
    <title>2015 总结</title>
    <link href="https://blog.xiang578.com/post/2015.html"/>
    <id>https://blog.xiang578.com/post/2015.html</id>
    <published>2016-02-09T17:59:51.000Z</published>
    <updated>2024-05-12T11:15:03.461Z</updated>
    
    <content type="html"><![CDATA[<p>在成为自己讨厌人的路上加速前进。只写四句吧。这是第三句。写完了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在成为自己讨厌人的路上加速前进。只写四句吧。这是第三句。写完了。&lt;/p&gt;
</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
  </entry>
  
  <entry>
    <title>杭电OJ AC300题</title>
    <link href="https://blog.xiang578.com/post/hdu300.html"/>
    <id>https://blog.xiang578.com/post/hdu300.html</id>
    <published>2015-12-11T14:16:22.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>距离上次AC200题，过去了89天。</p><blockquote><p>有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。</p></blockquote><span id="more"></span><p><img src="https://media.xiang578.com/practical-writing-41a2c155d-980f-4181-8323-37d4baba2735.png" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;距离上次AC200题，过去了89天。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
    <category term="hdu" scheme="https://blog.xiang578.com/tags/hdu/"/>
    
  </entry>
  
  <entry>
    <title>杭电OJ AC200题</title>
    <link href="https://blog.xiang578.com/post/hdu200.html"/>
    <id>https://blog.xiang578.com/post/hdu200.html</id>
    <published>2015-09-13T07:47:27.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。</p></blockquote><span id="more"></span><p><img src="https://media.xiang578.com/hdu200.png" alt="" /></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;有很多出去的学长学姐都是不知道把红宝书背了多少遍，又一次和XX聊天，他说我打赌你背的有些单词，你一辈子都不会用上，但是尽管如此，很多人都背下来，这就是毅力，就是韧性。有的人放弃了，有的人却坚持下来，不得不承认，只有耐得住寂寞的人最后才会成功。学习是一项孤独而崇高的事业。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="军机处" scheme="https://blog.xiang578.com/categories/%E5%86%9B%E6%9C%BA%E5%A4%84/"/>
    
    
    <category term="acm" scheme="https://blog.xiang578.com/tags/acm/"/>
    
    <category term="hdu" scheme="https://blog.xiang578.com/tags/hdu/"/>
    
  </entry>
  
  <entry>
    <title>从零开始利用 hexo + Github/Coding 搭建个人博客</title>
    <link href="https://blog.xiang578.com/post/how-to-build-a-hexo-blog.html"/>
    <id>https://blog.xiang578.com/post/how-to-build-a-hexo-blog.html</id>
    <published>2015-08-15T11:43:17.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>更新历史</p></blockquote><ul><li>2015年8月15日：完成初稿</li><li>2017年10月05日：添加新主题 <code>Even</code> 相关内容</li><li>2017年10月11日：文章阅读次数统计</li><li>2018年1月19日：修改页脚</li><li>2018年3月26日：双更新</li><li>20220226: 首页隐藏指定文章</li></ul><hr /><p>前几天自己在电脑上装Linux时，不小心把博客的数据文件夹给删了。无奈重新安装，同时写下这篇备忘录以防万一。当然，经历这个失误，看来也要利用网盘对博客的一些文件进行备份。</p><span id="more"></span><h3 id="安装-git-和-nodejs"><a class="markdownIt-Anchor" href="#安装-git-和-nodejs"></a> 安装 git 和 Node.js</h3><p>就是正常的在他们官网上下载最新版本，然后再点几下鼠标安装到你的电脑。不过，也许后面安装hexo时要设置node.js的环境变量，具体过程也可以百度到。</p><h3 id="安装-hexo"><a class="markdownIt-Anchor" href="#安装-hexo"></a> 安装 hexo</h3><p>打开gitbash（可能需要以管理员身份运行），利用npm命令安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo</span><br></pre></td></tr></table></figure><p>安装成功后大概会在shell中出现下面这样的信息<br /><img src="https://media.xiang578.com/%E5%AE%89%E8%A3%85hexo.jpg" alt="" /></p><h3 id="部署hexo"><a class="markdownIt-Anchor" href="#部署hexo"></a> 部署hexo</h3><p>比如我要安装在E盘hexo文件夹内，可以在gitbash中使用下面命令进行。如果你想明白这些命令是什么意思，可以百度cmd指令。（如无特殊说明，下面有的命令都在<code>/E/hexo</code>中使用gitbash完成）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd /E/hexo</span><br><span class="line">$ npm install hexo init</span><br></pre></td></tr></table></figure><p>安装成功后大概会在shell中出现下面这样的信息<br /><img src="https://media.xiang578.com/%E9%83%A8%E7%BD%B2hexo.jpg" alt="" /></p><h3 id="安装依赖包"><a class="markdownIt-Anchor" href="#安装依赖包"></a> 安装依赖包</h3><p>基础功能包，采用下面的命令安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install</span><br></pre></td></tr></table></figure><p>deploy git功能相关插件，网上发布时用的……</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>附加功能有sitemap和feed插件，如果你不懂这些也没有必要安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-generator-sitemap</span><br><span class="line">$ npm install hexo-generator-feed</span><br></pre></td></tr></table></figure><h3 id="第一次本地查看博客"><a class="markdownIt-Anchor" href="#第一次本地查看博客"></a> 第一次本地查看博客</h3><p>执行以下命令，然后到浏览器输入localhost:4000查看。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p>默认大概是下面的样子<br /><img src="https://media.xiang578.com/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%9C%AC%E5%9C%B0%E6%9F%A5%E7%9C%8B.jpg" alt="" /></p><h3 id="github相关部署和ssh设置"><a class="markdownIt-Anchor" href="#github相关部署和ssh设置"></a> github相关部署和ssh设置</h3><p>我的这些功能还可以用，所以没有重新设置。故不能详细论述，你可从下面参考链接中获得方法。</p><h3 id="发布功能部署"><a class="markdownIt-Anchor" href="#发布功能部署"></a> 发布功能部署</h3><p>编辑站点的<code>_config.yml</code>文件。你在部署时，要把下面的xiang578都换成你的账号名。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy: </span><br><span class="line">type: git</span><br><span class="line">repository: https://github.com/xiang578/xiang578.github.io.git</span><br><span class="line">branch: master</span><br></pre></td></tr></table></figure><p>执行下列指令即可完成部署，中间需要输入github用户名和密码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate hexo deploy</span><br></pre></td></tr></table></figure><h3 id="安装主题以next为例"><a class="markdownIt-Anchor" href="#安装主题以next为例"></a> 安装主题（以NexT为例）</h3><p>使用gitbash输入下面指令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd your-hexo-site</span><br><span class="line">$ git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><h3 id="启用主题"><a class="markdownIt-Anchor" href="#启用主题"></a> 启用主题</h3><p>修改Hexo目录下的config.yml配置文件中的theme属性，将其设置为next。运行<code>hexo g</code>和<code>hexo s</code>，并访问 <a href="http://localhost:4000">http://localhost:4000</a>，确保站点正确运行。</p><h3 id="主题优化"><a class="markdownIt-Anchor" href="#主题优化"></a> 主题优化</h3><p>参考相关主题的说明文档进行优化，或者访问使用相同主题的博客，查看博主相关文章。或者速成css和html自己改造。</p><h3 id="next主题404页面改造"><a class="markdownIt-Anchor" href="#next主题404页面改造"></a> next主题404页面改造</h3><p><code>E:\hexo\public</code>中创建404.html文件，复制下面代码，并保存，在配置文件中启用相关功能。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>404 - arao&#x27;blog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;404错误，页面不存在！&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge,chrome=1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;robots&quot;</span> <span class="attr">content</span>=<span class="string">&quot;all&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;robots&quot;</span> <span class="attr">content</span>=<span class="string">&quot;index,follow&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://qzonestyle.gtimg.cn/qzone_v6/lostchild/search_children.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果如下：<br /><img src="https://media.xiang578.com/404.jpg" alt="" /></p><h3 id="多说评论改造"><a class="markdownIt-Anchor" href="#多说评论改造"></a> 多说评论改造</h3><p>参考<a href="http://www.arao.me/2015/hexo-next-theme-optimize-duoshuo/"> 动动手指，给你的Hexo站点添加最近访客（多说篇）</a></p><p>效果如下：<img src="https://media.xiang578.com/%E5%A4%9A%E8%AF%B4.jpg" alt="" /></p><h3 id="域名绑定"><a class="markdownIt-Anchor" href="#域名绑定"></a> 域名绑定</h3><p>域名可以在<a href="http://wanwang.aliyun.com/">万网</a>上购买，大体上流程和淘宝购物差不多。现在大部分域名第一年价格比较便宜，续费也可以接受。当然如果你非要买<code>.集团</code>这种上万的域名，那么请联系我，土豪做个朋友吧！域名是有兴趣可以选择购买，采用默认的<code>github.io</code>也不错。</p><p>首先在<code>E:hexo\public</code>文件夹下创建名为<code>CNAME</code>文件（不要扩展名）接着输入你的域名。比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xiang578.top</span><br><span class="line">www.xiang578.top</span><br></pre></td></tr></table></figure><p>接着在万网的域名控制台增加如下图所示的两个解析<br /><img src="https://media.xiang578.com/%E5%9F%9F%E5%90%8D%E8%AE%BE%E7%BD%AE.jpg" alt="" /></p><h3 id="为-next-主题添加分类"><a class="markdownIt-Anchor" href="#为-next-主题添加分类"></a> 为 next 主题添加分类</h3><p>参考知乎<a href="https://www.zhihu.com/question/33324071">hexo下新建页面下如何放多个文章？</a></p><h3 id="去除-coding-pages-等待跳转页面"><a class="markdownIt-Anchor" href="#去除-coding-pages-等待跳转页面"></a> 去除 Coding Pages 等待跳转页面</h3><p>根据常识，只需要修改主题下面跟页脚相关的代码即可。比如 <code>Even</code> 主题中相关的代码在 <code>themes/even/layout/_partial/footer.swig</code>。</p><p>然后在这个文件中添加如下的代码即可。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hosted-by-coding-pages&quot;</span>&gt;</span></span><br><span class="line">    Hosted by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://pages.coding.me&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-weight: bold&quot;</span>&gt;</span>Coding Pages<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br></pre></td></tr></table></figure><p>最后，在项目的 Pages 服务中勾选<code>已放置 Hosted by Coding Pages</code>，等待审核通过就去除等待跳转页面。</p><h3 id="修改even主题的首页"><a class="markdownIt-Anchor" href="#修改even主题的首页"></a> 修改Even主题的首页</h3><p>不知道为什么，我不是很喜欢首页那种标题和文章摘要的形式。所以，决定把首页改造成归档页面的形式。</p><p>这步改造的思路是将生成归档页面相关的代码复制到生成首页的模板上去。在 <code>themes/even/layout</code> 文件夹里面修改<code>index.swig</code>，具体如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &quot;_layout.swig&quot; %&#125;</span><br><span class="line">&#123;% import &#x27;_macro/post.swig&#x27; as post_template %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block title %&#125; &#123;&#123; config.title &#125;&#125; &#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">  &lt;section id=&quot;posts&quot; class=&quot;posts&quot;&gt;</span><br><span class="line">    &lt;section id=&quot;archive&quot; class=&quot;archive&quot;&gt;</span><br><span class="line">    &#123;% if not page.prev %&#125;</span><br><span class="line">        &lt;div class=&quot;archive-title&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;archive-post-counter&quot;&gt;</span><br><span class="line">            &#123;&#123; _p(&quot;counter.archives&quot;, site.posts.length) &#125;&#125;</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">    &#123;% for post in page.posts %&#125;</span><br><span class="line">        &#123;% set year %&#125;</span><br><span class="line">        &#123;% set post.year = date(post.date, &#x27;YYYY&#x27;) %&#125;</span><br><span class="line"></span><br><span class="line">        &#123;% if post.year !== year %&#125;</span><br><span class="line">          &#123;% set year = post.year %&#125;</span><br><span class="line">          &lt;div class=&quot;collection-title&quot;&gt;</span><br><span class="line">            &lt;h2 class=&quot;archive-year&quot;&gt;&#123;&#123; year &#125;&#125;&lt;/h2&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;archive-post&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;archive-post-time&quot;&gt;</span><br><span class="line">            &#123;&#123; date(post.date, &#x27;MM-DD&#x27;) &#125;&#125;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">        &lt;span class=&quot;archive-post-title&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; class=&quot;archive-post-link&quot;&gt;</span><br><span class="line">            &#123;&#123; post.title &#125;&#125;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  &lt;/section&gt;</span><br><span class="line"></span><br><span class="line">  &#123;% include &quot;_partial/pagination.swig&quot; %&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>如果需要在首页显示所有的文章，可以参考 <a href="http://theme-next.iissnan.com/faqs.html#setting-page-size">如何设置页面文章的篇数？</a> 安装需要的插件，将 <code>per_page</code> 设置为0即可解决。</p><h3 id="添加文章统计"><a class="markdownIt-Anchor" href="#添加文章统计"></a> 添加文章统计</h3><ul><li>参考 <a href="https://github.com/ahonn/hexo-theme-even/wiki/%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0%E8%AE%BF%E9%97%AE%E9%87%8F%E7%BB%9F%E8%AE%A1">添加文章访问量统计</a>以及 <a href="http://www.joryhe.com/2016-05-29-how_to_create_leancloud_read_Counter.html">leanCloud,实现文章阅读量统计</a></li><li>自己使用时发现一个问题：每篇文章只有第一次打开时才显示阅读次数，而且计数都为1<ul><li>参考<a href="http://www.jianshu.com/p/702a7aec4d00">Hexo搭建博客系列：（五）Hexo添加不蒜子和LeanCloud统计无标题文章</a>中提到的创建 class 需要 <code>数据条目的默认 ACL 权限</code> 中选择无限制</li></ul></li></ul><h3 id="修改页脚"><a class="markdownIt-Anchor" href="#修改页脚"></a> 修改页脚</h3><p>未修改之前的页脚相关代码(<code>themes/even/layout/_partial/footer.swig</code>)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;copyright&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hosted-by-coding-pages&quot;</span>&gt;</span></span><br><span class="line">    Hosted by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://pages.coding.me&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-weight: bold&quot;</span>&gt;</span>Coding Pages<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;division&quot;</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;theme-info&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; __(&#x27;footer.theme&#x27;) &#125;&#125; -</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;theme-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://github.com/ahonn/hexo-theme-even&quot;</span>&gt;</span>Even<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;copyright-year&quot;</span>&gt;</span></span><br><span class="line">    &#123;% set current = date(Date.now(), &quot;YYYY&quot;) %&#125;</span><br><span class="line">    <span class="symbol">&amp;copy;</span></span><br><span class="line">    &#123;% if theme.since and theme.since != current %&#125;</span><br><span class="line">      &#123;&#123; theme.since &#125;&#125; -</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    &#123;&#123; current &#125;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;heart&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-heart&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;author&quot;</span>&gt;</span>&#123;&#123; config.author &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>未修改之前的效果</p><p><img src="https://media.xiang578.com/15163684556026.jpg" alt="" /></p><h3 id="双更新"><a class="markdownIt-Anchor" href="#双更新"></a> 双更新</h3><p>同时在 github 和 coding 上更新，然后根据访问时的 ip 地址跳转到不同的服务上。</p><p>下图框中的 a 和 b 为两个库的地址。<br /><img src="https://media.xiang578.com/15220743101609.jpg" alt="库的地址" /></p><p>github 项目中相关的地址修改<br /><img src="https://media.xiang578.com/15220746073007.jpg" alt="项目地址" /></p><p>最后，域名解析服务中添加如下的解析方式。<br /><img src="https://media.xiang578.com/15220746795739.jpg" alt="" /></p><h3 id="自动备份博客相关的源文件"><a class="markdownIt-Anchor" href="#自动备份博客相关的源文件"></a> 自动备份博客相关的源文件</h3><p>参考博文<a href="http://zhujiegao.com/2015/12/06/automatic-backup/">自动备份Hexo博客源文件 | Jolson’s Blog</a></p><h3 id="设置首页隐藏指定文章"><a class="markdownIt-Anchor" href="#设置首页隐藏指定文章"></a> 设置首页隐藏指定文章</h3><p>参考 <a href="https://www.jianshu.com/p/79fe9fb9dfa0">Hexo 设置首页隐藏指定文章 - 简书</a></p><ul><li>文档 YAML 中增加一个参数 <code>notshow:</code> 控制是否展示</li><li>修改主题 <code>index.swig</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> post <span class="keyword">in</span> page.<span class="property">posts</span> %&#125;</span><br><span class="line">  &#123;&#123; post_template.<span class="title function_">render</span>(post, <span class="literal">true</span>) &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>改成</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> post <span class="keyword">in</span> page.<span class="property">posts</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> post.<span class="property">notshow</span> != <span class="literal">true</span> %&#125;</span><br><span class="line">    &#123;&#123; post_template.<span class="title function_">render</span>(post, <span class="literal">true</span>) &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><hr /><p>大概这样就完成一个博客的安装和部署，接下来你就可以快乐的写博客。</p><h3 id="参考文章"><a class="markdownIt-Anchor" href="#参考文章"></a> 参考文章</h3><ul><li><a href="http://www.jianshu.com/p/q81RER">献给写作者的 Markdown 新手指南</a></li><li><a href="http://zipperary.com/2013/05/28/hexo-guide-2/">hexo系列教程：（二）搭建hexo博客</a></li><li><a href="https://hexo.io/zh-cn/">hexo官方网站</a></li><li><a href="http://blog.csdn.net/wx_962464/article/details/44786929">Hexo 使用中遇到的问题总结</a></li><li><a href="http://cnfeat.com/2014/05/10/2014-05-11-how-to-build-a-blog/">如何搭建一个独立博客——简明Github Pages与Hexo教程</a></li><li><a href="http://www.arao.me/2015/hexo-next-theme-optimize-base/">动动手指，NexT主题与Hexo更搭哦（基础篇）</a></li><li><a href="http://www.ahonn.me/2016/12/15/create-a-hexo-theme-from-scratch/">从零开始制作 Hexo 主题</a></li><li><a href="http://chensd.com/2016-06/hexo-theme-guide.html?utm_source=tuicool&amp;utm_medium=referral">Hexo 主题开发指南</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;更新历史&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;2015年8月15日：完成初稿&lt;/li&gt;
&lt;li&gt;2017年10月05日：添加新主题 &lt;code&gt;Even&lt;/code&gt; 相关内容&lt;/li&gt;
&lt;li&gt;2017年10月11日：文章阅读次数统计&lt;/li&gt;
&lt;li&gt;2018年1月19日：修改页脚&lt;/li&gt;
&lt;li&gt;2018年3月26日：双更新&lt;/li&gt;
&lt;li&gt;20220226: 首页隐藏指定文章&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;前几天自己在电脑上装Linux时，不小心把博客的数据文件夹给删了。无奈重新安装，同时写下这篇备忘录以防万一。当然，经历这个失误，看来也要利用网盘对博客的一些文件进行备份。&lt;/p&gt;</summary>
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
    <category term="hexo" scheme="https://blog.xiang578.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>hello world!</title>
    <link href="https://blog.xiang578.com/post/hello-world.html"/>
    <id>https://blog.xiang578.com/post/hello-world.html</id>
    <published>2015-08-06T12:58:27.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>由于与 hexo-leancloud-counter-security 软件冲突，将标题从 <code>System.out.println(&quot;hello world!&quot;);</code> 修改成 <code>hello world!</code>。具体问题分析见<br /><a href="https://xiang578.com/post/meet-leancloud-counter-security-problem.html">博客折腾记：hexo-leancloud-counter-security 与标题中的引号冲突</a>。</p><hr /><p>除去前几篇为了测试hexo博客的各项功能所发的博文，这是为新博客所写的第一篇文章。标题取自刚开始学习编程语言时输出的字符串，“hello world！” 。</p><p>之前，在QQ空间、博客园、csdn上都开过博客，但是结果都不尽如人意。毕竟免费用人家的东西，也不能奢求什么都朝着自己的意愿改变，情怀本身就敌不过他们的kpi。除此之外，也可以自己购买服务器和域名架设博客。可受限于现阶段经济实力，上面的方法也无法实现。所幸github+hexo架设博客的方式，给了我创造一片自由空间的机会。</p><p>另外，学习编程之后，觉得可编程的才有安全感。就好像越来越排斥word格式的难控，转向markdown书写的轻盈。hexo是一种实现静态网页的方式，不过自己目前没有专门学习过网页编程，所以大体上采用人家的现成解决方案，再通过网上的文章对站点进行一些小的改造。</p><p>开通这个博客的目的在于发一些自己写的文章，以此记录自己的大学生活、学习过程。</p><p>于杭州。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;由于与 hexo-leancloud-counter-security 软件冲突，将标题从 &lt;code&gt;System.out.println(&amp;quot;hello world!&amp;quot;);&lt;/code&gt; 修改成 &lt;code&gt;hello world!&lt;/code&gt;。具体</summary>
      
    
    
    
    <category term="程序园" scheme="https://blog.xiang578.com/categories/%E7%A8%8B%E5%BA%8F%E5%9B%AD/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="blog" scheme="https://blog.xiang578.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>构建之法读书笔记</title>
    <link href="https://blog.xiang578.com/post/build-to-win.html"/>
    <id>https://blog.xiang578.com/post/build-to-win.html</id>
    <published>2015-05-23T07:03:41.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>偶然发现之前在博客园写过这篇读书笔记，顺手贴过来。</p></blockquote><p>应该是从上周六开始看这本书，起因是其他人发布一张书中内容截图。作者讲到技能的反面中的总结部分——如何考察一个人是否精通魔方：</p><ol><li>给面试者一个各面打乱颜色的魔方;</li><li>要求他把六面还原;</li><li>如果还原了，要求他把魔方恢复成我最初给他的那个混乱的局面，必须一模一样。</li></ol><p>看到这些，最近自己也在思考这个问题，自己学习一样东西如何才是真正的掌握了？本书作者是微软员工，也是一名经验丰富的程序员，这种检测是否精通魔方的方法给我耳目一新，接下来的学习中可以这样去思考问题。</p><p>本书名叫《构建之法》，其实是讲述软件工程课程的教材。自己应该在大三也会有这一门课，不知道会上成什么样……前面几个章节看的比较仔细，团队运作模式之类的只是翻过一遍而已。现在对于这些不是很感兴趣。</p><p>总体来说，收获还是比较大的，也更新了自己的某些观念。比如作者在书中提出1/N的打分体系，第一档满分，第二档的一半，第三档得三分之一。</p><p>可以让想学习的学生知道如何努力，想混的也知道怎样才能混过去，不想上的也会知难而退。现在学校的打分体系确实差劲，很需要往这方面靠近。更重要的是给学生Natural critical learning environment，当然对自己学校来讲，要求有点过了。还有评价人的三种层次：行为和后果、习惯和动机、本质和固有性。</p><p>接下来是对编程的一些帮助，最重要的是“代码写出来是给人看的，而不是机器”。所以有了代码风格规范和代码设计规范。对于我自己来讲，体现在编程时的格式和变量名，格式可以靠自动对齐，和将复杂的功能用函数来实现，变量名可以采用英文缩写之类的，最重要不要出现什么拼音缩写。代码设计规范怎是考验编程能力了，这需要多写。最后是注释的原则，解释程序做什么和为什么这样做以及特别注意的地方。当然错误的注释比没有注释更麻烦。</p><p>最后是团队模式，现在自己学校里要求团队合作时，真心觉得还是自己一个人做方便，很难找到已经合适的人，自己又不喜欢协调沟通。不过书中讲的那么多规则，映象最深的是团队合作项目转组活动，这点目前没有经历过。其次是修改或维护前几届项目的原则，现在自己的作业，很多连样例都没有给你展示，更别说修改了，每次都要自己重新开始做。这也无可厚非吧。书中还讲到，结对编程，自己目前的体会是，几个人交流可以相互学习和传递经验，分享知识，不过某种程度也减少了探索的乐趣。书中补充了，带来更多满足感，更好的设计质量和代码质量之类的优势。</p><p>彩蛋：It’s not a bug .it’s a feature.</p><p>本书适合高年级之后，再来仔细研读。</p><p>2018 年重新阅读写的 <a href="https://xiang578.com/post/build-to-win-homework-0x00.html">构建之法 第 0 次个人作业</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;偶然发现之前在博客园写过这篇读书笔记，顺手贴过来。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;应该是从上周六开始看这本书，起因是其他人发布一张书中内容截图。作者讲到技能的反面中的总结部分——如何考察一个人是否精通魔方：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;给</summary>
      
    
    
    
    <category term="文渊阁" scheme="https://blog.xiang578.com/categories/%E6%96%87%E6%B8%8A%E9%98%81/"/>
    
    
    <category term="book" scheme="https://blog.xiang578.com/tags/book/"/>
    
    <category term="engineering" scheme="https://blog.xiang578.com/tags/engineering/"/>
    
  </entry>
  
  <entry>
    <title>钱塘江的风</title>
    <link href="https://blog.xiang578.com/post/before-go-to-univisity.html"/>
    <id>https://blog.xiang578.com/post/before-go-to-univisity.html</id>
    <published>2014-08-28T23:02:06.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>几年前读到过，前方纵然山花烂漫,诺是跃不过眼前窄窄的独木桥，就无法扑向那芬芳绽放的原野，眺望美景只能深深叹息。现在，已经过了。</p><p>高考前，路是黑的，只有前方亮着一盏灯，于是你只能坚定的朝那个方向走，而高考后，周围忽然亮了，很多条路在你面前，你反而不知道该往哪儿走了。我想起了罗伯特弗罗斯特的《未选择的路the road not taken》,以前是感叹选择的艰难，现在是体验艰难的选择。也只能和他一样选择了其中的一条路，余下的去回忆，或者遗憾。大概你选什么都会后悔的。就像关于高考完去旅行好还是买 iPhone好的回答，如果你去旅行，上了大学你会后悔没有买iphone。如果你买了iphone，大学毕业后你会后悔没有去旅行。</p><p>三个月来，多次翻看一位知友的话，高考最迷人的地方在于其阴差阳错，多一分少一分都有可能让你生活在完全不同的环境，认识完全不同的人，难道想一想这没有让你觉得激动和庆幸吗？无论上哪一所大学，都会让你失望，每一个新生都会骂他的学校。这是因为理想和现实永远存在差距。</p><p>听到要去学校的名字，钱塘江女子体育专修学校。大概就可以知道其特点，体育方面要求轻松超过清华（大一男子12分钟跑满分要求3000米，清华3000米满分要求12分钟20秒），清华称一流，我们就是超一流;女子就不用解释……再加上专业，总有一种NIKE还造钢笔的感觉。暑假中多次通过专业的工具考察学校地理位置，更是欣喜地发现这是一个适合读书的地方。当然要体验更丰富的大学生活还是要去综合性大学，一说起本校历史社团是归数学与统计学院，就可以知道大概了吧，或者我见识浅薄，他们是用全新的角度去诠释历史。总体上来讲，背靠下沙区，眺望萧山区，还可以称是杭州。按某位学长所讲，在学校边缘还会收到XX移动欢迎您的提示。旁边还有条江，就是题目中风的来源。更庆幸的是以后我从寝室出来，进入杭城另一所大学比去本校方便。这是不是一份花费，两份体验。</p><p>关于大学，现在无法去说它，也无必要。有学校在其新生手册中告诫学生，大部分学校本科教育不是濒临崩溃就是已经崩溃。也有复旦英语老师看到那么多大学开设英语专业时说，复旦这些学校可以凭名声再多挣扎一会儿，大部分学校却没有太大意义。大概就是这样了。某些学校还是不要叫大学为好，毁人不倦，希望我是错的。上大学，多半还是因为这条路通关人生的几率更大，直白点再混几年，什么促进人类文明进步，探索未知领域就太远、太广、太泛。初去时的欣喜可以持续多久，是开了又开？当你身临其中，也没有勇气再去赞同原深圳大学校长章必功关于某些东西的评论。毕竟人家是名校，你的是校名。征途，还会是星辰大海吗？</p><p>生活，没有已知条件。在这之前，又有多少人可以猜对归宿？多少人在仓促中选择，面对结果却只能接受。正是有些东西科学无法解释，世界才更有趣。或者仅仅是失败的安慰，不作就不会死。这个十几天内，我们中间有的去了北京，有的去了南京，或是留在了杭州的某一个遥远的角落，你又会在哪里入眠？有些要一年，有些要四年，有些要余生。某些冒险，唯一的作用就是让你明白自己是可以掌握自己的命运的，哪怕只是一点点。</p><p>不知道校园内可不可以吹到钱塘江的风，吹到了又是什么感觉？也不知道这是什么样的选择?</p><p>不管愿不愿意，新的生活已经开始了。谁知道又会发生什么？</p><p>谢谢你，看到这一行。</p><p>很高兴认识你，或许再也不见了。</p><p>2014年8月29日夜，于临海</p><p>PS：前几天独立、客观、第三方的在学校贴吧发的贴子都被删……</p><p><img src="https://media.xiang578.com/15139837811983.jpg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;几年前读到过，前方纵然山花烂漫,诺是跃不过眼前窄窄的独木桥，就无法扑向那芬芳绽放的原野，眺望美景只能深深叹息。现在，已经过了。&lt;/p&gt;
&lt;p&gt;高考前，路是黑的，只有前方亮着一盏灯，于是你只能坚定的朝那个方向走，而高考后，周围忽然亮了，很多条路在你面前，你反而不知道该往哪儿走</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
    <category term="zufe" scheme="https://blog.xiang578.com/tags/zufe/"/>
    
  </entry>
  
  <entry>
    <title>毕业杂感</title>
    <link href="https://blog.xiang578.com/post/something-about-high-school.html"/>
    <id>https://blog.xiang578.com/post/something-about-high-school.html</id>
    <published>2014-06-09T23:06:26.000Z</published>
    <updated>2024-05-12T11:15:03.469Z</updated>
    
    <content type="html"><![CDATA[<p>毕业杂感</p><p>三年前，我以为会骄傲的走出一中，下午又是怀着初次走进时的心情，三年仿佛一场梦，现在又回到了起点。</p><p>下午，唯一的期待只有排队上去领毕业证书，一中唯数不多的尊重个体的存在，最后的感动。其他的节目也可以无视了。之后，向学长讲的一样，信心满满的准备再来一次七圈半。挣扎完一圈后，获得与原来跑完七圈半一样的感觉，或者我也跑不动了。腰上的肉只是增加了体重。难怪其他人知道我长的这么凶猛，还欺负我。散步才是未来胖子的选择。</p><p>晚上吃饭时，压抑许久的东西爆发了。往日平静的人都拼命的喝起酒来，拿着麦克风歇斯底里的大叫。更有勇者，宣布了早已被他人看出的东西，不知后来有没有收到这个季节最合适的回答-------哪凉快哪呆着去,希望是我。我和其他两个人与两个老师退到了窗前，后面是喧闹与灯火通明，前面是寂静。冷风吹久了才明白，凤凰山庄真高档。听着已退休的化学老师感叹退休后真闲。也发现教了三年物理老师一只眼睛已经看不见。原因居然是书看太多……</p><p>与他人约定的雪碧大战啤酒，也在我喝完两杯雪碧后放弃了，幸亏他们又一次放过了我，no zuo，no die。我还是太年轻了，聚会还是喝酒好。在期待中，我们等来了最喜欢的数学老师。带着数学都是谁教的迷惑，我们勇敢的抬起了老师，毕竟五年来最难。每个人都在那里发疯，我也无聊的把啤酒摆成了12两个字。最后数学老师直接拿起了一瓶啤酒喝了起来，为什么没有人叫白酒。</p><p>离别时，有人对我说崇拜了我两年，愉快地说。小朋友真诚实。可却不知道，三模后我也开始嫉妒她。或者我是书看的太少，想的太多。想起其他人捡到的一本上届学长高三日记，原本以为他的经历我只能膜拜，到后来我也做到了。见证了他梦想从浙大到南大，最后留下作文跑题的遗憾，而我会有什么？我也没有勇气在自选考完之后，对着学霸讲出：你的时代已经结束了！虽然也只是我认识他，他不认识我。而我，也仅仅是俞敏洪演讲所提到的，有时候不是因为我坚强继续，只是别无选择，所以才全力以赴去做某些事。</p><p>此刻不得不提高考，去年6月承受着巨大的压力，有时中午是想起这东西而惊醒。这一年却又是平静。到头来，很少有人可以改变自己。就像六年来，没有发现我认为有巨大改变的人。该干什么，还是干什么。不该干什么，也许也会干。在考场上你才会发现，这就是高考，你已无能为力。打败你的不是试卷，而是你自己。放弃的自己。多数人也再无机会，唯一的选择只是直面惨淡的人生。无论什么结果，生活还要继续。现在才明白，高考不是淘汰，而是磨平一部分人的心。我们有过豪言壮志，非XX不上，再随手吓死看不起自己的人。到今天，更多的是正常水平就好，XX也好。毕竟是等待，为什么不多安排几个人改呢？自此，安逸才是奢求。想看过海韵上的文章所讲一样，8点钟睡觉。不由回想起小学时被逼8点钟睡，而不得已去拨慢时钟，最后在慢了半小时后被发现。真是罪过。现实下，哲学与诗歌终究太过单薄，宗教才是人类心灵之火的栖息地。像语文老师讲过的，信教真幸福。愿意余生在佛与GOD中度过。初中同学的突然生病离开，我才发现在生命面前，高考已无那么重要。有什么事再不做就没有以后了。</p><p>高考前觉得干什么都有用，家里人问我为什么看那么多与历史有关的书，我也可以骄傲地回答，可以用来写作文。高考之后换成了看什么都没有用，再看见那些书，只有祈祷，如果有来生，我也愿意信来生，再见面。</p><p>又回到自己，究竟是什么？自己认为的失败者。晚上还有人说我很有趣，老师告诉我够了。或者去年运动会时，某高二听了我的解说，认为我像周立波。都是不同，选择的不同。我很难与大多数人竞争，所以经常去干人少的事。就像3000m，实际上到了才发现人更多，所以又一直期待校运会上有5000m。实际上我更认可疯狂，像苹果早年广告所讲的一样，只有疯狂到自己能改变世界的人，才能真正改变世界。毕竟这也是曾经的梦想。</p><p>再回来，发现还有许多事情没有干。不提破解教室里的饮水机，踩死操场上所有的小草这些小事。总觉得走的太匆忙，解析几何还是不会，最后一题也仅是看看。达不到数学老师140分免暑假作业的要求。人生就是这样遗憾。</p><p>下午听到不是在最美的时光遇见你们，而是因为遇见你们才有了最美的时光。说白了也只是适应环境。去年来12班回访的学长讲到，如果高考考好一点，就可以去浙江财经大学，半年来发现杭电也不错。呆久了就会好的。三年的一切都在脑海里翻转，等待着我去忘记。原以为记录是最好的回忆，现在才明白遗忘才使过去日久弥新。就像教育的本质是那些你几年后还记着的东西。五毒书记张二江出狱后感叹过，关进去前几年，情人还来看过，原来整天称兄道弟官场上朋友，早不见踪影。只有大学同学，不管他是书记也好，囚徒也罢，还过来看看他。这就是北大EMBA招生广告中所宣称的28万让柳传志叫你一声老同学的意义吧。</p><p>浮生着甚苦奔忙，盛席华筵终散场。悲喜千般同幻渺，古今一梦尽荒唐。曹雪芹用这样的诗句来表明写红楼梦的内心，我们又何尝不是，三年来，在情感和分数里煎熬，吃的猪狗食，学的数理化，被囚禁的野兽是不会感谢笼子的。欢乐的时光总是短暂的，没有了下期再见。我们也终将忘记高考，终将忘记一中，终将忘记彼此。我也无法否认生命因你们而精彩。</p><p>我爱这个世界。</p><p>谢谢你看到这一行。</p><blockquote><p>本文仅是午夜梦话，所写一切均可看成虚构，与我无关。<br />6.10 00：01 于椒江<br />6.11 00：38修改<br />6.20 10：05修改</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;毕业杂感&lt;/p&gt;
&lt;p&gt;三年前，我以为会骄傲的走出一中，下午又是怀着初次走进时的心情，三年仿佛一场梦，现在又回到了起点。&lt;/p&gt;
&lt;p&gt;下午，唯一的期待只有排队上去领毕业证书，一中唯数不多的尊重个体的存在，最后的感动。其他的节目也可以无视了。之后，向学长讲的一样，信心满满的</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
  </entry>
  
  <entry>
    <title>如果，高一</title>
    <link href="https://blog.xiang578.com/post/if.html"/>
    <id>https://blog.xiang578.com/post/if.html</id>
    <published>2012-07-22T23:17:32.000Z</published>
    <updated>2024-05-12T11:15:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>1序<br />受《如果，宅》影响下编出来的东西，博君一笑。</p><span id="more"></span><p>2某星期三下午 学术报告厅内听校长讲座<br />校长：“同学们要根据自己未来的职业选择来读文理科。”<br />主任：“我要当领导，选什么？”<br />我:“退学！”<br />过了一会……<br />我:“先去泰国做手术，再找个干爸爸……”<br />主任：……</p><p>3语文课讲《烛之武退秦师》<br />老师：“烛之武为什么要这样讲，我们先看一下当时的中国地图。”<br />我纳闷了，没电脑，没插图，怎么看？<br />只见老师麻利地檫干净了黑板,化画了三个圈，分别写上秦晋郑。<br />老师：“当时秦国在这里，晋国夹在秦郑中间。”</p><p>4某天听力训练<br />主任写的不耐烦了，大叫并伴灿烂的笑容：“信B叔，得永生。”<br />于是写下了B B C<br />翻开答案一看：B C C<br />我：“B叔还是太年轻了。”</p><p>5 政治课前<br />我拿出政治书：“翻开政治，一想起国家尚未统一，世界尚未和平，我就没心思读了。”<br />主任：“建国前，刘少奇说：‘国家尚未统一，选毛主席。’朱德说：‘国家尚未统一，选毛主席。’邓小平说：‘国家尚未统一，选毛主席。’最后就有了毛主席。”</p><p>6 中考之后<br />瓜子：“伯形女儿考了这么好应该请吃饭。”<br />我：“多吃几张试卷还是有的。”<br />HG：“函数大餐，三角点心，向量甜品。”</p><p>7化学课，讲蛋白质，烧了蛋白质物品后<br />老师：“想要闻一下味道的，自己回去烧一下头发。”<br />我：“烧一把也没用。”<br />昏君淡定地笑了。</p><p>8数学课上课之后，化学老师还在<br />伯形：“大家先看一下上面的题目。”<br />化学老师看着自定义题目说：“这是什么符号。”<br />众人大笑。<br />伯形：“化学符号……”</p><p>9化学课<br />教写A2B,AB2型电子式。<br />老师：“都懂了吗？”<br />我：“过氧化钠怎么写？”<br />主任：“HClO怎么写？”<br />……</p><p>10 4月1日数学课<br />伯形照例抽人上去默写。<br />伯形：“41号”<br />我无奈地走了上去。<br />伯形拿着粉笔笑咪咪地对我说：“今天是你的节日……”<br />我……<br />实际上都是本地老狐狸，装什么聊斋……</p><p>11期中考试后，数学课<br />伯形：“你们江山一片红，几乎全是三十几分。”<br />我：“终于全班几十分了。”</p><p>12期中考之后，某一下午<br />伯形在教室叫了几个人默写后。<br />伯形：“这样查了，如果你们期末还没考好，我就去跳楼。”<br />在教室的人欢呼雀跃。<br />伯形：“有什么好激动的，我从一楼跳四楼，从楼梯上跳就好了。”<br />于是，期末考试数学再创新低。</p><p>13 音乐课<br />老师:“你们站到后面去排练一下。”<br />主任：“沈XX坏我大事，数学作业写不成了。”<br />我：“对啊！好几节音乐课没上，我的睡眠规律都被打乱了。”</p><p>14语文课，找人上去演讲《我有一个梦想》<br />王木高票推荐上台。<br />王木：“今天，我有一个梦想。”<br />众人：“好！”<br />某些人：“不是今日吗？”<br />众人：“哈哈……”</p><p>15物理课<br />老师：“我比较喜欢画V-T图像解题。”<br />HG：“我比较喜欢A-V图像。”<br />……</p><p>16默写完《雨霖铃》之后<br />老师：“有一位同学，错的很离谱，‘兰舟催发’写成了‘兰州催发’，兰舟就是小船，你写兰州干什么？”<br />主任：“贴吧玩多了。”<br />我：“人才！”<br />某人：“不去贴吧可惜了！”<br />二默中涌现出更多人才……</p><p>17政治课 讲宗教问题<br />老师：“清华北大是我国最高学府，大学生研究生出来，用科学思想武装自己，还是宗教思想，你们出来干什么？”<br />主任：“卖猪肉！”<br />……</p><p>18瓜子生日<br />主任HG准备好好庆祝一下！！！为新高一奉献一场精彩的表演。<br />晚读时 主任：“我已经等不到下课了。”<br />下课之后，我好像没有听到大动静。<br />主任从外面回来之后：“太爽了，没抬到楼下，在厕所门口就解决了。”<br />我：“有人帮你们吗？”<br />主任：“我和HG叫了一声阿鲁巴，一群七班的叫着：‘生活需要激情！’<br />帮忙抬起了瓜子，最后瓜子裤子破了，才停。”<br />回到寝室<br />我：“晚上咋么样？”<br />HG：“一群七班的大叫：‘生活需要激情！’……”<br />看来被压抑太久了……</p><p>19 WCG取消PC项目，看完游戏风云专题回顾后<br />主任：“WCG也欠我一个冠军！”<br />我：“……没关系，让HG去打鸟赢一个冠军回来。”</p><p>20 校园改造，拆除护网后<br />我：“全拆了。”<br />HG：“不，全都换上了无线网，看不见了，效果依旧。”<br />我：“一中也要打造无线校园了啊。”</p><p>21准备音乐考试<br />我：“有没有什么歌，整首只有一句歌词，一个调的？”<br />A：“祝你生日快乐~~~~~”<br />我：“是不是还有英文歌 happy birthday to you？”<br />A：“对的！”</p><p>22看着旁边一男的穿了一白背心<br />我“他穿背心了。”<br />主任摸了一下他背：“你穿吊带了啊！”<br />那人：“你神经病啊！”</p><p>23继续吊带<br />我：“今天他有没有穿？”<br />主任一摸：“穿了。”<br />H：“有什么好笑的，温jianbao也这么穿。”<br />我：“你怎么知道？”<br />H：“他深入下乡时不是都这样穿得吗？”</p><p>24继续<br />我：“今天领导有没有下乡。”<br />主任：“有。”<br />H……</p><p>25多日之后<br />我：“领导好久没下乡了！”</p><p>26某星期一早晨第一节课<br />班主任看着主任位子上没人对我说：“他还没来？”<br />我：“没有来？”<br />班主任正准备打电话，主任推开门进来<br />老师：“怎么这么晚才来？”<br />主任：“有原因的。”<br />老师：“起晚了？”<br />主任：“闹钟没响。”</p><p>27主任坐下后<br />我：“这么晚来都没事的啊？”<br />主任：“迟到一两分钟门卫会记你的，再晚一点他们不会管你的，所以我在外面逛了好久才进来。”<br />我：“原来你是为了班级荣誉才来那么晚的啊！”<br />主任笑了。</p><p>28 历史课，讲文学类型<br />老师：“路漫漫其修远兮，吾将上下而求索。有其他班同学讲漫漫没有三点水。”<br />众人：“语文书上没有。”<br />老师：“可能版本不同吧 ？”<br />我：“语文课上讲，写三点水的没文化。”<br />老师：……</p><p>29 期中考前一中午<br />教室后面又要进行阿鲁巴。一群人围住了一女生。<br />我：“是强奸吗？”<br />主任：“不，是轮奸。”<br />抬起时，伯形从外面晃进来。<br />众人迅速散去。<br />伯形：“你们只会欺负她一个人。”<br />伯形：“你们中午不学习，不要吵，去休息。搞的跟国际文武学校一样。”<br />说完就离开了。<br />主任：“风气都被七班带坏了。”<br />我：“又被救一个。”</p><p>30浙大学子回访时 在广播台做节目<br />主持人：“听说浙大美女很多？”<br />学长：“这么跟你说吧，我们一共有六幢宿舍，一女五男。”<br />事后一想，不正是一对情侣，两对基。</p><p>31期中考前 地理课<br />由于地理老师没讲清楚，大部分人不知到导引写哪里。<br />老师看见一个人用手挡住作业本：“不用挡了，我看见你没写了。”<br />老师继续看其他人。<br />看见我将作业大开地放在桌子上：“你怎么没写也不挡一下？”<br />无奈只好用手挡一下……</p><p>32<br />A:“化学实验手册明天交不交。”<br />我：“可以期中考后交。”<br />主任：“也可以不交。”<br />我：“丢了就好，主任经常丢的。”<br />主任：“我什么时候干过？”<br />我：“对，你是忘带了，放在枕头下面。”</p><p>33主任经常丢物理作业之后<br />主任：“我物理书丢了，怎么办？”<br />我：“再接再厉，帮我们把物理老师丢了。”<br />主任……</p><p>34未上课前<br />老师：“把地理试卷拿出来给我看看。”<br />我：“我先去趟厕所。”<br />当我在洗手时，又陆续来了一些人……<br />我：“大家都来了。”<br />周哥：“你那边已经检查过了，可以回去了。”<br />……</p><p>35分析2012浙江英语高考作文，读例文时<br />老周：“Take Abraham Lincoln, for example.”<br />我：“我可不可以Take my father Li Gang, for example.”<br />主任：“我爸是李刚，吓坏老师。”<br />我：“实际上，我爸是李刚，老师你懂的。”</p><p>36英语讲单词时<br />老周指着黑板上的 admire the moon 说：“实际上这moon换成girl更好。”<br />某人：“beauty！”<br />老周：“对！”</p><p>37 数学课用Word讲题<br />由于式子太小<br />伯形：“放大点，给你们看清楚。书没读好，各个都是高度近视。”<br />众人无语。<br />伯形：“虽然我书没读好，但眼睛还是好的。没有1.5，至少1.2。”<br />……<br />其实我们不关心你视力多少，更想知道书没读好眼睛没坏，到底花时间干什么去了……</p><p>38 去烈士陵园路上<br />HG：“早知道带副扑克去了。”<br />主任：“早知道带三国杀去了。”<br />我：“你们这帮人，战争年代，革命烈士抛头颅洒热血，才换来今天的幸福生活……”<br />此时，伯形从傍边经过，然后盯着我……</p><p>39 老周不在，14班老师代课<br />下课之后<br />昏君：“你们听懂了吗？”<br />我：“一整节课下来，我只听懂了一样东西，对于这个我也只能回答 I don’t know !”<br />主任：“都是you know? you know? you know? you know?”</p><p>40 继续<br />教室另一边<br />A:“有100多遍you know?”<br />B:“130多好吗？我很仔细记了！”<br />接下来的一周里，课堂上听的都是you know? you know? you know? you know?</p><p>41英语课讲二模改错时<br />讲到一个单词 梳头<br />老周：“一般女孩子都会带梳子和镜子<br />，可以整理一下。”<br />主任：“HG也有！！！”</p><p>42还在讲改错<br />老周读了一个长句子后，问哪里错了<br />主任：“这么长的句子，一个标点都没有，肯定有问题。”<br />……<br />老周又读完一个句子<br />主任：“这么长的句子，一个标点都没有，肯定有问题。”</p><p>43健力宝在超市门口搞活动<br />于是我们过去每人买了一瓶准备抽一把雨伞<br />无奈只抽到一些圆珠笔和餐巾纸<br />老板：“实际上，你们抽到都赚了。这些东西价格都在一元以上。不是在乡下，餐巾纸都要一元吧。”<br />我指着大一中超市：“这里面就卖五毛。”<br />老板……</p><p>44<br />老板继续：“你们吃完饭后，可以擦嘴。”<br />他把手放在嘴前做擦嘴动作。<br />老板：“上完厕所后……”<br />双手放下……<br />然后……<br />我们走了……</p><p>45 大合唱排练时 我们在体育馆台阶上练习时<br />HG指着其他一个班：“那是美女与野兽吗？”<br />主任：“不，是野兽与野兽。”<br />我：“不，是禽兽与野兽。”</p><p>46大合唱前，男的穿粉红色短袖，女的穿蓝色短袖<br />我：“等一下，他们以为八班男生都剪短发。”<br />昏君：“应该是八班男生好矮。”<br />L：“八班男生好多。”<br />我：“八班女的像男的。”<br />……</p><p>47 午休 英语考试前<br />老周：“小考小信心，大考大信心。”<br />主任：“小考小打击，大考大打击……”</p><p>48数学课<br />伯形指着黑板上的a=xb+yc说：“看到这些想起了什么？”<br />众人沉默<br />伯形：“苹果？如果想起苹果，那你完蛋了？”<br />之后<br />伯形：“想起了什么？”<br />主任：“苹果。”<br />我：“蓝莓。”</p><p>49数学课<br />已知P点是三条中线交点。<br />伯形：“P点是三角形的什么心？”<br />主任：“内心？”<br />……<br />主任外：“外心？”<br />……<br />伯形：“没良心……”</p><p>50某星期四早读<br />伯形进来后，语文课代表在讲台上查语文作业<br />伯形：“实际上，作业不用每天查。一次查到没做乘以五就好了。”<br />我：“这都什么？”<br />伯形：“你没学过抽样统计？”<br />计算着要抄的语文课文数（=1+2+3+4+5）<br />我：“好残忍！”<br />伯形：“谁让你犯贱！”</p><p>51主任杭州漫展回来后<br />买了桌游《宿命》，我翻着说明书<br />主任：“你现在跟我比宿命英雄技能谁知道的多!”<br />我：“比三国杀，爆你到日本。”</p><p>52英语听力时<br />广播：“衬衫的价格是九磅十五便士。”<br />老周：“物价上涨，只有衬衫的价格不涨！”</p><p>53物理课<br />老师：“重力做功与路线无关。什么力做功与路线有关？”<br />我：“摩擦力！”<br />老师：“对！”<br />于是在黑板上画了一个大圈。<br />老师：“从1 2 3走，摩擦力做功不同。”<br />主任：“老徐生动形像的解释了2b青年 文艺青年 普通青年。”</p><p><img src="https://media.xiang578.com/15139856357712.jpg" alt="" /></p><p>54 数学课讲练习<br />我：“又是观察猜想法！”<br />伯形：“也许你还不会！”<br />我：“全部填空题我就对这一道容易吗？”</p><p>55开学不久后的数学课<br />伯形指着一个复杂的等式：“会解吗？”<br />伯形：“不要看见就怕了哦！”<br />无人理……<br />伯形：“跟我在七班说的一样，你们这帮人，只能去造鸡蛋。造原子弹早就把自己炸死了！”</p><p>56数学课教求导公式时<br />伯形：“高斯的老师给学生一道题目1+2+3+…+100 有人从1加到100。<br />如果是你会怎么算？“<br />伯形：“十岁的高斯有个很好的方法。”<br />我：“首项加末项……”<br />伯形：“那你还行？”<br />我：“七岁老师就教过了！”<br />伯形……</p><p>57期中考<br />考完政治之后才知道和其他人的差距。<br />我考完试回来，有人吃完饭回来。<br />我：“你有没有吃完饭？”<br />主任：“想出来，出不来。”<br />我：“为什么？”<br />主任：“伯形监考。”<br />我：“脸皮厚一点就好了。”<br />主任：“有个十九班的要出去，被伯形留了下来。”<br />我……<br />地理考试中，伯形抓住一打小抄作弊者，我们感慨：“真乃电子狗伯形！”</p><p>58 某星期一下午<br />语文课看电影，下课后，伯形进来看。<br />过来一会儿，语文老师带着电脑走了。<br />伯形：“其实电影看多了，不好，人会变笨的。”<br />……</p><p>59 期中考完历史后<br />有一道题目，让你写毛泽东井冈山时期写的文章。<br />C：“《井冈山的故事》”<br />其他人：“《井冈山的斗争》”<br />A：“什么故事？”<br />C：“爱…情…故…事…”</p><p>60期中考后讲数学试卷<br />伯形叫了几个人上去写题目，自己在教室里转。<br />伯形：“你们这些人都是臭鸡蛋！”<br />众人不解。<br />伯形：“21题平均分0.9分，不是臭鸡蛋还是什么？”<br />我：“原来我是两个臭鸡蛋！”（21题 8分）</p><p>61 分析数学试卷时<br />伯形：“你们脑子坏了，用硫酸都融化不了，”<br />众人：“用王水。”<br />伯形：“什么王水，硝酸都不行。”<br />我：“王水酸性比硝酸强！”</p><p>62期中考后历史课<br />老师：“我把选择题答案报一下。”<br />众人：“写一下吧。”<br />老师：“写出都不环保。”<br />我：“讲出来有噪音污染。”<br />老师：“啊，写出来浪费粉笔。”<br />我：“高考前禁噪。”<br />老师……</p><p>63数学课将习题<br />伯形：“到底记住没有？没记住的都吃一点皮猪肉。”<br />伯形：“吃皮猪肉会增强记忆力，少吃鸡蛋。”<br />我：“那你吃了几头？”<br />……</p><p>64 期中考后<br />梁：“HG，我们政治都一样4X，班长8X，不是人。”<br />梁：“我们这种人，国家最放心，班长，国家不放心。”</p><p>65 英语课分析报纸<br />我指着试卷上的“go ahead”问主任什么意思。<br />主任：“去个头。”<br />……<br />从此以后再也不问主任……</p><p>66数学课<br />伯形“现在你们要好好学习，考上大学。以后出去，没大学文凭，人家会看不起你。”<br />伯形：“为什么现在哪么多老板会不惜几十万买一个文凭，摆出来看。我原来在读硕士，有老板花几万找人上学，再花一二万，找人写论文，一个博士文凭7万！！！”<br />主任：“才七万。”<br />我：“不读了吗？”</p><p>67化学课<br />要用酒精灯时<br />老师：“怎么实验员老是不给我火柴。”<br />众人大笑<br />老师：“幸亏我有打火机，呵呵！”</p><p>68化学课<br />老师：“好我们开始上课。”<br />我：“还有十分钟能讲什么新课？”<br />主任：“下课还有三十分钟。”</p><p>69王木回家喝喜酒回来后<br />我：“为什么不叫我们过去？”<br />王木：“……”<br />某人：“你家朋友多不多？”<br />王木：“没几个。”<br />我：“叫我们过去人就多了，等一下，你家亲戚会发现，你的人缘真好，认识的男的多，女的更多。”</p><p>70继续<br />HG：“对啊，天哥过去，会认为是高二升高三，yjn初三的，gx初一的。”<br />……</p><p>71历史课<br />老师：“这星期作业为导引必修一部分，星期日交。你们每天要写一点。不要以为是星期六晚上的作业。”<br />主任：“没关系，对于我是星期日早上的作业。”</p><p>72物理课——重力势能<br />老师：“可能这个例子不太好，有一个同学从四楼跳下去，我们来研究这个问题。”<br />众人：“@#￥%##@￥%……&amp;*￥#%！”<br />老师：“没什么问题吗？”<br />我：“思想问题，自杀是犯法的。”<br />老师：“我没说他往外面跳，他往里面跳。”<br />我……</p><p>73化学课<br />老师：“乙炔与乙烯是同系物吗？”<br />众人:“不是。”<br />老师：“大学中化学系与物理系不一样。”<br />我：“魔兽世界与魔兽争霸听着差不多，玩起来会一样吗？”<br />主任：“这就听懂了。”</p><p>74开学不久后<br />吃完早饭，回寝室中<br />主任看见有人边走边玩iphone。<br />主任：“其实不交钱，我也可以买iphone。”<br />我：“其实我们交了1代到4代外加ipod1 ipod2的钱。”</p><p>75数学课上午第一节课<br />伯形：“前几天，我看了一个电视。说你周六写作业，第一样写了1小时，第二样写了半小时，第三样写了二十分钟。最后你没写完。专家说你睡一觉，觉得时间没了会写完全部作业。”<br />某人：“那我们先睡半小时在上数学课。”<br />伯形：……<br />我：“难道高考先睡一个半小时，最后半小时，发愤图强将压轴题也秒杀了吗？”</p><p>76伯形理完发后，回来上课<br />站在讲台上扫视一周后<br />伯形：“后面一排干什么投降，个个低着头。”<br />我：“被你帅气的发型吓怕了……”<br />主任笑而不语</p><p>77物理课<br />老师：“第二题写错的同学没有看清两个字：匀加速。”<br />众人：“不是三个字吗？”<br />我拿起手指数了一下说：“我该补数学还是语文？”</p><p>78期中考前<br />发下一张物理答题卷<br />昏君看着选择题 、填空题的横线，找不到题目：“这叫人怎么写？”<br />主任：“这主要训练考前蒙题能力的，让你结合题号、上下题选项来蒙。”<br />混君：“填空题怎么办？”<br />主任：“结合生辰八字、考号、考场位置来蒙。”<br />……</p><p>79地理课其他老师代课<br />老师：“李老师讲过可持续发展三大原则吗？”<br />主任：“没有。”<br />老师：“公平性原则……”<br />主任：“有。”<br />回想起他的听课，我：“你懂？”<br />主任：“……”</p><p>80地理课，继续代课老师<br />老师：“我国黑土地分布在哪里？”<br />我对主任说：“QQ农场。”<br />老师：“你们有没有讲过紫色土壤。”<br />主任：“QQ农场还没出。”<br />我：“腾讯高级机密……”</p><p>81政治课 讲中央机构产生过程<br />A:“为什么都只有一个候选人？”<br />B：“如果有两个，一个没选上，关系不搞僵了，大家都认识……”</p><p>82不知团委书记找老周写什么东西。<br />老周：“笑话，让我一个英语老师写中文。”<br />主任对我说:“那我们中国人学什么英文……”</p><p>83自修课<br />看着前面XX与XX在XX<br />主任对我说：“只允许XX，不允许学习。”<br />我：“等到老了的时候，有人问你干了什么，你学习了，他们XXX。”</p><p>84某天语文课<br />老师：“现在同志都变味了，要是在以前，一声同志多么亲切，革命友谊。”<br />众人：“现在什么意思？”<br />老师：“我不告诉你，自己去查。”<br />于是，某人掏出手机……<br />没有然后了……</p><p>85数学课讲练习<br />伯形：“大家看看，做选择题就要不择手段，做出来就好了！”<br />众人大惊<br />伯形仔细一想，又补充了一句：“当然，作弊除外。你想一下，你把你旁边的人试卷看了，他比你更笨，你把自己正确的答案改了，怎么办？”</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;1序&lt;br /&gt;
受《如果，宅》影响下编出来的东西，博君一笑。&lt;/p&gt;</summary>
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
    <category term="life" scheme="https://blog.xiang578.com/tags/life/"/>
    
  </entry>
  
  <entry>
    <title>2011</title>
    <link href="https://blog.xiang578.com/post/2011.html"/>
    <id>https://blog.xiang578.com/post/2011.html</id>
    <published>2012-01-23T03:05:52.000Z</published>
    <updated>2024-05-12T11:15:03.461Z</updated>
    
    <content type="html"><![CDATA[<p>已过 2011年早已过去二十多天。原本打算在元旦完成这篇，可谁知一拖就到了春节。从公历新年到了农历新年。写这些东西，也不完全是一时心血来潮的想法，而是希望留下一些关于2011的记录（毕竟记忆力这东西不牢靠），加上借此机会反思一下自己一年来的行为。</p><p>回忆起2011，有什么特别？卡扎菲之死？乔布斯之死？金正日之死？或者三国杀完结？斗破完结？姚明退役？一件件大事跃然纸上，仔细一看却都不是什么好事。更实际些，只剩下中考。此处的中考，不仅仅局限于考试的那几天，更应该包括中考之前的几个月以及中考之后几个月所带来的一系列的变化。</p><p>先从中考开始说吧，很可悲，因为中考，才制定了人生中第一个明确的、长远的计划。说白了就是考上一中，仅此而已。2011年初，《网络游戏秘笈》搞了一个活动，写给2012的一封信。看了之后，我也写了一封，不过不是给2012，而是给6个月之后。当然6个月之后，我把它撕了。其中内容也无非是关于高中，当时假设会考上一中。最后，我仅猜对了结果，没有猜对过程。无奈，为国家财政分担教育支出。不过正如一位老师对我说的，再差还是在一中。也就马马虎虎完成了目标。</p><p>1月 期末考之后，拥有很大决心，独自跑到新华书店买了十本书（5本天利38套，5本压轴题），准备在下半学期完成。最后，也只是每本写了一点。<br />接下来的几个月，就是昏天黑地的读书（实际上也没那么严重），只为考上高中。记忆在此处已经是一片空白。<br />中考之后的暑假，本着白日做梦精神，规划高中学习，前途一片光明。时至今日，我发现我还是继续睡吧。离梦想越来越远。<br />8月底 可恶的军训，无非是关于痛苦的记忆。印象最深的是一天晚上，全班男生被教官罚蹲（不知是谁发明的，遭天杀的！！！完全无视人身权利），忍受着自身重力所带来的痛苦，一直到那天晚上训练结束。至今不明原因。<br />9月 高中第一个月，一来就不适应。前几天，一到数学课就想睡，下课铃一响就来精神。还有一读就想睡的政治，不知所云的地理。总之，前几个星期做梦般度过。直到有一星期，一同学打电话问我一道数学题，我才发现几星期来什么也没学，于是开始改变自己。<br />10月 第一次月考和运动会。成绩也令人失望，也发现自身存在的问题。于是，从那以后，几乎每天晚上到学习室报到。运动会没我什么事，三天都是坐在看台上打酱油，只是被高二高三开幕式创意所震惊。<br />11月 第二次月考 明白了跟其他人一样的学习方法根本不会有所谓的成功，原来不想做的必须做。也发现每天晚上去学习室写作业只是浪费光阴，造成效率低下。当然也记得，无聊所搞的神棍节大联欢以及那天晚上男生寝室的疯狂<br />12月 又是一年末。一学期以来习惯越来越差，也有了星期一恐惧症。还有元旦晚会，主要以热闹为主，谁管你好不好看，一上台就鼓掌呐喊，热闹就好。晚上，同学开始在寝室玩阿鲁巴，暴力啊！那么鲁着鲁着就到了2012……<br />1月 期末压力加剧，最后以远离计划的结果匆匆地结束了第一学期。<br />2011年大致就是如此，总结起来或许就是悲剧。然而却又无法否定悲剧所带来的改变。正所谓失败乃成功之母,一年以来各方面一直都在改变，世界观也越来越全面，思考越成熟。<br />2011年也认识了许多新朋友，虽然代价是与另群人见面更难。失去之后才懂得珍惜。走出去，才知道舞台的宽广。人生正是因为你们而精彩。<br />那么2011就结束吧！<br />对于2012，最先想到的是世界末日，主要归功于美国灾难大片《2012》的影响（只是听多了，却为曾看过）。世界将在2012年12月毁灭。当然，我也不想信1.听说玛雅人的预言水平与我的水平差不了都少。2.科学点，2012年只是玛雅文明新纪元的开始，就像我们从腊月廿九到龙年正月初一，只不过人家5000多年才新纪元，以及关于这之后没有预言（预言本质上看都是编的）3.世界上最公平的事，方舟不可能造出来，官二代富二代都与我们一样。<br />实际点，会考以及文理分班更值得担心。<br />当然对于2012，我充满信心。或者，我要活着看到2013年太阳的升起。<br />就是这一些吧。终于写完了！！！！！！<br />一万年太久，只争朝夕。<br />2012年1月23日<br />壬辰龙年正月初一<br />各位新年快乐一点吧！！！！！！去二十多天。原本打算在元旦完成这篇，可谁知一拖就到了春节。从公历新年到了农历新年。写这些东西，也不完全是一时心血来潮的想法，而是希望留下一些关于2011的记录（毕竟记忆力这东西不牢靠），加上借此机会反思一下自己一年来的行为。<br />回忆起2011，有什么特别？卡扎菲之死？乔布斯之死？金正日之死？或者三国杀完结？斗破完结？姚明退役？一件件大事跃然纸上，仔细一看却都不是什么好事。更实际些，只剩下中考。此处的中考，不仅仅局限于考试的那几天，更应该包括中考之前的几个月以及中考之后几个月所带来的一系列的变化。<br />先从中考开始说吧，很可悲，因为中考，才制定了人生中第一个明确的、长远的计划。说白了就是考上一中，仅此而已。2011年初，《网络游戏秘笈》搞了一个活动，写给2012的一封信。看了之后，我也写了一封，不过不是给2012，而是给6个月之后。当然6个月之后，我把它撕了。其中内容也无非是关于高中，当时假设会考上一中。最后，我仅猜对了结果，没有猜对过程。无奈，为国家财政分担教育支出。不过正如一位老师对我说的，再差还是在一中。也就马马虎虎完成了目标。<br />1月 期末考之后，拥有很大决心，独自跑到新华书店买了十本书（5本天利38套，5本压轴题），准备在下半学期完成。最后，也只是每本写了一点。<br />接下来的几个月，就是昏天黑地的读书（实际上也没那么严重），只为考上高中。记忆在此处已经是一片空白。<br />中考之后的暑假，本着白日做梦精神，规划高中学习，前途一片光明。时至今日，我发现我还是继续睡吧。离梦想越来越远。<br />8月底 可恶的军训，无非是关于痛苦的记忆。印象最深的是一天晚上，全班男生被教官罚蹲（不知是谁发明的，遭天杀的！！！完全无视人身权利），忍受着自身重力所带来的痛苦，一直到那天晚上训练结束。至今不明原因。<br />9月 高中第一个月，一来就不适应。前几天，一到数学课就想睡，下课铃一响就来精神。还有一读就想睡的政治，不知所云的地理。总之，前几个星期做梦般度过。直到有一星期，一同学打电话问我一道数学题，我才发现几星期来什么也没学，于是开始改变自己。<br />10月 第一次月考和运动会。成绩也令人失望，也发现自身存在的问题。于是，从那以后，几乎每天晚上到学习室报到。运动会没我什么事，三天都是坐在看台上打酱油，只是被高二高三开幕式创意所震惊。<br />11月 第二次月考 明白了跟其他人一样的学习方法根本不会有所谓的成功，原来不想做的必须做。也发现每天晚上去学习室写作业只是浪费光阴，造成效率低下。当然也记得，无聊所搞的神棍节大联欢以及那天晚上男生寝室的疯狂<br />12月 又是一年末。一学期以来习惯越来越差，也有了星期一恐惧症。还有元旦晚会，主要以热闹为主，谁管你好不好看，一上台就鼓掌呐喊，热闹就好。晚上，同学开始在寝室玩阿鲁巴，暴力啊！那么鲁着鲁着就到了2012……<br />1月 期末压力加剧，最后以远离计划的结果匆匆地结束了第一学期。<br />2011年大致就是如此，总结起来或许就是悲剧。然而却又无法否定悲剧所带来的改变。正所谓失败乃成功之母,一年以来各方面一直都在改变，世界观也越来越全面，思考越成熟。<br />2011年也认识了许多新朋友，虽然代价是与另群人见面更难。失去之后才懂得珍惜。走出去，才知道舞台的宽广。人生正是因为你们而精彩。<br />那么2011就结束吧！<br />对于2012，最先想到的是世界末日，主要归功于美国灾难大片《2012》的影响（只是听多了，却为曾看过）。世界将在2012年12月毁灭。当然，我也不想信1.听说玛雅人的预言水平与我的水平差不了都少。2.科学点，2012年只是玛雅文明新纪元的开始，就像我们从腊月廿九到龙年正月初一，只不过人家5000多年才新纪元，以及关于这之后没有预言（预言本质上看都是编的）3.世界上最公平的事，方舟不可能造出来，官二代富二代都与我们一样。</p><p>实际点，会考以及文理分班更值得担心。<br />当然对于2012，我充满信心。或者，我要活着看到2013年太阳的升起。<br />就是这一些吧。终于写完了！！！！！！<br />一万年太久，只争朝夕。<br />2012年1月23日<br />壬辰龙年正月初一<br />各位新年快乐一点吧！！！！！！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;已过 2011年早已过去二十多天。原本打算在元旦完成这篇，可谁知一拖就到了春节。从公历新年到了农历新年。写这些东西，也不完全是一时心血来潮的想法，而是希望留下一些关于2011的记录（毕竟记忆力这东西不牢靠），加上借此机会反思一下自己一年来的行为。&lt;/p&gt;
&lt;p&gt;回忆起201</summary>
      
    
    
    
    <category term="生活志" scheme="https://blog.xiang578.com/categories/%E7%94%9F%E6%B4%BB%E5%BF%97/"/>
    
    
  </entry>
  
</feed>
